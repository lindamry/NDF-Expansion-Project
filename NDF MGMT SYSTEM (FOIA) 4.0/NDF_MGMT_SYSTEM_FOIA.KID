KIDS Distribution saved on Thursday, 02/02/12 at 14:15
NDF MGMT SYSTEM (FOIA) 4.0
**KIDS**:NDF MGMT SYSTEM (FOIA) 4.0^

**INSTALL NAME**
NDF MGMT SYSTEM (FOIA) 4.0
"BLD",1414,0)
NDF MGMT SYSTEM (FOIA) 4.0^^0^3120202^n
"BLD",1414,4,0)
^9.64PA^5000.992^21
"BLD",1414,4,5000,0)
5000
"BLD",1414,4,5000,222)
y^y^f^^^^n
"BLD",1414,4,5000.1,0)
5000.1
"BLD",1414,4,5000.1,222)
y^y^f^^^^n
"BLD",1414,4,5000.2,0)
5000.2
"BLD",1414,4,5000.2,222)
y^y^f^^^^n
"BLD",1414,4,5000.23,0)
5000.23
"BLD",1414,4,5000.23,222)
y^y^f^^^^n
"BLD",1414,4,5000.3,0)
5000.3
"BLD",1414,4,5000.3,222)
y^y^f^^^^n
"BLD",1414,4,5000.4,0)
5000.4
"BLD",1414,4,5000.4,222)
y^y^f^^^^n
"BLD",1414,4,5000.5,0)
5000.5
"BLD",1414,4,5000.5,222)
y^y^f^^^^n
"BLD",1414,4,5000.506,0)
5000.506
"BLD",1414,4,5000.506,222)
y^y^f^^^^n
"BLD",1414,4,5000.507,0)
5000.507
"BLD",1414,4,5000.507,222)
y^y^f^^^^n
"BLD",1414,4,5000.508,0)
5000.508
"BLD",1414,4,5000.508,222)
y^y^f^^^^n
"BLD",1414,4,5000.509,0)
5000.509
"BLD",1414,4,5000.509,222)
y^y^f^^^^n
"BLD",1414,4,5000.56,0)
5000.56
"BLD",1414,4,5000.56,222)
y^y^f^^^^n
"BLD",1414,4,5000.6,0)
5000.6
"BLD",1414,4,5000.6,222)
y^y^f^^^^n
"BLD",1414,4,5000.608,0)
5000.608
"BLD",1414,4,5000.608,222)
y^y^f^^^^n
"BLD",1414,4,5000.7,0)
5000.7
"BLD",1414,4,5000.7,222)
y^y^f^^^^n
"BLD",1414,4,5000.8,0)
5000.8
"BLD",1414,4,5000.8,222)
y^y^f^^^^n
"BLD",1414,4,5000.9,0)
5000.9
"BLD",1414,4,5000.9,222)
y^y^f^^^^n
"BLD",1414,4,5000.91,0)
5000.91
"BLD",1414,4,5000.91,222)
y^y^f^^^^n
"BLD",1414,4,5000.92,0)
5000.92
"BLD",1414,4,5000.92,222)
y^y^f^^^^n
"BLD",1414,4,5000.991,0)
5000.991
"BLD",1414,4,5000.991,222)
y^y^f^^^^n
"BLD",1414,4,5000.992,0)
5000.992
"BLD",1414,4,5000.992,222)
y^y^f^^^^n
"BLD",1414,4,"B",5000,5000)

"BLD",1414,4,"B",5000.1,5000.1)

"BLD",1414,4,"B",5000.2,5000.2)

"BLD",1414,4,"B",5000.23,5000.23)

"BLD",1414,4,"B",5000.3,5000.3)

"BLD",1414,4,"B",5000.4,5000.4)

"BLD",1414,4,"B",5000.5,5000.5)

"BLD",1414,4,"B",5000.506,5000.506)

"BLD",1414,4,"B",5000.507,5000.507)

"BLD",1414,4,"B",5000.508,5000.508)

"BLD",1414,4,"B",5000.509,5000.509)

"BLD",1414,4,"B",5000.56,5000.56)

"BLD",1414,4,"B",5000.6,5000.6)

"BLD",1414,4,"B",5000.608,5000.608)

"BLD",1414,4,"B",5000.7,5000.7)

"BLD",1414,4,"B",5000.8,5000.8)

"BLD",1414,4,"B",5000.9,5000.9)

"BLD",1414,4,"B",5000.91,5000.91)

"BLD",1414,4,"B",5000.92,5000.92)

"BLD",1414,4,"B",5000.991,5000.991)

"BLD",1414,4,"B",5000.992,5000.992)

"BLD",1414,6.3)
1
"BLD",1414,"KRN",0)
^9.67PA^9002226^21
"BLD",1414,"KRN",.4,0)
.4
"BLD",1414,"KRN",.4,"NM",0)
^9.68A^5^5
"BLD",1414,"KRN",.4,"NM",1,0)
NDF & NDC ACTIVE LIST    FILE #50.68^50.68^0
"BLD",1414,"KRN",.4,"NM",2,0)
NDF ACTIVE LIST    FILE #50.68^50.68^0
"BLD",1414,"KRN",.4,"NM",3,0)
NDF LIST    FILE #50.68^50.68^0
"BLD",1414,"KRN",.4,"NM",4,0)
NDF PRODUCT DOWNLOAD    FILE #50.68^50.68^0
"BLD",1414,"KRN",.4,"NM",5,0)
NDFEXMP1    FILE #50.68^50.68^0
"BLD",1414,"KRN",.4,"NM","B","NDF & NDC ACTIVE LIST    FILE #50.68",1)

"BLD",1414,"KRN",.4,"NM","B","NDF ACTIVE LIST    FILE #50.68",2)

"BLD",1414,"KRN",.4,"NM","B","NDF LIST    FILE #50.68",3)

"BLD",1414,"KRN",.4,"NM","B","NDF PRODUCT DOWNLOAD    FILE #50.68",4)

"BLD",1414,"KRN",.4,"NM","B","NDFEXMP1    FILE #50.68",5)

"BLD",1414,"KRN",.401,0)
.401
"BLD",1414,"KRN",.401,"NM",0)
^9.68A^^
"BLD",1414,"KRN",.402,0)
.402
"BLD",1414,"KRN",.402,"NM",0)
^9.68A^^
"BLD",1414,"KRN",.403,0)
.403
"BLD",1414,"KRN",.5,0)
.5
"BLD",1414,"KRN",.84,0)
.84
"BLD",1414,"KRN",3.6,0)
3.6
"BLD",1414,"KRN",3.8,0)
3.8
"BLD",1414,"KRN",3.8,"NM",0)
^9.68A^2^2
"BLD",1414,"KRN",3.8,"NM",1,0)
NDF DATA^^0
"BLD",1414,"KRN",3.8,"NM",2,0)
NDF SUPPORT^^0
"BLD",1414,"KRN",3.8,"NM","B","NDF DATA",1)

"BLD",1414,"KRN",3.8,"NM","B","NDF SUPPORT",2)

"BLD",1414,"KRN",9.2,0)
9.2
"BLD",1414,"KRN",9.8,0)
9.8
"BLD",1414,"KRN",9.8,"NM",0)
^9.68A^55^55
"BLD",1414,"KRN",9.8,"NM",1,0)
NDF4P88P^^0^B307388
"BLD",1414,"KRN",9.8,"NM",2,0)
NDFAUTO^^0^B2918602
"BLD",1414,"KRN",9.8,"NM",3,0)
NDFCLAPR^^0^B3130397
"BLD",1414,"KRN",9.8,"NM",4,0)
NDFCLEAN^^0^B7358021
"BLD",1414,"KRN",9.8,"NM",5,0)
NDFCLPR^^0^B5123088
"BLD",1414,"KRN",9.8,"NM",6,0)
NDFCMOP^^0^B8375621
"BLD",1414,"KRN",9.8,"NM",7,0)
NDFDEACT^^0^B48719627
"BLD",1414,"KRN",9.8,"NM",8,0)
NDFDINT^^0^B9302716
"BLD",1414,"KRN",9.8,"NM",9,0)
NDFEDIT^^0^B589657
"BLD",1414,"KRN",9.8,"NM",10,0)
NDFENTER^^0^B10072202
"BLD",1414,"KRN",9.8,"NM",11,0)
NDFEX^^0^B2794368
"BLD",1414,"KRN",9.8,"NM",12,0)
NDFEXCLU^^0^B449129
"BLD",1414,"KRN",9.8,"NM",13,0)
NDFEXMP1^^0^B649764
"BLD",1414,"KRN",9.8,"NM",14,0)
NDFEXMPT^^0^B2346123
"BLD",1414,"KRN",9.8,"NM",15,0)
NDFINGR^^0^B1985906
"BLD",1414,"KRN",9.8,"NM",16,0)
NDFLIST^^0^B916307
"BLD",1414,"KRN",9.8,"NM",17,0)
NDFMERGE^^0^B8007115
"BLD",1414,"KRN",9.8,"NM",18,0)
NDFMESS^^0^B82972594
"BLD",1414,"KRN",9.8,"NM",19,0)
NDFMESS1^^0^B26019340
"BLD",1414,"KRN",9.8,"NM",20,0)
NDFMOP1^^0^B11529755
"BLD",1414,"KRN",9.8,"NM",21,0)
NDFNODDI^^0^B9351869
"BLD",1414,"KRN",9.8,"NM",22,0)
NDFNPRT^^0^B24217204
"BLD",1414,"KRN",9.8,"NM",23,0)
NDFNWVD^^0^B46034241
"BLD",1414,"KRN",9.8,"NM",24,0)
NDFORCE^^0^B10125920
"BLD",1414,"KRN",9.8,"NM",25,0)
NDFORMU^^0^B15982564
"BLD",1414,"KRN",9.8,"NM",26,0)
NDFPATCH^^0^B7739736
"BLD",1414,"KRN",9.8,"NM",27,0)
NDFPMI^^0^B1454016
"BLD",1414,"KRN",9.8,"NM",28,0)
NDFPMIL^^0^B815117
"BLD",1414,"KRN",9.8,"NM",29,0)
NDFPMIU1^^0^B4095282
"BLD",1414,"KRN",9.8,"NM",30,0)
NDFPMIUP^^0^B82005235
"BLD",1414,"KRN",9.8,"NM",31,0)
NDFPODDI^^0^B9408679
"BLD",1414,"KRN",9.8,"NM",32,0)
NDFPPRT^^0^B16485469
"BLD",1414,"KRN",9.8,"NM",33,0)
NDFPRE^^0^B42771381
"BLD",1414,"KRN",9.8,"NM",34,0)
NDFPRE1^^0^B22312725
"BLD",1414,"KRN",9.8,"NM",35,0)
NDFPRINT^^0^B8681815
"BLD",1414,"KRN",9.8,"NM",36,0)
NDFPURGE^^0^B6537121
"BLD",1414,"KRN",9.8,"NM",37,0)
NDFRECLS^^0^B24218333
"BLD",1414,"KRN",9.8,"NM",38,0)
NDFRR1^^0^B7091091
"BLD",1414,"KRN",9.8,"NM",39,0)
NDFRR10^^0^B49224079
"BLD",1414,"KRN",9.8,"NM",40,0)
NDFRR2^^0^B70274183
"BLD",1414,"KRN",9.8,"NM",41,0)
NDFRR22^^0^B11657258
"BLD",1414,"KRN",9.8,"NM",42,0)
NDFRR2A^^0^B141042683
"BLD",1414,"KRN",9.8,"NM",43,0)
NDFRR3^^0^B74290120
"BLD",1414,"KRN",9.8,"NM",44,0)
NDFRR5^^0^B4003001
"BLD",1414,"KRN",9.8,"NM",45,0)
NDFRR6^^0^B81057535
"BLD",1414,"KRN",9.8,"NM",46,0)
NDFRR7^^0^B47852152
"BLD",1414,"KRN",9.8,"NM",47,0)
NDFRR8^^0^B36357287
"BLD",1414,"KRN",9.8,"NM",48,0)
NDFRR9^^0^B51231892
"BLD",1414,"KRN",9.8,"NM",49,0)
NDFRR998^^0^B10432815
"BLD",1414,"KRN",9.8,"NM",50,0)
NDFRRDP^^0^B2302396
"BLD",1414,"KRN",9.8,"NM",51,0)
NDFRRDP1^^0^B2010305
"BLD",1414,"KRN",9.8,"NM",52,0)
NDFSHOW^^0^B5554261
"BLD",1414,"KRN",9.8,"NM",53,0)
NDFVUDPL^^0^B55796317
"BLD",1414,"KRN",9.8,"NM",54,0)
NDFVUID^^0^B54318253
"BLD",1414,"KRN",9.8,"NM",55,0)
NDFWARN^^0^B2120655
"BLD",1414,"KRN",9.8,"NM","B","NDF4P88P",1)

"BLD",1414,"KRN",9.8,"NM","B","NDFAUTO",2)

"BLD",1414,"KRN",9.8,"NM","B","NDFCLAPR",3)

"BLD",1414,"KRN",9.8,"NM","B","NDFCLEAN",4)

"BLD",1414,"KRN",9.8,"NM","B","NDFCLPR",5)

"BLD",1414,"KRN",9.8,"NM","B","NDFCMOP",6)

"BLD",1414,"KRN",9.8,"NM","B","NDFDEACT",7)

"BLD",1414,"KRN",9.8,"NM","B","NDFDINT",8)

"BLD",1414,"KRN",9.8,"NM","B","NDFEDIT",9)

"BLD",1414,"KRN",9.8,"NM","B","NDFENTER",10)

"BLD",1414,"KRN",9.8,"NM","B","NDFEX",11)

"BLD",1414,"KRN",9.8,"NM","B","NDFEXCLU",12)

"BLD",1414,"KRN",9.8,"NM","B","NDFEXMP1",13)

"BLD",1414,"KRN",9.8,"NM","B","NDFEXMPT",14)

"BLD",1414,"KRN",9.8,"NM","B","NDFINGR",15)

"BLD",1414,"KRN",9.8,"NM","B","NDFLIST",16)

"BLD",1414,"KRN",9.8,"NM","B","NDFMERGE",17)

"BLD",1414,"KRN",9.8,"NM","B","NDFMESS",18)

"BLD",1414,"KRN",9.8,"NM","B","NDFMESS1",19)

"BLD",1414,"KRN",9.8,"NM","B","NDFMOP1",20)

"BLD",1414,"KRN",9.8,"NM","B","NDFNODDI",21)

"BLD",1414,"KRN",9.8,"NM","B","NDFNPRT",22)

"BLD",1414,"KRN",9.8,"NM","B","NDFNWVD",23)

"BLD",1414,"KRN",9.8,"NM","B","NDFORCE",24)

"BLD",1414,"KRN",9.8,"NM","B","NDFORMU",25)

"BLD",1414,"KRN",9.8,"NM","B","NDFPATCH",26)

"BLD",1414,"KRN",9.8,"NM","B","NDFPMI",27)

"BLD",1414,"KRN",9.8,"NM","B","NDFPMIL",28)

"BLD",1414,"KRN",9.8,"NM","B","NDFPMIU1",29)

"BLD",1414,"KRN",9.8,"NM","B","NDFPMIUP",30)

"BLD",1414,"KRN",9.8,"NM","B","NDFPODDI",31)

"BLD",1414,"KRN",9.8,"NM","B","NDFPPRT",32)

"BLD",1414,"KRN",9.8,"NM","B","NDFPRE",33)

"BLD",1414,"KRN",9.8,"NM","B","NDFPRE1",34)

"BLD",1414,"KRN",9.8,"NM","B","NDFPRINT",35)

"BLD",1414,"KRN",9.8,"NM","B","NDFPURGE",36)

"BLD",1414,"KRN",9.8,"NM","B","NDFRECLS",37)

"BLD",1414,"KRN",9.8,"NM","B","NDFRR1",38)

"BLD",1414,"KRN",9.8,"NM","B","NDFRR10",39)

"BLD",1414,"KRN",9.8,"NM","B","NDFRR2",40)

"BLD",1414,"KRN",9.8,"NM","B","NDFRR22",41)

"BLD",1414,"KRN",9.8,"NM","B","NDFRR2A",42)

"BLD",1414,"KRN",9.8,"NM","B","NDFRR3",43)

"BLD",1414,"KRN",9.8,"NM","B","NDFRR5",44)

"BLD",1414,"KRN",9.8,"NM","B","NDFRR6",45)

"BLD",1414,"KRN",9.8,"NM","B","NDFRR7",46)

"BLD",1414,"KRN",9.8,"NM","B","NDFRR8",47)

"BLD",1414,"KRN",9.8,"NM","B","NDFRR9",48)

"BLD",1414,"KRN",9.8,"NM","B","NDFRR998",49)

"BLD",1414,"KRN",9.8,"NM","B","NDFRRDP",50)

"BLD",1414,"KRN",9.8,"NM","B","NDFRRDP1",51)

"BLD",1414,"KRN",9.8,"NM","B","NDFSHOW",52)

"BLD",1414,"KRN",9.8,"NM","B","NDFVUDPL",53)

"BLD",1414,"KRN",9.8,"NM","B","NDFVUID",54)

"BLD",1414,"KRN",9.8,"NM","B","NDFWARN",55)

"BLD",1414,"KRN",19,0)
19
"BLD",1414,"KRN",19,"NM",0)
^9.68A^68^68
"BLD",1414,"KRN",19,"NM",1,0)
NDF CLASSIFICATION PRINT^^0
"BLD",1414,"KRN",19,"NM",2,0)
NDF CS FEDERAL SCHEDULE^^0
"BLD",1414,"KRN",19,"NM",3,0)
NDF DISPENSE UNIT^^0
"BLD",1414,"KRN",19,"NM",4,0)
NDF DOSAGE FORM^^0
"BLD",1414,"KRN",19,"NM",5,0)
NDF DRUG UNITS^^0
"BLD",1414,"KRN",19,"NM",6,0)
NDF EDIT^^0
"BLD",1414,"KRN",19,"NM",7,0)
NDF ENTER EDIT^^0
"BLD",1414,"KRN",19,"NM",8,0)
NDF ENTER EDIT DATA^^0
"BLD",1414,"KRN",19,"NM",9,0)
NDF ENTER RESTRICTIONS^^0
"BLD",1414,"KRN",19,"NM",10,0)
NDF ENTER/EDIT 1^^0
"BLD",1414,"KRN",19,"NM",11,0)
NDF EXCLUDE^^0
"BLD",1414,"KRN",19,"NM",12,0)
NDF EXCLUSIONS^^0
"BLD",1414,"KRN",19,"NM",13,0)
NDF FORMULARY^^0
"BLD",1414,"KRN",19,"NM",14,0)
NDF INACTIVATE INTERACTION^^0
"BLD",1414,"KRN",19,"NM",15,0)
NDF INACTIVATE NDC^^0
"BLD",1414,"KRN",19,"NM",16,0)
NDF INACTIVATE PRODUCT^^0
"BLD",1414,"KRN",19,"NM",17,0)
NDF INGREDIENTS^^0
"BLD",1414,"KRN",19,"NM",18,0)
NDF INQUIRY^^0
"BLD",1414,"KRN",19,"NM",19,0)
NDF INTERACTIONS^^0
"BLD",1414,"KRN",19,"NM",20,0)
NDF LINK/UNLINK^^0
"BLD",1414,"KRN",19,"NM",21,0)
NDF LIST INGREDIENTS^^0
"BLD",1414,"KRN",19,"NM",22,0)
NDF LIST INTERACTIONS^^0
"BLD",1414,"KRN",19,"NM",23,0)
NDF MANAGER^^0
"BLD",1414,"KRN",19,"NM",24,0)
NDF MANUFACTURER^^0
"BLD",1414,"KRN",19,"NM",25,0)
NDF MERGE GENERICS^^0
"BLD",1414,"KRN",19,"NM",26,0)
NDF MERGE PRODUCTS^^0
"BLD",1414,"KRN",19,"NM",27,0)
NDF MESSAGE^^0
"BLD",1414,"KRN",19,"NM",28,0)
NDF MISCELLANEOUS^^0
"BLD",1414,"KRN",19,"NM",29,0)
NDF NDC INQUIRY^^0
"BLD",1414,"KRN",19,"NM",30,0)
NDF NEW PRODUCTS^^0
"BLD",1414,"KRN",19,"NM",31,0)
NDF PACKAGE SIZE^^0
"BLD",1414,"KRN",19,"NM",32,0)
NDF PACKAGE TYPE^^0
"BLD",1414,"KRN",19,"NM",33,0)
NDF PATCH EDIT REPORT^^0
"BLD",1414,"KRN",19,"NM",34,0)
NDF PFS^^0
"BLD",1414,"KRN",19,"NM",35,0)
NDF PMI CHANGED PMIS^^0
"BLD",1414,"KRN",19,"NM",36,0)
NDF PMI DELETED LINKS^^0
"BLD",1414,"KRN",19,"NM",37,0)
NDF PMI INSTALL COMMERCIAL^^0
"BLD",1414,"KRN",19,"NM",38,0)
NDF PMI INSTALL OPTIONS^^0
"BLD",1414,"KRN",19,"NM",39,0)
NDF PMI LENGTH CHECK^^0
"BLD",1414,"KRN",19,"NM",40,0)
NDF PMI LIST NEW^^0
"BLD",1414,"KRN",19,"NM",41,0)
NDF PMI UPDATE REAL PMI FILES^^0
"BLD",1414,"KRN",19,"NM",42,0)
NDF PMIS^^0
"BLD",1414,"KRN",19,"NM",43,0)
NDF PRINT^^0
"BLD",1414,"KRN",19,"NM",44,0)
NDF PRINT INTERACTIONS^^0
"BLD",1414,"KRN",19,"NM",45,0)
NDF PRODUCT ENTER/EDIT 1^^0
"BLD",1414,"KRN",19,"NM",46,0)
NDF PRODUCT INQUIRY^^0
"BLD",1414,"KRN",19,"NM",47,0)
NDF PRODUCT LINKED^^0
"BLD",1414,"KRN",19,"NM",48,0)
NDF PRODUCT PRINT^^0
"BLD",1414,"KRN",19,"NM",49,0)
NDF PRODUCTS AND PMIS^^0
"BLD",1414,"KRN",19,"NM",50,0)
NDF PRODUCTS BY CLASS^^0
"BLD",1414,"KRN",19,"NM",51,0)
NDF PRODUCTS FOR CMOP^^0
"BLD",1414,"KRN",19,"NM",52,0)
NDF PURGE^^0
"BLD",1414,"KRN",19,"NM",53,0)
NDF RECLASS^^0
"BLD",1414,"KRN",19,"NM",54,0)
NDF REPORTS^^0
"BLD",1414,"KRN",19,"NM",55,0)
NDF ROUTE^^0
"BLD",1414,"KRN",19,"NM",56,0)
NDF SEARCH^^0
"BLD",1414,"KRN",19,"NM",57,0)
NDF VA CLASS^^0
"BLD",1414,"KRN",19,"NM",58,0)
NDF VA GENERIC^^0
"BLD",1414,"KRN",19,"NM",59,0)
NDF VA PRODUCT^^0
"BLD",1414,"KRN",19,"NM",60,0)
NDF VUID CREATE^^0
"BLD",1414,"KRN",19,"NM",61,0)
NDF VUID LIST^^0
"BLD",1414,"KRN",19,"NM",62,0)
NDF VUID MENU^^0
"BLD",1414,"KRN",19,"NM",63,0)
NDFEXMPT^^0
"BLD",1414,"KRN",19,"NM",64,0)
NDFNODDI^^0
"BLD",1414,"KRN",19,"NM",65,0)
NDFPBM^^0
"BLD",1414,"KRN",19,"NM",66,0)
NDFPODDI^^0
"BLD",1414,"KRN",19,"NM",67,0)
NDFRTE^^0
"BLD",1414,"KRN",19,"NM",68,0)
NDFWARNINGLABEL^^0
"BLD",1414,"KRN",19,"NM","B","NDF CLASSIFICATION PRINT",1)

"BLD",1414,"KRN",19,"NM","B","NDF CS FEDERAL SCHEDULE",2)

"BLD",1414,"KRN",19,"NM","B","NDF DISPENSE UNIT",3)

"BLD",1414,"KRN",19,"NM","B","NDF DOSAGE FORM",4)

"BLD",1414,"KRN",19,"NM","B","NDF DRUG UNITS",5)

"BLD",1414,"KRN",19,"NM","B","NDF EDIT",6)

"BLD",1414,"KRN",19,"NM","B","NDF ENTER EDIT",7)

"BLD",1414,"KRN",19,"NM","B","NDF ENTER EDIT DATA",8)

"BLD",1414,"KRN",19,"NM","B","NDF ENTER RESTRICTIONS",9)

"BLD",1414,"KRN",19,"NM","B","NDF ENTER/EDIT 1",10)

"BLD",1414,"KRN",19,"NM","B","NDF EXCLUDE",11)

"BLD",1414,"KRN",19,"NM","B","NDF EXCLUSIONS",12)

"BLD",1414,"KRN",19,"NM","B","NDF FORMULARY",13)

"BLD",1414,"KRN",19,"NM","B","NDF INACTIVATE INTERACTION",14)

"BLD",1414,"KRN",19,"NM","B","NDF INACTIVATE NDC",15)

"BLD",1414,"KRN",19,"NM","B","NDF INACTIVATE PRODUCT",16)

"BLD",1414,"KRN",19,"NM","B","NDF INGREDIENTS",17)

"BLD",1414,"KRN",19,"NM","B","NDF INQUIRY",18)

"BLD",1414,"KRN",19,"NM","B","NDF INTERACTIONS",19)

"BLD",1414,"KRN",19,"NM","B","NDF LINK/UNLINK",20)

"BLD",1414,"KRN",19,"NM","B","NDF LIST INGREDIENTS",21)

"BLD",1414,"KRN",19,"NM","B","NDF LIST INTERACTIONS",22)

"BLD",1414,"KRN",19,"NM","B","NDF MANAGER",23)

"BLD",1414,"KRN",19,"NM","B","NDF MANUFACTURER",24)

"BLD",1414,"KRN",19,"NM","B","NDF MERGE GENERICS",25)

"BLD",1414,"KRN",19,"NM","B","NDF MERGE PRODUCTS",26)

"BLD",1414,"KRN",19,"NM","B","NDF MESSAGE",27)

"BLD",1414,"KRN",19,"NM","B","NDF MISCELLANEOUS",28)

"BLD",1414,"KRN",19,"NM","B","NDF NDC INQUIRY",29)

"BLD",1414,"KRN",19,"NM","B","NDF NEW PRODUCTS",30)

"BLD",1414,"KRN",19,"NM","B","NDF PACKAGE SIZE",31)

"BLD",1414,"KRN",19,"NM","B","NDF PACKAGE TYPE",32)

"BLD",1414,"KRN",19,"NM","B","NDF PATCH EDIT REPORT",33)

"BLD",1414,"KRN",19,"NM","B","NDF PFS",34)

"BLD",1414,"KRN",19,"NM","B","NDF PMI CHANGED PMIS",35)

"BLD",1414,"KRN",19,"NM","B","NDF PMI DELETED LINKS",36)

"BLD",1414,"KRN",19,"NM","B","NDF PMI INSTALL COMMERCIAL",37)

"BLD",1414,"KRN",19,"NM","B","NDF PMI INSTALL OPTIONS",38)

"BLD",1414,"KRN",19,"NM","B","NDF PMI LENGTH CHECK",39)

"BLD",1414,"KRN",19,"NM","B","NDF PMI LIST NEW",40)

"BLD",1414,"KRN",19,"NM","B","NDF PMI UPDATE REAL PMI FILES",41)

"BLD",1414,"KRN",19,"NM","B","NDF PMIS",42)

"BLD",1414,"KRN",19,"NM","B","NDF PRINT",43)

"BLD",1414,"KRN",19,"NM","B","NDF PRINT INTERACTIONS",44)

"BLD",1414,"KRN",19,"NM","B","NDF PRODUCT ENTER/EDIT 1",45)

"BLD",1414,"KRN",19,"NM","B","NDF PRODUCT INQUIRY",46)

"BLD",1414,"KRN",19,"NM","B","NDF PRODUCT LINKED",47)

"BLD",1414,"KRN",19,"NM","B","NDF PRODUCT PRINT",48)

"BLD",1414,"KRN",19,"NM","B","NDF PRODUCTS AND PMIS",49)

"BLD",1414,"KRN",19,"NM","B","NDF PRODUCTS BY CLASS",50)

"BLD",1414,"KRN",19,"NM","B","NDF PRODUCTS FOR CMOP",51)

"BLD",1414,"KRN",19,"NM","B","NDF PURGE",52)

"BLD",1414,"KRN",19,"NM","B","NDF RECLASS",53)

"BLD",1414,"KRN",19,"NM","B","NDF REPORTS",54)

"BLD",1414,"KRN",19,"NM","B","NDF ROUTE",55)

"BLD",1414,"KRN",19,"NM","B","NDF SEARCH",56)

"BLD",1414,"KRN",19,"NM","B","NDF VA CLASS",57)

"BLD",1414,"KRN",19,"NM","B","NDF VA GENERIC",58)

"BLD",1414,"KRN",19,"NM","B","NDF VA PRODUCT",59)

"BLD",1414,"KRN",19,"NM","B","NDF VUID CREATE",60)

"BLD",1414,"KRN",19,"NM","B","NDF VUID LIST",61)

"BLD",1414,"KRN",19,"NM","B","NDF VUID MENU",62)

"BLD",1414,"KRN",19,"NM","B","NDFEXMPT",63)

"BLD",1414,"KRN",19,"NM","B","NDFNODDI",64)

"BLD",1414,"KRN",19,"NM","B","NDFPBM",65)

"BLD",1414,"KRN",19,"NM","B","NDFPODDI",66)

"BLD",1414,"KRN",19,"NM","B","NDFRTE",67)

"BLD",1414,"KRN",19,"NM","B","NDFWARNINGLABEL",68)

"BLD",1414,"KRN",19.1,0)
19.1
"BLD",1414,"KRN",101,0)
101
"BLD",1414,"KRN",101,"NM",0)
^9.68A^8^8
"BLD",1414,"KRN",101,"NM",1,0)
NDF HIDDEN ACTIONS^^0
"BLD",1414,"KRN",101,"NM",2,0)
NDF QUIT^^0
"BLD",1414,"KRN",101,"NM",3,0)
NDF RSB^^0
"BLD",1414,"KRN",101,"NM",4,0)
NDF RSB ACCEPT^^0
"BLD",1414,"KRN",101,"NM",5,0)
NDF RSB EDIT^^0
"BLD",1414,"KRN",101,"NM",6,0)
NDF RSB NDC^^0
"BLD",1414,"KRN",101,"NM",7,0)
NDF RSB NDC ACCEPT^^0
"BLD",1414,"KRN",101,"NM",8,0)
NDF RSB NDC EDIT^^0
"BLD",1414,"KRN",101,"NM","B","NDF HIDDEN ACTIONS",1)

"BLD",1414,"KRN",101,"NM","B","NDF QUIT",2)

"BLD",1414,"KRN",101,"NM","B","NDF RSB",3)

"BLD",1414,"KRN",101,"NM","B","NDF RSB ACCEPT",4)

"BLD",1414,"KRN",101,"NM","B","NDF RSB EDIT",5)

"BLD",1414,"KRN",101,"NM","B","NDF RSB NDC",6)

"BLD",1414,"KRN",101,"NM","B","NDF RSB NDC ACCEPT",7)

"BLD",1414,"KRN",101,"NM","B","NDF RSB NDC EDIT",8)

"BLD",1414,"KRN",409.61,0)
409.61
"BLD",1414,"KRN",409.61,"NM",0)
^9.68A^2^2
"BLD",1414,"KRN",409.61,"NM",1,0)
NDF RSB ACCEPT/EDIT^^0
"BLD",1414,"KRN",409.61,"NM",2,0)
NDF RSB NDC A/E^^0
"BLD",1414,"KRN",409.61,"NM","B","NDF RSB ACCEPT/EDIT",1)

"BLD",1414,"KRN",409.61,"NM","B","NDF RSB NDC A/E",2)

"BLD",1414,"KRN",771,0)
771
"BLD",1414,"KRN",779.2,0)
779.2
"BLD",1414,"KRN",870,0)
870
"BLD",1414,"KRN",8989.51,0)
8989.51
"BLD",1414,"KRN",8989.52,0)
8989.52
"BLD",1414,"KRN",8994,0)
8994
"BLD",1414,"KRN",9002226,0)
9002226
"BLD",1414,"KRN","B",.4,.4)

"BLD",1414,"KRN","B",.401,.401)

"BLD",1414,"KRN","B",.402,.402)

"BLD",1414,"KRN","B",.403,.403)

"BLD",1414,"KRN","B",.5,.5)

"BLD",1414,"KRN","B",.84,.84)

"BLD",1414,"KRN","B",3.6,3.6)

"BLD",1414,"KRN","B",3.8,3.8)

"BLD",1414,"KRN","B",9.2,9.2)

"BLD",1414,"KRN","B",9.8,9.8)

"BLD",1414,"KRN","B",19,19)

"BLD",1414,"KRN","B",19.1,19.1)

"BLD",1414,"KRN","B",101,101)

"BLD",1414,"KRN","B",409.61,409.61)

"BLD",1414,"KRN","B",771,771)

"BLD",1414,"KRN","B",779.2,779.2)

"BLD",1414,"KRN","B",870,870)

"BLD",1414,"KRN","B",8989.51,8989.51)

"BLD",1414,"KRN","B",8989.52,8989.52)

"BLD",1414,"KRN","B",8994,8994)

"BLD",1414,"KRN","B",9002226,9002226)

"BLD",1414,"QUES",0)
^9.62^^
"FIA",5000)
UPDATE CONTROL
"FIA",5000,0)
^NDFK(5000,
"FIA",5000,0,0)
5000
"FIA",5000,0,1)
y^y^f^^^^n
"FIA",5000,0,10)

"FIA",5000,0,11)

"FIA",5000,0,"RLRO")

"FIA",5000,5000)
0
"FIA",5000,5000.001)
0
"FIA",5000,5000.002)
0
"FIA",5000,5000.003)
0
"FIA",5000,5000.06)
0
"FIA",5000,5000.07)
0
"FIA",5000.1)
EXTRA AUDIT
"FIA",5000.1,0)
^NDFK(5000.1,
"FIA",5000.1,0,0)
5000.1I
"FIA",5000.1,0,1)
y^y^f^^^^n
"FIA",5000.1,0,10)

"FIA",5000.1,0,11)

"FIA",5000.1,0,"RLRO")

"FIA",5000.1,5000.1)
0
"FIA",5000.2)
PRODUCTS TO UNMATCH
"FIA",5000.2,0)
^NDFK(5000.2,
"FIA",5000.2,0,0)
5000.2P
"FIA",5000.2,0,1)
y^y^f^^^^n
"FIA",5000.2,0,10)

"FIA",5000.2,0,11)

"FIA",5000.2,0,"RLRO")

"FIA",5000.2,5000.2)
0
"FIA",5000.23)
INTERACTION EXCLUSION/INCLUSION
"FIA",5000.23,0)
^NDFK(5000.23,
"FIA",5000.23,0,0)
5000.23P
"FIA",5000.23,0,1)
y^y^f^^^^n
"FIA",5000.23,0,10)

"FIA",5000.23,0,11)

"FIA",5000.23,0,"RLRO")

"FIA",5000.23,5000.23)
0
"FIA",5000.3)
GENERICS TO BE UNMATCHED
"FIA",5000.3,0)
^NDFK(5000.3,
"FIA",5000.3,0,0)
5000.3P
"FIA",5000.3,0,1)
y^y^f^^^^n
"FIA",5000.3,0,10)

"FIA",5000.3,0,11)

"FIA",5000.3,0,"RLRO")

"FIA",5000.3,5000.3)
0
"FIA",5000.4)
STRENGTH CHANGE
"FIA",5000.4,0)
^NDFK(5000.4,
"FIA",5000.4,0,0)
5000.4P
"FIA",5000.4,0,1)
y^y^f^^^^n
"FIA",5000.4,0,10)

"FIA",5000.4,0,11)

"FIA",5000.4,0,"RLRO")

"FIA",5000.4,5000.4)
0
"FIA",5000.5)
INDICATOR CHANGE
"FIA",5000.5,0)
^NDFK(5000.5,
"FIA",5000.5,0,0)
5000.5P
"FIA",5000.5,0,1)
y^y^f^^^^n
"FIA",5000.5,0,10)

"FIA",5000.5,0,11)

"FIA",5000.5,0,"RLRO")

"FIA",5000.5,5000.5)
0
"FIA",5000.506)
NEW VA PRODUCT NAMES
"FIA",5000.506,0)
^NDFK(5000.506,
"FIA",5000.506,0,0)
5000.506P
"FIA",5000.506,0,1)
y^y^f^^^^n
"FIA",5000.506,0,10)

"FIA",5000.506,0,11)

"FIA",5000.506,0,"RLRO")

"FIA",5000.506,5000.506)
0
"FIA",5000.506,5000.5062)
0
"FIA",5000.507)
PRODUCT NAMES WITH CHANGED CLASS
"FIA",5000.507,0)
^NDFK(5000.507,
"FIA",5000.507,0,0)
5000.507P
"FIA",5000.507,0,1)
y^y^f^^^^n
"FIA",5000.507,0,10)

"FIA",5000.507,0,11)

"FIA",5000.507,0,"RLRO")

"FIA",5000.507,5000.507)
0
"FIA",5000.508)
INGREDIENTS ADDED
"FIA",5000.508,0)
^NDFK(5000.508,
"FIA",5000.508,0,0)
5000.508P
"FIA",5000.508,0,1)
y^y^f^^^^n
"FIA",5000.508,0,10)

"FIA",5000.508,0,11)

"FIA",5000.508,0,"RLRO")

"FIA",5000.508,5000.508)
0
"FIA",5000.508,5000.5081)
0
"FIA",5000.509)
INGREDIENTS DELETED
"FIA",5000.509,0)
^NDFK(5000.509,
"FIA",5000.509,0,0)
5000.509P
"FIA",5000.509,0,1)
y^y^f^^^^n
"FIA",5000.509,0,10)

"FIA",5000.509,0,11)

"FIA",5000.509,0,"RLRO")

"FIA",5000.509,5000.509)
0
"FIA",5000.509,5000.5091)
0
"FIA",5000.56)
NEW INTERACTIONS
"FIA",5000.56,0)
^NDFK(5000.56,
"FIA",5000.56,0,0)
5000.56P
"FIA",5000.56,0,1)
y^y^f^^^^n
"FIA",5000.56,0,10)

"FIA",5000.56,0,11)

"FIA",5000.56,0,"RLRO")

"FIA",5000.56,5000.56)
0
"FIA",5000.6)
PMI UPDATE LOG
"FIA",5000.6,0)
^NDFK(5000.6,
"FIA",5000.6,0,0)
5000.6P
"FIA",5000.6,0,1)
y^y^f^^^^n
"FIA",5000.6,0,10)

"FIA",5000.6,0,11)

"FIA",5000.6,0,"RLRO")

"FIA",5000.6,5000.6)
0
"FIA",5000.608)
OVERRIDE CHANGES
"FIA",5000.608,0)
^NDFK(5000.608,
"FIA",5000.608,0,0)
5000.608P
"FIA",5000.608,0,1)
y^y^f^^^^n
"FIA",5000.608,0,10)

"FIA",5000.608,0,11)

"FIA",5000.608,0,"RLRO")

"FIA",5000.608,5000.608)
0
"FIA",5000.7)
UNMARKED FOR CMOP
"FIA",5000.7,0)
^NDFK(5000.7,
"FIA",5000.7,0,0)
5000.7P
"FIA",5000.7,0,1)
y^y^f^^^^n
"FIA",5000.7,0,10)

"FIA",5000.7,0,11)

"FIA",5000.7,0,"RLRO")

"FIA",5000.7,5000.7)
0
"FIA",5000.8)
CLASS CHANGES
"FIA",5000.8,0)
^NDFK(5000.8,
"FIA",5000.8,0,0)
5000.8P
"FIA",5000.8,0,1)
y^y^f^^^^n
"FIA",5000.8,0,10)

"FIA",5000.8,0,11)

"FIA",5000.8,0,"RLRO")

"FIA",5000.8,5000.8)
0
"FIA",5000.9)
PRODUCTS WITH SCHEDULE CHANGE
"FIA",5000.9,0)
^NDFK(5000.9,
"FIA",5000.9,0,0)
5000.9P
"FIA",5000.9,0,1)
y^y^f^^^^n
"FIA",5000.9,0,10)

"FIA",5000.9,0,11)

"FIA",5000.9,0,"RLRO")

"FIA",5000.9,5000.9)
0
"FIA",5000.91)
MED GUIDE CHANGES
"FIA",5000.91,0)
^NDFK(5000.91,
"FIA",5000.91,0,0)
5000.91
"FIA",5000.91,0,1)
y^y^f^^^^n
"FIA",5000.91,0,10)

"FIA",5000.91,0,11)

"FIA",5000.91,0,"RLRO")

"FIA",5000.91,5000.91)
0
"FIA",5000.92)
POSSIBLE DOSAGE SETTING CHANGES
"FIA",5000.92,0)
^NDFK(5000.92,
"FIA",5000.92,0,0)
5000.92P
"FIA",5000.92,0,1)
y^y^f^^^^n
"FIA",5000.92,0,10)

"FIA",5000.92,0,11)

"FIA",5000.92,0,"RLRO")

"FIA",5000.92,5000.92)
0
"FIA",5000.991)
DATA FOR VUID
"FIA",5000.991,0)
^NDFK(5000.991,
"FIA",5000.991,0,0)
5000.991
"FIA",5000.991,0,1)
y^y^f^^^^n
"FIA",5000.991,0,10)

"FIA",5000.991,0,11)

"FIA",5000.991,0,"RLRO")

"FIA",5000.991,5000.991)
0
"FIA",5000.991,5000.9912)
0
"FIA",5000.992)
VUID MAP
"FIA",5000.992,0)
^NDFK(5000.992,
"FIA",5000.992,0,0)
5000.992
"FIA",5000.992,0,1)
y^y^f^^^^n
"FIA",5000.992,0,10)

"FIA",5000.992,0,11)

"FIA",5000.992,0,"RLRO")

"FIA",5000.992,5000.992)
0
"KRN",.4,122,-1)
0^5
"KRN",.4,122,0)
NDFEXMP1^3030430.1017^@^50.68^^@^3090223
"KRN",.4,122,"F",2)
D ^NDFEXMP1;"";Z;"D ^NDFEXMP1"~
"KRN",.4,122,"H")
VA PRODUCT LIST
"KRN",.4,149,-1)
0^3
"KRN",.4,149,0)
NDF LIST^3090608.0847^^50.68^^^3090608
"KRN",.4,149,"F",1)
"***";X~.01;X~"^";X~5;X~"^";X~.05;X~"^";X~1;X~"^";X~2;X~"^";X~3;X~"^";X~4;X~"^";X~13;X~"^";X~6;X~"^";X~7;X~"^";X~8;X~"^";X~11;X~"^";X~15;X~"^";X~17;X~
"KRN",.4,149,"F",2)
"^";X~19;X~"^";X~23;X~"^";X~31;X~"^";X~99.99;X~"^";X~21;X~"^";X~14,"***";X~14,"%%%";X~14,"^";X~14,.01;X~14,"^";X~14,1;X~14,"^";X~14,2;X~
"KRN",.4,149,"H")
VA PRODUCT LIST
"KRN",.4,150,-1)
0^2
"KRN",.4,150,0)
NDF ACTIVE LIST^3090608.1055^^50.68^^^3090610
"KRN",.4,150,"F",1)
21;@~"***";X~.01;X~"^";X~5;X~"^";X~.05;X~"^";X~1;X~"^";X~2;X~"^";X~3;X~"^";X~4;X~"^";X~13;X~"^";X~6;X~"^";X~7;X~"^";X~8;X~"^";X~11;X~"^";X~15;X~"^";X~
"KRN",.4,150,"F",2)
17;X~"^";X~19;X~"^";X~23;X~"^";X~31;X~"^";X~99.99;X~"^";X~14,"***";X~14,"%%%";X~14,"^";X~14,.01;X~14,"^";X~14,1;X~14,"^";X~14,2;X~
"KRN",.4,150,"H")
[NDF ACTIVE LIST
"KRN",.4,152,-1)
0^1
"KRN",.4,152,0)
NDF & NDC ACTIVE LIST^3090608.1539^^50.68^^^3090608
"KRN",.4,152,"DXS",1,9.2)
S (D,D0)=$QS(DIMQ,$QL(DIMQ)) I D,$D(^PSNDF(50.67,D,0)) S X=$P(^(0),U) S DIXX=DIXX(1) D M
"KRN",.4,152,"DXS",1,9.3)
N DIMQ,DIMSTRT,DIMSCNT S (DIMQ,DIMSTRT)=$NA(^PSNDF(50.67,"ANDC",I(0,0))),DIMSCNT=$QL(DIMQ) F  S DIMQ=$Q(@DIMQ) Q:DIMQ=""  Q:$NA(@DIMQ,DIMSCNT)'=DIMSTRT   X DXS(1,9.2) Q:'$D(D)  S D=D0
"KRN",.4,152,"F",1)
21;@~"***";X~.01;X~"^";X~5;X~"^";X~.05;X~"^";X~1;X~"^";X~2;X~"^";X~3;X~"^";X~4;X~"^";X~
"KRN",.4,152,"F",2)
-50.67,^PSNDF(50.67,^1^S I(0,0)=$G(D0),DIP(1)=$S($D(^PSNDF(50.68,D0,1)):^(1),1:"") X DXS(1,9.3) S X="" S D0=I(0,0);Z;"NDC/UPN:"~-50.67,"***";X~-50.67,"&&&";X~
"KRN",.4,152,"F",3)
-50.67,"^";X~-50.67,4;X~-50.67,"^";X~-50.67,3;X~-50.67,"^";X~-50.67,8;X~-50.67,"^";X~-50.67,9;X~-50.67,"^";X~-50.67,10;X~-50.67,"^";X~-50.67,1;X~6;X~
"KRN",.4,152,"F",4)
"^";X~7;X~"^";X~8;X~"^";X~11;X~"^";X~15;X~"^";X~17;X~"^";X~19;X~"^";X~23;X~"^";X~31;X~"^";X~99.99;X~"^";X~14,"***";X~14,"%%%";X~14,"^";X~14,.01;X~
"KRN",.4,152,"F",5)
14,"^";X~14,1;X~14,"^";X~14,2;X~
"KRN",.4,152,"H")
VA PRODUCT LIST
"KRN",.4,158,-1)
0^4
"KRN",.4,158,0)
NDF PRODUCT DOWNLOAD^3110307.1423^@^50.68^^@^3110307
"KRN",.4,158,"F",2)
.01;x~"|"~15;X~"|"~.05;X~"|"~5;X~"|"~8;X~"|"~6;X~"|"~17;X~"|"~
"KRN",.4,158,"H")
VA PRODUCT LIST
"KRN",3.8,5,-1)
0^1
"KRN",3.8,5,0)
NDF DATA^PU^n^^^^
"KRN",3.8,5,2,0)
^^1^1^2970327^
"KRN",3.8,5,2,1,0)
This mail group will receive information about updates to NDF.
"KRN",3.8,5,3)

"KRN",3.8,6,-1)
0^2
"KRN",3.8,6,0)
NDF SUPPORT^PU^n^^^^
"KRN",3.8,6,2,0)
^^1^1^2990316^^^^
"KRN",3.8,6,2,1,0)
For messages from PDM
"KRN",19,824,-1)
0^6
"KRN",19,824,0)
NDF EDIT^National Drug File Enter/Edit^^R^^^^^^^^^^^1
"KRN",19,824,1,0)
^^1^1^2980825^
"KRN",19,824,1,1,0)
Enter/edit entries in NDF
"KRN",19,824,15)
D CLEAN^NDFRR10
"KRN",19,824,25)
NDFRR7
"KRN",19,824,99.1)
57580,36110
"KRN",19,824,"U")
NATIONAL DRUG FILE ENTER/EDIT
"KRN",19,825,-1)
0^7
"KRN",19,825,0)
NDF ENTER EDIT^Enter/Edit (NDF)^^M^^^^^^^^
"KRN",19,825,10,0)
^19.01IP^15^15
"KRN",19,825,10,1,0)
824^NDF^1
"KRN",19,825,10,1,"^")
NDF EDIT
"KRN",19,825,10,2,0)
827^VAPN^2
"KRN",19,825,10,2,"^")
NDF VA PRODUCT
"KRN",19,825,10,3,0)
828^GN^3
"KRN",19,825,10,3,"^")
NDF VA GENERIC
"KRN",19,825,10,4,0)
830^MFG^5
"KRN",19,825,10,4,"^")
NDF MANUFACTURER
"KRN",19,825,10,5,0)
831^DF^6
"KRN",19,825,10,5,"^")
NDF DOSAGE FORM
"KRN",19,825,10,6,0)
832^UNIT^7
"KRN",19,825,10,6,"^")
NDF DRUG UNITS
"KRN",19,825,10,7,0)
829^CL^4
"KRN",19,825,10,7,"^")
NDF VA CLASS
"KRN",19,825,10,8,0)
833^TYPE^8
"KRN",19,825,10,8,"^")
NDF PACKAGE TYPE
"KRN",19,825,10,9,0)
834^SIZE^9
"KRN",19,825,10,9,"^")
NDF PACKAGE SIZE
"KRN",19,825,10,10,0)
835^VISP^10
"KRN",19,825,10,10,"^")
NDF DISPENSE UNIT
"KRN",19,825,10,11,0)
840^RTE^11
"KRN",19,825,10,11,"^")
NDF ROUTE
"KRN",19,825,10,12,0)
837^INGR^12
"KRN",19,825,10,12,"^")
NDF INGREDIENTS
"KRN",19,825,10,13,0)
838^DDIN^13
"KRN",19,825,10,13,"^")
NDF INTERACTIONS
"KRN",19,825,10,14,0)
839^NATF^14
"KRN",19,825,10,14,"^")
NDF FORMULARY
"KRN",19,825,10,15,0)
925^CS^15
"KRN",19,825,10,15,"^")
NDF CS FEDERAL SCHEDULE
"KRN",19,825,99)
60232,40674
"KRN",19,825,99.1)
57580,50603
"KRN",19,825,"U")
ENTER/EDIT (NDF)
"KRN",19,826,-1)
0^8
"KRN",19,826,0)
NDF ENTER EDIT DATA^National Drug File Enter/Edit^Out of order^R^^^^^^^^
"KRN",19,826,25)
NDFEDIT
"KRN",19,826,"U")
NATIONAL DRUG FILE ENTER/EDIT
"KRN",19,827,-1)
0^59
"KRN",19,827,0)
NDF VA PRODUCT^VA Product Enter/Edit^^R^^^^^^^^NDF MANAGEMENT^^^1
"KRN",19,827,15)
D CLEAN^NDFRR10
"KRN",19,827,25)
NDFRR2
"KRN",19,827,"U")
VA PRODUCT ENTER/EDIT
"KRN",19,828,-1)
0^58
"KRN",19,828,0)
NDF VA GENERIC^VA Generic Enter/Edit^^R^^^^^^^^NDF MANAGEMENT
"KRN",19,828,25)
1^NDFENTER
"KRN",19,828,"U")
VA GENERIC ENTER/EDIT
"KRN",19,829,-1)
0^57
"KRN",19,829,0)
NDF VA CLASS^VA Drug Class Enter/Edit^^R^^^^^^^^
"KRN",19,829,25)
2^NDFENTER
"KRN",19,829,"U")
VA DRUG CLASS ENTER/EDIT
"KRN",19,830,-1)
0^24
"KRN",19,830,0)
NDF MANUFACTURER^Manufacturer Enter/Edit^^R^^^^^^^^
"KRN",19,830,25)
3^NDFENTER
"KRN",19,830,"U")
MANUFACTURER ENTER/EDIT
"KRN",19,831,-1)
0^4
"KRN",19,831,0)
NDF DOSAGE FORM^Dosage Form Enter/Edit^^R^^^^^^^^NDF MANAGEMENT
"KRN",19,831,25)
4^NDFENTER
"KRN",19,831,"U")
DOSAGE FORM ENTER/EDIT
"KRN",19,832,-1)
0^5
"KRN",19,832,0)
NDF DRUG UNITS^Drug Units Enter/Edit^^R^^^^^^^^NDF MANAGEMENT
"KRN",19,832,25)
5^NDFENTER
"KRN",19,832,"U")
DRUG UNITS ENTER/EDIT
"KRN",19,833,-1)
0^32
"KRN",19,833,0)
NDF PACKAGE TYPE^Package Type Enter/Edit^^R^^^^^^^^NDF MANAGEMENT
"KRN",19,833,25)
6^NDFENTER
"KRN",19,833,"U")
PACKAGE TYPE ENTER/EDIT
"KRN",19,834,-1)
0^31
"KRN",19,834,0)
NDF PACKAGE SIZE^Package Size Enter/Edit^^R^^^^^^^^NDF MANAGEMENT
"KRN",19,834,25)
7^NDFENTER
"KRN",19,834,"U")
PACKAGE SIZE ENTER/EDIT
"KRN",19,835,-1)
0^3
"KRN",19,835,0)
NDF DISPENSE UNIT^VA Dispense Units Enter/Edit^^R^^^^^^^^NDF MANAGEMENT
"KRN",19,835,25)
8^NDFENTER
"KRN",19,835,"U")
VA DISPENSE UNITS ENTER/EDIT
"KRN",19,837,-1)
0^17
"KRN",19,837,0)
NDF INGREDIENTS^Drug Ingredients Enter/Edit^^R^^^^^^^^NDF MANAGEMENT
"KRN",19,837,25)
10^NDFENTER
"KRN",19,837,"U")
DRUG INGREDIENTS ENTER/EDIT
"KRN",19,838,-1)
0^19
"KRN",19,838,0)
NDF INTERACTIONS^Drug-Drug Interaction Enter/Edit^^R^^^^^^^^NDF MANAGEMENT
"KRN",19,838,25)
11^NDFENTER
"KRN",19,838,"U")
DRUG-DRUG INTERACTION ENTER/ED
"KRN",19,839,-1)
0^13
"KRN",19,839,0)
NDF FORMULARY^National Formulary Information Enter/Edit^^R^^^^^^^^NDF MANAGEMENT
"KRN",19,839,25)
NDFORMU
"KRN",19,839,"U")
NATIONAL FORMULARY INFORMATION
"KRN",19,840,-1)
0^55
"KRN",19,840,0)
NDF ROUTE^Route of Administration Enter/Edit^^R^^^^^^^^NDF MANAGEMENT
"KRN",19,840,25)
9^NDFENTER
"KRN",19,840,"U")
ROUTE OF ADMINISTRATION ENTER/
"KRN",19,841,-1)
0^51
"KRN",19,841,0)
NDF PRODUCTS FOR CMOP^VA Products Marked for CMOP^^R^^^^^^^^
"KRN",19,841,25)
NDFCMOP
"KRN",19,841,"U")
VA PRODUCTS MARKED FOR CMOP
"KRN",19,842,-1)
0^50
"KRN",19,842,0)
NDF PRODUCTS BY CLASS^VA Product Names By Class^^R^^^^^^^^NDF MANAGEMENT
"KRN",19,842,25)
NDFCLPR
"KRN",19,842,"U")
VA PRODUCT NAMES BY CLASS
"KRN",19,843,-1)
0^1
"KRN",19,843,0)
NDF CLASSIFICATION PRINT^VA Drug Classification Print^^R^^^^^^^^NDF MANAGEMENT
"KRN",19,843,25)
NDFCLAPR
"KRN",19,843,"U")
VA DRUG CLASSIFICATION PRINT
"KRN",19,844,-1)
0^54
"KRN",19,844,0)
NDF REPORTS^Reports (NDF)^^M^^^^^^^^NDF MANAGEMENT
"KRN",19,844,1,0)
^19.06^1^1^3080115^^
"KRN",19,844,1,1,0)
 
"KRN",19,844,10,0)
^19.01IP^13^12
"KRN",19,844,10,1,0)
841^CMOP^1
"KRN",19,844,10,1,"^")
NDF PRODUCTS FOR CMOP
"KRN",19,844,10,2,0)
842^PNCL^2
"KRN",19,844,10,2,"^")
NDF PRODUCTS BY CLASS
"KRN",19,844,10,3,0)
843^CLAS^3
"KRN",19,844,10,3,"^")
NDF CLASSIFICATION PRINT
"KRN",19,844,10,4,0)
891^PINT
"KRN",19,844,10,4,"^")
NDF PRINT INTERACTIONS
"KRN",19,844,10,5,0)
892^PROP
"KRN",19,844,10,5,"^")
NDF PRODUCT PRINT
"KRN",19,844,10,6,0)
924^LIS^6
"KRN",19,844,10,6,"^")
NDF LIST INTERACTIONS
"KRN",19,844,10,8,0)
947^ING
"KRN",19,844,10,8,"^")
NDF LIST INGREDIENTS
"KRN",19,844,10,9,0)
949^EXM
"KRN",19,844,10,9,"^")
NDFEXMPT
"KRN",19,844,10,10,0)
950^EDDI
"KRN",19,844,10,10,"^")
NDFNODDI
"KRN",19,844,10,11,0)
951^POT
"KRN",19,844,10,11,"^")
NDFPODDI
"KRN",19,844,10,12,0)
1057
"KRN",19,844,10,12,"^")
NDF PRODUCTS AND PMIS
"KRN",19,844,10,13,0)
1058
"KRN",19,844,10,13,"^")
NDFWARNINGLABEL
"KRN",19,844,99)
61010,45218
"KRN",19,844,"U")
REPORTS (NDF)
"KRN",19,845,-1)
0^23
"KRN",19,845,0)
NDF MANAGER^NDF Management^^M^^^^^^^^NDF MANAGEMENT^^1^1
"KRN",19,845,1,0)
^19.06^1^1^3101102^^^
"KRN",19,845,1,1,0)
 
"KRN",19,845,10,0)
^19.01IP^8^7
"KRN",19,845,10,1,0)
825^EE^1
"KRN",19,845,10,1,"^")
NDF ENTER EDIT
"KRN",19,845,10,2,0)
844^RPT^3
"KRN",19,845,10,2,"^")
NDF REPORTS
"KRN",19,845,10,3,0)
847^^2
"KRN",19,845,10,3,"^")
NDF MISCELLANEOUS
"KRN",19,845,10,4,0)
856^INQ^4
"KRN",19,845,10,4,"^")
NDF INQUIRY
"KRN",19,845,10,5,0)
873^CAP^5
"KRN",19,845,10,5,"^")
NDFPBM
"KRN",19,845,10,7,0)
882^RTE^6
"KRN",19,845,10,7,"^")
NDFRTE
"KRN",19,845,15)
K XPDGREF
"KRN",19,845,20)
S XPDGREF=1
"KRN",19,845,99)
62032,40913
"KRN",19,845,99.1)
62032,47703
"KRN",19,845,"U")
NDF MANAGEMENT
"KRN",19,846,-1)
0^53
"KRN",19,846,0)
NDF RECLASS^Reclass VA Products^^R^^^^^^^^NDF MANAGEMENT
"KRN",19,846,25)
NDFRECLS
"KRN",19,846,"U")
RECLASS VA PRODUCTS
"KRN",19,847,-1)
0^28
"KRN",19,847,0)
NDF MISCELLANEOUS^Miscellaneous (NDF)^^M^^^^^^^^NDF MANAGEMENT
"KRN",19,847,1,0)
^19.06^1^1^3080125^^
"KRN",19,847,1,1,0)
 
"KRN",19,847,10,0)
^19.01IP^14^8
"KRN",19,847,10,3,0)
849^^3
"KRN",19,847,10,3,"^")
NDF INACTIVATE NDC
"KRN",19,847,10,4,0)
850^^4
"KRN",19,847,10,4,"^")
NDF INACTIVATE PRODUCT
"KRN",19,847,10,8,0)
861^^8
"KRN",19,847,10,8,"^")
NDF MESSAGE
"KRN",19,847,10,9,0)
862^^9
"KRN",19,847,10,9,"^")
NDF PURGE
"KRN",19,847,10,10,0)
863^^10
"KRN",19,847,10,10,"^")
NDF INACTIVATE INTERACTION
"KRN",19,847,10,12,0)
884
"KRN",19,847,10,12,"^")
NDF ENTER RESTRICTIONS
"KRN",19,847,10,13,0)
946
"KRN",19,847,10,13,"^")
NDF PATCH EDIT REPORT
"KRN",19,847,10,14,0)
1059
"KRN",19,847,10,14,"^")
NDF EXCLUSIONS
"KRN",19,847,99)
61020,33378
"KRN",19,847,"U")
MISCELLANEOUS (NDF)
"KRN",19,848,-1)
0^20
"KRN",19,848,0)
NDF LINK/UNLINK^Link/Unlink Two or More NDC/UPNs^^R^^^^^^^^NDF MANAGEMENT
"KRN",19,848,25)
LINK^NDFDEACT
"KRN",19,848,"U")
LINK/UNLINK TWO OR MORE NDC/UP
"KRN",19,849,-1)
0^15
"KRN",19,849,0)
NDF INACTIVATE NDC^Inactivate/Reactivate NDC/UPN^^R^^^^^^^^NDF MANAGEMENT
"KRN",19,849,25)
NDC^NDFDEACT
"KRN",19,849,"U")
INACTIVATE/REACTIVATE NDC/UPN
"KRN",19,850,-1)
0^16
"KRN",19,850,0)
NDF INACTIVATE PRODUCT^Inactivate VA Product^^R^^^^^^^^NDF MANAGEMENT
"KRN",19,850,25)
PROD^NDFDEACT
"KRN",19,850,"U")
INACTIVATE VA PRODUCT
"KRN",19,851,-1)
0^42
"KRN",19,851,0)
NDF PMIS^PMIS Linkage^Still being developed^M^^^^^^^^NDF MANAGEMENT
"KRN",19,851,"U")
PMIS LINKAGE
"KRN",19,852,-1)
0^25
"KRN",19,852,0)
NDF MERGE GENERICS^Merge VA Generic Names^^R^^^^^^^^NDF MANAGEMENT
"KRN",19,852,25)
GEN^NDFMERGE
"KRN",19,852,"U")
MERGE VA GENERIC NAMES
"KRN",19,853,-1)
0^26
"KRN",19,853,0)
NDF MERGE PRODUCTS^Merge VA Product entries^^R^^^^^^^^NDF MANAGEMENT
"KRN",19,853,25)
PROD^NDFMERGE
"KRN",19,853,"U")
MERGE VA PRODUCT ENTRIES
"KRN",19,854,-1)
0^29
"KRN",19,854,0)
NDF NDC INQUIRY^NDC/UPN Inquiry^^R^^^^^^^^NDF MANAGEMENT
"KRN",19,854,25)
NDCI^NDFDEACT
"KRN",19,854,"U")
NDC/UPN INQUIRY
"KRN",19,855,-1)
0^46
"KRN",19,855,0)
NDF PRODUCT INQUIRY^VA Product Inquiry^^R^^^^^^^^NDF MANAGEMENT
"KRN",19,855,25)
PRODI^NDFDEACT
"KRN",19,855,"U")
VA PRODUCT INQUIRY
"KRN",19,856,-1)
0^18
"KRN",19,856,0)
NDF INQUIRY^Inquiry (NDF)^^M^^^^^^^^NDF MANAGEMENT
"KRN",19,856,10,0)
^19.01IP^5^5
"KRN",19,856,10,1,0)
854^^1
"KRN",19,856,10,1,"^")
NDF NDC INQUIRY
"KRN",19,856,10,2,0)
855^PNIN^2
"KRN",19,856,10,2,"^")
NDF PRODUCT INQUIRY
"KRN",19,856,10,3,0)
871
"KRN",19,856,10,3,"^")
NDF PRINT
"KRN",19,856,10,4,0)
872
"KRN",19,856,10,4,"^")
NDF SEARCH
"KRN",19,856,10,5,0)
893
"KRN",19,856,10,5,"^")
NDF NEW PRODUCTS
"KRN",19,856,99)
60232,40674
"KRN",19,856,"U")
INQUIRY (NDF)
"KRN",19,857,-1)
0^10
"KRN",19,857,0)
NDF ENTER/EDIT 1^National Drug FIle Enter/Edit^^R^^^^^^^^^^^1
"KRN",19,857,15)
D CLEAN^NDFRR10
"KRN",19,857,25)
NDFRR7
"KRN",19,857,"U")
NATIONAL DRUG FILE ENTER/EDIT
"KRN",19,858,-1)
0^45
"KRN",19,858,0)
NDF PRODUCT ENTER/EDIT 1^VA Product Enter/Edit^^R^^^^^^^^^^^1
"KRN",19,858,15)
D CLEAN^NDFRR10
"KRN",19,858,25)
NDFRR2
"KRN",19,858,"U")
VA PRODUCT ENTER/EDIT
"KRN",19,861,-1)
0^27
"KRN",19,861,0)
NDF MESSAGE^Load/edit mail message^^R^^^^^^^^NDF MANAGEMENT
"KRN",19,861,25)
NDFMESS
"KRN",19,861,"U")
LOAD/EDIT MAIL MESSAGE
"KRN",19,862,-1)
0^52
"KRN",19,862,0)
NDF PURGE^Purge Files After Transmission^^R^^^^^^^^NDF MANAGEMENT
"KRN",19,862,25)
NDFPURGE
"KRN",19,862,"U")
PURGE FILES AFTER TRANSMISSION
"KRN",19,863,-1)
0^14
"KRN",19,863,0)
NDF INACTIVATE INTERACTION^Inactivate Drug/Drug Interactions^^R^^^^^^^^NDF MANAGEMENT
"KRN",19,863,1,0)
^^1^1^2981014^
"KRN",19,863,1,1,0)
This option allows one to inactivate a drug/drug interaction.
"KRN",19,863,25)
INACT^NDFDINT
"KRN",19,863,"U")
INACTIVATE DRUG/DRUG INTERACTI
"KRN",19,871,-1)
0^43
"KRN",19,871,0)
NDF PRINT^Print File Entries (NDF)^^R^^^^^^^^NDF MANAGEMENT
"KRN",19,871,25)
PRINT^NDFPRINT
"KRN",19,871,"U")
PRINT FILE ENTRIES (NDF)
"KRN",19,872,-1)
0^56
"KRN",19,872,0)
NDF SEARCH^Search File Entries (NDF)^^R^^^^^^^^NDF MANAGEMENT
"KRN",19,872,25)
SEARCH^NDFPRINT
"KRN",19,872,"U")
SEARCH FILE ENTRIES (NDF)
"KRN",19,873,-1)
0^65
"KRN",19,873,0)
NDFPBM^Capture NDF Data^^R^^^^^^^^
"KRN",19,873,1,0)
^^2^2^2990125^
"KRN",19,873,1,1,0)
This option will write to the screen NDF data in ASCII delimited format
"KRN",19,873,1,2,0)
to capture for PBM to load into their files.
"KRN",19,873,25)
ZZPBM
"KRN",19,873,"U")
CAPTURE NDF DATA
"KRN",19,874,-1)
0^38
"KRN",19,874,0)
NDF PMI INSTALL OPTIONS^Medication Information Sheet Install Options^^M^^^^^^^^
"KRN",19,874,1,0)
^19.06^2^2^3020910^^^^
"KRN",19,874,1,1,0)
This menu contains options to be used when preparing PMI data
"KRN",19,874,1,2,0)
for the matching process (see PMIS SOP)
"KRN",19,874,10,0)
^19.01IP^1^1
"KRN",19,874,10,1,0)
875^1^1
"KRN",19,874,10,1,"^")
NDF PMI INSTALL COMMERCIAL
"KRN",19,874,99)
60232,40674
"KRN",19,874,99.1)
58035,31107
"KRN",19,874,"U")
MEDICATION INFORMATION SHEET I
"KRN",19,875,-1)
0^37
"KRN",19,875,0)
NDF PMI INSTALL COMMERCIAL^Install Commercial Data into Utility/FDB Files^^R^^^^^^^^
"KRN",19,875,1,0)
^19.06^3^3^3020910^^^
"KRN",19,875,1,1,0)
This option moves data updates stored from the commercial source into
"KRN",19,875,1,2,0)
various files that will be used to do hte PMI matching process.
"KRN",19,875,1,3,0)
After running this option. This has been reconstructed for PMIS Redesign.
"KRN",19,875,25)
A3AFDBNK
"KRN",19,875,"U")
INSTALL COMMERCIAL DATA INTO U
"KRN",19,876,-1)
0^40
"KRN",19,876,0)
NDF PMI LIST NEW^List of New Medication Information Sheets^^R^^^^^^^^NDF MANAGEMENT
"KRN",19,876,1,0)
^^3^3^2990414^^
"KRN",19,876,1,1,0)
This option lists new Medication Information Sheets imported from the
"KRN",19,876,1,2,0)
most recent update from the commercial system.
"KRN",19,876,1,3,0)
 
"KRN",19,876,25)
ADD^NDFPMIUP
"KRN",19,876,"U")
LIST OF NEW MEDICATION INFORMA
"KRN",19,877,-1)
0^35
"KRN",19,877,0)
NDF PMI CHANGED PMIS^List of Changed Medication Information Sheets^^R^^^^^^^^NDF MANAGEMENT
"KRN",19,877,1,0)
^^3^3^2990203^
"KRN",19,877,1,1,0)
This option lists changed Medication Information Sheets imported from the
"KRN",19,877,1,2,0)
most recent update from the commercial system.
"KRN",19,877,1,3,0)
 
"KRN",19,877,25)
COMP^NDFPMIUP
"KRN",19,877,"U")
LIST OF CHANGED MEDICATION INF
"KRN",19,878,-1)
0^36
"KRN",19,878,0)
NDF PMI DELETED LINKS^List of VA Products Linked to Deleted PMIS^^R^^^^^^^^NDF MANAGEMENT
"KRN",19,878,1,0)
^^2^2^2990203^
"KRN",19,878,1,1,0)
This option lists VA products that are linked to deleted medication
"KRN",19,878,1,2,0)
information sheets.
"KRN",19,878,25)
VAPN^NDFPMIUP
"KRN",19,878,"U")
LIST OF VA PRODUCTS LINKED TO 
"KRN",19,879,-1)
0^41
"KRN",19,879,0)
NDF PMI UPDATE REAL PMI FILES^Move New PMI Data into Official Files^^R^^^^^^^^NDF MANAGEMENT
"KRN",19,879,1,0)
^^2^2^2990203^
"KRN",19,879,1,1,0)
This option is used to update the official files storing PMI text.
"KRN",19,879,1,2,0)
Once completed, links between VA Products and new PMIs can created.
"KRN",19,879,25)
MAP^NDFPMIUP
"KRN",19,879,"U")
MOVE NEW PMI DATA INTO OFFICIA
"KRN",19,880,-1)
0^39
"KRN",19,880,0)
NDF PMI LENGTH CHECK^Check for PMI Names Greater than 200 Characters^^R^^^^^^^^NDF MANAGEMENT
"KRN",19,880,1,0)
^^3^3^2990203^
"KRN",19,880,1,1,0)
This option can be used to check for PMI names larger than 200
"KRN",19,880,1,2,0)
characters. This was a problem with some of the early updates
"KRN",19,880,1,3,0)
from USPDI.
"KRN",19,880,25)
LENGTH^NDFPMIU1
"KRN",19,880,"U")
CHECK FOR PMI NAMES GREATER TH
"KRN",19,882,-1)
0^67
"KRN",19,882,0)
NDFRTE^Check For Missing Med Routes^^R^^^^^^^^
"KRN",19,882,25)
ZZNORTE
"KRN",19,882,"U")
CHECK FOR MISSING MED ROUTES
"KRN",19,883,-1)
0^47
"KRN",19,883,0)
NDF PRODUCT LINKED^Products Newly Linked to PMIs^^R^^^^^^^^NDF MANAGEMENT
"KRN",19,883,1,0)
^^2^2^2990414^
"KRN",19,883,1,1,0)
This option will send a mail message to the user listing all VA Products
"KRN",19,883,1,2,0)
which have bee newly linked to a PMI sheet.
"KRN",19,883,25)
NDFPMI
"KRN",19,883,"U")
PRODUCTS NEWLY LINKED TO PMIS
"KRN",19,884,-1)
0^9
"KRN",19,884,0)
NDF ENTER RESTRICTIONS^Enter/Edit Formulary Restrictions^^R^^^^^^^^NDF MANAGEMENT
"KRN",19,884,1,0)
^^1^1^2990909^
"KRN",19,884,1,1,0)
Enter and edit formulary restrictions.
"KRN",19,884,25)
ENTER^NDFORMU
"KRN",19,884,"U")
ENTER/EDIT FORMULARY RESTRICTI
"KRN",19,891,-1)
0^44
"KRN",19,891,0)
NDF PRINT INTERACTIONS^Print Interactions^^R^^^^^^^^NDF MANAGEMENT
"KRN",19,891,1,0)
^^1^1^2991202^
"KRN",19,891,1,1,0)
Print interactions and severity
"KRN",19,891,25)
INT^NDFPRINT
"KRN",19,891,"U")
PRINT INTERACTIONS
"KRN",19,892,-1)
0^48
"KRN",19,892,0)
NDF PRODUCT PRINT^Print Products & Restrictions^^R^^^^^^^^NDF MANAGEMENT
"KRN",19,892,25)
PRODP^NDFPRINT
"KRN",19,892,"U")
PRINT PRODUCTS & RESTRICTIONS
"KRN",19,893,-1)
0^30
"KRN",19,893,0)
NDF NEW PRODUCTS^List new VA Products^^R^^^^^^^^NDF MANAGEMENT
"KRN",19,893,25)
NEW^NDFPRINT
"KRN",19,893,"U")
LIST NEW VA PRODUCTS
"KRN",19,924,-1)
0^22
"KRN",19,924,0)
NDF LIST INTERACTIONS^List New and Edited Interactions^^R^^^^^^^^NDF MANAGEMENT
"KRN",19,924,1,0)
^^2^2^3020812^
"KRN",19,924,1,1,0)
List interactions which have been added, edited, or inactivated during
"KRN",19,924,1,2,0)
the current data update cycle.
"KRN",19,924,25)
LIST^NDFDINT
"KRN",19,924,"U")
LIST NEW AND EDITED INTERACTIO
"KRN",19,925,-1)
0^2
"KRN",19,925,0)
NDF CS FEDERAL SCHEDULE^CS Federal Schedule Edit^^R^^^^^^^^NDF MANAGEMENT
"KRN",19,925,1,0)
^^1^1^3020816^
"KRN",19,925,1,1,0)
Edit CS Federal Schedule data
"KRN",19,925,25)
14^NDFENTER
"KRN",19,925,"U")
CS FEDERAL SCHEDULE EDIT
"KRN",19,946,-1)
0^33
"KRN",19,946,0)
NDF PATCH EDIT REPORT^VA Product Changes Report^^R^^^^^^^^NATIONAL DRUG FILE
"KRN",19,946,1,0)
^19.06^15^15^3070725^^^^
"KRN",19,946,1,1,0)
This option will display current patch editsfor the following fields in
"KRN",19,946,1,2,0)
the VA PRODUCT file (#50.68):
"KRN",19,946,1,3,0)
 
"KRN",19,946,1,4,0)
NAME,
"KRN",19,946,1,5,0)
VA GENERIC NAME,
"KRN",19,946,1,6,0)
VA PRINT NAME,
"KRN",19,946,1,7,0)
UNITS,
"KRN",19,946,1,8,0)
DOSAGE FORM,
"KRN",19,946,1,9,0)
INACTIVATION DATE,
"KRN",19,946,1,10,0)
STRENGTH,
"KRN",19,946,1,11,0)
PRIMARY VA DRUG CLASS,
"KRN",19,946,1,12,0)
VA PRODUCT IDENTIFIER,
"KRN",19,946,1,13,0)
CS FEDERAL SCHEDULE, and 
"KRN",19,946,1,14,0)
VA DISPENSE UNIT
"KRN",19,946,1,15,0)
 
"KRN",19,946,25)
NDFPATCH
"KRN",19,946,"U")
VA PRODUCT CHANGES REPORT
"KRN",19,947,-1)
0^21
"KRN",19,947,0)
NDF LIST INGREDIENTS^List Ingredients^^R^^^^^^^^NDF MANAGEMENT
"KRN",19,947,1,0)
^^1^1^3030508^
"KRN",19,947,1,1,0)
List of VA Products and Ingredients
"KRN",19,947,25)
NDFINGR
"KRN",19,947,"U")
LIST INGREDIENTS
"KRN",19,948,-1)
0^11
"KRN",19,948,0)
NDF EXCLUDE^Exclude VA Products from Interaction Check^^R^^^^^^^^NDF MANAGEMENT
"KRN",19,948,25)
NDFEXCLU
"KRN",19,948,"U")
EXCLUDE VA PRODUCTS FROM INTER
"KRN",19,949,-1)
0^63
"KRN",19,949,0)
NDFEXMPT^VA Products Marked As Exemptions For DDI Checking^^R^^^^^^^^
"KRN",19,949,1,0)
^^2^2^3030521^
"KRN",19,949,1,1,0)
This option gives you a printed copy of active VA Products marked
"KRN",19,949,1,2,0)
as EXCLUDE from Drug-Drug Interaction checking.
"KRN",19,949,25)
NDFEXMPT
"KRN",19,949,"U")
VA PRODUCTS MARKED AS EXEMPTIO
"KRN",19,950,-1)
0^64
"KRN",19,950,0)
NDFNODDI^Products Exclude DDI check in Drg Interaction file^^R^^^^^^^^
"KRN",19,950,1,0)
^19.06^2^2^3030521^^^
"KRN",19,950,1,1,0)
This option will list VA Products from Don's Exclude DDIs List that
"KRN",19,950,1,2,0)
have entries in the DRUG INTERACTION file (#56).
"KRN",19,950,25)
NDFNODDI
"KRN",19,950,"U")
PRODUCTS EXCLUDE DDI CHECK IN 
"KRN",19,951,-1)
0^66
"KRN",19,951,0)
NDFPODDI^Potential Products to be Marked for NO DDI Check^^R^^^^^^^^
"KRN",19,951,1,0)
^19.06^2^2^3030521^^
"KRN",19,951,1,1,0)
This option will produce a list of Potential VA Products (Don's List)
"KRN",19,951,1,2,0)
to be marked as EXCLUDE from Drug-Drug Interaction checking.
"KRN",19,951,25)
NDFPODDI
"KRN",19,951,"U")
POTENTIAL PRODUCTS TO BE MARKE
"KRN",19,1030,-1)
0^60
"KRN",19,1030,0)
NDF VUID CREATE^Create New VUID Assignments^^R^^^^^^^^NDF MANAGEMENT
"KRN",19,1030,1,0)
^^7^7^3051103^
"KRN",19,1030,1,1,0)
This option is used to assign VUIDs to newly added entries and to update
"KRN",19,1030,1,2,0)
the VUID Status field when an entry is inactivated.  This option should
"KRN",19,1030,1,3,0)
be used prior to sending data to the Data Standardization Review Group.
"KRN",19,1030,1,4,0)
Ideally, it should be run only once for each NDF Data Update cycle.  If
"KRN",19,1030,1,5,0)
the Data Standardization Review Group identifies issues, it will have to be
"KRN",19,1030,1,6,0)
run a second time after edits are made.
"KRN",19,1030,1,7,0)
 
"KRN",19,1030,25)
NDFVUID
"KRN",19,1030,"U")
CREATE NEW VUID ASSIGNMENTS
"KRN",19,1031,-1)
0^61
"KRN",19,1031,0)
NDF VUID LIST^List of New Entries Pending VUID Assignment^^R^^^^^^^^NDF MANAGEMENT
"KRN",19,1031,1,0)
^19.06^4^4^3051104^^
"KRN",19,1031,1,1,0)
This report should be run prior to assigning VUID related information.
"KRN",19,1031,1,2,0)
It will display all newly added entries and their proposed VUID
"KRN",19,1031,1,3,0)
assignment.  It will also contain a section that lists entries that have
"KRN",19,1031,1,4,0)
been inactivated or reactivated.
"KRN",19,1031,25)
NDFVUDPL
"KRN",19,1031,"U")
LIST OF NEW ENTRIES PENDING VU
"KRN",19,1032,-1)
0^62
"KRN",19,1032,0)
NDF VUID MENU^VUID Assignment Menu^^M^^^^^^^^NDF MANAGEMENT
"KRN",19,1032,1,0)
^19.06^3^3^3051104^^^
"KRN",19,1032,1,1,0)
This menu contains options to manage the VUID assignment process.  It
"KRN",19,1032,1,2,0)
includes tools to assign VUIDs and related fields and reports to
"KRN",19,1032,1,3,0)
assist reviews.
"KRN",19,1032,10,0)
^19.01IP^2^2
"KRN",19,1032,10,1,0)
1031
"KRN",19,1032,10,1,"^")
NDF VUID LIST
"KRN",19,1032,10,2,0)
1030
"KRN",19,1032,10,2,"^")
NDF VUID CREATE
"KRN",19,1032,99)
60232,40674
"KRN",19,1032,"U")
VUID ASSIGNMENT MENU
"KRN",19,1041,-1)
0^34
"KRN",19,1041,0)
NDF PFS^Enter Service Codes^^R^^^^^^^^NDF MANAGEMENT
"KRN",19,1041,1,0)
^^1^1^3060713^
"KRN",19,1041,1,1,0)
Enter PFS codes into the VA PRODUCT file (#50.68).
"KRN",19,1041,25)
PFS^NDFENTER
"KRN",19,1041,"U")
ENTER SERVICE CODES
"KRN",19,1057,-1)
0^49
"KRN",19,1057,0)
NDF PRODUCTS AND PMIS^List Products and PMIs^^R^^^^^^^^NDF MANAGEMENT
"KRN",19,1057,1,0)
^^3^3^3071126^
"KRN",19,1057,1,1,0)
This option list all products and the PMIs to which they are matched
"KRN",19,1057,1,2,0)
in all instances where the first word of the product name is not the
"KRN",19,1057,1,3,0)
same as the first word of the PMI title.
"KRN",19,1057,25)
NDFPMIL
"KRN",19,1057,"U")
LIST PRODUCTS AND PMIS
"KRN",19,1058,-1)
0^68
"KRN",19,1058,0)
NDFWARNINGLABEL^Print products and warning labels^^R^^^^^^^^NDF MANAGEMENT
"KRN",19,1058,25)
NDFWARN
"KRN",19,1058,"U")
PRINT PRODUCTS AND WARNING LAB
"KRN",19,1059,-1)
0^12
"KRN",19,1059,0)
NDF EXCLUSIONS^Products and Exclusions From Checks^^R^^^^^^^^NDF MANAGEMENT
"KRN",19,1059,1,0)
^^2^2^3080125^
"KRN",19,1059,1,1,0)
This option prints a list of products entered during a selected date
"KRN",19,1059,1,2,0)
range and whether they are excluded from drug-drug interaction checking.
"KRN",19,1059,25)
NDFEX
"KRN",19,1059,"U")
PRODUCTS AND EXCLUSIONS FROM C
"KRN",101,51,-1)
0^3
"KRN",101,51,0)
NDF RSB^ACCEPT/EDIT MENU^^M^^^^^^^^
"KRN",101,51,4)
26
"KRN",101,51,10,0)
^101.01PA^2^2
"KRN",101,51,10,1,0)
55^ED^^
"KRN",101,51,10,1,"^")
NDF RSB EDIT
"KRN",101,51,10,2,0)
56^AC^^
"KRN",101,51,10,2,"^")
NDF RSB ACCEPT
"KRN",101,51,26)
D SHOW^VALM
"KRN",101,51,28)
Select Action:
"KRN",101,51,99)
59924,37646
"KRN",101,52,-1)
0^8
"KRN",101,52,0)
NDF RSB NDC EDIT^Edit^^A^^^^^^^^
"KRN",101,52,15)
K NDFEDIT2 D BUILD^NDFRR8
"KRN",101,52,20)
S NDFEDIT2=1 D EDIT^NDFRR8
"KRN",101,52,99)
59105,57936
"KRN",101,53,-1)
0^7
"KRN",101,53,0)
NDF RSB NDC ACCEPT^ACCEPT^^A^^^^^^^^
"KRN",101,53,20)
D ACCEPT^NDFRR9
"KRN",101,53,99)
59105,57936
"KRN",101,54,-1)
0^6
"KRN",101,54,0)
NDF RSB NDC^ACCEPT/EDIT MENU^^M^^^^^^^^
"KRN",101,54,4)
26
"KRN",101,54,10,0)
^101.01PA^3^3
"KRN",101,54,10,1,0)
52^ED^^
"KRN",101,54,10,1,"^")
NDF RSB NDC EDIT
"KRN",101,54,10,2,0)
53^AC^^
"KRN",101,54,10,2,"^")
NDF RSB NDC ACCEPT
"KRN",101,54,10,3,0)
77^QU^^
"KRN",101,54,10,3,"^")
NDF QUIT
"KRN",101,54,15)
I XQORNOD(0)="" S VALMBCK="R"
"KRN",101,54,26)
D SHOW^VALM S XQORM("B")=""
"KRN",101,54,28)
Select AC, ED, or QU
"KRN",101,54,99)
59927,27720
"KRN",101,55,-1)
0^5
"KRN",101,55,0)
NDF RSB EDIT^Edit^^A^^^^^^^^
"KRN",101,55,4)
^^^
"KRN",101,55,15)
K NDFEDIT D BUILD^NDFRR6(NDFNAME)
"KRN",101,55,20)
S NDFEDIT=1 D EDIT^NDFRR5
"KRN",101,55,99)
59105,57936
"KRN",101,56,-1)
0^4
"KRN",101,56,0)
NDF RSB ACCEPT^ACCEPT^^A^^^^^^^^
"KRN",101,56,20)
D ACCEPT^NDFRR3
"KRN",101,56,99)
59105,57936
"KRN",101,76,-1)
0^1
"KRN",101,76,0)
NDF HIDDEN ACTIONS^NDF Hidden Actions^^M^^^^^^^^NDF MANAGEMENT
"KRN",101,76,10,0)
^101.01PA^7^7
"KRN",101,76,99)
60759,32214
"KRN",101,77,-1)
0^2
"KRN",101,77,0)
NDF QUIT^QUIT^^A^^^^^^^^
"KRN",101,77,.1)
Quit
"KRN",101,77,2,0)
^101.02A^1^1
"KRN",101,77,2,1,0)
QU
"KRN",101,77,2,"B","QU",1)

"KRN",101,77,15)

"KRN",101,77,20)
Q
"KRN",101,77,99)
59105,57936
"KRN",409.61,3,-1)
0^1
"KRN",409.61,3,0)
NDF RSB ACCEPT/EDIT^1^^80^4^21^1^1^Protocol^NDF RSB^VA Product Accept/Edit^1^^1
"KRN",409.61,3,1)
^VALM HIDDEN ACTIONS
"KRN",409.61,3,"ARRAY")
 ^TMP("NDFRSB",$J)
"KRN",409.61,3,"HDR")
D HDR^NDFRR6
"KRN",409.61,3,"INIT")
D BUILD^NDFRR6(NDFNAME)
"KRN",409.61,4,-1)
0^2
"KRN",409.61,4,0)
NDF RSB NDC A/E^1^^80^4^21^1^1^Protocol^NDF RSB NDC^National Drug File Accept/Edit^^^0
"KRN",409.61,4,1)
^NDF HIDDEN ACTIONS
"KRN",409.61,4,"ARRAY")
 ^TMP("NDFDRSB",$J)
"KRN",409.61,4,"HDR")
D HDR^NDFRR8
"KRN",409.61,4,"INIT")
D BUILD^NDFRR8
"MBREQ")
0
"ORD",5,.4)
.4;5;;;EDEOUT^DIFROMSO(.4,DA,"",XPDA);FPRE^DIFROMSI(.4,"",XPDA);EPRE^DIFROMSI(.4,DA,$E("N",$G(XPDNEW)),XPDA,"",OLDA);;EPOST^DIFROMSI(.4,DA,"",XPDA);DEL^DIFROMSK(.4,"",%)
"ORD",5,.4,0)
PRINT TEMPLATE
"ORD",11,3.8)
3.8;11;;;MAILG^XPDTA1;MAILGF1^XPDIA1;MAILGE1^XPDIA1;MAILGF2^XPDIA1;;MAILGDEL^XPDIA1(%)
"ORD",11,3.8,0)
MAIL GROUP
"ORD",15,101)
101;15;;;PRO^XPDTA;PROF1^XPDIA;PROE1^XPDIA;PROF2^XPDIA;;PRODEL^XPDIA
"ORD",15,101,0)
PROTOCOL
"ORD",17,409.61)
409.61;17;1;;;;LME1^XPDIA1;;;LMDEL^XPDIA1
"ORD",17,409.61,0)
LIST TEMPLATE
"ORD",18,19)
19;18;;;OPT^XPDTA;OPTF1^XPDIA;OPTE1^XPDIA;OPTF2^XPDIA;;OPTDEL^XPDIA
"ORD",18,19,0)
OPTION
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
NO
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
NO
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
NO
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
55
"RTN","NDF4P88P")
0^1^B307388
"RTN","NDF4P88P",1,0)
NDF4P88P ;BIR/DMA-pretransport routine for gender specific ; 19 Aug 04
"RTN","NDF4P88P",2,0)
 ;;0.0; Internal;; 19 Aug 04;Build 1
"RTN","NDF4P88P",3,0)
 S DA=0,LINE="" F  S DA=$O(^PS(50.625,DA)) Q:'DA  I $G(^(DA,2))]"" S LINE=LINE_DA_"^"_^(2)_"^"
"RTN","NDF4P88P",4,0)
 S @XPDGREF@(1)=LINE
"RTN","NDF4P88P",5,0)
 Q
"RTN","NDFAUTO")
0^2^B2918602
"RTN","NDFAUTO",1,0)
NDFAUTO ;BIRM/WRT - Auto marking of VA Products to be excluded from Drug-Drug Interaction checking.; 05/19/03 10:01
"RTN","NDFAUTO",2,0)
 ;;4.0; NDF MANAGEMENT;; 1 Jan 99;Build 1
"RTN","NDFAUTO",3,0)
START ; Begin update process
"RTN","NDFAUTO",4,0)
 W !!,"This option will run the auto-marking process. This will be accomplished by",!,"taking entries in ^TMP global and mark those IENs in VA PRODUCT file (#50.68) marking them with a flag",!
"RTN","NDFAUTO",5,0)
 W "to exclude from drug-drug interaction checking."
"RTN","NDFAUTO",6,0)
 W ! S DIR("A")="Are you sure you are ready to proceed? "
"RTN","NDFAUTO",7,0)
 S DIR("B")="NO",DIR(0)="YA" D ^DIR K DIR I $D(DTOUT)!$D(DUOUT) Q
"RTN","NDFAUTO",8,0)
 I Y=0 Q
"RTN","NDFAUTO",9,0)
 D LOOP W !!,"**** OK, I'm through. Please REVIEW your matches. ****"
"RTN","NDFAUTO",10,0)
 K IFN
"RTN","NDFAUTO",11,0)
 Q
"RTN","NDFAUTO",12,0)
 ;
"RTN","NDFAUTO",13,0)
LOOP ;
"RTN","NDFAUTO",14,0)
 F IFN=0:0 S IFN=$O(^DONLIST1(IFN)) Q:'IFN  U IO W:'(IFN#100) "." D STUFF
"RTN","NDFAUTO",15,0)
 Q
"RTN","NDFAUTO",16,0)
DELETE S DA=IFN S DIE="^PSNDF(50.68,",DR="23////"_"@" D ^DIE
"RTN","NDFAUTO",17,0)
 Q
"RTN","NDFAUTO",18,0)
STUFF K DA,DIE S DA=IEN S DIE="^PSNDF(50.68,",DR="23////"_"1" D ^DIE
"RTN","NDFAUTO",19,0)
 Q
"RTN","NDFCLAPR")
0^3^B3130397
"RTN","NDFCLAPR",1,0)
NDFCLAPR ;BIR/DMA-print VA Classification scheme ;01 Sep 98 / 1:35 PM
"RTN","NDFCLAPR",2,0)
 ;;4.0; NDF MANAGEMENT;; 1 Jan 99;Build 1
"RTN","NDFCLAPR",3,0)
 D EN^XUTMDEVQ("GO^NDFCLAPR","PRINT VA DRUG CLASSIFICATION SCHEME")
"RTN","NDFCLAPR",4,0)
 I POP W !,"No device selected"
"RTN","NDFCLAPR",5,0)
 Q
"RTN","NDFCLAPR",6,0)
 ;
"RTN","NDFCLAPR",7,0)
GO ;ENTRY POINT
"RTN","NDFCLAPR",8,0)
 K ^TMP($J) S TD=$TR($$HTE^XLFDT($H),"@"," "),PG=1,$P(LINE,"-",IOM-1)=""
"RTN","NDFCLAPR",9,0)
 S DA=0 F  S DA=$O(^PS(50.605,DA)) Q:'DA  S X=^(DA,0) I $P(X,"^")'="AA000" S ^TMP($J,$P(X,"^",1,2)_"^"_DA)=""
"RTN","NDFCLAPR",10,0)
 D HEAD S CO="" F  S CO=$O(^TMP($J,CO)) Q:CO=""  S CL=$P(CO,"^",1),DE=$P(CO,"^",2),NDF1=$P(CO,"^",3) D:$Y+4+$O(^PS(50.605,NDF1,1," "),-1)>IOSL HEAD W !,?$S(CL["000":0,CL["00":5,1:15),CL_"   "_DE I $O(^PS(50.605,NDF1,1,0)) D
"RTN","NDFCLAPR",11,0)
 .F NDF=0:0 S NDF=$O(^PS(50.605,NDF1,1,NDF)) Q:'NDF  W !,^(NDF,0)
"RTN","NDFCLAPR",12,0)
 .W !
"RTN","NDFCLAPR",13,0)
 K NDF1,NDF,X,TD,PG,LINE,C0,CL,DE,^TMP($J),^UTILITY($J,"W") S:$D(ZTQUEUED) ZTREQ="" D ^%ZISC Q
"RTN","NDFCLAPR",14,0)
 ;
"RTN","NDFCLAPR",15,0)
HEAD W:$Y @IOF W !,"VA DRUG CLASSIFICATION",?IOM-30," ",TD," PAGE ",PG,!,LINE,! S PG=PG+1 Q
"RTN","NDFCLEAN")
0^4^B7358021
"RTN","NDFCLEAN",1,0)
NDFCLEAN ;BIR/WRT-LOOP THRU STANDARDIZED FILES TO MAKE UNIQUE TERMS MASTERS; 12/08/05 10:28
"RTN","NDFCLEAN",2,0)
 ;;0.0; NATIONAL DRUG FILE MANAGEMENT SYSTEM;; 30 Oct 98;Build 1
"RTN","NDFCLEAN",3,0)
 ; All Unique Terms are Masters
"RTN","NDFCLEAN",4,0)
 K ^TMP("NDF1") D UNIQ1 ; UNIQ2,UNIQ3 K NUMB,WRT,AA,TRM
"RTN","NDFCLEAN",5,0)
 Q
"RTN","NDFCLEAN",6,0)
UNIQ1 F WRT=0:0 S WRT=$O(^PSNDF(50.68,WRT)) Q:'WRT  S TRM=$P(^PSNDF(50.68,WRT,0),"^") I $D(^PSNDF(50.68,WRT,"VUID")),$P(^PSNDF(50.68,WRT,"VUID"),"^",2)=0 D DUP1
"RTN","NDFCLEAN",7,0)
 Q
"RTN","NDFCLEAN",8,0)
DUP1 S NUMB=0 F AA=0:0 S AA=$O(^PSNDF(50.68,"B",TRM,AA)) Q:'AA  S NUMB=NUMB+1 I NUMB=1 S DATE=$P($G(^PSNDF(50.68,AA,7)),"^",3) S:'$G(DATE) DATE=DT S ^TMP("NDF1",50.68,AA)="" S DA=AA,DIE="^PSNDF(50.68,",DR="99.98////"_1 D ^DIE D STAT
"RTN","NDFCLEAN",9,0)
 Q
"RTN","NDFCLEAN",10,0)
STAT I DATE=DT S DA(1)=AA,DIC="^PSNDF(50.68,"_AA_",""TERMSTATUS"",",X=DT,DIC(0)="L",DLAYGO=50.6899,DIC("DR")=".02////"_1 D FILE^DICN
"RTN","NDFCLEAN",11,0)
 I DATE'=DT S DA(1)=AA,DIC="^PSNDF(50.68,"_AA_",""TERMSTATUS"",",X=DT,DIC(0)="L",DLAYGO=50.6899,DIC("DR")=".02////"_0 D FILE^DICN
"RTN","NDFCLEAN",12,0)
 Q
"RTN","NDFCLEAN",13,0)
UNIQ2 K NUMB,WRT,AA,TRM
"RTN","NDFCLEAN",14,0)
 F WRT=0:0 S WRT=$O(^PS(50.416,WRT)) Q:'WRT  S TRM=$P(^PS(50.416,WRT,0),"^") I $D(^PS(50.416,WRT,"VUID")),$P(^PS(50.416,WRT,"VUID"),"^",2)=0 D DUP2
"RTN","NDFCLEAN",15,0)
 Q
"RTN","NDFCLEAN",16,0)
DUP2 S NUMB=0 F AA=0:0 S AA=$O(^PS(50.416,"B",TRM,AA)) Q:'AA  S NUMB=NUMB+1 I NUMB=1 S ^TMP("NDF1",50.416,AA)="",DA=AA,DIE="^PS(50.416,",DR="99.98////"_1 D ^DIE
"RTN","NDFCLEAN",17,0)
 Q
"RTN","NDFCLEAN",18,0)
UNIQ3 K NUMB,WRT,AA,TRM
"RTN","NDFCLEAN",19,0)
 F WRT=0:0 S WRT=$O(^PSNDF(50.6,WRT)) Q:'WRT  S TRM=$P(^PSNDF(50.6,WRT,0),"^") I $D(^PSNDF(50.6,WRT,"VUID")),$P(^PSNDF(50.6,WRT,"VUID"),"^",2)=0 D DUP3
"RTN","NDFCLEAN",20,0)
 Q
"RTN","NDFCLEAN",21,0)
DUP3 S NUMB=0 F AA=0:0 S AA=$O(^PSNDF(50.6,"B",TRM,AA)) Q:'AA  S NUMB=NUMB+1 I NUMB=1 S ^TMP("NDF1",50.6,AA)="",DA=AA,DIE="^PSNDF(50.6,",DR="99.98////"_1 D ^DIE
"RTN","NDFCLEAN",22,0)
 Q
"RTN","NDFCLPR")
0^5^B5123088
"RTN","NDFCLPR",1,0)
NDFCLPR ;BIR/DMA-print products sorted by class ;31 Aug 98 / 1:57 PM
"RTN","NDFCLPR",2,0)
 ;;4.0; NDF MANAGEMENT;; 1 Jan 99;Build 1
"RTN","NDFCLPR",3,0)
 S DIR(0)="SA^P:PRIMARY;S:SECONDARY;B:BOTH",DIR("A")="Sort by Primary (P), Secondary (S), or Both (B) Classes? " D ^DIR G END:$D(DIRUT) S S=Y
"RTN","NDFCLPR",4,0)
 S ZTSAVE("S")="" D EN^XUTMDEVQ("GO^NDFCLPR","PRINT DRUGS SORTED BY CLASS",.ZTSAVE) I POP W !,"No device selected",!
"RTN","NDFCLPR",5,0)
END K DIR,S,X,Y,ZTSAVE Q
"RTN","NDFCLPR",6,0)
 ;
"RTN","NDFCLPR",7,0)
GO ;ENTRY POINT
"RTN","NDFCLPR",8,0)
 K ^TMP($J)
"RTN","NDFCLPR",9,0)
 S DA=0 F  S DA=$O(^PSNDF(50.68,DA)) Q:'DA  S NA=$P(^(DA,0),"^") D
"RTN","NDFCLPR",10,0)
 .I S'="S" S CL=$P($G(^PSNDF(50.68,DA,3)),"^"),CL=$P(^PS(50.605,+CL,0),"^"),^TMP($J,CL,NA)=""
"RTN","NDFCLPR",11,0)
 .I S'="P" S K=0 F  S K=$O(^PSNDF(DA,4,K,0)) Q:'K  S CL=$P($G(^PS(50.605,K,0)),"^")_$S(S="B":"*",1:""),^TMP($J,CL,NA)=""
"RTN","NDFCLPR",12,0)
 ;
"RTN","NDFCLPR",13,0)
 S PG=1,TD=$TR($$HTE^XLFDT($H),"@"," "),$P(LINE,"-",IOM-1)=""
"RTN","NDFCLPR",14,0)
 D HEAD S CL="" F  S CL=$O(^TMP($J,CL)),NA="" Q:CL=""  F  S NA=$O(^TMP($J,CL,NA)) Q:NA=""  W !,CL,?S="B"*8+10,NA I $Y+4>IOSL D HEAD
"RTN","NDFCLPR",15,0)
 K CL,DA,K,LINE,NA,S,TD S:$D(ZTQUEUED) ZTREQ="@" D ^%ZISC Q
"RTN","NDFCLPR",16,0)
 ;
"RTN","NDFCLPR",17,0)
HEAD W:$Y @IOF W !,"VA PRODUCT LIST",?IOM-30," ",TD," PAGE ",PG,!! W:S="P" "PRIMARY",! W:S="S" "SECONDARY",! W:S="B" "PRIMARY OR",!,"SECONDARY",!,"VA CLASS CODE" W:S'="B" "VA CLASS",!,"CODE" W ?S="B"*10+12,"VA PRODUCT NAME",!,LINE,! S PG=PG+1 Q
"RTN","NDFCMOP")
0^6^B8375621
"RTN","NDFCMOP",1,0)
NDFCMOP ;BIR/DMA-print products marked for CMOP ;31 Aug 98 / 1:05 PM
"RTN","NDFCMOP",2,0)
 ;;4.0; NDF MANAGEMENT;; 1 Jan 99;Build 1
"RTN","NDFCMOP",3,0)
 S DIR(0)="SA^I:IDENTIFIER;N:NAME",DIR("A")="Sort by VA Identifier (I) or VA Product Nnme (N)? " D ^DIR G END:$D(DIRUT) S S=Y
"RTN","NDFCMOP",4,0)
 S ZTSAVE("S")="" D EN^XUTMDEVQ("GO^NDFCMOP","PRINT DRUGS MARKED FOR CMOP",.ZTSAVE) I POP W !,"No device selected",!
"RTN","NDFCMOP",5,0)
END K DIR,S,X,Y,ZTSAVE Q
"RTN","NDFCMOP",6,0)
 ;
"RTN","NDFCMOP",7,0)
GO ;ENTRY POINT
"RTN","NDFCMOP",8,0)
 K ^TMP($J) D @S
"RTN","NDFCMOP",9,0)
 S:$D(ZTQUEUED) ZTREQ="@" K DA,DIR,ID,LINE,NA,PG,PR,S,TD,UN,X0,X1,Y,^TMP($J) D ^%ZISC Q
"RTN","NDFCMOP",10,0)
 ;
"RTN","NDFCMOP",11,0)
I ;SORT BY ID
"RTN","NDFCMOP",12,0)
 S DA=0 F  S DA=$O(^PSNDF(50.68,DA)) Q:'DA  S X0=^(DA,0),X1=^(1) I $P(X1,"^",3) S ID=$P(X1,"^",2),NA=$P(X0,"^",1),UN=$P(X1,"^",4),UN=$P($G(^PSNDF(50.64,+UN,0)),"^"),^TMP($J,ID,NA,UN)=""
"RTN","NDFCMOP",13,0)
 S PG=1,TD=$TR($$HTE^XLFDT($H),"@"," "),$P(LINE,"-",IOM-1)="" D HEADID
"RTN","NDFCMOP",14,0)
 S ID="" F  S ID=$O(^TMP($J,ID)),NA="" Q:ID=""  F  S NA=$O(^TMP($J,ID,NA)),UN="" Q:NA=""  F  S UN=$O(^TMP($J,ID,NA,UN)) Q:UN=""  W !,ID,?12,NA,?60,UN I $Y+4>IOSL D HEADID
"RTN","NDFCMOP",15,0)
 Q
"RTN","NDFCMOP",16,0)
 ;
"RTN","NDFCMOP",17,0)
HEADID W:$Y @IOF W !,?12,"VA PRODUCT LIST",?IOM-30," ",TD," PAGE ",PG,!,"ID#",?12,"VA PRINT NAME",?55,"VA DISP UNIT",!,LINE,! S PG=PG+1 Q
"RTN","NDFCMOP",18,0)
 ;
"RTN","NDFCMOP",19,0)
 ;
"RTN","NDFCMOP",20,0)
N ;SORT BY NAME
"RTN","NDFCMOP",21,0)
 S DA=0 F  S DA=$O(^PSNDF(50.68,DA)) Q:'DA  S X0=^(DA,0),X1=^(1) I $P(X0,"^",3)]"" S NA=$P(X1,"^"),PR=$P(X1,"^"),UN=$P(X1,"^",4),UN=$P($G(^PSNDF(50.64,+UN,0)),"^"),ID=$P(X1,"^",2),^TMP($J,NA,PR,UN,ID)=""
"RTN","NDFCMOP",22,0)
 S PG=1,TD=$TR($$HTE^XLFDT($H),"@"," "),$P(LINE,"-",IOM-1)="" D HEADNA
"RTN","NDFCMOP",23,0)
 S NA="" F  S NA=$O(^TMP($J,NA)),PR="" Q:NA=""  F  S PR=$O(^TMP($J,NA,PR)),UN="" Q:PR=""  F  S UN=$O(^TMP($J,NA,PR,UN)),ID="" Q:UN=""  F  S ID=$O(^TMP($J,NA,PR,UN,ID)) Q:ID=""  D
"RTN","NDFCMOP",24,0)
 .W !,NA,!,?7,PR,?60,UN,?70,ID I $Y+4>IOSL D HEADNA
"RTN","NDFCMOP",25,0)
 Q
"RTN","NDFCMOP",26,0)
 ;
"RTN","NDFCMOP",27,0)
HEADNA W:$Y @IOF W !,?12,"VA PRODUCT LIST",?IOM-30," ",TD," PAGE ",PG,!,"VA PRODCUT NAME",!,?5,"VA PRINT NAME",?55,"VA DISP UNIT",?70,"ID#",!,LINE,! S PG=PG+1 Q
"RTN","NDFDEACT")
0^7^B48719627
"RTN","NDFDEACT",1,0)
NDFDEACT ;BIR/DMA-inquiries, link/unlink, and inactivate/reactivate items ; 19 Apr 2010  8:46 AM
"RTN","NDFDEACT",2,0)
 ;;4.0; NDF MANAGEMENT;; 1 Jan 99;Build 1
"RTN","NDFDEACT",3,0)
 ;
"RTN","NDFDEACT",4,0)
PROD ;INACTIVATE PRODUCT (AND ASSOCIATED NDCS)
"RTN","NDFDEACT",5,0)
 F  Q:$D(DIRUT)  S DIC=50.68,DIC(0)="AEQMZ" D ^DIC Q:Y<0  S DA=+Y,Y1=^(1),Y3=^(3),Y7=$G(^(7)) D
"RTN","NDFDEACT",6,0)
 .W @IOF,!,"VA Product name: ",$P(Y(0),"^"),!,"VA Generic Name: ",$P(^PSNDF(50.6,+$P(Y(0),"^",2),0),"^"),!,"Dose Form: ",$P(^PS(50.606,+$P(Y(0),"^",3),0),"^"),"   Strength: ",$P(Y(0),"^",4)," Units: ",$P($G(^PS(50.607,+$P(Y(0),"^",5),0)),"^")
"RTN","NDFDEACT",7,0)
 .W !,"National Formulary Name: ",$P(Y(0),"^",6),!,"VA Print Name: ",$P(Y1,"^"),!,"VA Product Identifier: ",$P(Y1,"^",2)," Transmit to CMOP: ",$S($P(Y1,"^",3):"Yes",1:"No")
"RTN","NDFDEACT",8,0)
 .W " VA Dispense Unit: ",$P($G(^PSNDF(50.64,+$P(Y1,"^",4),0)),"^")
"RTN","NDFDEACT",9,0)
 .W !,"PMIS: ",$P($G(^PSPPI(+$P(Y1,"^",5),0),"None"),"^"),!,"Active Ingredients: " S K=0 F  S K=$O(^PSNDF(50.68,DA,2,K)) Q:'K  S X=^(K,0),ING=^PS(50.416,K,0) S:$P(ING,"^",2) ING=^PS(50.416,$P(ING,"^",2),0) D
"RTN","NDFDEACT",10,0)
 ..W ?23,$P(ING,"^"),"  Strength: ",$P(X,"^",2)," Units :",$P($G(^PS(50.607,+$P(X,"^",3),0)),"^"),!
"RTN","NDFDEACT",11,0)
 .W !,"Primary VA Drug Class: ",$P($G(^PS(50.605,+Y3,0),"Unknown"),"^"),!,"Secondary VA Drug Class: " S K=0 F  S K=$O(^PSNDF(DA,4,K)) Q:'K  W ?26,$P($G(^PS(50.605,+K,0),"Unknown"),"^"),!
"RTN","NDFDEACT",12,0)
 .W !,"CS Federal Schedule: ",$P(Y7,"^")," Single/Multi Source Product ",$S($P(Y7,"^",2)="M":"Multi",$P(Y7,"^",2)="S":"Single",1:"")
"RTN","NDFDEACT",13,0)
 .W !,"Inactivation date: ",$$FMTE^XLFDT($P(Y7,"^",3))
"RTN","NDFDEACT",14,0)
 .W !,"Max Single Dose: ",$P(Y7,"^",4),"  Min Single Dose: ",$P(Y7,"^",5),!,"Max Daily Dose: ",$P(Y7,"^",6),"  Min Daily Dose: ",$P(Y7,"^",7),!,"Max Cumulative Dose: ",$P(Y7,"^",8),!!
"RTN","NDFDEACT",15,0)
 .I $P(Y7,"^",3)="" S DIR(0)="Y",DIR("A")="Do you want to Inactivate " D ^DIR Q:$D(DIRUT)  I Y S DR="21////"_DT_";",DIE="^PSNDF(50.68," D ^DIE S DIC="^NDFK(5000.2,",X=DA K DD,DO D FILE^DICN S OLDDA=DA D
"RTN","NDFDEACT",16,0)
 ..S DA=0 F  S DA=$O(^PSNDF(50,68,"ANDC",OLDDA,DA)) Q:'DA  S DIE="^PSNDF(50.67,",DR="7////"_DT_";" D ^DIE
"RTN","NDFDEACT",17,0)
 ..;S DA(1)=OLDDA,DIC="^PSNDF(50.68,"_DA(1)_",""TERMSTATUS"",",X=DT,DIC("DR")=".02////0" D FILE^DICN
"RTN","NDFDEACT",18,0)
 .I $P(Y7,"^",3) S DIR(0)="Y",DIR("A")="Do you want to Reactivate " W !,"That product was inactivated on ",$$FMTE^XLFDT($P(Y7,"^",3)) D ^DIR Q:$D(DIRUT)  I Y D
"RTN","NDFDEACT",19,0)
  ..S DIE="^PSNDF(50.68,",DR="21///@" D ^DIE S OLDDA=DA D
"RTN","NDFDEACT",20,0)
 ...S DIK="^NDFK(5000.2,",DA=$O(^NDFK(5000.2,"B",OLDDA,0)) I DA D ^DIK
"RTN","NDFDEACT",21,0)
 ...S DA=0 F  S DA=$O(^PSNDF(50.68,"ANDC",OLDDA,DA)) Q:'DA  S DIE="^PSNDF(50.67,",DR="7///@" D ^DIE
"RTN","NDFDEACT",22,0)
 ...;S DA(1)=OLDDA,DIC="^PSNDF(50.68,"_DA(1)_",""TERMSTATUS"",",X=DT,DIC("DR")=".02////1" D FILE^DICN
"RTN","NDFDEACT",23,0)
 K DA,DIE,DIE,DIRUT,DR,ING,K,OLDDA,X,Y,Y1,Y3,Y7 Q
"RTN","NDFDEACT",24,0)
 ;
"RTN","NDFDEACT",25,0)
NDC ;OR UPN
"RTN","NDFDEACT",26,0)
 S DIR(0)="SA^N:NDC;U:UPN",DIR("A")="NDC (N) or UPN (U) " D ^DIR G END:$D(DIRUT) S PROMPT=Y(0)
"RTN","NDFDEACT",27,0)
 F  S DIC=50.67,DIC(0)="AEQZ",DIC("A")="Select "_PROMPT_" ",D=PROMPT D IX^DIC Q:Y<0  S DA=+Y,NDF=Y(0) D
"RTN","NDFDEACT",28,0)
 .W @IOF,!,"NDC: ",$P(NDF,"^",2)," UPN: ",$P(NDF,"^",3),!,"VA Product Name: ",$P(^PSNDF(50.68,$P(NDF,"^",6),0),"^"),!,"Manfacturer: ",$P($G(^PS(55.95,+$P(NDF,"^",4),0)),"^"),"  Trade Name: ",$P(NDF,"^",5)
"RTN","NDFDEACT",29,0)
 .S K=0 F  S K=$O(^PSNDF(50.67,DA,1,K)) Q:'K  W $P(^PS(51.2,K,0),"^")," "
"RTN","NDFDEACT",30,0)
 .W !,"Inactivation Date: ",$$FMTE^XLFDT($P(NDF,"^",7)),!,"Package Size: ",$P(^PS(50.609,$P(NDF,"^",8),0),"^"),"  Package Type: ",$P(^PS(50.608,$P(NDF,"^",9),0),"^")
"RTN","NDFDEACT",31,0)
 .W !,"OTC/Rx Indicator: ",$S($P(NDF,"^",10)="O":"OTC",$P(NDF,"^",10)="R":"Rx",1:""),!
"RTN","NDFDEACT",32,0)
 .I $P(NDF,"^",7)="" S DIR(0)="Y",DIR("A")="Do you want to inactivate " D ^DIR Q:$D(DIRUT)  I Y S DIE=DIC,DR="7////"_DT_";" D ^DIE
"RTN","NDFDEACT",33,0)
 .I $P(NDF,"^",7) S DIR(0)="Y",DIR("A")="Do you want to Reactivate " W !,"That ",PROMPT," was inactivated on ",$$FMTE^XLFDT($P(NDF,"^",7)) D ^DIR Q:$D(DIRUT)  I Y S DIE=DIC,DR="7///@;" D ^DIE
"RTN","NDFDEACT",34,0)
 G NDC
"RTN","NDFDEACT",35,0)
END K D,DA,DIC,DIE,DIR,DIRUT,DR,IN,ING,J,K,L,NEW,NDF,OLD,OLDDA,PROMPT,X,Y,Y1,Y3,Y7,^TMP($J) Q
"RTN","NDFDEACT",36,0)
 Q
"RTN","NDFDEACT",37,0)
 ;
"RTN","NDFDEACT",38,0)
PRODI ;INQUIRE INTO 50.68
"RTN","NDFDEACT",39,0)
 F  S DIC="^PSNDF(50.68,",DIC(0)="AEQM" D ^DIC Q:Y<0  S DA=+Y D EN^DIQ
"RTN","NDFDEACT",40,0)
 K DA,DIC,X,Y Q
"RTN","NDFDEACT",41,0)
 ;
"RTN","NDFDEACT",42,0)
NDCI ;INQUIRE INTO 50.67
"RTN","NDFDEACT",43,0)
 S DIR(0)="SA^N:NDC;U:UPN;T:TRADE;P:PRODUCT",DIR("A")="NDC (N), UPN (U), Trade name (T), or Product (P) " D ^DIR G END:$D(DIRUT) S PROMPT=Y(0) G LISTNDC:PROMPT["PRO",LISTNDC1:PROMPT="NDC" I PROMPT["T" S PROMPT="T"
"RTN","NDFDEACT",44,0)
 F  S DIC="^PSNDF(50.67,",DIC(0)="AEQZS",DIC("A")="Select "_PROMPT S:PROMPT="T" DIC("A")=DIC("A")_"rade name" S DIC("A")=DIC("A")_" ",D=PROMPT D IX^DIC Q:Y<0  S DA=+Y D EN^DIQ
"RTN","NDFDEACT",45,0)
 K DA,DIC,DIR,PROMPT,X,Y Q
"RTN","NDFDEACT",46,0)
 ;
"RTN","NDFDEACT",47,0)
LINK ;LINK NDCS OR UPNS
"RTN","NDFDEACT",48,0)
 S DIR(0)="SA^N:NDC;U:UPN",DIR("A")="NDC (N) or UPN (U) ",DIR("B")="NDC" D ^DIR G END:$D(DIRUT) S PROMPT=Y(0)
"RTN","NDFDEACT",49,0)
 F  Q:$D(DIRUT)!(Y<0)  S DIC=50.67,DIC(0)="AEQZ",DIC("A")="Enter Current "_PROMPT_" ",D=PROMPT D IX^DIC Q:Y<0  S DA=+Y,OLD=$P(Y(0),"^",$S(PROMPT="NDC":2,1:3)) D
"RTN","NDFDEACT",50,0)
 .K DIR S DIR(0)="F^"_$S(PROMPT="NDC":"12:12",1:"1:40")_"^W:$D(^PSNDF(50.67,PROMPT,X)) !!,""That "_PROMPT_" already exists"",! K:$D(^PSNDF(50.67,PROMPT,X)) X",DIR("A")="Enter a new "_PROMPT_" " D ^DIR K DIR Q:$D(DIRUT)  S NEW=Y
"RTN","NDFDEACT",51,0)
 .I PROMPT="NDC" D
"RTN","NDFDEACT",52,0)
 ..S IN=$O(^PSNDF(50.67,DA,2,"B",NEW,0)) I IN S DIR(0)="Y" W !,"Those NDCs are already linked" S DIR("A")="Do you want to unlink them " D ^DIR Q:$D(DIRUT)  Q:'Y
"RTN","NDFDEACT",53,0)
 ..I IN S DA(1)=DA,DA=IN,DIE="^PSNDF(50.67,"_DA(1)_",2,",DR=".01///@;" D ^DIE W !,"Unlinked",! Q
"RTN","NDFDEACT",54,0)
 ..I 'IN S DIE="^PSNDF(50.67,",DR="1////"_NEW D ^DIE K DD,DO S DA(1)=DA,DIC="^PSNDF(50.67,"_DA(1)_",2,",DIC(0)="L",DIC("P")=$P(^DD(50.67,11,0),"^",2),X=OLD D ^DIC W !,"Linked",! Q
"RTN","NDFDEACT",55,0)
 .I PROMPT="UPN" D
"RTN","NDFDEACT",56,0)
 ..S IN=$O(^PSNDF(50.67,DA,3,"B",NEW,0)) I IN S DIR(0)="Y" W !,"Those UPNs are already linked" S DIR("A")="Do you want to unlink them " D ^DIR Q:$D(DIRUT)  Q:'Y
"RTN","NDFDEACT",57,0)
  ..S DA(1)=DA,DA=IN,DIE="^PSNDF(50.67,"_DA(1)_",3,",DR=".01///@;" D ^DIE W !,"Unlinked",! Q
"RTN","NDFDEACT",58,0)
 ..I 'IN S DIE="^PSNDF(50.67,",DR="1////"_NEW D ^DIE K DD,DO S DA(1)=DA,DIC="^PSNDF(50.67,"_DA(1)_",3,",DIC(0)="L",DIC("P")=$P(^DD(50.67,12,0),"^",2),X=OLD D ^DIC W !,"Linked",! Q
"RTN","NDFDEACT",59,0)
 G LINK
"RTN","NDFDEACT",60,0)
 ;
"RTN","NDFDEACT",61,0)
LISTNDC ;LOOK UP NDCS BY PRODUCT
"RTN","NDFDEACT",62,0)
 K L,DA,DIR,^TMP($J)
"RTN","NDFDEACT",63,0)
 S DIC=50.68,DIC(0)="AQEM" D ^DIC G END:Y<0 S K=0 F CNT=0:1 S K=$O(^PSNDF(50.68,"ANDC",+Y,K)) Q:'K  S ^TMP($J,"A"_$P(^PSNDF(50.67,K,0),"^",2)_"^"_K)=""
"RTN","NDFDEACT",64,0)
 I '$D(^TMP($J)) W !!,"No NDCs associated with ",$P(Y,"^",2),!! Q
"RTN","NDFDEACT",65,0)
 S A="",QUIT=0 F J=0:1 Q:QUIT  F K=1:1:5 Q:QUIT  S A=$O(^TMP($J,A)) S QUIT=A="" S:A]"" L(5*J+K)=$P(A,"^",2) W:A]"" !,$J(J*5+K,4),"   ",$P($P(A,"^"),"A",2,15) I K=5!(A="") D
"RTN","NDFDEACT",66,0)
 .S:A="" K=K-1 S DIR(0)="NOA^1:"_(J*5+K),DIR("A")="Choose 1 - "_(J*5+K)_" or ^ to quit" S:A'="" DIR("A")=DIR("A")_" or return to see more" S DIR("A")=DIR("A")_" " D ^DIR
"RTN","NDFDEACT",67,0)
 .I $D(DUOUT)!$D(DTOUT) S QUIT=1 Q
"RTN","NDFDEACT",68,0)
 .I Y="" Q
"RTN","NDFDEACT",69,0)
 .S DA=L(+Y),QUIT=1,DIC="^PSNDF(50.67," W !!! D EN^DIQ Q
"RTN","NDFDEACT",70,0)
 G END
"RTN","NDFDEACT",71,0)
 ;
"RTN","NDFDEACT",72,0)
LISTNDC1 ;LOOK UP PARTIAL NDC
"RTN","NDFDEACT",73,0)
 ;
"RTN","NDFDEACT",74,0)
 F  K ^TMP($J) S QUIT=0,DIR(0)="F^1:12",DIR("A")="Select NDC " D ^DIR Q:$D(DIRUT)  S PSN1=Y,PSN=Y D
"RTN","NDFDEACT",75,0)
 .I $D(^PSNDF(50.67,"NDC",PSN1)) S DA=0 F  S DA=$O(^PSNDF(50.67,"NDC",PSN1,DA)) S:'DA QUIT=1 Q:QUIT  S DIC="^PSNDF(50.67," W ! D EN^DIQ
"RTN","NDFDEACT",76,0)
 .Q:QUIT
"RTN","NDFDEACT",77,0)
 .I PSN1?."0".E S PSN1=PSN1_"/"
"RTN","NDFDEACT",78,0)
 .I PSN1?.N,PSN1=+PSN1 S PSN1=$$LJ^XLFSTR(PSN1,12,0)-1
"RTN","NDFDEACT",79,0)
 .S ZCT=0 F  Q:QUIT  S PSN1=$O(^PSNDF(50.67,"NDC",PSN1)),DA=0 Q:$E(PSN1,1,$L(PSN))'=PSN  F  Q:QUIT  S DA=$O(^PSNDF(50.67,"NDC",PSN1,DA)) Q:'DA  S ZCT=ZCT+1,^TMP($J,ZCT)=DA W !,$J(ZCT,5),"  ",PSN1 D
"RTN","NDFDEACT",80,0)
 ..S MORE=$E($O(^PSNDF(50.67,"NDC",PSN1)),1,$L(PSN))=PSN!$O(^(PSN1,DA)) I ZCT#5&MORE Q
"RTN","NDFDEACT",81,0)
 ..S DIR(0)="NOA^1:"_ZCT,DIR("A")="Choose 1 - "_ZCT_" or ^ to quit " S:MORE DIR("A")=DIR("A")_"or return to see more "
"RTN","NDFDEACT",82,0)
 ..D ^DIR I $D(DUOUT)!$D(DTOUT) S QUIT=1 Q
"RTN","NDFDEACT",83,0)
 ..I Y="" Q
"RTN","NDFDEACT",84,0)
 ..S DA=^TMP($J,Y),QUIT=1,DIC="^PSNDF(50.67," W !! D EN^DIQ Q
"RTN","NDFDEACT",85,0)
 G END
"RTN","NDFDINT")
0^8^B9302716
"RTN","NDFDINT",1,0)
NDFDINT ;BIR/DMA-ENTER/EDIT INTERACTIONS ; 18 Aug 2006  2:38 PM
"RTN","NDFDINT",2,0)
 ;;4.0; NDF MANAGEMENT;; 1 Jan 99;Build 1
"RTN","NDFDINT",3,0)
GO W !!
"RTN","NDFDINT",4,0)
 S PSNDF=1 K PSN,PSN1,PSN2,PSNN,PSNNN
"RTN","NDFDINT",5,0)
 S DIC=50.416,DIC(0)="AEMQZ",DIC("A")="Choose first ingredient ",DIC("S")="I '$P(^(0),""^"",2)" D ^DIC G OUT:Y<0 S PSN1=+Y,PSNN($P(Y(0),"^"))=""
"RTN","NDFDINT",6,0)
 S DIC("A")="Choose second ingredient ",DIC("S")=DIC("S")_",+Y'=PSN1" D ^DIC G OUT:Y<0 S PSN2=+Y,PSNN($P(Y(0),"^"))=""
"RTN","NDFDINT",7,0)
 S DA=$O(^PS(56,"AE",PSN1,PSN2,0)),PSND=DA I DA S PSN=^PS(56,DA,0) W !,"Severity: ",$S($P(PSN,"^",4)=2:"Significant",1:"Critical") D  G GO
"RTN","NDFDINT",8,0)
 .S DIR(0)="Y",DIR("A")="That interaction already exists.  Do you wish to edit it" D ^DIR Q:'Y  K DIR S DIR(0)="56,3" D ^DIR Q:'Y  S DIE="^PS(56,",DR="3////"_Y_";",PSND1=Y'=$P(PSN,"^",4) D ^DIE
"RTN","NDFDINT",9,0)
 .I PSND1 S ^NDFK(5000.56,PSND,0)=PSND_"^E"
"RTN","NDFDINT",10,0)
 .Q
"RTN","NDFDINT",11,0)
 S PSNNN=$O(PSNN(""))_"/"_$O(PSNN($O(PSNN(""))))
"RTN","NDFDINT",12,0)
 K DA,DIR S DIR(0)="56,3" D ^DIR G OUT:$D(DTOUT)!$D(DUOUT) S PSN=Y
"RTN","NDFDINT",13,0)
 W !,PSNNN,"   Severity : ",Y(0)
"RTN","NDFDINT",14,0)
 S DIR(0)="Y",DIR("A")="OK to add " D ^DIR G OUT:$D(DTOUT)!$D(DUOUT) I 'Y K PSNN,PSNNN G GO
"RTN","NDFDINT",15,0)
 F  L +^PS(56):3 Q:$T
"RTN","NDFDINT",16,0)
 S DINUM=$O(^PS(56,15000),-1)+1,PSND=DINUM
"RTN","NDFDINT",17,0)
 S DIC("DR")="1////"_PSN1_";2////"_PSN2_";3////"_PSN_";4////1",DIC="^PS(56,",DIC(0)="L",X=PSNNN K DD,DO D FILE^DICN L -^PS(56)
"RTN","NDFDINT",18,0)
 S ^NDFK(5000.56,PSND,0)=PSND_"^A"
"RTN","NDFDINT",19,0)
 K NDF,PSN1,PSN2,PSNN,PSNNN G GO
"RTN","NDFDINT",20,0)
 ;
"RTN","NDFDINT",21,0)
OUT K PSN,PSN1,PSN2,PSND,PSND1,PSNDF,PSNL,PSNN,PSNNN,DA,DIC,DIR,DINUM,DTOUT,DUOUT,DIRUT,DR,X,Y Q
"RTN","NDFDINT",22,0)
 ;
"RTN","NDFDINT",23,0)
INACT ;Inactivate an existing interaction
"RTN","NDFDINT",24,0)
 F  S DIC=56,DIC(0)="AEQM" D ^DIC Q:Y<0  S DIE=DIC,DA=+Y,INA=$P(^(0),"^",7),DR="7;" D ^DIE D
"RTN","NDFDINT",25,0)
 .I 'INA,$P(^PS(56,DA,0),"^",7) S ^NDFK(5000.56,DA,0)=DA_"^I"
"RTN","NDFDINT",26,0)
 .I INA,'$P(^PS(56,DA,0),"^",7),$P($G(^NDFK(5000.56,DA,0)),"^",2)="I" K ^NDFK(5000.56,DA)
"RTN","NDFDINT",27,0)
 K DIC,DIE,DA,INA,X,Y,DR Q
"RTN","NDFDINT",28,0)
 ;
"RTN","NDFDINT",29,0)
LIST ;LIST ADDED INTERACTIONS FROM 5000.56
"RTN","NDFDINT",30,0)
 D EN^XUTMDEVQ("LIST1^NDFDINT","LIST NEW INTERACTIONS") Q
"RTN","NDFDINT",31,0)
 ;
"RTN","NDFDINT",32,0)
LIST1 ;ENTRY POINT
"RTN","NDFDINT",33,0)
 K ^TMP($J) S DA=0 F  S DA=$O(^NDFK(5000.56,DA)) Q:'DA  S X=^(DA,0),^TMP($J,$P(X,"^",2),^PS(56,+X,0))=""
"RTN","NDFDINT",34,0)
 F J="A","E","I" S DA="" D HEAD W:'$D(^TMP($J,J)) "  NONE",! F  S DA=$O(^TMP($J,J,DA)) Q:DA=""  S X=$P(DA,"^",4) W $P(DA,"^"),?60,$S(X=1:"Critical",1:"Significant"),! I $Y+4>IOSL D HEAD
"RTN","NDFDINT",35,0)
 S:$D(ZTQUEUED) ZTREQ="@" D ^%ZISC K J,X,^TMP($J) Q
"RTN","NDFDINT",36,0)
 ;
"RTN","NDFDINT",37,0)
HEAD ;
"RTN","NDFDINT",38,0)
 W:$Y&(DA]"") @IOF W !!,$S(J="A":"Added",J="E":"Edited",1:"Inactivated")," Interactions",!!
"RTN","NDFDINT",39,0)
 Q
"RTN","NDFEDIT")
0^9^B589657
"RTN","NDFEDIT",1,0)
NDFEDIT ;
"RTN","NDFEDIT",2,0)
 ;;4.0; NDF MANAGEMENT;; 1 Jan 99;Build 1
"RTN","NDFEDIT",3,0)
 W !,"START"
"RTN","NDFEDIT",4,0)
 K ^TMP("NDFEDIT",$J)
"RTN","NDFEDIT",5,0)
 S ^TMP("NDFEDIT",$J,0)=2
"RTN","NDFEDIT",6,0)
 S ^TMP("NDFEDIT",$J,1,0)="ONE"
"RTN","NDFEDIT",7,0)
 S ^TMP("NDFEDIT",$J,2,0)="TWO"
"RTN","NDFEDIT",8,0)
 D EN^VALM("NDF RSB ACCEPT/EDIT")
"RTN","NDFEDIT",9,0)
 W !,"END"
"RTN","NDFEDIT",10,0)
 Q
"RTN","NDFEDIT",11,0)
 ;
"RTN","NDFEDIT",12,0)
EDIT ;
"RTN","NDFEDIT",13,0)
 Q
"RTN","NDFEDIT",14,0)
ACCEPT ;
"RTN","NDFEDIT",15,0)
 Q
"RTN","NDFEDIT",16,0)
BUILD ;
"RTN","NDFEDIT",17,0)
 K ^TMP("NDFEDIT",$J)
"RTN","NDFEDIT",18,0)
 S ^TMP("NDFEDIT",$J,0)=2
"RTN","NDFEDIT",19,0)
 S ^TMP("NDFEDIT",$J,1,0)="ONE"
"RTN","NDFEDIT",20,0)
 S ^TMP("NDFEDIT",$J,2,0)="TWO"
"RTN","NDFEDIT",21,0)
 Q
"RTN","NDFEDIT",22,0)
HDR ;
"RTN","NDFEDIT",23,0)
 S VALMHDR(1)=$$SETSTR^VALM1("HEADER ONE"," ",3,3) Q
"RTN","NDFENTER")
0^10^B10072202
"RTN","NDFENTER",1,0)
NDFENTER ;BIR/DMA-enter/edit options for NDF ; 08 Sep 2008  11:01 AM
"RTN","NDFENTER",2,0)
 ;;4.0; NDF MANAGEMENT;; 1 Jan 99;Build 1
"RTN","NDFENTER",3,0)
 ;
"RTN","NDFENTER",4,0)
P ;ENTER/EDIT PRODUCT
"RTN","NDFENTER",5,0)
 D ADDONE^PRODUCT Q
"RTN","NDFENTER",6,0)
 ;
"RTN","NDFENTER",7,0)
1 ;VA GENERIC
"RTN","NDFENTER",8,0)
 F  S DIC(0)="AEQLMZ",(DIC,DIE,DLAYGO)=50.6 W !! D ^DIC Q:Y<0  S DR=".01;1;",DA=+Y D ^DIE
"RTN","NDFENTER",9,0)
 K DIC,DIE,DR Q
"RTN","NDFENTER",10,0)
 ;
"RTN","NDFENTER",11,0)
2 ;VA CLASS
"RTN","NDFENTER",12,0)
 F  S DIC(0)="AEQLMZ",(DIC,DIE,DLAYGO)=50.605 W !! D ^DIC Q:Y<0  S DR=".01;1;2;3;4;",DA=+Y D ^DIE S Z="PS(50.605,"_DA_",1)" I '$D(^NDFK(5000,1,4,"B",Z)) S X=$O(^NDFK(5000,1,4," "),-1)+1,^(X,0)=Z,^NDFK(5000,1,4,"B",Z,X)=""
"RTN","NDFENTER",13,0)
 K DIC,DIE,DR Q
"RTN","NDFENTER",14,0)
 ;
"RTN","NDFENTER",15,0)
3 ;MANFACTUERER
"RTN","NDFENTER",16,0)
 F  S DIC(0)="AEQLMZ",(DIC,DIE,DLAYGO)=55.95 W !! D ^DIC Q:Y<0  S DR=".01;1;2;",DA=+Y D ^DIE
"RTN","NDFENTER",17,0)
 K DIC,DIE,DA,DR Q
"RTN","NDFENTER",18,0)
 ;
"RTN","NDFENTER",19,0)
4 ;DOSE FORM
"RTN","NDFENTER",20,0)
 ; NEW fields added to template 1/17/2002 and 9/8/2008
"RTN","NDFENTER",21,0)
 F  S DIC(0)="AEQLMZ",(DIC,DIE,DLAYGO)=50.606,NDFOK=1 W !! D ^DIC Q:Y<0  S DR=".01;7;9;8;11;",DA=+Y D ^DIE
"RTN","NDFENTER",22,0)
 K DIC,DIE,DA,DR,NDFOK Q
"RTN","NDFENTER",23,0)
 ;
"RTN","NDFENTER",24,0)
5 ;UNITS
"RTN","NDFENTER",25,0)
 F  S DIC(0)="AEQLMZ",(DIC,DIE,DLAYGO)=50.607 W !! D ^DIC Q:Y<0  S DR=".01;1;",DA=+Y D ^DIE
"RTN","NDFENTER",26,0)
 K DIC,DIE,DA,DR Q
"RTN","NDFENTER",27,0)
 ;
"RTN","NDFENTER",28,0)
6 ;PACKAGE TYPE
"RTN","NDFENTER",29,0)
 F  S DIC(0)="AEQLMZ",(DIC,DIE,DLAYGO)=50.608 W !! D ^DIC Q:Y<0  S DR=".01;1;",DA=+Y D ^DIE
"RTN","NDFENTER",30,0)
 K DIC,DIE,DA,DR Q
"RTN","NDFENTER",31,0)
 ;
"RTN","NDFENTER",32,0)
7 ;PACKAGE SIZE
"RTN","NDFENTER",33,0)
 F  S DIC(0)="AEQLMZ",(DIC,DIE,DLAYGO)=50.609 W !! D ^DIC Q:Y<0  S DR=".01;1;",DA=+Y D ^DIE
"RTN","NDFENTER",34,0)
 K DIC,DIC,DA,DR Q
"RTN","NDFENTER",35,0)
 ;
"RTN","NDFENTER",36,0)
8 ;VA UNITS
"RTN","NDFENTER",37,0)
 F  S DIC(0)="AEQLMZ",(DIC,DIE,DLAYGO)=50.64 W !! D ^DIC Q:Y<0  S DR=".01;1;",DA=+Y D ^DIE
"RTN","NDFENTER",38,0)
 K DIC,DIE,DA,DR Q
"RTN","NDFENTER",39,0)
 ;
"RTN","NDFENTER",40,0)
9 ;ROUTE
"RTN","NDFENTER",41,0)
 F  S DIC(0)="AEQLMZ",(DIC,DIE,DLAYGO)=51.2 W !! D ^DIC Q:Y<0  S DR=".01;1;5;",DA=+Y D ^DIE
"RTN","NDFENTER",42,0)
 K DIC,DIE,DA,DR Q
"RTN","NDFENTER",43,0)
 ;
"RTN","NDFENTER",44,0)
10 ;INGREDIENTS
"RTN","NDFENTER",45,0)
 F  S DIC(0)="AEQLMZ",(DIC,DIE,DLAYGO)=50.416 W !! D ^DIC Q:Y<0  S DR=".01;2;3;",DA=+Y D ^DIE
"RTN","NDFENTER",46,0)
 K DIC,DIE,DA,DR Q
"RTN","NDFENTER",47,0)
 ;
"RTN","NDFENTER",48,0)
11 ;INTERACTIONS
"RTN","NDFENTER",49,0)
 D ^NDFDINT
"RTN","NDFENTER",50,0)
 Q
"RTN","NDFENTER",51,0)
 ;
"RTN","NDFENTER",52,0)
12 ;FORMULARY INFORMATION
"RTN","NDFENTER",53,0)
 F  S DIC(0)="AEQMZ",(DIC,DIE,DLAYGO)=50.68 W !! D ^DIC Q:Y<0  S DR="17;18;",DA=+Y D ^DIE
"RTN","NDFENTER",54,0)
 K DIC,DIE,DA,DR Q
"RTN","NDFENTER",55,0)
 ;
"RTN","NDFENTER",56,0)
14 ;CS FEDERAL SCHEDULE
"RTN","NDFENTER",57,0)
 K ^TMP($J)
"RTN","NDFENTER",58,0)
 K DIR S DIR(0)="FO",DIR("A")="Select VA PRODUCT NAME " D ^DIR I $D(DIRUT) K DIR,DIRUT,X,Y Q
"RTN","NDFENTER",59,0)
 K DIR D FIND^DIC(50.68,,,"M",Y,,,,,"^TMP($J)")
"RTN","NDFENTER",60,0)
 ;D LIST^DIC(50.68,,,"",,,Y,,,,"^TMP($J)") K DIR
"RTN","NDFENTER",61,0)
 S J=0 F  S J=$O(^TMP($J,"DILIST",1,J)) Q:'J  S DA=^TMP($J,"DILIST",2,J),NA=^TMP($J,"DILIST",1,J) W !,NA,! S DIR(0)="50.68,19Or" D ^DIR Q:$D(DTOUT)  Q:$D(DUOUT)  D
"RTN","NDFENTER",62,0)
 .S OLD=$P($G(^PSNDF(50.68,DA,7)),"^"),NEW=$P(Y,"^"),DIE=50.68,DR="19////"_$P(Y,"^") D ^DIE I OLD'=NEW S ^NDFK(5000.9,DA,0)=DA
"RTN","NDFENTER",63,0)
 K DA,DIE,DIR,J,NA,X,Y,^TMP($J) Q
"RTN","NDFENTER",64,0)
 ;
"RTN","NDFENTER",65,0)
PFS ;SERVICE CODE
"RTN","NDFENTER",66,0)
 F  S DIC=50.68,DIC(0)="AEQM" D ^DIC Q:Y<0  S DIE=DIC,DA=+Y,DR="2000;" D ^DIE
"RTN","NDFENTER",67,0)
 K DIC,DIE,Y Q
"RTN","NDFENTER",68,0)
 ;
"RTN","NDFEX")
0^11^B2794368
"RTN","NDFEX",1,0)
NDFEX ;BIR/DMA-NEW PRODUCTS AND EXCLUDE FROM INTERACTION CHECKING ; 26 Jan 2011  2:36 PM
"RTN","NDFEX",2,0)
 ;;4.0; NDF MANAGEMENT;; 1 Jan 99;Build 1
"RTN","NDFEX",3,0)
 ;
"RTN","NDFEX",4,0)
GO ;
"RTN","NDFEX",5,0)
 N DIR,NDF,NDF1,NDFE,NDFS,X,Y
"RTN","NDFEX",6,0)
 K ^TMP($J)
"RTN","NDFEX",7,0)
 K DIR S DIR(0)="D",DIR("A")="ENTER START DATE" D ^DIR S NDFS=Y I $D(DUOUT)!$D(DTOUT) G QUIT
"RTN","NDFEX",8,0)
 K DIR S DIR(0)="D",DIR("A")="ENTER END DATE" D ^DIR S NDFE=Y+.3 I $D(DUOUT)!$D(DTOUT) G QUIT
"RTN","NDFEX",9,0)
 I NDFE<NDFS W !,"END DATE MUST BE GREATER THAN START DATE",! G GO
"RTN","NDFEX",10,0)
 S NDF=$Q(^DIA(50.68,"C",NDFS),-1),NDF=$QS(NDF,4)
"RTN","NDFEX",11,0)
 F  S NDF=$O(^DIA(50.68,NDF)) Q:'NDF  S NDF1=^(NDF,0) Q:$P(NDF1,"^",2)>NDFE  I $P(NDF1,"^",3)[".01",$P(NDF1,"^",5)="A" S X=$P(^PSNDF(50.68,+NDF1,0),"^")_"^"_$S($G(^(8)):"YES",1:"NO"),^TMP($J,X)=""
"RTN","NDFEX",12,0)
 I '$D(^TMP($J)) W !,"NOTHING TO REPORT",! G QUIT
"RTN","NDFEX",13,0)
 W !,"PRODUCT",?60,"EXCLUDED",!,"=======",?60,"========",!
"RTN","NDFEX",14,0)
 S NDF="" F  S NDF=$O(^TMP($J,NDF)) Q:NDF=""  W !,$P(NDF,"^"),?65,$P(NDF,"^",2)
"RTN","NDFEX",15,0)
QUIT K DIR,DTOUT,DUOUT,NDF,NDF1,NDFE,NDFS,X,Y,^TMP($J)
"RTN","NDFEXCLU")
0^12^B449129
"RTN","NDFEXCLU",1,0)
NDFEXCLU ;BIR/DMA-EDIT EXCLUDE FROM INTERACTION CHECKING ;16 May 03
"RTN","NDFEXCLU",2,0)
 ;;4.0; NDF MANAGEMENT;; 1 Jan 99;Build 1
"RTN","NDFEXCLU",3,0)
 F  S DIC=50.68,DIC(0)="AEQM" D ^DIC Q:Y<0  S DIE=DIC,DA=+Y,DR="23;" D
"RTN","NDFEXCLU",4,0)
 .S OLD=+$G(^PSNDF(50.68,DA,8)) D ^DIE I +$G(^PSNDF(50.68,DA,8))'=OLD D
"RTN","NDFEXCLU",5,0)
 ..I $D(^NDFK(5000.23,DA)) K ^(DA) Q
"RTN","NDFEXCLU",6,0)
 ..S ^NDFK(5000.23,DA,0)=DA_"^"_'OLD
"RTN","NDFEXCLU",7,0)
 K DA,DIC,DIE,DR,OLD,Y
"RTN","NDFEXMP1")
0^13^B649764
"RTN","NDFEXMP1",1,0)
NDFEXMP1 ;BIR/WRT-REPORT TO DISPLAY EXEMPTIONS FOR DDI INTERACTIONS CHECKING IN VA PRODUCT FILE ; 04/30/03 10:19
"RTN","NDFEXMP1",2,0)
 ;;4.0; NDF MANAGEMENT;; 1 Jan 99;Build 1
"RTN","NDFEXMP1",3,0)
BRANCH ;
"RTN","NDFEXMP1",4,0)
 I '$D(^PSNDF(50.68,D0,7)),$G(^PSNDF(50.68,D0,8)) S NODE=^PSNDF(50.68,D0,0) D WRIT
"RTN","NDFEXMP1",5,0)
 I $D(^PSNDF(50.68,D0,7)) S ACT=$P(^PSNDF(50.68,D0,7),"^",3) I 'ACT!(ACT>DT) I $G(^PSNDF(50.68,D0,8)) D WRIT
"RTN","NDFEXMP1",6,0)
 Q
"RTN","NDFEXMP1",7,0)
WRIT W !,$P(^PSNDF(50.68,D0,0),"^")
"RTN","NDFEXMP1",8,0)
 Q
"RTN","NDFEXMP1",9,0)
GETDF ; S DF=$P(^PS(50.606,DFORM,0),"^")
"RTN","NDFEXMP1",10,0)
 Q
"RTN","NDFEXMPT")
0^14^B2346123
"RTN","NDFEXMPT",1,0)
NDFEXMPT ;BIR/WRT-REPORT TO DISPLAY EXEMPTIONS FOR DDI CHECKING IN VA PRODUCT FILE ; 05/07/03 10:36
"RTN","NDFEXMPT",2,0)
 ;;4.0; NDF MANAGEMENT;; 1 Jan 99;Build 1
"RTN","NDFEXMPT",3,0)
 D RPT K ACT,NODE
"RTN","NDFEXMPT",4,0)
 Q
"RTN","NDFEXMPT",5,0)
RPT W !!,"This report gives you a printed copy of active VA Products marked as",!,"exclude from Drug-Drug Interaction checking.",!,"You may queue the report to print, if you wish.",!
"RTN","NDFEXMPT",6,0)
 S DIC="^PSNDF(50.68,",L=0,FLDS="[NDFEXMP1]",BY="@.01",DHD="VA Products Marked As Exclude From Drg-Drg Interaction Checking" D EN1^DIP
"RTN","NDFEXMPT",7,0)
 Q
"RTN","NDFINGR")
0^15^B1985906
"RTN","NDFINGR",1,0)
NDFINGR ;BIR/DMA-LIST INGREDIENTS ;7 May 03
"RTN","NDFINGR",2,0)
 ;;4.0; NDF MANAGEMENT;; 1 Jan 99;Build 1
"RTN","NDFINGR",3,0)
 ;
"RTN","NDFINGR",4,0)
 W ! K %ZIS,IOP,POP,ZTSK S %ZIS="QM" D ^%ZIS I POP G EXIT
"RTN","NDFINGR",5,0)
 ;
"RTN","NDFINGR",6,0)
 R !,"Turn on capture and press return",X:DTIME G EXIT:'$T G EXIT:X["^"
"RTN","NDFINGR",7,0)
 S DA=0 F  S DA=$O(^PSNDF(50.68,DA)) Q:'DA  I $O(^(DA,2,0)) D
"RTN","NDFINGR",8,0)
 .S ZERO=^PSNDF(50.68,DA,0),VAP=$P(ZERO,"^"),DOS=$P(ZERO,"^",3),DOS=$P($G(^PS(50.606,DOS,0)),"^")
"RTN","NDFINGR",9,0)
 .S K=0 F  S K=$O(^PSNDF(50.68,DA,2,K)) Q:'K  S X=^(K,0),LINE=$P($G(^PS(50.416,+X,0)),"^")_"^"_$P(X,"^",2)_"^"_$P($G(^PS(50.607,+$P(X,"^",3),0)),"^") W !,VAP_"^"_LINE_"^"_DOS
"RTN","NDFINGR",10,0)
 R !!,"Turn off capture and press return",X,!!
"RTN","NDFINGR",11,0)
EXIT ;
"RTN","NDFINGR",12,0)
 K DA,DOS,K,LINE,VAP,X,ZERO
"RTN","NDFINGR",13,0)
 I IO'=IO(0) D ^%ZISC
"RTN","NDFINGR",14,0)
 Q
"RTN","NDFLIST")
0^16^B916307
"RTN","NDFLIST",1,0)
NDFLIST ;BIR/DMA-list changes made in NDF ; 14 Apr 2005  10:07 AM
"RTN","NDFLIST",2,0)
 ;;4.0; NDF MANAGEMENT;; 1 Jan 99;Build 1
"RTN","NDFLIST",3,0)
 ;
"RTN","NDFLIST",4,0)
 NEW CT,DA,FILE,NEW,OLD
"RTN","NDFLIST",5,0)
 F FILE=50.416,50.6,50.605,50.68 S DA=$P(^NDFK(5000,1,1,FILE,0),"^",2),CT=0 D
"RTN","NDFLIST",6,0)
 .W !!!,$P(^DIC(FILE,0),"^"),!,"OLD VALUE",?45,"NEW VALUE",!
"RTN","NDFLIST",7,0)
 .F  S DA=$O(^DIA(FILE,DA)) Q:'DA  I $P(^(DA,0),"^",3)=.01 S NEW=$G(^(3)),OLD=$G(^(2)) I OLD'=NEW W !,OLD,?40," ",NEW S CT=CT+1
"RTN","NDFLIST",8,0)
 .I 'CT W !,"No Changes"
"RTN","NDFLIST",9,0)
 K CT,DA,FILE,NEW,OLD Q
"RTN","NDFMERGE")
0^17^B8007115
"RTN","NDFMERGE",1,0)
NDFMERGE ;BIR/DMA-merge VA generics or VA products ;24 Sep 98 / 7:15 AM
"RTN","NDFMERGE",2,0)
 ;;4.0; NDF MANAGEMENT;; 1 Jan 99;Build 1
"RTN","NDFMERGE",3,0)
 ;
"RTN","NDFMERGE",4,0)
PROD ;MERGE PRODUCTS
"RTN","NDFMERGE",5,0)
 S DIC=50.68,DIC(0)="AEQMZ",DIC("A")="Select VA Product " D ^DIC G END:Y<0 S PRO1=+Y,PROD1=$P(Y,"^",2)
"RTN","NDFMERGE",6,0)
 S DIC("A")="Merge into VA Product ",DIC("S")="I $P(Y,""^"")'=PRO1" D ^DIC G END:Y<0 S PRO2=+Y,PROD2=$P(Y,"^",2)
"RTN","NDFMERGE",7,0)
 W !,"This procedure is very difficult to reverse",! S DIR(0)="Y",DIR("B")="NO",DIR("A")="Are you sure you want to merge "_PROD1_" into "_PROD2_" " D ^DIR G END:$D(DIRUT),PROD:'Y
"RTN","NDFMERGE",8,0)
 S ZTIO="",(ZTSAVE("PRO1"),ZTSAVE("PRO2"))="",ZTRTN="ENP^NDFMERGE",ZTDESC="MERGE VA PRODUCTS" D ^%ZTLOAD
"RTN","NDFMERGE",9,0)
 K PRO1,PROD1,PRO2,PROD2,X,Y,DIC,DIR,ZTSAVE G PROD
"RTN","NDFMERGE",10,0)
 ;
"RTN","NDFMERGE",11,0)
ENP ;entry for merging products
"RTN","NDFMERGE",12,0)
 S NDC=0 F  S NDC=$O(^PSNDF(50.68,"ANDC",PRO1,NDC)) Q:'NDC  S DIE="^PSNDF(50.67,",DA=NDC,DR="5////"_PRO2_";" D ^DIE
"RTN","NDFMERGE",13,0)
 S DA=PRO1,DIE="^PSNDF(50.68,",DR="21////"_DT_";" D ^DIE S NDF=$O(^NDFK(5000.2," "),-1)+1,^(NDF,0)=PRO1
"RTN","NDFMERGE",14,0)
 S ZTREQ="@" Q
"RTN","NDFMERGE",15,0)
 ;
"RTN","NDFMERGE",16,0)
GEN ;MERGE GENERICS
"RTN","NDFMERGE",17,0)
 S DIC=50.6,DIC(0)="AQEMZ",DIC("A")="Select VA Generic " D ^DIC G END:Y<0 S GEN1=+Y,GENE1=$P(Y,"^",2)
"RTN","NDFMERGE",18,0)
 S DIC("A")="Merge into VA Generic ",DIC("S")="I $P(Y,""^"")'=GEN1" D ^DIC G END:Y<0 S GEN2=+Y,GENE2=$P(Y,"^",2)
"RTN","NDFMERGE",19,0)
 W !,"This procedure is very difficult to reverse",! S DIR(0)="Y",DIR("B")="NO",DIR("A")="Are you sure you want to merge "_GENE1_" into "_GENE2_" " D ^DIR G END:$D(DIRUT),GEN:'Y
"RTN","NDFMERGE",20,0)
  S ZTIO="",(ZTSAVE("GEN1"),ZTSAVE("GEN2"))="",ZTRTN="ENG^NDFMERGE",ZTDESC="MERGE VA GENERICS" D ^%ZTLOAD
"RTN","NDFMERGE",21,0)
 K GEN1,GENE1,GEN2,GENE2,X,Y,DIC,DIR,ZTSAVE G GEN
"RTN","NDFMERGE",22,0)
 ;
"RTN","NDFMERGE",23,0)
ENG ;entry for merging generics
"RTN","NDFMERGE",24,0)
 S PRO=0 F  S PRO=$O(^PSNDF(50.6,"APRO",GEN1,PRO)) Q:'PRO  S DIE="^PSNDF(50.68,",DA=PRO,DR=".05////"_GEN2_";" D ^DIE
"RTN","NDFMERGE",25,0)
 S DA=GEN1,DIE="^PSNDF(50.6,",DR="1////"_DT_";" D ^DIE S NDF=$O(^NDFK(5000.3," "),-1)+1,^(NDF,0)=GEN1
"RTN","NDFMERGE",26,0)
 S ZTREQ="@" Q
"RTN","NDFMERGE",27,0)
 ;
"RTN","NDFMERGE",28,0)
END K DA,DIC,DIE,DIR,DIRUT,GEN1,GEN2,GENE1,GENE2,NDC,PRO,PRO1,PRO2,PROD1,PROD2,X,Y,ZTDESC,ZTRTN,ZTSAVE Q
"RTN","NDFMESS")
0^18^B82972594
"RTN","NDFMESS",1,0)
NDFMESS ;BIR/DMA-CREATE AND EDIT MESSAGE ; 29 Jan 2010  7:55 AM
"RTN","NDFMESS",2,0)
 ;;4.0;NDF MANAGEMENT;**108,262**; 1 Jan 1999;Build 1
"RTN","NDFMESS",3,0)
 ;
"RTN","NDFMESS",4,0)
 N DIR S NDF=1
"RTN","NDFMESS",5,0)
 I '$O(^NDFK(5000,NDF,2,0)),'$O(^NDFK(5000,NDF,3,0)) G LOAD
"RTN","NDFMESS",6,0)
 I $O(^NDFK(5000,NDF,2,0)) S DIR("A")="Do you wish to edit the product message",DIR("A",1)="Text already exists in this message",DIR(0)="Y" D ^DIR K DIR G END:$D(DIRUT),INT:'Y
"RTN","NDFMESS",7,0)
 S DIC="^NDFK(5000,NDF,2,",DWPK=1 D EN^DIWE
"RTN","NDFMESS",8,0)
INT I $O(^NDFK(5000,NDF,3,0)) S DIR("A")="Do you wish to edit the interaction message",DIR("A",1)="Text already exists in this message",DIR(0)="Y" D ^DIR K DIR G END:$D(DIRUT),LOAD:'Y
"RTN","NDFMESS",9,0)
 S DIC="^NDFK(5000,NDF,3,",DWPK=1 D EN^DIWE
"RTN","NDFMESS",10,0)
 ;
"RTN","NDFMESS",11,0)
 ;if we've edited, do we want to load
"RTN","NDFMESS",12,0)
 S DIR("A")="Are you ready to load data into the message",DIR(0)="Y" D ^DIR G END:$D(DIRUT),END:'Y
"RTN","NDFMESS",13,0)
 ;
"RTN","NDFMESS",14,0)
LOAD ;from 5000.506 and 5000.56
"RTN","NDFMESS",15,0)
 W !,"Now loading data",!
"RTN","NDFMESS",16,0)
ADDED S LINE=$O(^NDFK(5000,NDF,2," "),-1)+1,^NDFK(5000,NDF,2,LINE,0)=" ",LINE=LINE+1
"RTN","NDFMESS",17,0)
 K ^TMP($J) S DA=0 F  S DA=$O(^NDFK(5000.506,DA)) Q:'DA  S X=^(DA,0),PN=$P($G(^PSNDF(50.68,X,0)),"^") I PN]"" S ^TMP($J,PN_"^"_X)=""
"RTN","NDFMESS",18,0)
 I $D(^TMP($J)) D
"RTN","NDFMESS",19,0)
 .F J=1:1 S X=$P($T(TEXT+J),";",3,300) Q:X=""  S ^NDFK(5000,NDF,2,LINE,0)=X,LINE=LINE+1
"RTN","NDFMESS",20,0)
 .S PN="" F  S PN=$O(^TMP($J,PN)) Q:PN=""  S ^NDFK(5000,NDF,2,LINE,0)="   "_$P(PN,"^"),LINE=LINE+1,X=$P(PN,"^",2) D
"RTN","NDFMESS",21,0)
 ..S CMOP=$P($G(^PSNDF(50.68,X,1)),"^",2),DU=$P(^(1),"^",4),DU=$P(^PSNDF(50.64,+DU,0),"^"),^NDFK(5000,NDF,2,LINE,0)=$S(CMOP]"":"    (CMOP - "_CMOP_")",1:""),$E(^(0),30)="(DISPENSE UNIT - "_DU_")",LINE=LINE+1
"RTN","NDFMESS",22,0)
 ..S TXT="     ",I=0 F  S I=$O(^PSNDF(50.68,"ANDC",X,I)) Q:'I  S NDC=$P(^PSNDF(50.67,I,0),"^",2) I NDC]"" S NDC=$E(NDC,1,6)_"-"_$E(NDC,7,10)_"-"_$E(NDC,11,12),TXT=TXT_NDC_"   " I $L(TXT)>65 D
"RTN","NDFMESS",23,0)
 ...S ^NDFK(5000,NDF,2,LINE,0)=TXT,LINE=LINE+1,TXT=""
"RTN","NDFMESS",24,0)
 ..I $L(TXT)>5 S ^NDFK(5000,NDF,2,LINE,0)=TXT,LINE=LINE+1
"RTN","NDFMESS",25,0)
 K ^TMP($J) S DA=0 F  S DA=$O(^NDFK(5000.5,DA)) Q:'DA  S ^TMP($J,$S($P($G(^PSNDF(50.68,DA,5)),"^"):"F",1:"N"),$P(^PSNDF(50.68,DA,0),"^"))=""
"RTN","NDFMESS",26,0)
NFI S ^NDFK(5000,NDF,2,LINE,0)=" ",LINE=LINE+1 F J=1:1 S X=$P($T(TEXT2+J),";",3,300) Q:X=""  S ^NDFK(5000,NDF,2,LINE,0)=X,LINE=LINE+1
"RTN","NDFMESS",27,0)
 S ^NDFK(5000,NDF,2,LINE,0)="FORMULARY ITEMS",LINE=LINE+1
"RTN","NDFMESS",28,0)
 S NA="" I $O(^TMP($J,"F",NA))="" S ^NDFK(5000,NDF,2,LINE,0)="   NONE",LINE=LINE+1
"RTN","NDFMESS",29,0)
 F  S NA=$O(^TMP($J,"F",NA)) Q:NA=""  S ^NDFK(5000,NDF,2,LINE,0)="   "_NA,LINE=LINE+1
"RTN","NDFMESS",30,0)
 S ^NDFK(5000,NDF,2,LINE,0)=" ",LINE=LINE+1,^NDFK(5000,NDF,2,LINE,0)="NON-FORMULARY ITEMS",LINE=LINE+1
"RTN","NDFMESS",31,0)
 S NA="" I $O(^TMP($J,"N",NA))="" S ^NDFK(5000,NDF,2,LINE,0)="   NONE",LINE=LINE+1
"RTN","NDFMESS",32,0)
 F  S NA=$O(^TMP($J,"N",NA)) Q:NA=""  S ^NDFK(5000,NDF,2,LINE,0)="   "_NA,LINE=LINE+1
"RTN","NDFMESS",33,0)
 K ^TMP($J) S DA=0 F  S DA=$O(^NDFK(5000.7,DA)) Q:'DA  S DA1=^(DA,0),^TMP($J,$P(^PSNDF(50.68,DA1,0),"^"))=$P($G(^PSNDF(50.68,DA1,1)),"^",2)
"RTN","NDFMESS",34,0)
CMOP I $D(^TMP($J)) S ^NDFK(5000,NDF,2,LINE,0)=" ",LINE=LINE+1 F J=1:1 S X=$P($T(TEXT3+J),";",3,300) Q:X=""  S ^NDFK(5000,NDF,2,LINE,0)=X,LINE=LINE+1
"RTN","NDFMESS",35,0)
 I $D(^TMP($J)) S ^NDFK(5000,NDF,2,LINE,0)=" ",LINE=LINE+1,DA="" F  S DA=$O(^TMP($J,DA)) Q:DA=""  S X=^(DA),^NDFK(5000,NDF,2,LINE,0)="   "_DA_"    "_X,LINE=LINE+1
"RTN","NDFMESS",36,0)
 K ^TMP($J) S DA=0 F  S DA=$O(^NDFK(5000,1,4,DA)) Q:'DA  S X=^(DA,0),X=+$P(X,"50.68,",2) I X S ^TMP($J,$P(^PSNDF(50.68,X,0),"^"))="    "_$G(^PSNDF(50.68,X,6,1,0),"Restriction deleted")
"RTN","NDFMESS",37,0)
NFR I $D(^TMP($J)) S ^NDFK(5000,NDF,2,LINE,0)=" ",LINE=LINE+1,^NDFK(5000,NDF,2,LINE,0)="The National Formulary Restriction has changed for the following VA Products.",LINE=LINE+1 D
"RTN","NDFMESS",38,0)
 .S DA="" F  S DA=$O(^TMP($J,DA)) Q:DA=""  S ^NDFK(5000,NDF,2,LINE,0)="   "_DA,LINE=LINE+1,^NDFK(5000,NDF,2,LINE,0)="    "_^TMP($J,DA),LINE=LINE+1
"RTN","NDFMESS",39,0)
 K ^TMP($J) S DA=0 F  S DA=$O(^NDFK(5000.9,DA)) Q:'DA  S CS=$P($G(^PSNDF(50.68,DA,7)),"^"),NA=$P(^(0),"^") I CS S ^TMP($J,NA_"^"_CS)=""
"RTN","NDFMESS",40,0)
 ;
"RTN","NDFMESS",41,0)
CS I $D(^TMP($J)) S ^NDFK(5000,NDF,2,LINE,0)=" ",LINE=LINE+1 F J=1:1 S X=$P($T(TEXT4+J),";",3,300) Q:X=""  S ^NDFK(5000,NDF,2,LINE,0)=X,LINE=LINE+1
"RTN","NDFMESS",42,0)
 I $D(^TMP($J)) S NA=""  F  S NA=$O(^TMP($J,NA)) Q:NA=""  S ^NDFK(5000,NDF,2,LINE,0)=$P(NA,"^"),$E(^(0),70)=$P(NA,"^",2),LINE=LINE+1
"RTN","NDFMESS",43,0)
 ;
"RTN","NDFMESS",44,0)
 ;Possible Dosages Setting Changes
"RTN","NDFMESS",45,0)
 N VAPRDNAM,VAPRDIEN,ACDPD,PDTC,CMOP K ^TMP($J) S VAPRDIEN=0
"RTN","NDFMESS",46,0)
 F  S VAPRDIEN=$O(^NDFK(5000.92,VAPRDIEN)) Q:'VAPRDIEN  D
"RTN","NDFMESS",47,0)
 . S VAPRDNAM=$P($G(^PSNDF(50.68,VAPRDIEN,0)),"^") Q:VAPRDNAM=""
"RTN","NDFMESS",48,0)
 . S ^TMP($J,VAPRDNAM)=VAPRDIEN
"RTN","NDFMESS",49,0)
 I $D(^TMP($J)) D
"RTN","NDFMESS",50,0)
 . S ^NDFK(5000,NDF,2,LINE,0)=""
"RTN","NDFMESS",51,0)
 . S LINE=LINE+1,^NDFK(5000,NDF,2,LINE,0)="The Auto-Create Possible Dosages settings have been edited for the"
"RTN","NDFMESS",52,0)
 . S LINE=LINE+1,^NDFK(5000,NDF,2,LINE,0)="following VA Products. Please review your local dosages for products"
"RTN","NDFMESS",53,0)
 . S LINE=LINE+1,^NDFK(5000,NDF,2,LINE,0)="matched to these entries. Edits to your site's possible dosages or"
"RTN","NDFMESS",54,0)
 . S LINE=LINE+1,^NDFK(5000,NDF,2,LINE,0)="local possible dosages may be needed."
"RTN","NDFMESS",55,0)
 . S LINE=LINE+1,^NDFK(5000,NDF,2,LINE,0)=""
"RTN","NDFMESS",56,0)
 . S VAPRDNAM=""
"RTN","NDFMESS",57,0)
 . F  S VAPRDNAM=$O(^TMP($J,VAPRDNAM)) Q:VAPRDNAM=""  D
"RTN","NDFMESS",58,0)
 . . S VAPRDIEN=^TMP($J,VAPRDNAM),LINE=LINE+1
"RTN","NDFMESS",59,0)
 . . S CMOP=$P($G(^PSNDF(50.68,VAPRDIEN,1)),"^",2)
"RTN","NDFMESS",60,0)
 . . S ^NDFK(5000,NDF,2,LINE,0)=VAPRDNAM_"    "_$S(CMOP'="":"(CMOP - "_CMOP_")",1:""),LINE=LINE+1
"RTN","NDFMESS",61,0)
 . . S ACDPD=$$GET1^DIQ(50.68,VAPRDIEN,40,"I")
"RTN","NDFMESS",62,0)
 . . S PDTC=$$GET1^DIQ(50.68,VAPRDIEN,41,"I")
"RTN","NDFMESS",63,0)
 . . S ^NDFK(5000,NDF,2,LINE,0)="     Auto-Create Default Possible Dosage? "_$$GET1^DIQ(50.68,VAPRDIEN,40),LINE=LINE+1
"RTN","NDFMESS",64,0)
 . . S:ACDPD="N" ^NDFK(5000,NDF,2,LINE,0)="     Possible Dosages To Auto-Create: "_$$GET1^DIQ(50.68,VAPRDIEN,41),LINE=LINE+1
"RTN","NDFMESS",65,0)
 . . S:(ACDPD="N"&(PDTC'="N")) ^NDFK(5000,NDF,2,LINE,0)="     Package: "_$$GET1^DIQ(50.68,VAPRDIEN,42),LINE=LINE+1
"RTN","NDFMESS",66,0)
 . . S ^NDFK(5000,NDF,2,LINE,0)=""
"RTN","NDFMESS",67,0)
 ;
"RTN","NDFMESS",68,0)
 S LAST=$O(^NDFK(5000,NDF,2," "),-1),$P(^NDFK(5000,NDF,2,0),"^",3,4)=LAST_"^"_LAST K ^TMP($J)
"RTN","NDFMESS",69,0)
 K ^TMP($J) S DA=0 F  S DA=$O(^NDFK(5000.56,DA)) Q:'DA  S IN=$P(^(DA,0),"^",2),X=$G(^PS(56,DA,0)) I X]"" S ^TMP($J,IN,$P(X,"^"))=$S($P(X,"^",4)=1:"Critical",1:"Significant")
"RTN","NDFMESS",70,0)
 S LINE=1 F J=1:1 S X=$P($T(TEXT1+J),";",3) Q:X=""  S ^NDFK(5000,1,3,LINE,0)=X,LINE=LINE+1
"RTN","NDFMESS",71,0)
 I '$D(^TMP($J,"A")) S ^NDFK(5000,1,3,LINE,0)="   NONE",LINE=LINE+1
"RTN","NDFMESS",72,0)
 S PN="" F  S PN=$O(^TMP($J,"A",PN)) Q:PN=""  S X="   "_$$LJ^XLFSTR(PN,50)_" "_^(PN),^NDFK(5000,NDF,3,LINE,0)=X,LINE=LINE+1
"RTN","NDFMESS",73,0)
 S ^NDFK(5000,1,3,LINE,0)=" ",LINE=LINE+1,^NDFK(5000,1,3,LINE,0)="EDITED INTERACTIONS",LINE=LINE+1,^NDFK(5000,1,3,LINE,0)=" ",LINE=LINE+1
"RTN","NDFMESS",74,0)
 I '$D(^TMP($J,"E")) S ^NDFK(5000,1,3,LINE,0)="   NONE",LINE=LINE+1
"RTN","NDFMESS",75,0)
 S PN="" F  S PN=$O(^TMP($J,"E",PN)) Q:PN=""  S X="   "_$$LJ^XLFSTR(PN,50)_" "_^(PN),^NDFK(5000,NDF,3,LINE,0)=X,LINE=LINE+1
"RTN","NDFMESS",76,0)
 S ^NDFK(5000,1,3,LINE,0)=" ",LINE=LINE+1,^NDFK(5000,1,3,LINE,0)="INACTIVATED INTERACTIONS",LINE=LINE+1,^NDFK(5000,1,3,LINE,0)=" ",LINE=LINE+1
"RTN","NDFMESS",77,0)
 I '$D(^TMP($J,"I")) S ^NDFK(5000,1,3,LINE,0)="   NONE",LINE=LINE+1
"RTN","NDFMESS",78,0)
 S PN="" F  S PN=$O(^TMP($J,"I",PN)) Q:PN=""  S X="   "_$$LJ^XLFSTR(PN,50)_" "_^(PN),^NDFK(5000,NDF,3,LINE,0)=X,LINE=LINE+1
"RTN","NDFMESS",79,0)
 ;
"RTN","NDFMESS",80,0)
 K ^TMP($J) S DA=0 F  S DA=$O(^NDFK(5000.23,DA)) Q:'DA  S ARG=+$P(^(DA,0),"^",2),^TMP($J,ARG,$P(^PSNDF(50.68,DA,0),"^"))=""
"RTN","NDFMESS",81,0)
 I $D(^TMP($J)) S ^NDFK(5000,NDF,3,LINE,0)=" ",LINE=LINE+1
"RTN","NDFMESS",82,0)
 I $D(^TMP($J,1)) S ^NDFK(5000,NDF,3,LINE,0)="The following products have been flagged for exclusion from drug-drug",^NDFK(5000,NDF,3,LINE+1,0)="interaction checks.",^NDFK(5000,NDF,3,LINE+2,0)=" ",LINE=LINE+3 D
"RTN","NDFMESS",83,0)
 .S NA="" F  S NA=$O(^TMP($J,1,NA)) Q:NA=""  S ^NDFK(5000,NDF,3,LINE,0)=" "_NA,LINE=LINE+1
"RTN","NDFMESS",84,0)
 I $D(^TMP($J,0)) S ^NDFK(5000,NDF,3,LINE,0)=" ",LINE=LINE+1 D
"RTN","NDFMESS",85,0)
 .S ^NDFK(5000,NDF,3,LINE,0)="The following products, previously flagged for exclusion from drug-drug",^NDFK(5000,NDF,3,LINE+1,0)="interaction checks, have been changed to be included"
"RTN","NDFMESS",86,0)
 .S ^NDFK(5000,NDF,3,LINE+2,0)="in drug-drug interaction checks where appropriate."
"RTN","NDFMESS",87,0)
 .S ^NDFK(5000,NDF,3,LINE+3,0)=" ",LINE=LINE+4
"RTN","NDFMESS",88,0)
 .S NA="" F  S NA=$O(^TMP($J,0,NA)) Q:NA=""  S ^NDFK(5000,NDF,3,LINE,0)=" "_NA,LINE=LINE+1
"RTN","NDFMESS",89,0)
 I $O(^NDFK(5000.91,0)) K ^TMP($J) S DA=0,^NDFK(5000,NDF,3,LINE,0)=" ",^NDFK(5000,NDF,3,LINE+1,0)="The FDA Med Guide for the following products has been changed",^NDFK(5000,NDF,3,LINE+2,0)=" ",LINE=LINE+3 D
"RTN","NDFMESS",90,0)
 .F  S DA=$O(^NDFK(5000.91,DA)) Q:'DA  S X=^(DA,0),NA=$P(^PSNDF(50.68,+X,0),"^"),^TMP($J,$P(X,"^",2),NA)=""
"RTN","NDFMESS",91,0)
 I $D(^TMP($J,"A")) S ^NDFK(5000,NDF,3,LINE,0)=" ADDED",^NDFK(5000,NDF,3,LINE+1,0)=" ==========",LINE=LINE+2,NA="" F  S NA=$O(^TMP($J,"A",NA)) Q:NA=""  S ^NDFK(5000,NDF,3,LINE,0)=" "_NA,LINE=LINE+1
"RTN","NDFMESS",92,0)
 I $D(^TMP($J,"E")) S ^NDFK(5000,NDF,3,LINE,0)=" ",^NDFK(5000,NDF,3,LINE+1,0)=" EDITED",^NDFK(5000,NDF,3,LINE+2,0)=" ===========",LINE=LINE+3,NA="" D
"RTN","NDFMESS",93,0)
 .F  S NA=$O(^TMP($J,"E",NA)) Q:NA=""  S ^NDFK(5000,NDF,3,LINE,0)=" "_NA,LINE=LINE+1
"RTN","NDFMESS",94,0)
 I $D(^TMP($J,"D")) S ^NDFK(5000,NDF,3,LINE,0)=" ",^NDFK(5000,NDF,3,LINE+1,0)=" DELETED",^NDFK(5000,NDF,3,LINE+2,0)=" ===========",LINE=LINE+3,NA="" D
"RTN","NDFMESS",95,0)
 .F  S NA=$O(^TMP($J,"D",NA)) Q:NA=""  S ^NDFK(5000,NDF,3,LINE,0)=" "_NA,LINE=LINE+1
"RTN","NDFMESS",96,0)
 S ^NDFK(5000,NDF,3,LINE,0)=" ",LINE=LINE+1
"RTN","NDFMESS",97,0)
 S LAST=$O(^NDFK(5000,NDF,3," "),-1),$P(^NDFK(5000,NDF,3,0),"^",3,4)=LAST_"^"_LAST
"RTN","NDFMESS",98,0)
 S DIR(0)="Y",DIR("A")="Do you wish to edit the product message" D ^DIR K DIR G END:$D(DIRUT) I Y S DIC="^NDFK(5000,NDF,2,",DWPK=1 D EN^DIWE
"RTN","NDFMESS",99,0)
 S DIR(0)="Y",DIR("A")="Do you wish to edit the interaction message" D ^DIR K DIR G END:$D(DIRUT),END:'Y S DIC="^NDFK(5000,NDF,3,",DWPK=1 D EN^DIWE
"RTN","NDFMESS",100,0)
END K DA,DIC,DIR,DIRUT,DWPK,LINE,NDC,PN,X,Y
"RTN","NDFMESS",101,0)
 Q
"RTN","NDFMESS",102,0)
 ;
"RTN","NDFMESS",103,0)
TEXT ;
"RTN","NDFMESS",104,0)
 ;;The following VA Products have been added to the National
"RTN","NDFMESS",105,0)
 ;;Drug File.  You may wish to review, then match or unmatch
"RTN","NDFMESS",106,0)
 ;;local drug file entries based on this updated information.
"RTN","NDFMESS",107,0)
 ;; 
"RTN","NDFMESS",108,0)
 ;;
"RTN","NDFMESS",109,0)
TEXT1 ;
"RTN","NDFMESS",110,0)
 ;;The following interactions in National Drug File (NDF) have been added,
"RTN","NDFMESS",111,0)
 ;;edited or inactivated.  These changes are the result of review and
"RTN","NDFMESS",112,0)
 ;;recommendations from the NDF support group.
"RTN","NDFMESS",113,0)
 ;; 
"RTN","NDFMESS",114,0)
 ;;ADDED INTERACTIONS
"RTN","NDFMESS",115,0)
 ;; 
"RTN","NDFMESS",116,0)
 ;;
"RTN","NDFMESS",117,0)
TEXT2 ;
"RTN","NDFMESS",118,0)
 ;;The National Formulary Indicator has changed for the following
"RTN","NDFMESS",119,0)
 ;;VA Products.  The National Formulary Indicator will automatically
"RTN","NDFMESS",120,0)
 ;;be changed in your local DRUG file (#50).  Please review the
"RTN","NDFMESS",121,0)
 ;;VISN and Local Formulary designations of these products and
"RTN","NDFMESS",122,0)
 ;;make appropriate changes.
"RTN","NDFMESS",123,0)
 ;; 
"RTN","NDFMESS",124,0)
 ;
"RTN","NDFMESS",125,0)
TEXT3 ;
"RTN","NDFMESS",126,0)
 ;;The following active VA Products are no longer marked for CMOP.
"RTN","NDFMESS",127,0)
 ;;All local drug file entries matched to these VA Products will
"RTN","NDFMESS",128,0)
 ;;be UNMARKED for CMOP.  In order to have these entries dispensed
"RTN","NDFMESS",129,0)
 ;;by CMOP any local DRUG file (#50) entries matched to these
"RTN","NDFMESS",130,0)
 ;;products must be re-matched to another VA product that is actively
"RTN","NDFMESS",131,0)
 ;;marked for CMOP dispensing.
"RTN","NDFMESS",132,0)
 ;
"RTN","NDFMESS",133,0)
TEXT4 ;
"RTN","NDFMESS",134,0)
 ;; 
"RTN","NDFMESS",135,0)
 ;;The CS Federal Schedule for the following VA Products has
"RTN","NDFMESS",136,0)
 ;;been added or changed.  You may wish to review the DRUG
"RTN","NDFMESS",137,0)
 ;;file (#50) and make appropriate changes to the DEA, SPECIAL
"RTN","NDFMESS",138,0)
 ;;HDLG field (#3).
"RTN","NDFMESS",139,0)
 ;; 
"RTN","NDFMESS",140,0)
 ;
"RTN","NDFMESS1")
0^19^B26019340
"RTN","NDFMESS1",1,0)
NDFMESS1 ;BIR/DMA-CREATE AND EDIT MESSAGE ;23 Jul 99 / 11:31 AM
"RTN","NDFMESS1",2,0)
 ;;4.0; NDF MANAGEMENT;; 1 Jan 99;Build 1
"RTN","NDFMESS1",3,0)
 S NDF=1
"RTN","NDFMESS1",4,0)
 I '$O(^PRE53(5000,NDF,2,0)) G LOAD
"RTN","NDFMESS1",5,0)
 S DIR("A")="Do you wish to edit this message",DIR("A",1)="Text already exists in this message",DIR(0)="Y" D ^DIR K DIR G END:$D(DIRUT),LOAD:'Y
"RTN","NDFMESS1",6,0)
 S DIC="^PRE53(5000,NDF,2,",DWPK=1 D EN^DIWE
"RTN","NDFMESS1",7,0)
 ;
"RTN","NDFMESS1",8,0)
 ;if we've edited, do we want to load
"RTN","NDFMESS1",9,0)
 S DIR("A")="Are you ready to load data ito the message",DIR(0)="Y" D ^DIR G END:$D(DIRUT),END:'Y
"RTN","NDFMESS1",10,0)
 ;
"RTN","NDFMESS1",11,0)
LOAD ;from 5000.506 and 5000.56
"RTN","NDFMESS1",12,0)
 W !,"Now loading data",!
"RTN","NDFMESS1",13,0)
 S LINE=$O(^PRE53(5000,NDF,2," "),-1)+1,^PRE53(5000,NDF,2,LINE,0)=" ",LINE=LINE+1
"RTN","NDFMESS1",14,0)
 K ^TMP($J) S DA=0 F  S DA=$O(^PRE53(5000.506,DA)) Q:'DA  S X=^(DA,0),PN=$P($G(^PSNDF(50.68,X,0)),"^") I PN]"" S ^TMP($J,PN_"^"_X)=""
"RTN","NDFMESS1",15,0)
 I $D(^TMP($J)) D
"RTN","NDFMESS1",16,0)
 .F J=1:1 S X=$P($T(TEXT+J),";",3,300) Q:X=""  S ^PRE53(5000,NDF,2,LINE,0)=X,LINE=LINE+1
"RTN","NDFMESS1",17,0)
 .S PN="" F  S PN=$O(^TMP($J,PN)) Q:PN=""  S ^PRE53(5000,NDF,2,LINE,0)="   "_$P(PN,"^"),LINE=LINE+1,X=$P(PN,"^",2) D
"RTN","NDFMESS1",18,0)
 ..S CMOP=$P($G(^PSNDF(50.68,X,1)),"^",2),DU=$P(^(1),"^",4),DU=$P(^PSNDF(50.64,+DU,0),"^"),^PRE53(5000,NDF,2,LINE,0)=$S(CMOP]"":"    (CMOP - "_CMOP_")",1:""),$E(^(0),30)="(DISPENSE UNIT - "_DU_")",LINE=LINE+1
"RTN","NDFMESS1",19,0)
 ..S TXT="     ",I=0 F  S I=$O(^PSNDF(50.68,"ANDC",X,I)) Q:'I  S NDC=$P(^PSNDF(50.67,I,0),"^",2) I NDC]"" S NDC=$E(NDC,1,6)_"-"_$E(NDC,7,10)_"-"_$E(NDC,11,12),TXT=TXT_NDC_"   " I $L(TXT)>65 D
"RTN","NDFMESS1",20,0)
 ...S ^PRE53(5000,NDF,2,LINE,0)=TXT,LINE=LINE+1,TXT=""
"RTN","NDFMESS1",21,0)
 ..I $L(TXT)>5 S ^PRE53(5000,NDF,2,LINE,0)=TXT,LINE=LINE+1
"RTN","NDFMESS1",22,0)
 K ^TMP($J) S DA=0 F  S DA=$O(^PRE53(5000.5,DA)) Q:'DA  S ^TMP($J,$P(^PSNDF(50.68,DA,0),"^"))=""
"RTN","NDFMESS1",23,0)
 I $D(^TMP($J)) S ^PRE53(5000,NDF,2,LINE,0)=" ",LINE=LINE+1,^PRE53(5000,NDF,2,LINE,0)="  The National Formulary Indicator has changed for the following VA Products." D
"RTN","NDFMESS1",24,0)
 .S LINE=LINE+1,^PRE53(5000,NDF,2,LINE,0)=" ",LINE=LINE+1,DA="" F  S DA=$O(^TMP($J,DA)) Q:DA=""   S ^PRE53(5000,NDF,2,LINE,0)="   "_DA,LINE=LINE+1
"RTN","NDFMESS1",25,0)
 K ^TMP($J) S DA=0 F  S DA=$O(^PRE53(5000.7,DA)) Q:'DA  S ^TMP($J,$P(^PSNDF(50.68,DA,0),"^"))=""
"RTN","NDFMESS1",26,0)
 I $D(^TMP($J)) S ^PRE53(5000,2,LINE,0)=" ",LINE=LINE+1,^PRE53(5000,NDF,2,LINE,0)=" The following VA Products are no longer marked for CMOP.",LINE=LINE+1 D
"RTN","NDFMESS1",27,0)
 .S ^PRE53(5000,NDF,2,LINE,0)=" All local drug file entries matched to these VA Products will be UNMARKED for CMOP." D
"RTN","NDFMESS1",28,0)
 .S LINE=LINE+1,^PRE53(5000,NDF,2,LINE,0)=" ",LINE=LINE+1,DA="" F  S DA=$O(^TMP($J,DA)) Q:DA=""   S ^PRE53(5000,NDF,2,LINE,0)="   "_DA,LINE=LINE+1
"RTN","NDFMESS1",29,0)
 K ^TMP($J) S DA=0 F  S DA=$O(^PRE53(5000,1,4,DA)) Q:'DA  S X=^(DA,0),X=+$P(X,"50.68,",2) I X S ^TMP($J,$P(^PSNDF(50.68,X,0),"^"))=""
"RTN","NDFMESS1",30,0)
 I $D(^TMP($J)) S ^PRE53(5000,NDF,2,LINE,0)=" ",LINE=LINE+1,^PRE53(5000,NDF,2,LINE,0)="   The National Formulary Restriction has changed for the following VA Products.",LINE=LINE+1 D
"RTN","NDFMESS1",31,0)
 .S DA="" F  S DA=$O(^TMP($J,DA)) Q:DA=""  S ^PRE53(5000,NDF,2,LINE,0)="   "_DA,LINE=LINE+1
"RTN","NDFMESS1",32,0)
 S LINE=LINE-1,$P(^PRE53(5000,NDF,2,0),"^",3,4)=LINE_"^"_LINE K ^TMP($J)
"RTN","NDFMESS1",33,0)
 K ^TMP($J) S DA=0 F  S DA=$O(^PRE53(5000.56,DA)) Q:'DA  S IN=$P(^(DA,0),"^",2),X=$G(^PS(56,DA,0)) I X]"" S ^TMP($J,IN,$P(X,"^"))=$S($P(X,"^",4)=1:"Critical",1:"Significant")
"RTN","NDFMESS1",34,0)
 S LINE=1 F J=1:1 S X=$P($T(TEXT1+J),";",3) Q:X=""  S ^PRE53(5000,1,3,LINE,0)=X,LINE=LINE+1
"RTN","NDFMESS1",35,0)
 I '$D(^TMP($J,"A")) S ^PRE53(5000,1,3,LINE,0)="   NONE",LINE=LINE+1
"RTN","NDFMESS1",36,0)
 S PN="" F  S PN=$O(^TMP($J,"A",PN)) Q:PN=""  S X="   "_$$LJ^XLFSTR(PN,50)_" "_^(PN),^PRE53(5000,NDF,3,LINE,0)=X,LINE=LINE+1
"RTN","NDFMESS1",37,0)
 S ^PRE53(5000,1,3,LINE,0)=" ",LINE=LINE+1,^PRE53(5000,1,3,LINE,0)="EDITED INTERACTIONS",LINE=LINE+1,^PRE53(5000,1,3,LINE,0)=" ",LINE=LINE+1
"RTN","NDFMESS1",38,0)
 I '$D(^TMP($J,"E")) S ^PRE53(5000,1,3,LINE,0)="   NONE",LINE=LINE+1
"RTN","NDFMESS1",39,0)
 S PN="" F  S PN=$O(^TMP($J,"E",PN)) Q:PN=""  S X="   "_$$LJ^XLFSTR(PN,50)_" "_^(PN),^PRE53(5000,NDF,3,LINE,0)=X,LINE=LINE+1
"RTN","NDFMESS1",40,0)
 S ^PRE53(5000,1,3,LINE,0)=" ",LINE=LINE+1,^PRE53(5000,1,3,LINE,0)="INACTIVATED INTERACTIONS",LINE=LINE+1,^PRE53(5000,1,3,LINE,0)=" ",LINE=LINE+1
"RTN","NDFMESS1",41,0)
 I '$D(^TMP($J,"I")) S ^PRE53(5000,1,3,LINE,0)="   NONE",LINE=LINE+1
"RTN","NDFMESS1",42,0)
 S PN="" F  S PN=$O(^TMP($J,"I",PN)) Q:PN=""  S X="   "_$$LJ^XLFSTR(PN,50)_" "_^(PN),^PRE53(5000,NDF,3,LINE,0)=X,LINE=LINE+1
"RTN","NDFMESS1",43,0)
 S DIR(0)="Y",DIR("A")="Do you wish to edit" D ^DIR K DIR G END:$D(DIRUT),END:'Y S DIC="^PRE53(5000,NDF,2,",DWPK=1 D EN^DIWE
"RTN","NDFMESS1",44,0)
END K DA,DIC,DIR,DIRUT,DWPK,LINE,NDC,PN,X,Y
"RTN","NDFMESS1",45,0)
 Q
"RTN","NDFMESS1",46,0)
 ;
"RTN","NDFMESS1",47,0)
TEXT ;
"RTN","NDFMESS1",48,0)
 ;;The following VA Products have been added to the National
"RTN","NDFMESS1",49,0)
 ;;Drug File.  You may wish to review, then match or unmatch
"RTN","NDFMESS1",50,0)
 ;;local drug file entries based on this updated information.
"RTN","NDFMESS1",51,0)
 ;; 
"RTN","NDFMESS1",52,0)
 ;;
"RTN","NDFMESS1",53,0)
TEXT1 ;
"RTN","NDFMESS1",54,0)
 ;;The following interactions in National Drug File (NDF) have been added,
"RTN","NDFMESS1",55,0)
 ;;edited or inactivated.  These changes are the result of review and
"RTN","NDFMESS1",56,0)
 ;;recommendations from the NDF support group.
"RTN","NDFMESS1",57,0)
 ;; 
"RTN","NDFMESS1",58,0)
 ;;ADDED INTERACTIONS
"RTN","NDFMESS1",59,0)
 ;; 
"RTN","NDFMESS1",60,0)
 ;;
"RTN","NDFMOP1")
0^20^B11529755
"RTN","NDFMOP1",1,0)
NDFMOP1 ;BIR/WRT-PROPOSED NEW VUID Assignment Report; 12/21/05 15:52
"RTN","NDFMOP1",2,0)
 ;;0.0; NATIONAL DRUG FILE MANAGEMENT SYSTEM;; 30 Oct 98;Build 1
"RTN","NDFMOP1",3,0)
 K I
"RTN","NDFMOP1",4,0)
 W !,"This report gives you a hard copy of NEW entries with proposed VUIDs.",!,"In addition, it will reflect entries that have been Inactivated or Re-Activated.",!,"You may queue the report to print, if you wish.",!
"RTN","NDFMOP1",5,0)
 K ^WRT("NDFID") S VUID=$P(^NDFK(5000.991,1,0),"^",2)+1,NUM=1
"RTN","NDFMOP1",6,0)
DVC K %ZIS,POP,IOP S %ZIS="QM",%ZIS("B")="",%ZIS("A")="Select Printer: " D ^%ZIS G:POP DONE W:$E(IOST)'="P" !!,"This report must be run on a printer.",!! G:$E(IOST)'="P" DVC I POP K IOP,POP,IO("Q") Q
"RTN","NDFMOP1",7,0)
QUEUE I $D(IO("Q")) K IO("Q") S ZTRTN="ENQ^NDFMOP1",ZTDESC="List of NEW Entries Pending VUID Assignment",ZTSAVE("VUID")="",ZTSAVE("NUM")="" D ^%ZTLOAD K ZTSK D ^%ZISC Q
"RTN","NDFMOP1",8,0)
ENQ ;ENTRY POINT WHEN QUEUED
"RTN","NDFMOP1",9,0)
 U IO
"RTN","NDFMOP1",10,0)
 S NDFPGCT=0,NDFPGLNG=IOSL-6 D TITLE,ACT
"RTN","NDFMOP1",11,0)
DONE W @IOF S:$D(ZTQUEUED) ZTREQ="@" K NDFPRT,I,NAM,IFN,DATE,MAST,MASTER,NBR,NUM,STAMP,VUID,DVUID,ENTRY,MJT,NDFPGCT,NDFPGLNG,Y,IOP,POP,IO("Q") K ^WRT("NDFID") D ^%ZISC
"RTN","NDFMOP1",12,0)
 Q
"RTN","NDFMOP1",13,0)
TITLE I $D(IOF),IOF]"" W @IOF S NDFPGCT=NDFPGCT+1
"RTN","NDFMOP1",14,0)
 S NDFPRT=0 W !,?12," List of NEW Entries Pending VUID Assignment",!
"RTN","NDFMOP1",15,0)
 W !?27,"VA PRODUCT FILE",!
"RTN","NDFMOP1",16,0)
 S Y=DT X ^DD("DD") W ?22,"Date printed: ",Y,!
"RTN","NDFMOP1",17,0)
 W !,"IEN",?8,"VA PRODUCT NAME",!,?8,"PLANNED VUID",?63,"MASTER/NON-MASTER",!
"RTN","NDFMOP1",18,0)
 F MJT=1:1:80 W "-"
"RTN","NDFMOP1",19,0)
 Q
"RTN","NDFMOP1",20,0)
ACT S NBR=$P(^NDFK(5000,1,1,50.68,0),"^",2) F  S NBR=$O(^DIA(50.68,NBR)) Q:'NBR  I $P(^(NBR,0),"^",3)=6 S ENTRY=$P(^DIA(50.68,NBR,0),"^") I $D(^PSNDF(50.68,ENTRY,0)) D CHECK
"RTN","NDFMOP1",21,0)
 Q
"RTN","NDFMOP1",22,0)
CHECK I $D(^DIA(50.68,NBR,2.1)),'$D(^DIA(50.68,NBR,3.1)) W !!,ENTRY,?8,$P(^PSNDF(50.68,ENTRY,0),"^"),?67,"RE-ACTIVATED" S NDFPRT=1
"RTN","NDFMOP1",23,0)
 I '$D(^DIA(50.68,NBR,2.1)),$D(^DIA(50.68,NBR,3.1)) S STAMP=$P(^DIA(50.68,NBR,3.1),"^"),Y=STAMP X ^DD("DD") I STAMP>3050310 W !!,ENTRY,?8,$P(^PSNDF(50.68,ENTRY,0),"^"),?67,"INACTIVATED",!?67,Y S NDFPRT=1
"RTN","NDFMOP1",24,0)
 I $D(^DIA(50.68,NBR,2.1)),$D(^DIA(50.68,NBR,3.1)) S STAMP=$P(^DIA(50.68,NBR,3.1),"^"),Y=STAMP X ^DD("DD") I STAMP>3050310 W !!,ENTRY,?8,$P(^PSNDF(50.68,ENTRY,0),"^"),?67,"INACTIVATED",!?67,Y S NDFPRT=1
"RTN","NDFMOP1",25,0)
 Q
"RTN","NDFNODDI")
0^21^B9351869
"RTN","NDFNODDI",1,0)
NDFNODDI ;BIR/WRT-Print report from Don's List and check for National DDIs ; 05/21/03 14:20
"RTN","NDFNODDI",2,0)
 ;;4.0; NDF MANAGEMENT;; 1 Jan 99;Build 1
"RTN","NDFNODDI",3,0)
 W !!,"This report will list VA Products from Don's Exclude DDIs List that have",!,"entries in the DRUG INTERACTION file (#56). Information included in this",!,"report is the Dose Form, VA Drug Class, and VA Generic."
"RTN","NDFNODDI",4,0)
 W !,"You may queue the report to print, if you wish.",!
"RTN","NDFNODDI",5,0)
DVC K %ZIS,POP,IOP S %ZIS="QM",%ZIS("B")="",%ZIS("A")="Select Printer: " D ^%ZIS G:POP DONE W:$E(IOST)'="P" !!,"This report must be run on a printer.",!! G:$E(IOST)'="P" DVC I POP K IOP,POP,IO("Q") Q
"RTN","NDFNODDI",6,0)
QUEUE I $D(IO("Q")) K IO("Q") S ZTRTN="ENQ^NDFNODDI",ZTDESC="VA Products from Don's List with National DDIs Report" D ^%ZTLOAD K ZTSK D ^%ZISC Q
"RTN","NDFNODDI",7,0)
ENQ ;ENTRY POINT WHEN QUEUED
"RTN","NDFNODDI",8,0)
 U IO
"RTN","NDFNODDI",9,0)
 S PSNPGCT=0,PSNPGLNG=IOSL-6,PSNPRT=0 D TITLE,LOOP1
"RTN","NDFNODDI",10,0)
DONE I $D(PSNPRT) W:PSNPRT=0 !!?10,"No Entries Found"
"RTN","NDFNODDI",11,0)
 W @IOF S:$D(ZTQUEUED) ZTREQ="@" K PSNPRT,PSNB,CODE,CL,CLS,DF,DFM,GN,NODE,VA,NAME,CLSDA,WRT,MJT,PSNPGCT,PSNPGLNG,Y,IOP,POP,IO("Q") D ^%ZISC
"RTN","NDFNODDI",12,0)
 Q
"RTN","NDFNODDI",13,0)
TITLE I $D(IOF),IOF]"" W @IOF S PSNPGCT=PSNPGCT+1
"RTN","NDFNODDI",14,0)
 W !,?8,"VA Products from Don's list that have National DDIs",!
"RTN","NDFNODDI",15,0)
 S Y=DT X ^DD("DD") W !,"Date printed: ",Y,?55,"Page: ",PSNPGCT,!
"RTN","NDFNODDI",16,0)
 W !,"VA PRODUCT",?65,"DOSE FORM",!,"VA GENERIC",?65,"VA CLASS",!,"INACTIVE DATE",!
"RTN","NDFNODDI",17,0)
 F MJT=1:1:80 W "-"
"RTN","NDFNODDI",18,0)
 Q
"RTN","NDFNODDI",19,0)
LOOP1 S NAME="" F WRT=0:0 S NAME=$O(^DONLIST1("B",NAME)) Q:NAME=""  F PSNB=0:0 S PSNB=$O(^DONLIST1("B",NAME,PSNB)) Q:'PSNB  D LOOP2
"RTN","NDFNODDI",20,0)
 Q
"RTN","NDFNODDI",21,0)
LOOP2 I $P(^DONLIST1(PSNB),"^",2)=1 D GETDAT
"RTN","NDFNODDI",22,0)
 Q
"RTN","NDFNODDI",23,0)
GETDAT S NODE=^PSNDF(50.68,PSNB,0),GN=$P(NODE,"^",2),DF=$P(NODE,"^",3),CL=$P($G(^PSNDF(50.68,PSNB,3)),"^"),VA=$P($G(^PSNDF(50.6,GN,0)),"^"),DFM=$P($G(^PS(50.606,DF,0)),"^"),CLS=$P($G(^PS(50.605,CL,0)),"^") D REPRT
"RTN","NDFNODDI",24,0)
 Q
"RTN","NDFNODDI",25,0)
INACT S DATE=$P($G(^PSNDF(50.68,PSNB,7)),"^",3)
"RTN","NDFNODDI",26,0)
 Q
"RTN","NDFNODDI",27,0)
REPRT D:$Y>PSNPGLNG TITLE W !!,NAME,?65,DFM,!,VA,?65,CLS S PSNPRT=1
"RTN","NDFNODDI",28,0)
 D:$Y>PSNPGLNG TITLE I $G(DATE) S Y=DATE X ^DD("DD") W !,Y
"RTN","NDFNODDI",29,0)
 Q
"RTN","NDFNPRT")
0^22^B24217204
"RTN","NDFNPRT",1,0)
NDFNPRT ;BIR/DMA NEW REPORT ; 16 Dec 02 / 10:56 AM 
"RTN","NDFNPRT",2,0)
 ;;4.0; NDF MANAGEMENT;; 16 Dec 02;Build 1
"RTN","NDFNPRT",3,0)
 ;using files 5000.506 50.416 50.607 50.6 50.64 50.68
"RTN","NDFNPRT",4,0)
 ;
"RTN","NDFNPRT",5,0)
 ;NDFCNT=counter for subfiles
"RTN","NDFNPRT",6,0)
 ;NDFD1=hold variable for several fields contents
"RTN","NDFNPRT",7,0)
 ;NDFE=subfile ien, NDFE1=hold variable for several fields contents
"RTN","NDFNPRT",8,0)
 ;NDFFC=flag to handle blanks at start of restrictions
"RTN","NDFNPRT",9,0)
 ;NDFFNU=product file #, NDFG=counter, NDF1=date print hold
"RTN","NDFNPRT",10,0)
 ;NDFHR=$$GET1 setup variable to read subfile, NDF2=array to hold subfile
"RTN","NDFNPRT",11,0)
 ;NDF3=page break checker, NDF4=counter, NDFLC=page break counter
"RTN","NDFNPRT",12,0)
 ;NDFN=product name, NDFSI=subfile ien, NDFPG=page counter
"RTN","NDFNPRT",13,0)
 ;NDFPH=print heading, NDFPR=print restrictions holder
"RTN","NDFNPRT",14,0)
 ;NDFR=restrictions hold variable, NDFAT=audit and temp ien
"RTN","NDFNPRT",15,0)
 ;NDFC1=ien from audit file for product file
"RTN","NDFNPRT",16,0)
 ;NDFC=ien from temp file for product file, NDFSTR=strength, NDF5=counter
"RTN","NDFNPRT",17,0)
 ;NDF6=generic name, NDF7=dosage form, NDF8=active ingredient
"RTN","NDFNPRT",18,0)
 ;NDFTM=reformated restrictions, NDFUNT=units
"RTN","NDFNPRT",19,0)
 ;
"RTN","NDFNPRT",20,0)
 N NDFAT,BL,CL,NDFCNT,NDFD1,NDFE,NDFE1,NDFFC,NDFFNU,NDFG,NDF1,NDFHR,NDF2,NDF3,NDF4,NDFLC,NDFN,NDFSI,NDFPG,NDFPH,NDFPR,NDFR,NDFC1,NDFC,NDFSTR,NDF5,NDF6,NDF7,NDF8,NDFTM,NDFUNT
"RTN","NDFNPRT",21,0)
 S NDFFNU=50.68 K ^TMP("NDFSR",$J)
"RTN","NDFNPRT",22,0)
 S %H=$H D YX^%DTC S NDF1=Y,BL="" F NDFG=1:1:70 S BL=BL_"-"
"RTN","NDFNPRT",23,0)
 S CL=0 D ^%ZIS S:POP>0 CL=1 D:POP>0 ^%ZISC Q:CL>0
"RTN","NDFNPRT",24,0)
 U IO S NDFPG=1,NDFLC=0 D HEAD
"RTN","NDFNPRT",25,0)
F1 ;
"RTN","NDFNPRT",26,0)
 S NDFAT=0 F  S NDFAT=$O(^NDFK(5000.506,NDFAT)) Q:'NDFAT  S NDFC1=^(NDFAT,0),NDFN=$$GET1^DIQ(NDFFNU,NDFC1,.01),^TMP("NDFSR",$J,NDFN)=NDFC1
"RTN","NDFNPRT",27,0)
 S NDFAT="" F  S NDFAT=$O(^TMP("NDFSR",$J,NDFAT)) Q:NDFAT=""  S NDFC=^(NDFAT) D PRINT I NDFLC=2 W # D HEAD S NDFLC=0
"RTN","NDFNPRT",28,0)
 I NDFLC=1 W # S NDFLC=0
"RTN","NDFNPRT",29,0)
 ;
"RTN","NDFNPRT",30,0)
QUIT ;
"RTN","NDFNPRT",31,0)
 K ^TMP("NDFSR",$J)
"RTN","NDFNPRT",32,0)
 D ^%ZISC
"RTN","NDFNPRT",33,0)
 Q
"RTN","NDFNPRT",34,0)
 ;
"RTN","NDFNPRT",35,0)
PRINT ;PRINT A RECORD
"RTN","NDFNPRT",36,0)
 W "NAME: "_$$GET1^DIQ(NDFFNU,NDFC,.01),!,"VA GENERIC NAME: ",$$GET1^DIQ(NDFFNU,NDFC,.05),!,"DOSAGE FORM: ",$$GET1^DIQ(NDFFNU,NDFC,1),!,"VA PRINT NAME: ",$$GET1^DIQ(NDFFNU,NDFC,5),!,"VA DISPENSE UNIT: ",$$GET1^DIQ(NDFFNU,NDFC,8),!!
"RTN","NDFNPRT",37,0)
 ;
"RTN","NDFNPRT",38,0)
 S NDFSTR=$$GET1^DIQ(NDFFNU,NDFC,2),NDFUNT=$$GET1^DIQ(NDFFNU,NDFC,3) W "STRENGTH:  ",NDFSTR,?30,"UNITS: ",NDFUNT,!
"RTN","NDFNPRT",39,0)
 W "EXCLUDE DRUG TO DRUG INTERACTION: ",$$GET1^DIQ(NDFFNU,NDFC,23),!
"RTN","NDFNPRT",40,0)
 W "NATIONAL FORMULARY NAME: ",$$GET1^DIQ(NDFFNU,NDFC,4),!!
"RTN","NDFNPRT",41,0)
 ;
"RTN","NDFNPRT",42,0)
 W "VA PRODUCT IDENTIFIER: ",$$GET1^DIQ(NDFFNU,NDFC,6),?30,"TRANSMIT TO CMOP: ",$$GET1^DIQ(NDFFNU,NDFC,7),!
"RTN","NDFNPRT",43,0)
 S NDFD1=$$GET1^DIQ(NDFFNU,NDFC,19) W "CS SCHEDULE: ",$S(NDFD1'="":NDFD1,1:"UNKNOWN"),!
"RTN","NDFNPRT",44,0)
 S NDFD1=$$GET1^DIQ(NDFFNU,NDFC,20) W "MULTISOURCE/SINGLE SOURCE: ",$S(NDFD1'="":NDFD1,1:"UNKNOWN"),!!
"RTN","NDFNPRT",45,0)
 ;
"RTN","NDFNPRT",46,0)
 S NDFD1=$$GET1^DIQ(NDFFNU,NDFC,11) W "GCNSEQNO: ",$S(NDFD1'="":NDFD1,1:"UNKNOWN"),!
"RTN","NDFNPRT",47,0)
 S NDFD1=$$GET1^DIQ(NDFFNU,NDFC,12) W "PREVIOUS GCN SEQNO: ",$S(NDFD1'="":NDFD1,1:"UNKNOWN")
"RTN","NDFNPRT",48,0)
 S NDFD1=$$GET1^DIQ(NDFFNU,NDFC,13) W ?30,"NDC LINK TO GCNSEQNO: ",$S(NDFD1'="":NDFD1,1:"UNKNOWN"),!
"RTN","NDFNPRT",49,0)
 ;getting active ingredients(.01), strength(1) and units(2) from the 
"RTN","NDFNPRT",50,0)
 ;active ingreadients subfile and putting in array J(
"RTN","NDFNPRT",51,0)
 S NDFCNT=0,NDFE=0 F  S NDFE=$O(^PSNDF(NDFFNU,NDFC,2,NDFE)) Q:'NDFE  S NDFCNT=NDFCNT+1,NDFHR=NDFE_","_NDFC_",",NDF2(NDFCNT)=$$GET1^DIQ(50.6814,NDFHR,.01)_U_$$GET1^DIQ(50.6814,NDFHR,1)_U_$$GET1^DIQ(50.6814,NDFHR,2)
"RTN","NDFNPRT",52,0)
 S NDF6=$$GET1^DIQ(NDFFNU,NDFC,.05)
"RTN","NDFNPRT",53,0)
 S NDFE1=$$GET1^DIQ(NDFFNU,NDFC,1),NDF7=$S(NDFE1'="":NDFE1,1:" UNKNOWN")
"RTN","NDFNPRT",54,0)
 S NDF8=$S($P($G(NDF2(1)),U)'="":$P($G(NDF2(1)),U),1:" UNKNOWN")
"RTN","NDFNPRT",55,0)
 W "FDB DESCRIPTION: ",NDF6_" "_NDF7_" "_NDF8,!
"RTN","NDFNPRT",56,0)
 ;
"RTN","NDFNPRT",57,0)
 F NDF4=1:1:NDFCNT Q:$P(NDF2(NDF4),U)=""  D
"RTN","NDFNPRT",58,0)
 .I $P(NDF2(NDF4),U,2)'=""&($P(NDF2(NDF4),U,3)'="") W "ACTIVE INGREDIENTS: ",$S($P(NDF2(NDF4),U)'="":$P(NDF2(NDF4),U),1:"UNKNOWN")
"RTN","NDFNPRT",59,0)
 .W !,"STRENGTH: ",$P(NDF2(NDF4),U,2),?30,"UNITS: ",$P(NDF2(NDF4),U,3),!
"RTN","NDFNPRT",60,0)
 I $G(^PSNDF(NDFFNU,NDFC,2,1,0))="",NDFCNT=0 W "ACTIVE INGREDIENTS: ","UNKNOWN",!,"STRENGTH: ","UNKNOWN",?30,"UNITS: ","UNKNOWN",!!
"RTN","NDFNPRT",61,0)
 F NDF4=1:1:NDFCNT S NDF2(NDF4)="" ;setting NDF2( array to null for next product
"RTN","NDFNPRT",62,0)
 ;
"RTN","NDFNPRT",63,0)
 S NDFE1=$$GET1^DIQ(NDFFNU,NDFC,15) W "PRIMARY VA DRUG CLASS: ",$S(NDFE1'="":NDFE1,1:"UNKNOWN")
"RTN","NDFNPRT",64,0)
 S NDFE1="",NDFE="",NDFE=$P($G(^PSNDF(NDFFNU,NDFC,4,0)),U,3) I NDFE S NDFE1=$$GET1^DIQ(50.6816,NDFE_","_NDFC_",",.01)
"RTN","NDFNPRT",65,0)
 W ?40,"SECONDARY VA CLASS: ",$S(NDFE1'="":NDFE1,1:"UNKNOWN"),!
"RTN","NDFNPRT",66,0)
 W "NATIONAL FORMULARY INDICATOR: ",$$GET1^DIQ(NDFFNU,NDFC,17),?40,"INACTIVE DATE: ",$$GET1^DIQ(NDFFNU,NDFC,21),!
"RTN","NDFNPRT",67,0)
 I $G(^PSNDF(NDFFNU,NDFC,6,1,0))="" W "NATIONAL RESTRICTIONS: ","UNKNOWN",!,BL,!! S NDFLC=NDFLC+1 D  Q
"RTN","NDFNPRT",68,0)
 .S NDF3=$O(^TMP("NDFSR",$J,NDFAT)) I NDF3=""&(NDFLC=2) S NDFLC=0
"RTN","NDFNPRT",69,0)
 ;
"RTN","NDFNPRT",70,0)
 ;if restrictions loop through get the information and print
"RTN","NDFNPRT",71,0)
 W "NATIONAL RESTRICTIONS: ",!
"RTN","NDFNPRT",72,0)
 S NDFSI=0 F  S NDFSI=$O(^PSNDF(NDFFNU,NDFC,6,NDFSI)) Q:NDFSI=""  S NDFR=$G(^PSNDF(NDFFNU,NDFC,6,NDFSI,0)),NDFTM="",NDFFC=0 S:$E(NDFR,1,1)=" " NDFFC=1 D
"RTN","NDFNPRT",73,0)
 .S:NDFFC NDFTM=$P(NDFR," ",2,$L(NDFR)) S:'NDFFC NDFTM=$P(NDFR," ",1,$L(NDFR))
"RTN","NDFNPRT",74,0)
 .W NDFTM,!
"RTN","NDFNPRT",75,0)
        W BL,!! S NDFLC=NDFLC+1 S NDF3=$O(^TMP("NDFSR",$J,NDFAT)) I NDF3=""&(NDFLC=2) S NDFLC=0
"RTN","NDFNPRT",76,0)
        Q
"RTN","NDFNPRT",77,0)
 ;
"RTN","NDFNPRT",78,0)
HEAD ;
"RTN","NDFNPRT",79,0)
 S NDFPH="VA NEW PRODUCTS REPORT" W !!,?26,NDFPH,?65,"PAGE: ",NDFPG,!
"RTN","NDFNPRT",80,0)
 W ?5,"DATE: ",$P(NDF1,"@"),?49,"TIME: ",$P(NDF1,"@",2),!,BL,!! S NDFPG=NDFPG+1,NDFLC=0
"RTN","NDFNPRT",81,0)
 Q
"RTN","NDFNWVD")
0^23^B46034241
"RTN","NDFNWVD",1,0)
NDFNWVD ;BIR/WRT-NEW VUID Assignment Report; 12/15/05 10:23
"RTN","NDFNWVD",2,0)
 ;;0.0; NATIONAL DRUG FILE MANAGEMENT SYSTEM;; 30 Oct 98;Build 1
"RTN","NDFNWVD",3,0)
 K I
"RTN","NDFNWVD",4,0)
 W !,"This report gives you a hard copy of NEW entries with ASSIGNED VUIDs.",!,"In addition, it will reflect entries that have been Inactivated or Re-Activated.",!,"You may queue the report to print, if you wish.",!
"RTN","NDFNWVD",5,0)
 K ^WRT("NDFID") S VUID=$P(^NDFK(5000.991,1,0),"^",2)+1,NUM=1
"RTN","NDFNWVD",6,0)
DVC K %ZIS,POP,IOP S %ZIS="QM",%ZIS("B")="",%ZIS("A")="Select Printer: " D ^%ZIS G:POP DONE W:$E(IOST)'="P" !!,"This report must be run on a printer.",!! G:$E(IOST)'="P" DVC I POP K IOP,POP,IO("Q") Q
"RTN","NDFNWVD",7,0)
QUEUE I $D(IO("Q")) K IO("Q") S ZTRTN="ENQ^NDFNWVD",ZTDESC="List of NEW Entries After VUID Assignment",ZTSAVE("VUID")="",ZTSAVE("NUM")="" D ^%ZTLOAD K ZTSK D ^%ZISC Q
"RTN","NDFNWVD",8,0)
ENQ ;ENTRY POINT WHEN QUEUED
"RTN","NDFNWVD",9,0)
 U IO
"RTN","NDFNWVD",10,0)
 S NDFPGCT=0,NDFPGLNG=IOSL-6 D TITLE,LOOP1,NONE,TITLE1,ACT,NONE,TITLE2,LOOP2,NONE,TITLE2A,ACT2,NONE,TITLE3,LOOP3,NONE,TITLE4,LOOP4,NONE,TITLE4A,ACT4,NONE
"RTN","NDFNWVD",11,0)
DONE W @IOF S:$D(ZTQUEUED) ZTREQ="@" K NDFPRT,IEN,NAM,IFN,DATE,MAST,MASTER,NBR,NUM,STAMP,VUID,DVUID,ENTRY,MJT,NDFPGCT,NDFPGLNG,Y,IOP,POP,IO("Q") K ^BT("PSNVUID") D ^%ZISC
"RTN","NDFNWVD",12,0)
 Q
"RTN","NDFNWVD",13,0)
TITLE I $D(IOF),IOF]"" W @IOF S NDFPGCT=NDFPGCT+1
"RTN","NDFNWVD",14,0)
 S NDFPRT=0 W !,?12," List of NEW Entries After VUID Assignment",!
"RTN","NDFNWVD",15,0)
 W !?27,"VA PRODUCT FILE",!
"RTN","NDFNWVD",16,0)
 S Y=DT X ^DD("DD") W ?22,"Date printed: ",Y,!
"RTN","NDFNWVD",17,0)
 W !,"IEN",?8,"VA PRODUCT NAME",!,?8,"ASSIGNED VUID",?63,"MASTER/NON-MASTER",!
"RTN","NDFNWVD",18,0)
 F MJT=1:1:80 W "-"
"RTN","NDFNWVD",19,0)
 Q
"RTN","NDFNWVD",20,0)
LOOP1 F IEN=0:0 S IEN=$O(^BT("PSNVUID","VAPN",IEN)) Q:'IEN   S NAM=$P(^PSNDF(50.68,IEN,0),"^"),DATE=$P($G(^PSNDF(50.68,IEN,"TERMSTATUS",1,0)),"^"),NODE=^PSNDF(50.68,IEN,"VUID"),VUID=$P(NODE,"^"),MAST=$P(NODE,"^",2) D MASTER,PROP
"RTN","NDFNWVD",21,0)
 Q
"RTN","NDFNWVD",22,0)
MASTER S:MAST=1 MASTER="MASTER" S:MAST=0 MASTER="NON-MASTER"
"RTN","NDFNWVD",23,0)
 Q
"RTN","NDFNWVD",24,0)
 ; See if term exists & set VUID
"RTN","NDFNWVD",25,0)
PROP W !!,IEN,?8,NAM,!,?8,"VUID: ",VUID,?72,MASTER S NDFPRT=1 Q
"RTN","NDFNWVD",26,0)
 Q
"RTN","NDFNWVD",27,0)
ACT S NBR=$P(^NDFK(5000,1,1,50.68,0),"^",2) F  S NBR=$O(^DIA(50.68,NBR)) Q:'NBR  I $P(^(NBR,0),"^",3)=21 S ENTRY=$P(^DIA(50.68,NBR,0),"^") I $D(^PSNDF(50.68,ENTRY,0)) D CHECK
"RTN","NDFNWVD",28,0)
 Q
"RTN","NDFNWVD",29,0)
CHECK I $D(^DIA(50.68,NBR,2.1)),'$D(^DIA(50.68,NBR,3.1)) W !!,ENTRY,?8,$P(^PSNDF(50.68,ENTRY,0),"^"),?67,"RE-ACTIVATED" S NDFPRT=1
"RTN","NDFNWVD",30,0)
 I '$D(^DIA(50.68,NBR,2.1)),$D(^DIA(50.68,NBR,3.1)) S STAMP=$P(^DIA(50.68,NBR,3.1),"^"),Y=STAMP X ^DD("DD") I STAMP>3050310 W !!,ENTRY,?8,$P(^PSNDF(50.68,ENTRY,0),"^"),?67,"INACTIVATED",!?67,Y S NDFPRT=1
"RTN","NDFNWVD",31,0)
 I $D(^DIA(50.68,NBR,2.1)),$D(^DIA(50.68,NBR,3.1)) S STAMP=$P(^DIA(50.68,NBR,3.1),"^"),Y=STAMP X ^DD("DD") I STAMP>3050310 W !!,ENTRY,?8,$P(^PSNDF(50.68,ENTRY,0),"^"),?67,"INACTIVATED",!?67,Y S NDFPRT=1
"RTN","NDFNWVD",32,0)
 Q
"RTN","NDFNWVD",33,0)
TITLE1 I $D(IOF),IOF]"" W @IOF S NDFPGCT=NDFPGCT+1
"RTN","NDFNWVD",34,0)
 S NDFPRT=0 W !,?8," List of Entries Inactivated/Re-Activated in Next Data Update"
"RTN","NDFNWVD",35,0)
 W !,?35,"VA PRODUCT FILE",!
"RTN","NDFNWVD",36,0)
 S Y=DT X ^DD("DD") W ?28,"Date printed: ",Y,!
"RTN","NDFNWVD",37,0)
 W !,?7,"VA PRODUCT NAME",?67,"STATUS",!?67,"DATE",!
"RTN","NDFNWVD",38,0)
 F MJT=1:1:80 W "-"
"RTN","NDFNWVD",39,0)
 Q
"RTN","NDFNWVD",40,0)
 ; Drug Ingredients
"RTN","NDFNWVD",41,0)
TITLE2 I $D(IOF),IOF]"" W @IOF S NDFPRT=0 W !!,?13," List of NEW Entries After VUID Assignment",!
"RTN","NDFNWVD",42,0)
 W !?27,"DRUG INGREDIENTS FILE",!
"RTN","NDFNWVD",43,0)
 S Y=DT X ^DD("DD") W ?25,"Date printed: ",Y,!
"RTN","NDFNWVD",44,0)
 W !,"IEN",?8,"DRUG INGREDIENT",!?8,"ASSIGNED VUID",?63,"MASTER/NON-MASTER",!
"RTN","NDFNWVD",45,0)
 F MJT=1:1:80 W "-"
"RTN","NDFNWVD",46,0)
 Q
"RTN","NDFNWVD",47,0)
LOOP2 K NAM,I
"RTN","NDFNWVD",48,0)
 F IEN=0:0 S IEN=$O(^BT("PSNVUID","ING",IEN)) Q:'IEN   S NAM=$P(^PS(50.416,IEN,0),"^"),DATE=$P($G(^PS(50.416,IEN,"TERMSTATUS",1,0)),"^"),NODE=^PS(50.416,IEN,"VUID"),VUID=$P(NODE,"^"),MAST=$P(NODE,"^",2) D MASTER,PROP
"RTN","NDFNWVD",49,0)
 Q
"RTN","NDFNWVD",50,0)
ACT2 S NBR=$P(^NDFK(5000,1,1,50.416,0),"^",2) F  S NBR=$O(^DIA(50.416,NBR)) Q:'NBR  I $P(^(NBR,0),"^",3)=3 S ENTRY=$P(^DIA(50.416,NBR,0),"^") I $D(^PS(50.416,ENTRY,0)) D CHECK2
"RTN","NDFNWVD",51,0)
 Q
"RTN","NDFNWVD",52,0)
CHECK2 I $D(^DIA(50.416,NBR,2.1)),'$D(^DIA(50.416,NBR,3.1)) W !!,ENTRY,?8,$P(^PS(50.416,ENTRY,0),"^"),?67,"RE-ACTIVATED" S NDFPRT=1
"RTN","NDFNWVD",53,0)
 I '$D(^DIA(50.416,NBR,2.1)),$D(^DIA(50.416,NBR,3.1)) S STAMP=$P(^DIA(50.416,NBR,3.1),"^"),Y=STAMP X ^DD("DD") I STAMP>3050310 W !!,ENTRY,?8,$P(^PS(50.416,ENTRY,0),"^"),?67,"INACTIVATED",!?67,Y S NDFPRT=1
"RTN","NDFNWVD",54,0)
 I $D(^DIA(50.416,NBR,2.1)),$D(^DIA(50.416,NBR,3.1)) S STAMP=$P(^DIA(50.416,NBR,3.1),"^"),Y=STAMP X ^DD("DD") I STAMP>3050310 W !!,ENTRY,?8,$P(^PS(50.416,ENTRY,0),"^"),?67,"INACTIVATED",!?67,Y S NDFPRT=1
"RTN","NDFNWVD",55,0)
 Q
"RTN","NDFNWVD",56,0)
TITLE2A I $D(IOF),IOF]"" W @IOF S NDFPRT=0 W !!,?11," List of Entries Inactivated/Re-Activated in Next Data Update"
"RTN","NDFNWVD",57,0)
 W !,?35,"DRUG INGREDIENTS FILE",!
"RTN","NDFNWVD",58,0)
 S Y=DT X ^DD("DD") W ?33,"Date printed: ",Y,!
"RTN","NDFNWVD",59,0)
 W !,?7,"DRUG INGREDIENT",?67,"STATUS",!?67,"DATE",!
"RTN","NDFNWVD",60,0)
 F MJT=1:1:80 W "-"
"RTN","NDFNWVD",61,0)
 Q
"RTN","NDFNWVD",62,0)
NONE W:NDFPRT=0 !," 0 ENTRIES FOUND"
"RTN","NDFNWVD",63,0)
 Q
"RTN","NDFNWVD",64,0)
 ; VA Drug Class
"RTN","NDFNWVD",65,0)
TITLE3 I $D(IOF),IOF]"" W @IOF S NDFPRT=0 W !!,?13," List of NEW Entries After VUID Assignment",!
"RTN","NDFNWVD",66,0)
 W !?27,"VA DRUG CLASS",!
"RTN","NDFNWVD",67,0)
 S Y=DT X ^DD("DD") W ?22,"Date printed: ",Y,!
"RTN","NDFNWVD",68,0)
 W !,"IEN",?8,"VA DRUG CLASS",!?8,"ASSIGNED VUID",?63,"MASTER/NON-MASTER",!
"RTN","NDFNWVD",69,0)
 F MJT=1:1:80 W "-"
"RTN","NDFNWVD",70,0)
 Q
"RTN","NDFNWVD",71,0)
LOOP3 K NAM,I
"RTN","NDFNWVD",72,0)
 F IEN=0:0 S IEN=$O(^BT("PSNVUID","VACL",IEN)) Q:'IEN  D SET
"RTN","NDFNWVD",73,0)
 Q
"RTN","NDFNWVD",74,0)
SET S NAM=$P(^PS(50.605,IEN,0),"^"),DATE=$P($G(^PS(50.605,IEN,"TERMSTATUS",1,0)),"^"),NODE=^PS(50.605,IEN,"VUID"),VUID=$P(NODE,"^"),MAST=$P(NODE,"^",2) D MASTER,PROP
"RTN","NDFNWVD",75,0)
 Q
"RTN","NDFNWVD",76,0)
 ; VA Generic
"RTN","NDFNWVD",77,0)
TITLE4 I $D(IOF),IOF]"" W @IOF S NDFPRT=0 W !!,?13," List of NEW Entries After VUID Assignment",!
"RTN","NDFNWVD",78,0)
 W !?27,"VA GENERIC FILE",!
"RTN","NDFNWVD",79,0)
 S Y=DT X ^DD("DD") W ?22,"Date printed: ",Y,!
"RTN","NDFNWVD",80,0)
 W !,"IEN",?8,"VA GENERIC NAME",!?8,"ASSIGNED VUID",?63,"MASTER/NON-MASTER",!
"RTN","NDFNWVD",81,0)
 F MJT=1:1:80 W "-"
"RTN","NDFNWVD",82,0)
 Q
"RTN","NDFNWVD",83,0)
LOOP4 K NAM,I
"RTN","NDFNWVD",84,0)
 F IEN=0:0 S IEN=$O(^BT("PSNVUID","VAGN",IEN)) Q:'IEN   S NAM=$P(^PSNDF(50.6,IEN,0),"^"),DATE=$P($G(^PSNDF(50.6,IEN,"TERMSTATUS",1,0)),"^"),NODE=^PSNDF(50.6,IEN,"VUID"),VUID=$P(NODE,"^"),MAST=$P(NODE,"^",2) D MASTER,PROP
"RTN","NDFNWVD",85,0)
 Q
"RTN","NDFNWVD",86,0)
ACT4 S NBR=$P(^NDFK(5000,1,1,50.6,0),"^",2) F  S NBR=$O(^DIA(50.6,NBR)) Q:'NBR  I $P(^(NBR,0),"^",3)=1 S ENTRY=$P(^DIA(50.6,NBR,0),"^") I $D(^PSNDF(50.6,ENTRY,0)) D CHECK4
"RTN","NDFNWVD",87,0)
 Q
"RTN","NDFNWVD",88,0)
CHECK4 I $D(^DIA(50.6,NBR,2.1)),'$D(^DIA(50.6,NBR,3.1)) W !!,ENTRY,?8,$P(^PSNDF(50.6,ENTRY,0),"^"),?67,"RE-ACTIVATED" S NDFPRT=1
"RTN","NDFNWVD",89,0)
 I '$D(^DIA(50.6,NBR,2.1)),$D(^DIA(50.6,NBR,3.1)) S STAMP=$P(^DIA(50.6,NBR,3.1),"^"),Y=STAMP X ^DD("DD") I STAMP>3050310 W !!,ENTRY,?8,$P(^PSNDF(50.6,ENTRY,0),"^"),?67,"INACTIVATED",!?67,Y S NDFPRT=1
"RTN","NDFNWVD",90,0)
 I $D(^DIA(50.6,NBR,2.1)),$D(^DIA(50.6,NBR,3.1)) S STAMP=$P(^DIA(50.6,NBR,3.1),"^"),Y=STAMP X ^DD("DD") I STAMP>3050310 W !!,ENTRY,?8,$P(^PSNDF(50.6,ENTRY,0),"^"),?67,"INACTIVATED",!?67,Y S NDFPRT=1
"RTN","NDFNWVD",91,0)
 Q
"RTN","NDFNWVD",92,0)
TITLE4A I $D(IOF),IOF]"" W @IOF S NDFPRT=0 W !!,?11," List of Entries Inactivated/Re-Activated in Next Data Update"
"RTN","NDFNWVD",93,0)
 W !,?35,"VA GENERIC FILE",!
"RTN","NDFNWVD",94,0)
 S Y=DT X ^DD("DD") W ?30,"Date printed: ",Y,!
"RTN","NDFNWVD",95,0)
 W !,?7,"VA GENERIC NAME",?67,"STATUS",!?67,"DATE",!
"RTN","NDFNWVD",96,0)
 F MJT=1:1:80 W "-"
"RTN","NDFNWVD",97,0)
 Q
"RTN","NDFORCE")
0^24^B10125920
"RTN","NDFORCE",1,0)
NDFORCE ;BIR/WRT-LOOP THRU STANDARDIZED FILES TO CHECK FOR INACTIVE & RE-ACTIVATED; 12/09/05 14:56
"RTN","NDFORCE",2,0)
 ;;0.0; NATIONAL DRUG FILE MANAGEMENT SYSTEM;; 30 Oct 98;Build 1
"RTN","NDFORCE",3,0)
 D ACT,ACT2,ACT3 K NBR,ENTRY,STAMP
"RTN","NDFORCE",4,0)
 Q
"RTN","NDFORCE",5,0)
 ; Loop thru each AUDIT file
"RTN","NDFORCE",6,0)
ACT S NBR=$P(^NDFK(5000,1,1,50.68,0),"^",2) F  S NBR=$O(^DIA(50.68,NBR)) Q:'NBR  I $P(^(NBR,0),"^",3)=21 S ENTRY=$P(^DIA(50.68,NBR,0),"^") I $D(^PSNDF(50.68,ENTRY,0)) D CHECK
"RTN","NDFORCE",7,0)
 Q
"RTN","NDFORCE",8,0)
CHECK I $D(^DIA(50.68,NBR,2.1)),'$D(^DIA(50.68,NBR,3.1)) S DA(1)=ENTRY,DIC="^PSNDF(50.68,"_ENTRY_",""TERMSTATUS"",",X=DT,DIC(0)="L",DLAYGO=50.6899,DIC("DR")=".02////"_1 D FILE^DICN
"RTN","NDFORCE",9,0)
 I '$D(^DIA(50.68,NBR,2.1)),$D(^DIA(50.68,NBR,3.1)) S STAMP=$P(^DIA(50.68,NBR,3.1),"^") I STAMP>3050310 D INACT
"RTN","NDFORCE",10,0)
 I $D(^DIA(50.68,NBR,2.1)),$D(^DIA(50.68,NBR,3.1)) S STAMP=$P(^DIA(50.68,NBR,3.1),"^") I STAMP>3050310 D INACT
"RTN","NDFORCE",11,0)
 Q
"RTN","NDFORCE",12,0)
INACT S DA(1)=ENTRY,DIC="^PSNDF(50.68,"_ENTRY_",""TERMSTATUS"",",X=STAMP,DIC(0)="L",DLAYGO=50.6899,DIC("DR")=".02////"_0 D FILE^DICN
"RTN","NDFORCE",13,0)
 Q
"RTN","NDFORCE",14,0)
ACT2 S NBR=$P(^NDFK(5000,1,1,50.416,0),"^",2) F  S NBR=$O(^DIA(50.416,NBR)) Q:'NBR  I $P(^(NBR,0),"^",3)=3 S ENTRY=$P(^DIA(50.416,NBR,0),"^") I $D(^PS(50.416,ENTRY,0)) D CHECK2
"RTN","NDFORCE",15,0)
 Q
"RTN","NDFORCE",16,0)
CHECK2 I $D(^DIA(50.416,NBR,2.1)),'$D(^DIA(50.416,NBR,3.1)) S DA(1)=ENTRY,DIC="^PS(50.416,"_ENTRY_",""TERMSTATUS"",",X=DT,DIC(0)="L",DLAYGO=50.4169,DIC("DR")=".02////"_1 D FILE^DICN
"RTN","NDFORCE",17,0)
 I '$D(^DIA(50.416,NBR,2.1)),$D(^DIA(50.416,NBR,3.1)) S STAMP=$P(^DIA(50.416,NBR,3.1),"^") D INACT2
"RTN","NDFORCE",18,0)
 Q
"RTN","NDFORCE",19,0)
INACT2 S DA(1)=ENTRY,DIC="^PS(50.416,"_ENTRY_",""TERMSTATUS"",",X=STAMP,DIC(0)="L",DLAYGO=50.4169,DIC("DR")=".02////"_0 D FILE^DICN
"RTN","NDFORCE",20,0)
 Q
"RTN","NDFORCE",21,0)
ACT3 S NBR=$P(^NDFK(5000,1,1,50.6,0),"^",2) F  S NBR=$O(^DIA(50.6,NBR)) Q:'NBR  I $P(^(NBR,0),"^",3)=1 S ENTRY=$P(^DIA(50.6,NBR,0),"^") I $D(^PSNDF(50.6,ENTRY,0)) D CHECK3
"RTN","NDFORCE",22,0)
 Q
"RTN","NDFORCE",23,0)
CHECK3 I $D(^DIA(50.6,NBR,2.1)),'$D(^DIA(50.6,NBR,3.1)) S DA(1)=ENTRY,DIC="^PSNDF(50.6,"_ENTRY_",""TERMSTATUS"",",X=DT,DIC(0)="L",DLAYGO=50.6009,DIC("DR")=".02////"_1 D FILE^DICN
"RTN","NDFORCE",24,0)
 I '$D(^DIA(50.6,NBR,2.1)),$D(^DIA(50.6,NBR,3.1)) S STAMP=$P(^DIA(50.6,NBR,3.1),"^") D INACT3
"RTN","NDFORCE",25,0)
 Q
"RTN","NDFORCE",26,0)
INACT3 S DA(1)=ENTRY,DIC="^PSNDF(50.6,"_ENTRY_",""TERMSTATUS"",",X=STAMP,DIC(0)="L",DLAYGO=50.6009,DIC("DR")=".02////"_0 D FILE^DICN
"RTN","NDFORCE",27,0)
 Q
"RTN","NDFORMU")
0^25^B15982564
"RTN","NDFORMU",1,0)
NDFORMU ;BIR/DMA-entry formulary information ;13 Sep 99 / 7:41 AM
"RTN","NDFORMU",2,0)
 ;;4.0; NDF MANAGEMENT;; 1 Jan 99;Build 1
"RTN","NDFORMU",3,0)
GO S DIR(0)="SA^P:VA Product;G:VA Generic",DIR("A")="Do you wish to sort by VA Product (P) or VA Generic (G)? " W !! D ^DIR G END:$D(DIRUT),G:Y="G"
"RTN","NDFORMU",4,0)
 ;by product
"RTN","NDFORMU",5,0)
 S DIR(0)="SA^S:SINGLE;M:MULTIPLE",DIR("A")="Single (S) or Multiple (M) Products ?" D ^DIR G END:$D(DIRUT),MULT:Y="M"
"RTN","NDFORMU",6,0)
 F  S DIC=50.68,DIC(0)="AEQM" D ^DIC Q:Y<0  S DA=+Y,DIE=DIC,DR="4;17R;" D EDIT
"RTN","NDFORMU",7,0)
 G END
"RTN","NDFORMU",8,0)
 ;
"RTN","NDFORMU",9,0)
MULT ;Multiple products
"RTN","NDFORMU",10,0)
 S DIC=50.605,DIC(0)="QEAM",DIC("A")="P^50.605",DIC("A")="Enter VA Drug Class Code to sort by " W !! D ^DIC G GO:Y<0 S COD=+Y
"RTN","NDFORMU",11,0)
 S DIR(0)="SA^P:PRIMARY;S:SECONDARY;B:BOTH",DIR("A")="Sort Primary (P), Secondary (S), or Both (B)? " D ^DIR G END:$D(DIRUT) S PSB=Y
"RTN","NDFORMU",12,0)
 W !,"Excuse me while I sort",! K ^TMP($J) S DA=0 F  S DA=$O(^PSNDF(50.68,DA)) Q:'DA  W:DA#200=0 "." S NA=$P(^(DA,0),"^") I PSB'="S"&($P($G(^(3)),"^")=COD)!(PSB'="P"&$D(^(4,COD))) S ^TMP($J,NA_"^"_DA)=""
"RTN","NDFORMU",13,0)
 I '$D(^TMP($J)) W !,"No Matches Found",! G MULT
"RTN","NDFORMU",14,0)
 K Y S NA="" F  S NA=$O(^TMP($J,NA)) Q:NA=""  S DIE=50.68,DR="4;17R;",DA=$P(NA,"^",2) W !!,$P(NA,"^") D EDIT
"RTN","NDFORMU",15,0)
 G MULT
"RTN","NDFORMU",16,0)
 ;
"RTN","NDFORMU",17,0)
G ;GENERICS
"RTN","NDFORMU",18,0)
 S DIC=50.605,DIC(0)="QEAM",DIC("A")="P^50.605",DIC("A")="Enter VA Drug Class Code to sort by " W !! D ^DIC G GO:Y<0 S COD=+Y
"RTN","NDFORMU",19,0)
 S DIR(0)="SA^P:PRIMARY;S:SECONDARY;B:BOTH",DIR("A")="Sort Primary (P), Secondary (S), or Both (B)? " D ^DIR G END:$D(DIRUT) S PSB=Y
"RTN","NDFORMU",20,0)
 K DIC S DIC=50.6,DIC(0)="AEQM" D ^DIC G G:Y<0 S DA1=+Y
"RTN","NDFORMU",21,0)
 W !,"Excuse me while I sort " K ^TMP($J) S DA=0 F  S DA=$O(^PSNDF(50.6,"APRO",DA1,DA)) Q:'DA  S NA=$P(^PSNDF(50.68,DA,0),"^") I PSB'="S"&($P($G(^(3)),"^")=COD)!(PSB'="P"&($D(^(4,COD)))) S ^TMP($J,NA_"^"_DA)=""
"RTN","NDFORMU",22,0)
 I '$D(^TMP($J)) W !,"No Matches Found",! G G
"RTN","NDFORMU",23,0)
 K Y S NA="" F  S NA=$O(^TMP($J,NA)) Q:NA=""  S DA=$P(NA,"^",2) W !!,$P(NA,"^") S DIE=50.68,DR="4;17R;" D EDIT
"RTN","NDFORMU",24,0)
 G G
"RTN","NDFORMU",25,0)
END K ARR,COD,DA,DA1,DIC,DIE,DIR,DIR,DR,IND,NA,NDF1,NDF2,PSB,X,Y,^TMP($J) Q
"RTN","NDFORMU",26,0)
 Q
"RTN","NDFORMU",27,0)
 ;
"RTN","NDFORMU",28,0)
CSUM(FILE,DA,MULT) ;check sum of a word processing field
"RTN","NDFORMU",29,0)
 N C,J,L,X S CSUM=0
"RTN","NDFORMU",30,0)
 S L=0 F  S L=$O(@FILE@(DA,MULT,L)) Q:'L  S X=^(L,0) F J=1:1:$L(X) S CSUM=L*J*$A(X,J)+CSUM
"RTN","NDFORMU",31,0)
 Q CSUM
"RTN","NDFORMU",32,0)
 ;
"RTN","NDFORMU",33,0)
EDIT ;DIE call and look up into wp file
"RTN","NDFORMU",34,0)
 S NDF1=$P($G(^PSNDF(50.68,DA,5)),"^")
"RTN","NDFORMU",35,0)
 D ^DIE
"RTN","NDFORMU",36,0)
 I $P($G(^PSNDF(50.68,DA,5)),"^")'=NDF1 S ^NDFK(5000.5,DA,0)=DA
"RTN","NDFORMU",37,0)
 S NDF1=$$CSUM("^PSNDF(50.68)",DA,6)
"RTN","NDFORMU",38,0)
 ;
"RTN","NDFORMU",39,0)
 I '$O(^PSNDF(50.68,DA,6,0)) W !," No current restriction",!
"RTN","NDFORMU",40,0)
 E  S X=0 W !," Current restriction",! F  S X=$O(^PSNDF(50.68,DA,6,X)) Q:'X  W ?5,^(X,0),!
"RTN","NDFORMU",41,0)
 R !," Restriction (@ to delete) :",X:DTIME Q:'$T  Q:X["^"
"RTN","NDFORMU",42,0)
 I X="@",$O(^PSNDF(50.68,DA,6,0)) K ^PSNDF(50.68,DA,6) S Z=$O(^NDFK(5000,1,4," "),-1)+1,^(Z,0)="PSNDF(50.68,"_DA_",6)" K Z W "    Deleted",! Q
"RTN","NDFORMU",43,0)
 I X="@",'$O(^PSNDF(50.68,DA,6,0)) W !!," No restriction to delete" Q
"RTN","NDFORMU",44,0)
 I $E(X)="?" K ARR D
"RTN","NDFORMU",45,0)
 .W @IOF,$C(13) S IND=0 F J=1:1 S IND=$O(^PS(51.7,IND)) Q:'IND  S ARR(J)=IND,K=0 W J F  S K=$O(^PS(51.7,IND,2,K)) Q:'K  W ?5,^(K,0),!
"RTN","NDFORMU",46,0)
 .S DIR(0)="N^1:"_(J-1),DIR("A")="Select 1 to "_(J-1)_" or ^ to quit" D ^DIR Q:$D(DIRUT)  S Y=ARR(+Y)
"RTN","NDFORMU",47,0)
 Q:$D(DIRUT)
"RTN","NDFORMU",48,0)
 E  S DIC=51.7,DIC(0)="EZ" D ^DIC Q:Y<0
"RTN","NDFORMU",49,0)
 K ^PSNDF(50.68,DA,6) M ^PSNDF(50.68,DA,6)=^PS(51.7,+Y,2)
"RTN","NDFORMU",50,0)
 S NDF2=$$CSUM("^PSNDF(50.68)",DA,6)
"RTN","NDFORMU",51,0)
 I NDF1'=NDF2 S X=$O(^NDFK(5000,1,4," "),-1)+1,^(X,0)="PSNDF(50.68,"_DA_",6)"
"RTN","NDFORMU",52,0)
 I NDF1=NDF2,$G(^PSNDF(50.68,DA,6,0))]"" S X=$O(^NDFK(5000,1,4," "),-1)+1,^(X,0)="PSNDF(50.68,"_DA_",6,0)"
"RTN","NDFORMU",53,0)
 Q
"RTN","NDFORMU",54,0)
 ;
"RTN","NDFORMU",55,0)
ENTER ;enter new restriction
"RTN","NDFORMU",56,0)
 S PSSNFI=1
"RTN","NDFORMU",57,0)
 F  S DIC=51.7,DIC(0)="AQELMZ",DLAYGO=51.7 D ^DIC Q:Y<0  S DIE=DIC,DA=+Y,DR=".01;3" D ^DIE
"RTN","NDFORMU",58,0)
 K DA,DIC,DIE,DR,PSSNFI,Y Q
"RTN","NDFPATCH")
0^26^B7739736
"RTN","NDFPATCH",1,0)
NDFPATCH ;BIR/DMA NEW REPORT ; 27 Jul 2007  9:38 AM
"RTN","NDFPATCH",2,0)
 ;;4.0; NDF MANAGEMENT;; 16 April 03;Build 1
"RTN","NDFPATCH",3,0)
 ;
"RTN","NDFPATCH",4,0)
 ;
"RTN","NDFPATCH",5,0)
 W @IOF
"RTN","NDFPATCH",6,0)
 ;N DATA,DIR,LIST,NA,NDF1,NDFDATA,NDFAF,NDFBL,NDFCL,NDFE,NDFF,NDFS,NDFSORT,NEW,OLD,Y
"RTN","NDFPATCH",7,0)
 S DIR(0)="S^P:PRODUCT;F:FIELD",DIR("A")="Sort by: " D ^DIR I $D(DIRUT) K DIR Q
"RTN","NDFPATCH",8,0)
 S NDFSORT=Y
"RTN","NDFPATCH",9,0)
 S NDFBL="" F NDF1=1:1:75 S NDFBL=NDFBL_"-"
"RTN","NDFPATCH",10,0)
 ;
"RTN","NDFPATCH",11,0)
 W !,"START DATE (Corresponding to the start of entering data for the current patch)",!
"RTN","NDFPATCH",12,0)
 K DIR S DIR(0)="D",DIR("A")="ENTER START DATE" D ^DIR S NDFS=Y W !
"RTN","NDFPATCH",13,0)
 I $D(DTOUT)!($D(DUOUT)) Q
"RTN","NDFPATCH",14,0)
 K DIR S DIR(0)="D",DIR("A")="ENTER END DATE" D ^DIR S NDFE=Y+.3 W !
"RTN","NDFPATCH",15,0)
 I $D(DTOUT)!($D(DUOUT)) Q
"RTN","NDFPATCH",16,0)
 I NDFS<$$FMADD^XLFDT(DT,-180)!(NDFE>(DT+1)) W !,"DATES OUT OF ACCEPTABLE RANGES" H 2 Q
"RTN","NDFPATCH",17,0)
 ;
"RTN","NDFPATCH",18,0)
 S NDFCL=0 D ^%ZIS S:POP>0 NDFCL=1 D:POP>0 ^%ZISC Q:NDFCL>0
"RTN","NDFPATCH",19,0)
 U IO K ^TMP("NDFAU",$J),^TMP($J) W @IOF
"RTN","NDFPATCH",20,0)
 S LIST="^.01^.05^5^3^1^21^2^15^6^19^8^" ;list of fields
"RTN","NDFPATCH",21,0)
 S NDFAF=$QS($Q(^DIA(50.68,"C",NDFS-.1)),4)-1
"RTN","NDFPATCH",22,0)
 F  S NDFAF=$O(^DIA(50.68,NDFAF)) Q:'NDFAF  S NDFDATA=^(NDFAF,0) Q:$P(NDFDATA,"^",2)>NDFE  D
"RTN","NDFPATCH",23,0)
 .I $P(NDFDATA,"^",3)=.01,$P(NDFDATA,"^",5)="A" S ^TMP($J,+NDFDATA)=""
"RTN","NDFPATCH",24,0)
 .S NDFF=$P(NDFDATA,"^",3) I LIST[("^"_NDFF_"^"),'$D(^TMP($J,+NDFDATA)) S OLD=$G(^DIA(50.68,NDFAF,2)),NEW=$G(^(3)) I OLD'=NEW D
"RTN","NDFPATCH",25,0)
 ..I NDFSORT="F" S ^TMP("NDFAU",$J,$P(^DD(50.68,$P(NDFDATA,"^",3),0),"^"),$P(^PSNDF(50.68,+NDFDATA,0),"^")_"^"_$$FMTE^XLFDT($P($P(NDFDATA,"^",2),"."))_"^"_OLD_"^"_NEW)=""
"RTN","NDFPATCH",26,0)
 ..I NDFSORT="P" S ^TMP("NDFAU",$J,$P(^PSNDF(50.68,+NDFDATA,0),"^"),$P(^DD(50.68,$P(NDFDATA,"^",3),0),"^")_"^"_$$FMTE^XLFDT($P($P(NDFDATA,"^",2),"."))_"^"_OLD_"^"_NEW)=""
"RTN","NDFPATCH",27,0)
PRINT ;
"RTN","NDFPATCH",28,0)
 W !,"The following list contains VA Product changes made between ",!,"       ",$$FMTE^XLFDT(NDFS)," and ",$$FMTE^XLFDT(NDFE),!,NDFBL,!!
"RTN","NDFPATCH",29,0)
 S NA="" F  S NA=$O(^TMP("NDFAU",$J,NA)),DATA="" Q:NA=""  W !,NA,! F  S DATA=$O(^TMP("NDFAU",$J,NA,DATA)) Q:DATA=""  D
"RTN","NDFPATCH",30,0)
 .W !,?5,$P(DATA,"^"),?60,$P(DATA,"^",2),!,?5,"Old Value: ",$P(DATA,"^",3),!,?5,"New Value: ",$P(DATA,"^",4),!
"RTN","NDFPATCH",31,0)
 ;
"RTN","NDFPATCH",32,0)
 ;K DATA,DIR,DTOUT,DUOUT,LIST,NA,NDFDATA,NDFAF,NDFBL,NDFCL,NDFE,NDFF,NDFS,NDFSORT,NEW,OLD,X,Y,^TMP($J),^TMP("NDFAU",$J) D ^%ZISC Q
"RTN","NDFPMI")
0^27^B1454016
"RTN","NDFPMI",1,0)
NDFPMI ;BIR/DMA - LIST OF NEWLY LINKED PRODUCTS ;14 Apr 99 / 2:47 PM
"RTN","NDFPMI",2,0)
 ;;4.0; NDF MANAGEMENT;; 1 Jan 99;Build 1
"RTN","NDFPMI",3,0)
 K ^TMP($J),^TMP("NDF",$J) S DA=0
"RTN","NDFPMI",4,0)
 F  S DA=$O(^NDFK(5000.6,DA)) Q:'DA  I $P(^(DA,0),"^",2) S ^TMP($J,$P(^PSNDF(50.68,DA,0),"^"))=""
"RTN","NDFPMI",5,0)
 Q:'$D(^TMP($J))
"RTN","NDFPMI",6,0)
 S ^TMP("NDF",$J,1)="The following products have been linked to PMI sheets",^(2)=" "
"RTN","NDFPMI",7,0)
 S DA="",J=3 F  S DA=$O(^TMP($J,DA)) Q:DA=""  S ^TMP("NDF",$J,J)=DA,J=J+1
"RTN","NDFPMI",8,0)
 ;
"RTN","NDFPMI",9,0)
 K XMY S XMSUB="NEWLY LINKED PRODUCTS",XMDUZ="NDF MANAGER",XMY(DUZ)="",XMTEXT="^TMP(""NDF"",$J," N DIFROM D ^XMD
"RTN","NDFPMI",10,0)
 K DA,J,XMDUZ,XMSUB,XMTEXT,XMY,^TMP($J),^TMP("NDF",$J) Q
"RTN","NDFPMIL")
0^28^B815117
"RTN","NDFPMIL",1,0)
NDFPMIL ;BIR/DMA-LIST PRODUCTS AND PMIS ; 26 Nov 2007  1:34 PM
"RTN","NDFPMIL",2,0)
 ;;4.0; NDF MANAGEMENT;****; 1 Jan 99;Build 1
"RTN","NDFPMIL",3,0)
 N DA,GNC,NA,NDC,PM
"RTN","NDFPMIL",4,0)
 D ^%ZIS Q:POP
"RTN","NDFPMIL",5,0)
 S DA=0 F  S DA=$O(^PSNDF(50.68,DA)) Q:'DA  S NDC=$P($G(^(DA,1)),"^",7) I NDC]"" S NA=$P(^(0),"^") D
"RTN","NDFPMIL",6,0)
 .S GNC=$O(^PS(50.628,"B",$E(NDC,2,12),0)) I GNC]"" S PM=$P(^PS(50.628,GNC,0),"^",3) I $P(NA," ")'=$P(PM," ") W !,NA,!,?8,PM,!
"RTN","NDFPMIL",7,0)
 K DA,GNC,NA,NDC,PM Q
"RTN","NDFPMIU1")
0^29^B4095282
"RTN","NDFPMIU1",1,0)
NDFPMIU1 ; Birmingham ISC/WRT - print PMIs greater than 200 ; 11 May 98 / 9:05 AM
"RTN","NDFPMIU1",2,0)
 ;;0.0;;;;Build 1
"RTN","NDFPMIU1",3,0)
LENGTH ;FIND ANY LONGER THAN 200
"RTN","NDFPMIU1",4,0)
 D EN^XUTMDEVQ("ENLENGTH^NDFPMIU1","LOOK FOR PMIS LONGER THAN 200") Q
"RTN","NDFPMIU1",5,0)
 ;
"RTN","NDFPMIU1",6,0)
ENLENGTH ;ENTRY FOR LENGTH
"RTN","NDFPMIU1",7,0)
 S (DA,CT,MAX)=0,PG=1,TODAY=$$HTE^XLFDT(+$H) D HEADLENG F  S DA=$O(^PSPPI(DA)) Q:'DA  S X=$P(^(DA,0),"^") I $L(X)>200 S CT=CT+1 W !,DA,?5,X,!,?25,$L(X) I $L(X)>MAX S MAX=$L(X)
"RTN","NDFPMIU1",8,0)
 I CT W !!!,?12,CT," ENTRIES FOUND    THE LONGEST IS ",MAX,!!,"Contact the Maintenance Team Leader before proceeding with the",!,"matching process."
"RTN","NDFPMIU1",9,0)
 I 'CT W !!!,?12,"NO ENTIRES FOUND"
"RTN","NDFPMIU1",10,0)
 D ^%ZISC S ZTREQ="@" Q
"RTN","NDFPMIU1",11,0)
HEADLENG D UNDERDOG W:$Y @IOF W !!,"Medication Sheets with Names Longer than 200 characters",?IOM-20,"Page ",PG,!,?5,"Printed: ",TODAY,!!,"Internal File Number",?40,"Name",!,?32,"Length",!,NDFUL,!! S PG=PG+1 Q
"RTN","NDFPMIU1",12,0)
 ;
"RTN","NDFPMIU1",13,0)
 Q
"RTN","NDFPMIU1",14,0)
UNDERDOG ; create underline
"RTN","NDFPMIU1",15,0)
 S NDFUL="" F MOE=1:1:75 S NDFUL=NDFUL_"="
"RTN","NDFPMIU1",16,0)
 K MOE
"RTN","NDFPMIU1",17,0)
 Q
"RTN","NDFPMIUP")
0^30^B82005235
"RTN","NDFPMIUP",1,0)
NDFPMIUP ;BIRM/WRT/TTH - load in usp stuf into temporary global;16 Feb 99 / 2:13 PM
"RTN","NDFPMIUP",2,0)
 ;;0.0;PATIENT MEDICATION INFORMATION SHEET - UPDATE;;;Build 1
"RTN","NDFPMIUP",3,0)
START ; Begin update process
"RTN","NDFPMIUP",4,0)
 W !!,"This process will take approximately two hours. Upon completion, the following",!,"reports can be generated."
"RTN","NDFPMIUP",5,0)
 W !!,"1. List of new Medication Information Sheets",!,"2. List of Changed Medication Information Sheets",!,"3. List of VA Products Linked to Deleted Medication Information Sheets"
"RTN","NDFPMIUP",6,0)
 W !!!,"Before running this option, you should have installed the most recent PMI",!,"update from the commercial source."
"RTN","NDFPMIUP",7,0)
 W ! S DIR("A")="Are you sure you are ready to proceed? "
"RTN","NDFPMIUP",8,0)
 S DIR("B")="NO",DIR(0)="YA" D ^DIR K DIR I $D(DTOUT)!$D(DUOUT) Q
"RTN","NDFPMIUP",9,0)
 I Y=0 Q
"RTN","NDFPMIUP",10,0)
 D LOAD,SETZERO,DELETED,GETIT,LOSTONES
"RTN","NDFPMIUP",11,0)
 Q
"RTN","NDFPMIUP",12,0)
 ;
"RTN","NDFPMIUP",13,0)
 ;
"RTN","NDFPMIUP",14,0)
LOAD ;
"RTN","NDFPMIUP",15,0)
 W !!!,"Setting up utility globals ^ZZRAND and ^ZZCOPY."
"RTN","NDFPMIUP",16,0)
 I $D(^ZZRAND) F XX=0:0 S XX=$O(^ZZRAND(XX)) Q:'XX  K ^ZZRAND(XX)
"RTN","NDFPMIUP",17,0)
 I $D(^ZZRAND1) F XX=0:0 S XX=$O(^ZZRAND1(XX)) Q:'XX  K ^ZZRAND1(XX)
"RTN","NDFPMIUP",18,0)
 ;I $D(^ZZCOPY) F XX=0:0 S XX=$O(^ZZCOPY(XX)) Q:'XX  K ^ZZCOPY(XX)
"RTN","NDFPMIUP",19,0)
 ;I $D(^ZYXWVUT) F XX=0:0 S XX=$O(^ZYXWVUT(XX)) Q:'XX  K ^ZYXWVUT(XX)
"RTN","NDFPMIUP",20,0)
NAMES S Y=$$FTG^%ZISH("USER$:[PMIS]","VAMIS.DAT",$NA(^ZZRAND(1)),1)
"RTN","NDFPMIUP",21,0)
 S Y=$$FTG^%ZISH("USER$:[PMIS]","VATITLE.DAT",$NA(^ZZRAND1(1)),1)
"RTN","NDFPMIUP",22,0)
 S Y=$$FTG^%ZISH("USER$:[PMIS]","VACOPY.DAT",$NA(^ZZCOPY(1)),1)
"RTN","NDFPMIUP",23,0)
 S Y=$$FTG^%ZISH("USER$:[PMIS]","VADELETE.DAT",$NA(^ZYXWVUT(1)),1)
"RTN","NDFPMIUP",24,0)
 Q
"RTN","NDFPMIUP",25,0)
 ;
"RTN","NDFPMIUP",26,0)
DELETED ;
"RTN","NDFPMIUP",27,0)
 W !!,"Processing list of deleted Medication Information Sheets."
"RTN","NDFPMIUP",28,0)
 I $D(^DEL597) F XX=0:0 S XX=$O(^DEL597(XX)) Q:'XX  K ^DEL597(XX)
"RTN","NDFPMIUP",29,0)
 S X="" F  S X=$O(^ZYXWVUT(X)) Q:'X  S D=^(X),^DEL597(D)=D
"RTN","NDFPMIUP",30,0)
 I $D(^ZYXWVUT) F XX=0:0 S XX=$O(^ZYXWVUT(XX)) Q:'XX  K ^ZYXWVUT(XX)
"RTN","NDFPMIUP",31,0)
 Q
"RTN","NDFPMIUP",32,0)
 ;
"RTN","NDFPMIUP",33,0)
GETIT ;MOVE FROM ZZRAND TO DIZ(521010.7 AND PPIDRG
"RTN","NDFPMIUP",34,0)
 W !!,"Loading incoming PMI text into ^DIZ(521010.7) and product info into ^PPIDRG."
"RTN","NDFPMIUP",35,0)
 K SPEC S SPEC("==")="",SPEC("//")=""
"RTN","NDFPMIUP",36,0)
 S IND=0 F  S IND=$O(^ZZRAND(IND)) Q:'IND  S X=^(IND),DA=+X,LAN=$P(X,"^",3),DATA=$$REPLACE^XLFSTR($P(X,"^",4,40),.SPEC) I IND]"",LAN]"" D
"RTN","NDFPMIUP",37,0)
 .I LAN'="D" S DA1=$S(LAN="E1":1,LAN="E2":2,LAN="EA":3,LAN="S1":4,LAN="S2":5,LAN="SA":6),DA2=$O(^DIZ(521010.7,DA,DA1," "),-1)+1,^DIZ(521010.7,DA,DA1,DA2,0)=DATA
"RTN","NDFPMIUP",38,0)
 .I LAN="D" S A=$P(X,"^",4),B=$P(X,"^",5),DA=+X D
"RTN","NDFPMIUP",39,0)
 ..S DA1=$O(^PPIDRG(DA,1,"B",A,0)) I 'DA1 S DA1=$O(^PPIDRG(DA,1," "),-1)+1,^PPIDRG(DA,1,DA1,0)=A,^PPIDRG(DA,1,"B",A,DA1)=""
"RTN","NDFPMIUP",40,0)
 ..S DA2=$O(^PPIDRG(DA,1,DA1,2,"B",B,0)) I 'DA2 S DA2=$O(^PPIDRG(DA,1,DA1,2," "),-1)+1,^(DA2,0)=B,^PPIDRG(DA,1,DA1,2,"B",B,DA2)=""
"RTN","NDFPMIUP",41,0)
 Q
"RTN","NDFPMIUP",42,0)
 ;
"RTN","NDFPMIUP",43,0)
SETZERO ;
"RTN","NDFPMIUP",44,0)
 W !!,"Setting zero node for file 521010.7 and ^PPIDRG"
"RTN","NDFPMIUP",45,0)
 K ^DIZ(521010.7) S IND="" F  S IND=$O(^ZZRAND1(IND)) Q:IND=""  S X=^(IND),DA=+X,^DIZ(521010.7,DA,0)=$P(X,"^",2,22),^PPIDRG(DA,0)=$P(X,"^",2,22),^PPIDRG("B",$P(X,"^",2),DA)=""
"RTN","NDFPMIUP",46,0)
 S ^DIZ(521010.7,0)=^DIC(521010.7,0)
"RTN","NDFPMIUP",47,0)
 ;NOW UPDATE COPYRIGHT
"RTN","NDFPMIUP",48,0)
 K ^PSPPI(.5) S ^PSPPI(.5,0)="DISCLAIMER/COPYRIGHT",X=0
"RTN","NDFPMIUP",49,0)
 F  S X=$O(^ZZCOPY(X)) Q:'X  S D=^(X),N=$P(D,"^"),S=$P(D,"^",3),ARG=$S(N=1:S="IC"+1,1:S="IC"+2),DA=$O(^PSPPI(.5,ARG," "),-1)+1,^PSPPI(.5,ARG,DA,0)=$TR($P(D,"^",4,200),"=/*")
"RTN","NDFPMIUP",50,0)
 Q
"RTN","NDFPMIUP",51,0)
 ;
"RTN","NDFPMIUP",52,0)
 ;
"RTN","NDFPMIUP",53,0)
LOSTONES ;
"RTN","NDFPMIUP",54,0)
 ; new file structure change
"RTN","NDFPMIUP",55,0)
 W !!,"Creating the global ^ZGONE."
"RTN","NDFPMIUP",56,0)
 I $D(^ZGONE) F XX=0:0 S XX=$O(^ZGONE(XX)) Q:'XX  K ^ZGONE(XX)
"RTN","NDFPMIUP",57,0)
 S DA=0 F  S DA=$O(^PSNDF(50.68,DA)) Q:'DA  S A=$P($G(^PSNDF(50.68,DA,1)),"^",5) I A,$D(^DEL597(A)) S ^ZGONE(DA)=""
"RTN","NDFPMIUP",58,0)
 Q
"RTN","NDFPMIUP",59,0)
 ;
"RTN","NDFPMIUP",60,0)
COMP ;CHECK OLD NAMES AGAINST NEW ONES
"RTN","NDFPMIUP",61,0)
 D UNDERDOG
"RTN","NDFPMIUP",62,0)
 D EN^XUTMDEVQ("COMP1^NDFPMIUP","Changed PMIs") Q
"RTN","NDFPMIUP",63,0)
 ;
"RTN","NDFPMIUP",64,0)
COMP1 K ^TMP($J) S DA=0 F  S DA=$O(^PSPPI(DA)) Q:'DA  S X=^(DA,0) I $D(^DIZ(521010.7,DA)),^(DA,0)'=X S ^TMP($J,X_"^"_DA)=""
"RTN","NDFPMIUP",65,0)
 D UNDERDOG
"RTN","NDFPMIUP",66,0)
 ;
"RTN","NDFPMIUP",67,0)
 S PG=1 D HEADCOMP S X="" F  S X=$O(^TMP($J,X)) Q:X=""  W !," ",$P(X,"^",3),?9,$P(X,"^"),!,?12,$P(^DIZ(521010.7,$P(X,"^",3),0),"^") I $Y+4>IOSL D HEADCOMP
"RTN","NDFPMIUP",68,0)
 D ^%ZISC S ZTREQ="@" Q
"RTN","NDFPMIUP",69,0)
 ;
"RTN","NDFPMIUP",70,0)
HEADCOMP W:$Y @IOF W !,"PMIs with Changed Names",?(IOM-15),"Page ",PG,!,"Printed: ",$$HTE^XLFDT(+$H),!!,?5,"OLD NAME",!,?12,"NEW NAME",!,NDFUL,! Q
"RTN","NDFPMIUP",71,0)
 Q
"RTN","NDFPMIUP",72,0)
 ;
"RTN","NDFPMIUP",73,0)
ADD ;ADDED PMIS
"RTN","NDFPMIUP",74,0)
 D EN^XUTMDEVQ("ADD1^NDFPMIUP","NEW PMIS") Q
"RTN","NDFPMIUP",75,0)
 ;
"RTN","NDFPMIUP",76,0)
ADD1 D UNDERDOG K ^TMP($J) S DA=$O(^PSPPI(" "),-1) F  S DA=$O(^PPIDRG(DA)),K=0 Q:'DA  F  S K=$O(^PPIDRG(DA,1,K)) Q:'K  S X=$P(^(K,0),"^"),^TMP($J,X_"^"_DA)=""
"RTN","NDFPMIUP",77,0)
 ;
"RTN","NDFPMIUP",78,0)
 S PG=1 D HEADADD S X="" F  S X=$O(^TMP($J,X)) Q:X=""  W !,?5,$P(X,"^",2),?12,$P(X,"^") I $Y+4>IOSL D HEADADD
"RTN","NDFPMIUP",79,0)
 S ZTREQ="@" Q
"RTN","NDFPMIUP",80,0)
 ;
"RTN","NDFPMIUP",81,0)
HEADADD W:$Y @IOF W !,"Added Medication Information Sheets",?(IOM-15),"Page ",PG,!,"Printed: ",$$HTE^XLFDT(+$H),!,NDFUL,! S PG=PG+1 Q
"RTN","NDFPMIUP",82,0)
 ;
"RTN","NDFPMIUP",83,0)
DEL ;DELETED PMIS
"RTN","NDFPMIUP",84,0)
 D UNDERDOG
"RTN","NDFPMIUP",85,0)
 D EN^XUTMDEVQ("DEL1^NDFPMIUP","DELETED PMIS") Q
"RTN","NDFPMIUP",86,0)
 ;
"RTN","NDFPMIUP",87,0)
DEL1 K ^TMP($J) S DA=0 F  S DA=$O(^DEL597(DA)) Q:'DA  S X=^PSPPI(DA,0),^TMP($J,X_"^"_DA)=""
"RTN","NDFPMIUP",88,0)
 ;
"RTN","NDFPMIUP",89,0)
 S PG=1 D HEADDEL S X="" F  S X=$O(^TMP($J,X)) Q:X=""  W !,?5,$P(X,"^",3),?12,$P(X,"^") I $Y+4>IOSL D HEADDEL
"RTN","NDFPMIUP",90,0)
 S ZTREQ="@" D ^%ZISC Q
"RTN","NDFPMIUP",91,0)
 ;
"RTN","NDFPMIUP",92,0)
HEADDEL W:$Y @IOF W !,"Deleted Medication Information Sheets",?(IOM-15),"Page ",PG,!,"Printed: ",$$HTE^XLFDT(+$H),!,NDFUL,! S PG=PG+1 Q
"RTN","NDFPMIUP",93,0)
 ;
"RTN","NDFPMIUP",94,0)
 ;
"RTN","NDFPMIUP",95,0)
VAPN ;VAPN that are attached to deleted PMIs
"RTN","NDFPMIUP",96,0)
 D EN^XUTMDEVQ("VAPN1^NDFPMIUP","PRODUCT NAME LIST") Q
"RTN","NDFPMIUP",97,0)
 ;
"RTN","NDFPMIUP",98,0)
VAPN1 ;
"RTN","NDFPMIUP",99,0)
 ;
"RTN","NDFPMIUP",100,0)
 D UNDERDOG
"RTN","NDFPMIUP",101,0)
 K ^TMP($J) S DA=0 F  S DA=$O(^ZGONE(DA)) Q:'DA  S X=$P(^PSNDF(50.68,DA,1),"^",5),^TMP($J,X_"^"_DA)=""
"RTN","NDFPMIUP",102,0)
 ;
"RTN","NDFPMIUP",103,0)
 S PG=1 D HEADVAPN S X="" F  S X=$O(^TMP($J,X)) Q:X=""  W !!,"PMI Entry: "_$P(X,"^"),!,$P(X,"^",2)_":",?10,$P(^PSNDF(50.68,$P(X,"^",2),0),"^") I $Y+4>IOSL D HEADVAPN
"RTN","NDFPMIUP",104,0)
 S ZTREQ="@" D ^%ZISC Q
"RTN","NDFPMIUP",105,0)
 ;
"RTN","NDFPMIUP",106,0)
HEADVAPN W:$Y @IOF W !,"VA Products Connected to Deleted Medication Information Sheets",?(IOM-15),"Page ",PG,!,"Printed: ",$$HTE^XLFDT(+$H),!,NDFUL,! S PG=PG+1 Q
"RTN","NDFPMIUP",107,0)
 ;
"RTN","NDFPMIUP",108,0)
CUR ;ALL CURRENT PMIS
"RTN","NDFPMIUP",109,0)
 D EN^XUTMDEVQ("CUR1^NDFPMIUP","PMI list") Q
"RTN","NDFPMIUP",110,0)
 ;
"RTN","NDFPMIUP",111,0)
CUR1 D UNDERDOG K ^TMP($J) S DA=.9 F  S DA=$O(^DIZ(521010.7,DA)) Q:'DA  S X=^(DA,0),^TMP($J,X_"^"_DA)=""
"RTN","NDFPMIUP",112,0)
 ;
"RTN","NDFPMIUP",113,0)
 S PG=1 D HEADCUR S X="" F  S X=$O(^TMP($J,X)) Q:X=""  W !," ",$P(X,"^",3),?12,$P(X,"^") I $Y+4>IOSL D HEADCUR
"RTN","NDFPMIUP",114,0)
 S ZTREQ="@" D ^%ZISC Q
"RTN","NDFPMIUP",115,0)
 ;
"RTN","NDFPMIUP",116,0)
HEADCUR W:$Y @IOF W !,"Current Medication Information Sheets",?(IOM-15),"Page ",PG,!,"Printed: ",$$HTE^XLFDT(+$H),!,NDFUL,! S PG=PG+1 Q
"RTN","NDFPMIUP",117,0)
 ;
"RTN","NDFPMIUP",118,0)
MAP ; update official PMI files
"RTN","NDFPMIUP",119,0)
 W !!,"Prior to using this option, you should have run the option Install Commercial",!,"Data into Utility Files, and reviewed the reports listing PMI updates."
"RTN","NDFPMIUP",120,0)
 W !!,"Be sure that the options to link to Medication Information Sheets are disabled",!,"prior to running this process."
"RTN","NDFPMIUP",121,0)
 W ! S DIR("A")="Are you sure you are ready to proceed? "
"RTN","NDFPMIUP",122,0)
 S DIR("B")="NO",DIR(0)="YA" D ^DIR K DIR I $D(DTOUT)!$D(DUOUT) Q
"RTN","NDFPMIUP",123,0)
 I Y=0 Q
"RTN","NDFPMIUP",124,0)
MONTALI ;
"RTN","NDFPMIUP",125,0)
 D UNMARK,DELETE,MERGE,PPINAME
"RTN","NDFPMIUP",126,0)
 Q
"RTN","NDFPMIUP",127,0)
 ;
"RTN","NDFPMIUP",128,0)
UNMARK ;UNMARK ENTRIES MAPPED TO DELETED PMIS AND STORE DA(1) AND DA IN ^DELETED
"RTN","NDFPMIUP",129,0)
 I $D(^DELETED) F XX=0:0 S XX=$O(^DELETED(XX)) Q:'XX  K ^DELETED(XX)
"RTN","NDFPMIUP",130,0)
 W !!,"Updating entries in the VA PRODUCT NAME file that are linked to deleted PMIs.",!!,"The following entries have been unlinked."
"RTN","NDFPMIUP",131,0)
 S PSNVAP=0 F  S PSNVAP=$O(^PSNDF(50.68,PSNVAP)) Q:'PSNVAP  S PSNPPI=$P($G(^PSNDF(50.68,PSNVAP,1)),"^",5) I PSNPPI,$D(^DEL597(PSNPPI)) D 
"RTN","NDFPMIUP",132,0)
 .W !,PSNVAP_":",?10,$P(^PSNDF(50.68,PSNVAP,0),"^")
"RTN","NDFPMIUP",133,0)
 .K DIE,DR,DA S DA=PSNVAP,DIE=50.68,DR="11///@;12///@" D ^DIE K DIE,DR,DA
"RTN","NDFPMIUP",134,0)
 .K DA,DIC,DD,DO,DINUM S X=PSNVAP,DINUM=X,DIC(0)="L",DIC="^NDFK(5000.6,",DLAYGO=5000.6 D FILE^DICN K X,DIC,DLAYGO,DINUM,DD,DO
"RTN","NDFPMIUP",135,0)
 .S X=$O(^DELETED(" "),-1)+1,^DELETED(X)=PSNVAP
"RTN","NDFPMIUP",136,0)
 Q
"RTN","NDFPMIUP",137,0)
 ;
"RTN","NDFPMIUP",138,0)
DELETE ;BLOW AWAY THE PMIS
"RTN","NDFPMIUP",139,0)
 ;
"RTN","NDFPMIUP",140,0)
 W !!,"Removing deleted Medication Information Sheets from the MEDICATION",!,"INSTRUCTION SHEETS file (54.7)."
"RTN","NDFPMIUP",141,0)
 S U="^",ZZ=0 F  S ZZ=$O(^DEL597(ZZ)) Q:'ZZ  S DA=ZZ,DIK="^PSPPI(" D ^DIK  K DIK,DIAU
"RTN","NDFPMIUP",142,0)
 S U="^",ZZ=0 F  S ZZ=$O(^DEL597(ZZ)) Q:'ZZ  S DA=ZZ,DIK="^PPIDRG(" D ^DIK  K DIK,DIAU
"RTN","NDFPMIUP",143,0)
 Q
"RTN","NDFPMIUP",144,0)
 ;
"RTN","NDFPMIUP",145,0)
MERGE ;FROM DIZ(521010.7 TO PSPPI
"RTN","NDFPMIUP",146,0)
 W !!,"Moving data into the MEDICATION INSTRUCTION SHEETS file (54.7)."
"RTN","NDFPMIUP",147,0)
 S DA=0 F  S DA=$O(^DIZ(521010.7,DA)) Q:'DA  K ^PSPPI(DA) M ^PSPPI(DA)=^DIZ(521010.7,DA)
"RTN","NDFPMIUP",148,0)
 ;SET ZERO NODE
"RTN","NDFPMIUP",149,0)
 S LAST=$O(^PSPPI(" "),-1),DA=0 F TOT=0:1 S DA=$O(^PSPPI(DA)) Q:'DA
"RTN","NDFPMIUP",150,0)
 S $P(^PSPPI(0),"^",3,4)=LAST_"^"_TOT
"RTN","NDFPMIUP",151,0)
 Q
"RTN","NDFPMIUP",152,0)
 ;
"RTN","NDFPMIUP",153,0)
NEWMATCH ;find new matches
"RTN","NDFPMIUP",154,0)
 W !!,"This option no longer works",!! Q
"RTN","NDFPMIUP",155,0)
 ;this compares against ^PSNDF in BIL,NDF
"RTN","NDFPMIUP",156,0)
 ;this may change from release to release
"RTN","NDFPMIUP",157,0)
 ;
"RTN","NDFPMIUP",158,0)
 D EN^XUTMDEVQ("NEWMTCH^NDFPMIUP","NEWLY MATCHED PRODUCTS") Q
"RTN","NDFPMIUP",159,0)
 ;
"RTN","NDFPMIUP",160,0)
NEWMTCH K ^TMP($J)
"RTN","NDFPMIUP",161,0)
 S DA=0 F  S DA=$O(^PSNDF(DA)),DA1=0 Q:'DA  F  S DA1=$O(^PSNDF(DA,5,DA1)) Q:'DA1  S X=^(DA1,0) I $P(X,"^",7),'$P($G(^["BIL"]PSNDF(DA,5,DA1,0)),"^",7) S ^TMP($J,$P(X,"^")_"^"_DA_"^"_DA1)=""
"RTN","NDFPMIUP",162,0)
 S PG=1 D HEADNEW
"RTN","NDFPMIUP",163,0)
 S X="" F  S X=$O(^TMP($J,X)) Q:X=""  W !,?5,$P(X,"^") I $Y+4>IOSL D HEADNEW
"RTN","NDFPMIUP",164,0)
 D ^%ZISC S ZTREQ="@" K ^TMP($J) Q
"RTN","NDFPMIUP",165,0)
 ;
"RTN","NDFPMIUP",166,0)
HEADNEW W:$Y @IOF W !,"VA products newly matched to PMIs",?(IOM-15),"PAGE ",PG,!,"printed on ",$$HTE^XLFDT(+$H),! S PG=PG+1 Q
"RTN","NDFPMIUP",167,0)
 ;
"RTN","NDFPMIUP",168,0)
 ;
"RTN","NDFPMIUP",169,0)
 ;
"RTN","NDFPMIUP",170,0)
PPINAME ;build ^PPINAME from ^PPIDRG
"RTN","NDFPMIUP",171,0)
 S A=^PPINAME(0)
"RTN","NDFPMIUP",172,0)
 K ^PPINAME(0),^PPINAME("B"),^PPINAME("C"),^PPINAME("D") S X="" F  S X=$O(^PPINAME(X)) Q:'X  K ^PPINAME(X)
"RTN","NDFPMIUP",173,0)
 H 20 S ^PPINAME(0)=$P(A,"^",1,2)
"RTN","NDFPMIUP",174,0)
 S DA=0 F  S DA=$O(^PPIDRG(DA)),DA1=0 Q:'DA  F  S DA1=$O(^PPIDRG(DA,1,DA1)),DA2=0  Q:'DA1  S X=$P(^(DA1,0),"^"),IND=$O(^PPINAME(" "),-1)+1,^PPINAME(IND,0)=X_"^"_DA_"^"_DA1 D
"RTN","NDFPMIUP",175,0)
 .S ^PPINAME("C",X,IND)="",^PPINAME("B",X,IND)="",^PPINAME("D",$$UP^XLFSTR(X),IND)=""
"RTN","NDFPMIUP",176,0)
 .F  S DA2=$O(^PPIDRG(DA,1,DA1,2,DA2)) Q:'DA2  S X=$P(^(DA2,0),"^"),IND1=$O(^PPINAME(IND,1," "),-1)+1,^PPINAME(IND,1,IND1,0)=X
"RTN","NDFPMIUP",177,0)
 Q
"RTN","NDFPMIUP",178,0)
 ;
"RTN","NDFPMIUP",179,0)
 ;
"RTN","NDFPMIUP",180,0)
LIST ;OF VA PRODUCTS ATTACHED TO PMI
"RTN","NDFPMIUP",181,0)
 D EN^XUTMDEVQ("ENLIST^NDFPMIUP","LIST OF VA PRODUCTS WITH PMIS") Q
"RTN","NDFPMIUP",182,0)
 ;
"RTN","NDFPMIUP",183,0)
ENLIST ;
"RTN","NDFPMIUP",184,0)
 D UNDERDOG
"RTN","NDFPMIUP",185,0)
 K ^TMP($J) S DA=0 F  S DA=$O(^PSNDF(DA)),K=0 Q:'DA  F  S K=$O(^PSNDF(DA,5,K)) Q:'K  S X=^(K,0) I $P(X,"^",7) S ^TMP($J,$P(X,"^")_"^"_DA_"^"_K)=""
"RTN","NDFPMIUP",186,0)
 S PG=1,TODAY=$$HTE^XLFDT(+$H) D HEADLIST
"RTN","NDFPMIUP",187,0)
 S X="" F  S X=$O(^TMP($J,X)) Q:X=""  W !,?5,$P(X,"^") I $Y+4>IOSL D HEADLIST
"RTN","NDFPMIUP",188,0)
 D ^%ZISC K ^TMP($J) S ZTREQ="@" Q
"RTN","NDFPMIUP",189,0)
 ;
"RTN","NDFPMIUP",190,0)
HEADLIST W:$Y @IOF W !!,"VA Products Associated with a PMI Sheet",?IOM-15,"Page ",PG,!,"Printed: ",TODAY,!,NDFUL,! S PG=PG+1 Q
"RTN","NDFPMIUP",191,0)
 ;
"RTN","NDFPMIUP",192,0)
 Q
"RTN","NDFPMIUP",193,0)
UNDERDOG ; create underline
"RTN","NDFPMIUP",194,0)
 S NDFUL="" F MOE=1:1:75 S NDFUL=NDFUL_"="
"RTN","NDFPMIUP",195,0)
 K MOE
"RTN","NDFPMIUP",196,0)
 Q
"RTN","NDFPODDI")
0^31^B9408679
"RTN","NDFPODDI",1,0)
NDFPODDI ;BIR/WRT-Print report from Don's List that will potentially be marked for NO DDI check ; 05/21/03 14:22
"RTN","NDFPODDI",2,0)
 ;;4.0; NDF MANAGEMENT;; 1 Jan 99;Build 1
"RTN","NDFPODDI",3,0)
 W !!,"This report will list VA Products from Don's Exclude DDIs List that will",!,"potentially be marked. Information included in this",!,"report is the Dose Form, VA Drug Class, and VA Generic."
"RTN","NDFPODDI",4,0)
 W !,"You may queue the report to print, if you wish.",!
"RTN","NDFPODDI",5,0)
DVC K %ZIS,POP,IOP S %ZIS="QM",%ZIS("B")="",%ZIS("A")="Select Printer: " D ^%ZIS G:POP DONE W:$E(IOST)'="P" !!,"This report must be run on a printer.",!! G:$E(IOST)'="P" DVC I POP K IOP,POP,IO("Q") Q
"RTN","NDFPODDI",6,0)
QUEUE I $D(IO("Q")) K IO("Q") S ZTRTN="ENQ^NDFPODDI",ZTDESC="VA Products from Don's List that potentially be marked (No DDI check) Report" D ^%ZTLOAD K ZTSK D ^%ZISC Q
"RTN","NDFPODDI",7,0)
ENQ ;ENTRY POINT WHEN QUEUED
"RTN","NDFPODDI",8,0)
 U IO
"RTN","NDFPODDI",9,0)
 S PSNPGCT=0,PSNPGLNG=IOSL-6,PSNPRT=0 D TITLE,LOOP1
"RTN","NDFPODDI",10,0)
DONE I $D(PSNPRT) W:PSNPRT=0 !!?10,"No Entries Found"
"RTN","NDFPODDI",11,0)
 W @IOF S:$D(ZTQUEUED) ZTREQ="@" K PSNPRT,PSNB,CODE,CL,CLS,DF,DFM,GN,NODE,VA,NAME,CLSDA,WRT,MJT,PSNPGCT,PSNPGLNG,Y,IOP,POP,IO("Q") D ^%ZISC
"RTN","NDFPODDI",12,0)
 Q
"RTN","NDFPODDI",13,0)
TITLE I $D(IOF),IOF]"" W @IOF S PSNPGCT=PSNPGCT+1
"RTN","NDFPODDI",14,0)
 W !,?3,"VA Products from Don's list that will potentially be marked for NO DDI check",!
"RTN","NDFPODDI",15,0)
 S Y=DT X ^DD("DD") W !,?3,"Date printed: ",Y,?55,"Page: ",PSNPGCT,!
"RTN","NDFPODDI",16,0)
 W !,"VA PRODUCT",?65,"DOSE FORM",!,"VA GENERIC",?65,"VA CLASS",!,"INACTIVE DATE",!
"RTN","NDFPODDI",17,0)
 F MJT=1:1:80 W "-"
"RTN","NDFPODDI",18,0)
 Q
"RTN","NDFPODDI",19,0)
LOOP1 S NAME="" F WRT=0:0 S NAME=$O(^DONLIST1("B",NAME)) Q:NAME=""  F PSNB=0:0 S PSNB=$O(^DONLIST1("B",NAME,PSNB)) Q:'PSNB  D GETDAT
"RTN","NDFPODDI",20,0)
 Q
"RTN","NDFPODDI",21,0)
GETDAT S NODE=^PSNDF(50.68,PSNB,0),GN=$P(NODE,"^",2),DF=$P(NODE,"^",3),CL=$P($G(^PSNDF(50.68,PSNB,3)),"^"),VA=$P($G(^PSNDF(50.6,GN,0)),"^"),DFM=$P($G(^PS(50.606,DF,0)),"^"),CLS=$P($G(^PS(50.605,CL,0)),"^") D REPRT
"RTN","NDFPODDI",22,0)
 Q
"RTN","NDFPODDI",23,0)
INACT S DATE=$P($G(^PSNDF(50.68,PSNB,7)),"^",3)
"RTN","NDFPODDI",24,0)
 Q
"RTN","NDFPODDI",25,0)
REPRT D:$Y>PSNPGLNG TITLE W !!,NAME,?65,DFM,!,VA,?65,CLS S PSNPRT=1
"RTN","NDFPODDI",26,0)
 D:$Y>PSNPGLNG TITLE I $G(DATE) S Y=DATE X ^DD("DD") W !,Y
"RTN","NDFPODDI",27,0)
 Q
"RTN","NDFPPRT")
0^32^B16485469
"RTN","NDFPPRT",1,0)
NDFPPRT ;BIR/DMA NEW REPORT ; 25 Jul 2007  11:13 AM
"RTN","NDFPPRT",2,0)
 ;;4.0; NDF MANAGEMENT;; 16 April 03;Build 1
"RTN","NDFPPRT",3,0)
 ;
"RTN","NDFPPRT",4,0)
 W !!,"This report has been replaced with VA Product Changes Report.",!! Q
"RTN","NDFPPRT",5,0)
 ;NDFACK = person entering change
"RTN","NDFPPRT",6,0)
 ;NDFAF1=audit file change product file IEN
"RTN","NDFPPRT",7,0)
 ;NDFAF2=audit file change product file subfile IEN
"RTN","NDFPPRT",8,0)
 ;NDFAF0=the data at the 0 node of the audit file
"RTN","NDFPPRT",9,0)
 ;NDFAF=IEN of audit file, NDFBL = line separater
"RTN","NDFPPRT",10,0)
 ;NDFCFDT=date field was changed, NDFCKD=check date for dates enteries
"RTN","NDFPPRT",11,0)
 ;NDFCL = flag for closing open device, NDFE=ending date for report
"RTN","NDFPPRT",12,0)
 ;NDFEP=printable end date, NDFF1=NDF audit file #s
"RTN","NDFPPRT",13,0)
 ;NDFF2=VA product file #, NDFFT=first time flag, NDF1=counter
"RTN","NDFPPRT",14,0)
 ;NDF2=todays date, NDFFNC=field number that was changed
"RTN","NDFPPRT",15,0)
 ;NDFFNS=subfile field # that was changed, NDFDNM=drug name
"RTN","NDFPPRT",16,0)
 ;NDFINM=drug ingredient name, NDFF3=hold for IEN from product file
"RTN","NDFPPRT",17,0)
 ;NDFLC=printed line count, NDFD1=drug name, NDFN=new value of field
"RTN","NDFPPRT",18,0)
 ;NDFF4=product file IEN from the NDF audit files
"RTN","NDFPPRT",19,0)
 ;NDFO=old value of field, NDFPG=page number count
"RTN","NDFPPRT",20,0)
 ;NDFOT=$O sequence variable for TMP file used in sorting
"RTN","NDFPPRT",21,0)
 ;NDFON=$O sequence variable for NDF audit files
"RTN","NDFPPRT",22,0)
 ;NDFS=starting date for the report, NDFSP=printable start date
"RTN","NDFPPRT",23,0)
 ;
"RTN","NDFPPRT",24,0)
 W @IOF
"RTN","NDFPPRT",25,0)
 N NDFAF1,NDFAF2,NDFAF0,NDFAF,NDFBL,NDFCFDT,NDFCKD,NDFCL,NDFE,NDFEP,NDFF1,NDFF2,NDFFT,NDF1,NDF2,NDFFNC,NDFFNS,NDFDNM,NDFINM,NDFF3,NDFD1,NDFN,NDFF4,NDFO,NDFPG,NDFOT,NDFON,NDFS,NDFSP
"RTN","NDFPPRT",26,0)
 S %H=$H D YX^%DTC S NDF2=Y,NDFBL="" F NDF1=1:1:75 S NDFBL=NDFBL_"-"
"RTN","NDFPPRT",27,0)
 ;
"RTN","NDFPPRT",28,0)
 W "START DATE (Corresponding to the start of entering data for the current patch)",!
"RTN","NDFPPRT",29,0)
 K DIR S DIR(0)="D",DIR("A")="ENTER START DATE" D ^DIR S NDFS=Y W !
"RTN","NDFPPRT",30,0)
 I $D(DTOUT)!($D(DUOUT)) Q
"RTN","NDFPPRT",31,0)
 W !,"END DATE of today (no date can be less than 180 days from today, as the report",!,"uses current patch data files).",!
"RTN","NDFPPRT",32,0)
 K DIR S DIR(0)="D",DIR("A")="ENTER END DATE" D ^DIR S NDFE=Y W !
"RTN","NDFPPRT",33,0)
 I $D(DTOUT)!($D(DUOUT)) Q
"RTN","NDFPPRT",34,0)
 S %H=$H-180 D YMD^%DTC S NDFCKD=X
"RTN","NDFPPRT",35,0)
 I NDFS<NDFCKD!(NDFE>DT) W !,"DATES OUT OF ACCEPTABLE RANGES" H 2 Q
"RTN","NDFPPRT",36,0)
 S Y=NDFS D DD^%DT S NDFSP=Y,Y=NDFE D DD^%DT S NDFEP=Y
"RTN","NDFPPRT",37,0)
 ;
"RTN","NDFPPRT",38,0)
 S NDFCL=0 D ^%ZIS S:POP>0 NDFCL=1 D:POP>0 ^%ZISC Q:NDFCL>0
"RTN","NDFPPRT",39,0)
 U IO S NDFF2=50.68 K ^TMP("NDFAU",$J) W @IOF
"RTN","NDFPPRT",40,0)
 S NDFPG=1,NDFLC=0,NDFF3=0,NDFMRN=0,NDFAF1=1,NDFFT=1 D HEAD
"RTN","NDFPPRT",41,0)
 F NDFF1=5000.2,5000.4,5000.5,5000.7,5000.507,5000.9 D EDIT
"RTN","NDFPPRT",42,0)
 D EDIT1 K ^TMP("NDFAU",$J)
"RTN","NDFPPRT",43,0)
 D ^%ZISC
"RTN","NDFPPRT",44,0)
 Q
"RTN","NDFPPRT",45,0)
 ;
"RTN","NDFPPRT",46,0)
EDIT S NDFON=0 F  S NDFON=$O(^NDFK(NDFF1,NDFON)) Q:'NDFON  S NDFF4=^(NDFON,0),NDFD1=$$GET1^DIQ(NDFF2,NDFF4,.01),^TMP("NDFAU",$J,NDFD1)=NDFF4
"RTN","NDFPPRT",47,0)
 Q
"RTN","NDFPPRT",48,0)
 ;
"RTN","NDFPPRT",49,0)
EDIT1 S NDFOT="" F  S NDFOT=$O(^TMP("NDFAU",$J,NDFOT)) Q:NDFOT=""  S NDFMRN=^(NDFOT),NDFFT=1 D AUDIT
"RTN","NDFPPRT",50,0)
 Q
"RTN","NDFPPRT",51,0)
 ;
"RTN","NDFPPRT",52,0)
AUDIT S NDFAF=0 F  S NDFAF=$O(^DIA(50.68,NDFAF)) Q:'NDFAF  S NDFAF0=$G(^DIA(50.68,NDFAF,0)),NDFAF1=$P(NDFAF0,U),NDFCFDT=$P($P(NDFAF0,U,2),".") I +NDFAF1=+NDFMRN I NDFCFDT'<NDFS&(NDFCFDT'>NDFE) D 
"RTN","NDFPPRT",53,0)
 .S NDFO=$G(^DIA(50.68,NDFAF,2)),NDFN=$G(^DIA(50.68,NDFAF,3)),NDFACK=$P(NDFAF0,U,5)
"RTN","NDFPPRT",54,0)
 .S NDFAF2=$P(NDFAF1,",",2),NDFFNC=$P(NDFAF0,U,3),NDFFNS=$P(NDFFNC,",",2),Y=NDFCFDT D DD^%DT S NDFCFDT=Y
"RTN","NDFPPRT",55,0)
 .Q:NDFAF2!(NDFFNS&(NDFO'=""))  S:NDFACK="A" NDFF3=NDFMRN Q:NDFF3=NDFMRN  Q:NDFO=NDFN
"RTN","NDFPPRT",56,0)
 .I NDFFT=1 S NDFDNM=$$GET1^DIQ(50.68,NDFMRN,.01) W !,?3,NDFDNM,!! S NDFFT=0,NDFLC=NDFLC+3
"RTN","NDFPPRT",57,0)
 .I NDFAF2!(NDFFNS) D
"RTN","NDFPPRT",58,0)
 ..S NDFINM=$$GET1^DIQ(50.416,NDFAF2,.01) D FIELD^DID(50.68_$P(NDFFNC,","),NDFFNS,,"LABEL","LBLS") S NDFFNS=LBLS("LABEL"),LBLS("LABEL")=""
"RTN","NDFPPRT",59,0)
 ..W "INGREDIENT: ",NDFINM,?35,NDFFNS,!,?45,NDFCFDT,! S NDFLC=NDFLC+2
"RTN","NDFPPRT",60,0)
 .I 'NDFAF2&('NDFFNS) D FIELD^DID(50.68,NDFFNC,,"LABEL","LBL") S NDFFNC=LBL("LABEL"),LBL("LABEL")="" W NDFFNC,?45,NDFCFDT,! S NDFLC=NDFLC+1 D:NDFLC>60 HEAD
"RTN","NDFPPRT",61,0)
 .W ?5,"OLD VALUE: ",NDFO,!,?5,"NEW VALUE: ",NDFN,!! S NDFLC=NDFLC+3
"RTN","NDFPPRT",62,0)
 .S (NDFAF1,NDFAF2,NDFFNC,NDFFNS)=0,(NDFO,NDFN,NDFINM,NDFCFDT)=""
"RTN","NDFPPRT",63,0)
 Q
"RTN","NDFPPRT",64,0)
 ;
"RTN","NDFPPRT",65,0)
HEAD W #,!!,?5,$P(NDF2,"@"),?27,"VA PATCH EDIT REPORT",?55,$P(NDF2,"@",2),?65,"PAGE: ",NDFPG,!
"RTN","NDFPPRT",66,0)
 W "START DATE: ",NDFSP,?50,"END DATE: ",NDFEP,!,NDFBL,! S NDFPG=NDFPG+1,NDFLC=5
"RTN","NDFPPRT",67,0)
 I NDFFT=0 I +NDFMRN=+NDFAF1 W !,?3,NDFDNM,!! S NDFLC=NDFLC+3
"RTN","NDFPPRT",68,0)
 Q
"RTN","NDFPRE")
0^33^B42771381
"RTN","NDFPRE",1,0)
NDFPRE ;BIR/DMA-pre-transport routine to gather data ; 12 Dec 2008  8:18 AM
"RTN","NDFPRE",2,0)
 ;;4.0;NDF MANAGEMENT;; 1 Jan 99;Build 1
"RTN","NDFPRE",3,0)
 ;
"RTN","NDFPRE",4,0)
 ;Reads to the AUDIT File (#1.1), ^DIA, supported by DBIA #2602
"RTN","NDFPRE",5,0)
 ;
"RTN","NDFPRE",6,0)
 S DIR(0)="Y",DIR("A")="Have you run the VUID assigner",DIR("B")="NO" D ^DIR I 'Y W !,"Aborting" Q
"RTN","NDFPRE",7,0)
 S DIR(0)="Y",DIR("A")="Have you backed up NDFK",DIR("B")="NO" D ^DIR I 'Y W !,"Aborting" Q
"RTN","NDFPRE",8,0)
 ;LOAD THE TEXT
"RTN","NDFPRE",9,0)
 F J=1:1 S X=$P($T(TEXT+J),";",3,300) Q:X=""  S @XPDGREF@("TEXT",J)=X
"RTN","NDFPRE",10,0)
 ;
"RTN","NDFPRE",11,0)
 S PN=$P(XPDNM,"*",3) I $D(^NDFK(5000,1,5,PN)) W !!,"This patch has already been transported",!! Q
"RTN","NDFPRE",12,0)
 K ^TMP($J)
"RTN","NDFPRE",13,0)
 ;N A1,A2,CT,FILE,GRP,I,J,J1,J2,K,LAST,LOC,NEW,NEWP,NMSP,NUM,PRE,ROOT,ROOT1,ROOT2,ROOT3,X
"RTN","NDFPRE",14,0)
 S NMSP=$P(XPDNM,"*"),NUM=$O(^NDFK(5000,"B",NMSP,0)),FILE=0 Q:'NUM
"RTN","NDFPRE",15,0)
 I $D(^NDFK(5000,NUM,"PRE")) S PRE=^("PRE") I PRE]"" S:PRE'["^" PRE="^"_PRE I @("$T("_PRE_")]""""") D @PRE
"RTN","NDFPRE",16,0)
 ;run package specific pre-pre-transport routine
"RTN","NDFPRE",17,0)
 I $D(^NDFK(5000,NUM,"POST")) S POST=^("POST"),@XPDGREF@("POST")=POST
"RTN","NDFPRE",18,0)
 ;and load name of package specific post-post install routine into transport global
"RTN","NDFPRE",19,0)
 S TREC=0 F  S FILE=$O(^NDFK(5000,NUM,1,FILE)) Q:'FILE  S X=^(FILE,0),J1=+$P(X,"^",2),J2=+$P(X,"^",3) D
"RTN","NDFPRE",20,0)
 .F  S J1=$O(^DIA(FILE,J1)) Q:'J1  I $D(^(J1,0)) S X=^(0),P01=$P(X,"^",3)[".01"&$D(^(3)),P01T=P01&($P(X,"^",3)=".01") D
"RTN","NDFPRE",21,0)
 ..;P01=.01 FIELD, P01T=.01 TOP LEVEL
"RTN","NDFPRE",22,0)
 ..I P01 S ^TMP($J,"SN"_$S(P01T:"T",P01:""),FILE,J1)="",^TMP($J,"SET01",FILE,$P(X,"^"),$P(X,"^",3),J1)=""
"RTN","NDFPRE",23,0)
 ..I 'P01 S ^TMP($J,"D",FILE,$P(X,"^"),$P(X,"^",3))=FILE_"^"_J1
"RTN","NDFPRE",24,0)
 ..S LAST=J1,TREC=TREC+1
"RTN","NDFPRE",25,0)
 .I $D(LAST) S $P(^NDFK(5000,NUM,1,FILE,0),"^",2)=LAST K LAST
"RTN","NDFPRE",26,0)
 .F  S J2=$O(^NDFK(5000.1,FILE,J2)) Q:'J2  I $D(^(J2,0)) S X=^(0),P01=$P(X,"^",3)[".01"&$D(^(3)),P01T=P01&($P(X,"^",3)=".01") D
"RTN","NDFPRE",27,0)
 ..;P01=.01 FIELD, P01T=.01 TOP LEVEL
"RTN","NDFPRE",28,0)
 ..I P01 S ^TMP($J,"SN"_$S(P01T:"T",P01:""),FILE,J2)="",^TMP($J,"SET01",FILE,$P(X,"^"),$P(X,"^",3),J2)=""
"RTN","NDFPRE",29,0)
 ..I 'P01 S ^TMP($J,"D",FILE,$P(X,"^"),$P(X,"^",3))=FILE_"^"_J2
"RTN","NDFPRE",30,0)
 ..S LAST=J2,TREC=TREC+1
"RTN","NDFPRE",31,0)
 .I $D(LAST) S $P(^NDFK(5000,NUM,1,FILE,0),"^",3)=LAST K LAST
"RTN","NDFPRE",32,0)
 F A1="D","E" S FILE=0 F  S FILE=$O(^TMP($J,A1,FILE)),A2=0 Q:'FILE  F  S A2=$O(^TMP($J,A1,FILE,A2)),A3=0 Q:A2=""  F  S A3=$O(^TMP($J,A1,FILE,A2,A3)) Q:'A3  S X=^(A3),^TMP($J,"S"_A1,$P(X,"^"),$P(X,"^",2))=""
"RTN","NDFPRE",33,0)
 S ROOT=$NA(@XPDGREF@("DATANT"))
"RTN","NDFPRE",34,0)
 ;get new .01 top level fields first
"RTN","NDFPRE",35,0)
 S FILE=0  F  S FILE=$O(^TMP($J,"SNT",FILE)),J=0,CT=0 Q:'FILE  S ROOT1=$NA(@ROOT@(FILE)) F  S J=$O(^TMP($J,"SNT",FILE,J)) Q:'J  D
"RTN","NDFPRE",36,0)
 .S CT=CT+1,@ROOT1@(CT)=$G(^DIA(FILE,J,0)),DATA=^DIA(FILE,J,3),CT=CT+1 D DATER S @ROOT1@(CT)=DATA
"RTN","NDFPRE",37,0)
 .I $D(^DIA(FILE,J,3.1)) S @ROOT1@(CT)=$P(^DIA(FILE,J,3.1),"^")
"RTN","NDFPRE",38,0)
 S ROOT=$NA(@XPDGREF@("DATAN"))
"RTN","NDFPRE",39,0)
 ;get new .01 multiple fields next
"RTN","NDFPRE",40,0)
 S FILE=0  F  S FILE=$O(^TMP($J,"SN",FILE)),J=0,CT=0 Q:'FILE  S ROOT1=$NA(@ROOT@(FILE)) F  S J=$O(^TMP($J,"SN",FILE,J)) Q:'J  D
"RTN","NDFPRE",41,0)
 .S CT=CT+1,@ROOT1@(CT)=$G(^DIA(FILE,J,0)),DATA=^DIA(FILE,J,3),CT=CT+1 D DATER S @ROOT1@(CT)=DATA
"RTN","NDFPRE",42,0)
 .I $D(^DIA(FILE,J,3.1)) S @ROOT1@(CT)=$P(^DIA(FILE,J,3.1),"^")
"RTN","NDFPRE",43,0)
 ;
"RTN","NDFPRE",44,0)
 S FILE=0,ROOT=$NA(@XPDGREF@("DATAO"))
"RTN","NDFPRE",45,0)
 ;now get the rest of the data
"RTN","NDFPRE",46,0)
  S FILE=0 F  S FILE=$O(^TMP($J,"SD",FILE)),J=0 Q:'FILE  S ROOT1=$NA(@ROOT@(FILE)),CT=$O(@ROOT1@(" "),-1) F  S J=$O(^TMP($J,"SD",FILE,J)) Q:'J  D
"RTN","NDFPRE",47,0)
 .F I=0,3 S LOC(I)=$G(^DIA(FILE,J,I))
"RTN","NDFPRE",48,0)
 .I $D(^DIA(FILE,J,3.1)) S LOC(3)=$P(^DIA(FILE,J,3.1),"^")
"RTN","NDFPRE",49,0)
 .I LOC(3)="" I $O(^TMP($J,"SET01",FILE,$P(LOC(0),"^"),$P(LOC(0),"^",3),J)) Q
"RTN","NDFPRE",50,0)
 .;if it's a delete and there's a later set - ignore
"RTN","NDFPRE",51,0)
 .;primarily for .01 fields which are set first
"RTN","NDFPRE",52,0)
 .S CT=CT+1,@ROOT1@(CT)=LOC(0),DATA=LOC(3) D DATER S CT=CT+1,@ROOT1@(CT)=DATA
"RTN","NDFPRE",53,0)
 S FILE=0  F  S FILE=$O(^TMP($J,"SE",FILE)) Q:'FILE  S ROOT1=$NA(@ROOT@(FILE)),CT=$O(@ROOT1@(" "),-1) F  S J=$O(^TMP($J,"SE",FILE,J)) Q:'J  D
"RTN","NDFPRE",54,0)
 .F I=0,3 S CT=CT+1,@ROOT1@(CT)=$G(^NDFK(5000.1,FILE,J,I))
"RTN","NDFPRE",55,0)
 .I $D(^NDFK(5000.1,FILE,J,3.1)) S @ROOT1@(CT)=$P(^NDFK(5000.1,FILE,J,3.1),"^")
"RTN","NDFPRE",56,0)
 ;
"RTN","NDFPRE",57,0)
WORD S J1=+$P(^NDFK(5000,NUM,0),"^",3),ROOT1=$NA(@XPDGREF@("WORD")),CT=1
"RTN","NDFPRE",58,0)
 F  S J1=$O(^NDFK(5000,NUM,4,J1)) Q:'J1  S X=^(J1,0) S:$E(X)'="^" X="^"_X S LAST=J1,^TMP($J,"W",X)="",TREC=TREC+1
"RTN","NDFPRE",59,0)
 S X="" F  S X=$O(^TMP($J,"W",X)) Q:X=""  S @ROOT1@(CT)=X,ROOT2=$NA(@ROOT1@(CT)),ROOT3=$NA(@ROOT2@("D")) M @ROOT3=@X S CT=CT+1
"RTN","NDFPRE",60,0)
 I $D(LAST) S $P(^NDFK(5000,NUM,0),"^",3)=LAST
"RTN","NDFPRE",61,0)
 ;
"RTN","NDFPRE",62,0)
GROUP S GRP=$P(^NDFK(5000,NUM,0),"^",2),@XPDGREF@("GROUP")=GRP
"RTN","NDFPRE",63,0)
 ;
"RTN","NDFPRE",64,0)
MESSAGE M @XPDGREF@("MESSAGE")=^NDFK(5000,NUM,2)
"RTN","NDFPRE",65,0)
 M @XPDGREF@("MESSAGE2")=^NDFK(5000,NUM,3)
"RTN","NDFPRE",66,0)
 I $O(^NDFK(5000.608,0)) D
"RTN","NDFPRE",67,0)
 .K ^TMP("PSN",$J),^TMP("PSNN",$J) S ROOT=$NA(@XPDGREF@("MESSAGE")),LINE=$O(@ROOT@(" "),-1)+1
"RTN","NDFPRE",68,0)
 .S ^TMP("PSN",$J,LINE,0)=" ",^TMP("PSN",$J,LINE+1,0)="The override dose form checks field has changed for the following products",^TMP("PSN",$J,LINE+2,0)=" ",LINE=LINE+3
"RTN","NDFPRE",69,0)
 .S DA=0 F  S DA=$O(^NDFK(5000.608,DA)) Q:'DA  S X=^(DA,0),^TMP("PSNN",$J,$P(^PSNDF(50.68,+X,0),"^")_"^"_$P(X,"^",2,3))=""
"RTN","NDFPRE",70,0)
 .S NA="" F  S NA=$O(^TMP("PSNN",$J,NA)) Q:NA=""  S ^TMP("PSN",$J,LINE,0)=$P(NA,"^"),^TMP("PSN",$J,LINE+1,0)="    changed from "_$S($P(X,"^",2):"YES",1:"NO")_" to "_$S($P(X,"^",3):"YES",1:"NO"),^TMP("PSN",$J,LINE+2,0)=" ",LINE=LINE+3
"RTN","NDFPRE",71,0)
 M @XPDGREF@("MESSAGE")=^TMP("PSN",$J)
"RTN","NDFPRE",72,0)
 ;
"RTN","NDFPRE",73,0)
UNMAP ;GET GENERICS AND PRODUCTS TO UNMAP
"RTN","NDFPRE",74,0)
 S ROOT1=$NA(@XPDGREF@("GENERIC")),DA=0 F  S DA=$O(^NDFK(5000.3,DA)) Q:'DA  S X=^(DA,0),@ROOT1@(X)=""
"RTN","NDFPRE",75,0)
 S ROOT1=$NA(@XPDGREF@("PRODUCT")),DA=0 F  S DA=$O(^NDFK(5000.2,DA)) Q:'DA  S X=^(DA,0),@ROOT1@(X)=""
"RTN","NDFPRE",76,0)
 S DA=0 F  S DA=$O(^PSNDF(50.68,DA)) Q:'DA  I $P($G(^(DA,7)),"^",3) S @ROOT1@(DA)=""
"RTN","NDFPRE",77,0)
 S ROOT1=$NA(@XPDGREF@("POE")),DA=0 F  S DA=$O(^NDFK(5000.4,DA)) Q:'DA  S X=^(DA,0),@ROOT1@(X)=""
"RTN","NDFPRE",78,0)
 S ROOT1=$NA(@XPDGREF@("CMOP")),DA=0 F  S DA=$O(^NDFK(5000.7,DA)) Q:'DA  S @ROOT1@(X)=""
"RTN","NDFPRE",79,0)
 S ROOT1=$NA(@XPDGREF@("NFI")),DA=0 F  S DA=$O(^NDFK(5000.5,DA)) Q:'DA  S @ROOT1@(DA)=""
"RTN","NDFPRE",80,0)
 M @XPDGREF@("CLASS")=^NDFK(5000.8)
"RTN","NDFPRE",81,0)
 ;
"RTN","NDFPRE",82,0)
 S ^NDFK(5000,1,5,PN,0)=PN_"^"_$$NOW^XLFDT_"^"_DUZ,@XPDGREF@("TREC")=TREC
"RTN","NDFPRE",83,0)
 ;K A1,A2,CT,FILE,GRP,I,J,J1,J2,K,LAST,LOC,NEW,NEWP,NMSP,NUM,PRE,ROOT,ROOT1,ROOT2,ROOT3,X,^TMP($J)
"RTN","NDFPRE",84,0)
 Q
"RTN","NDFPRE",85,0)
 ;
"RTN","NDFPRE",86,0)
 ;
"RTN","NDFPRE",87,0)
DATER ;CONVERT DATE TO INTERNAL
"RTN","NDFPRE",88,0)
 I DATA?3A1" "1.2N1", "4N,"JAN^FEB^MAR^APR^MAY^JUN^JUL^AUG^SEP^OCT^NOV^DEC^Jan^Feb^Mar^Apr^May^Jun^Jul^Aug^Sep^Oct^Nov^Dec^"[$E(DATA,1,3) N X S X=DATA,%DT="X" D ^%DT S DATA=Y
"RTN","NDFPRE",89,0)
 Q
"RTN","NDFPRE",90,0)
 ;
"RTN","NDFPRE",91,0)
TEXT ;
"RTN","NDFPRE",92,0)
 ;;unmatched from the National Drug File (NDF).  The VA Product
"RTN","NDFPRE",93,0)
 ;;name and CMOP ID corresponding to the unmatched local drug file
"RTN","NDFPRE",94,0)
 ;;name are listed on the indented line beneath each entry.  An
"RTN","NDFPRE",95,0)
 ;;Inactivation Date may be listed for entries when this reason
"RTN","NDFPRE",96,0)
 ;;applies.  Until you rematch these entries to NDF, they will not
"RTN","NDFPRE",97,0)
 ;;transmit to CMOP and drug-drug interaction checks will not check
"RTN","NDFPRE",98,0)
 ;;for these products.  It is critical that you rematch these
"RTN","NDFPRE",99,0)
 ;;products immediately.  You may also need to match a new
"RTN","NDFPRE",100,0)
 ;;orderable item.  Any possible dosages and local possible
"RTN","NDFPRE",101,0)
 ;;dosages for these unmatched products have been deleted.
"RTN","NDFPRE",102,0)
 ;;Therefore, the dosages for each unmatched product should
"RTN","NDFPRE",103,0)
 ;;be reviewed after the rematch or recreated if the product
"RTN","NDFPRE",104,0)
 ;;can not be rematched to a VA Product through the NDF
"RTN","NDFPRE",105,0)
 ;;matching process.
"RTN","NDFPRE",106,0)
 ;; 
"RTN","NDFPRE",107,0)
 ;; DRUG                                                 IEN       INACTIVATION
"RTN","NDFPRE",108,0)
 ;;                                                                    DATE
"RTN","NDFPRE",109,0)
 ;; 
"RTN","NDFPRE1")
0^34^B22312725
"RTN","NDFPRE1",1,0)
NDFPRE1 ;BIR/DMA-pre-transport routine to gather data for PSN*4*58 ;18 Dec 98 / 11:34 AM
"RTN","NDFPRE1",2,0)
 ;;4.0; NDF MANAGEMENT;; 1 Jan 99;Build 1
"RTN","NDFPRE1",3,0)
 ;
"RTN","NDFPRE1",4,0)
 ;Reads to the AUDIT File (#1.1), ^DIA, supported by DBIA #2602
"RTN","NDFPRE1",5,0)
 ;
"RTN","NDFPRE1",6,0)
 K ^TMP($J)
"RTN","NDFPRE1",7,0)
 ;N A1,A2,CT,FILE,GRP,I,J,J1,J2,K,LAST,LOC,NEW,NEWP,NMSP,NUM,PRE,ROOT,ROOT1,ROOT2,ROOT3,X
"RTN","NDFPRE1",8,0)
 S NMSP=$P(XPDNM,"*"),NUM=$O(^PRE58(5000,"B",NMSP,0)),FILE=0 Q:'NUM
"RTN","NDFPRE1",9,0)
 I $D(^PRE58(5000,NUM,"PRE")) S PRE=^("PRE") I PRE]"" S:PRE'["^" PRE="^"_PRE I @("$T("_PRE_")]""""") D @PRE
"RTN","NDFPRE1",10,0)
 ;run package specific pre-pre-transport routine
"RTN","NDFPRE1",11,0)
 I $D(^PRE58(5000,NUM,"POST")) S POST=^("POST"),@XPDGREF@("POST")=POST
"RTN","NDFPRE1",12,0)
 ;and load name of package specific post-post install routine into transport global
"RTN","NDFPRE1",13,0)
 F  S FILE=$O(^PRE58(5000,NUM,1,FILE)) Q:'FILE  S X=^(FILE,0),J1=+$P(X,"^",2),J2=+$P(X,"^",3),J3=$P(^NDFK(5000,NUM,1,FILE,0),"^",2) D
"RTN","NDFPRE1",14,0)
 .F  S J1=$O(^DIA(FILE,J1)) Q:'J1  Q:J1>J3  I $D(^(J1,0)) S X=^(0),P01=$P(X,"^",3)[".01"&$D(^(3)),P01T=P01&($P(X,"^",3)=".01") D
"RTN","NDFPRE1",15,0)
 ..;P01=.01 FIELD, P01T=.01 TOP LEVEL
"RTN","NDFPRE1",16,0)
 ..I P01 S ^TMP($J,"SN"_$S(P01T:"T",P01:""),FILE,J1)="",^TMP($J,"SET01",FILE,$P(X,"^"),$P(X,"^",3),J1)=""
"RTN","NDFPRE1",17,0)
 ..I 'P01 S ^TMP($J,"D",FILE,$P(X,"^"),$P(X,"^",3))=FILE_"^"_J1
"RTN","NDFPRE1",18,0)
 ..S LAST=J1
"RTN","NDFPRE1",19,0)
 .;I $D(LAST) S $P(^PRE58(5000,NUM,1,FILE,0),"^",2)=LAST K LAST
"RTN","NDFPRE1",20,0)
 .K LAST
"RTN","NDFPRE1",21,0)
 .F  S J2=$O(^PRE58(5000.1,FILE,J2)) Q:'J2  I $D(^(J2,0)) S X=^(0),P01=$P(X,"^",3)[".01"&$D(^(3)),P01T=P01&($P(X,"^",3)=".01") D
"RTN","NDFPRE1",22,0)
 ..;P01=.01 FIELD, P01T=.01 TOP LEVEL
"RTN","NDFPRE1",23,0)
 ..I P01 S ^TMP($J,"SN"_$S(P01T:"T",P01:""),FILE,J2)="",^TMP($J,"SET01",FILE,$P(X,"^"),$P(X,"^",3),J2)=""
"RTN","NDFPRE1",24,0)
 ..I 'P01 S ^TMP($J,"D",FILE,$P(X,"^"),$P(X,"^",3))=FILE_"^"_J2
"RTN","NDFPRE1",25,0)
 ..S LAST=J2
"RTN","NDFPRE1",26,0)
 .;I $D(LAST) S $P(^PRE58(5000,NUM,1,FILE,0),"^",3)=LAST K LAST
"RTN","NDFPRE1",27,0)
 .K LAST
"RTN","NDFPRE1",28,0)
 F A1="D","E" S FILE=0 F  S FILE=$O(^TMP($J,A1,FILE)),A2=0 Q:'FILE  F  S A2=$O(^TMP($J,A1,FILE,A2)),A3=0 Q:A2=""  F  S A3=$O(^TMP($J,A1,FILE,A2,A3)) Q:'A3  S X=^(A3),^TMP($J,"S"_A1,$P(X,"^"),$P(X,"^",2))=""
"RTN","NDFPRE1",29,0)
 S ROOT=$NA(@XPDGREF@("DATANT"))
"RTN","NDFPRE1",30,0)
 ;get new .01 top level fields first
"RTN","NDFPRE1",31,0)
 S FILE=0  F  S FILE=$O(^TMP($J,"SNT",FILE)),J=0,CT=0 Q:'FILE  S ROOT1=$NA(@ROOT@(FILE)) F  S J=$O(^TMP($J,"SNT",FILE,J)) Q:'J  D
"RTN","NDFPRE1",32,0)
 .S CT=CT+1,@ROOT1@(CT)=$G(^DIA(FILE,J,0)),DATA=^DIA(FILE,J,3),CT=CT+1 D DATER S @ROOT1@(CT)=DATA
"RTN","NDFPRE1",33,0)
 .I $D(^DIA(FILE,J,3.1)) S @ROOT1@(CT)=$P(^DIA(FILE,J,3.1),"^")
"RTN","NDFPRE1",34,0)
 S ROOT=$NA(@XPDGREF@("DATAN"))
"RTN","NDFPRE1",35,0)
 ;get new .01 multiple fields next
"RTN","NDFPRE1",36,0)
 S FILE=0  F  S FILE=$O(^TMP($J,"SN",FILE)),J=0,CT=0 Q:'FILE  S ROOT1=$NA(@ROOT@(FILE)) F  S J=$O(^TMP($J,"SN",FILE,J)) Q:'J  D
"RTN","NDFPRE1",37,0)
 .S CT=CT+1,@ROOT1@(CT)=$G(^DIA(FILE,J,0)),DATA=^DIA(FILE,J,3),CT=CT+1 D DATER S @ROOT1@(CT)=DATA
"RTN","NDFPRE1",38,0)
 .I $D(^DIA(FILE,J,3.1)) S @ROOT1@(CT)=$P(^DIA(FILE,J,3.1),"^")
"RTN","NDFPRE1",39,0)
 ;
"RTN","NDFPRE1",40,0)
 S FILE=0,ROOT=$NA(@XPDGREF@("DATAO"))
"RTN","NDFPRE1",41,0)
 ;now get the rest of the data
"RTN","NDFPRE1",42,0)
  S FILE=0 F  S FILE=$O(^TMP($J,"SD",FILE)),J=0 Q:'FILE  S ROOT1=$NA(@ROOT@(FILE)),CT=$O(@ROOT1@(" "),-1) F  S J=$O(^TMP($J,"SD",FILE,J)) Q:'J  D
"RTN","NDFPRE1",43,0)
 .F I=0,3 S LOC(I)=$G(^DIA(FILE,J,I))
"RTN","NDFPRE1",44,0)
 .I $D(^DIA(FILE,J,3.1)) S LOC(3)=$P(^DIA(FILE,J,3.1),"^")
"RTN","NDFPRE1",45,0)
 .I LOC(3)="" I $O(^TMP($J,"SET01",FILE,$P(LOC(0),"^"),$P(LOC(0),"^",3),J)) Q
"RTN","NDFPRE1",46,0)
 .;if it's a delete and there's a later set - ignore
"RTN","NDFPRE1",47,0)
 .;primarily for .01 fields which are set first
"RTN","NDFPRE1",48,0)
 .S CT=CT+1,@ROOT1@(CT)=LOC(0),DATA=LOC(3) D DATER S CT=CT+1,@ROOT1@(CT)=DATA
"RTN","NDFPRE1",49,0)
 S FILE=0  F  S FILE=$O(^TMP($J,"SE",FILE)) Q:'FILE  S ROOT1=$NA(@ROOT@(FILE)),CT=$O(@ROOT1@(" "),-1) F  S J=$O(^TMP($J,"SE",FILE,J)) Q:'J  D
"RTN","NDFPRE1",50,0)
 .F I=0,3 S CT=CT+1,@ROOT1@(CT)=$G(^PRE58(5000.1,FILE,J,I))
"RTN","NDFPRE1",51,0)
 .I $D(^PRE58(5000.1,FILE,J,3.1)) S @ROOT1@(CT)=$P(^PRE58(5000.1,FILE,J,3.1),"^")
"RTN","NDFPRE1",52,0)
 ;
"RTN","NDFPRE1",53,0)
WORD S J1=+$P(^PRE58(5000,NUM,0),"^",3),ROOT1=$NA(@XPDGREF@("WORD")),CT=1
"RTN","NDFPRE1",54,0)
 F  S J1=$O(^PRE58(5000,NUM,4,J1)) Q:'J1  S X=^(J1,0) S:$E(X)'="^" X="^"_X S LAST=J1,^TMP($J,"W",X)=""
"RTN","NDFPRE1",55,0)
 S X="" F  S X=$O(^TMP($J,"W",X)) Q:X=""  S @ROOT1@(CT)=X,ROOT2=$NA(@ROOT1@(CT)),ROOT3=$NA(@ROOT2@("D")) M @ROOT3=@X S CT=CT+1
"RTN","NDFPRE1",56,0)
 ;I $D(LAST) S $P(^PRE58(5000,NUM,0),"^",3)=LAST
"RTN","NDFPRE1",57,0)
 ;
"RTN","NDFPRE1",58,0)
GROUP S GRP=$P(^PRE58(5000,NUM,0),"^",2),@XPDGREF@("GROUP")=GRP
"RTN","NDFPRE1",59,0)
 ;
"RTN","NDFPRE1",60,0)
MESSAGE M @XPDGREF@("MESSAGE")=^PRE58(5000,NUM,2)
"RTN","NDFPRE1",61,0)
 M @XPDGREF@("MESSAGE2")=^PRE58(5000,NUM,3)
"RTN","NDFPRE1",62,0)
 ;
"RTN","NDFPRE1",63,0)
UNMAP ;GET GENERICS AND PRODUCTS TO UNMAP
"RTN","NDFPRE1",64,0)
 S ROOT1=$NA(@XPDGREF@("GENERIC")),DA=0 F  S DA=$O(^PRE58(5000.3,DA)) Q:'DA  S X=^(DA,0),@ROOT1@(X)=""
"RTN","NDFPRE1",65,0)
 S ROOT1=$NA(@XPDGREF@("PRODUCT")),DA=0 F  S DA=$O(^PRE58(5000.2,DA)) Q:'DA  S X=^(DA,0),@ROOT1@(X)=""
"RTN","NDFPRE1",66,0)
 S DA=0 F  S DA=$O(^PSNDF(50.68,DA)) Q:'DA  I $P($G(^(DA,7)),"^",3) S @ROOT1@(DA)=""
"RTN","NDFPRE1",67,0)
 S ROOT1=$NA(@XPDGREF@("POE")),DA=0 F  S DA=$O(^PRE58(5000.4,DA)) Q:'DA  S X=^(DA,0),@ROOT1@(X)=""
"RTN","NDFPRE1",68,0)
 S ROOT1=$NA(@XPDGREF@("CMOP")),DA=0 F  S DA=$O(^PRE58(5000.7,DA)) Q:'DA  S @ROOT1@(X)=""
"RTN","NDFPRE1",69,0)
 S ROOT1=$NA(@XPDGREF@("NFI")),DA=0 F  S DA=$O(^PRE58(5000.5,DA)) Q:'DA  S @ROOT1@(DA)=""
"RTN","NDFPRE1",70,0)
 ;
"RTN","NDFPRE1",71,0)
 ;K A1,A2,CT,FILE,GRP,I,J,J1,J2,K,LAST,LOC,NEW,NEWP,NMSP,NUM,PRE,ROOT,ROOT1,ROOT2,ROOT3,X,^TMP($J)
"RTN","NDFPRE1",72,0)
 Q
"RTN","NDFPRE1",73,0)
 ;
"RTN","NDFPRE1",74,0)
 ;
"RTN","NDFPRE1",75,0)
DATER ;CONVERT DATE TO INTERNAL
"RTN","NDFPRE1",76,0)
 I DATA?3A1" "1.2N1", "4N,"JAN^FEB^MAR^APR^MAY^JUN^JUL^AUG^SEP^OCT^NOV^DEC^Jan^Feb^Mar^Apr^May^Jun^Jul^Aug^Sep^Oct^Nov^Dec^"[$E(DATA,1,3) N X S X=DATA,%DT="X" D ^%DT S DATA=Y
"RTN","NDFPRE1",77,0)
 Q
"RTN","NDFPRINT")
0^35^B8681815
"RTN","NDFPRINT",1,0)
NDFPRINT ;BIR/DMA-VA FileMan print and search from files 50.67 & 50.68 ; 09 Aug 2006  9:06 AM
"RTN","NDFPRINT",2,0)
 ;;4.0; NDF MANAGEMENT;; 1 Jan 99;Build 1
"RTN","NDFPRINT",3,0)
 ;
"RTN","NDFPRINT",4,0)
PRINT ;
"RTN","NDFPRINT",5,0)
 S DIR(0)="SA^G:VA GENERIC;P:VA PRODUCT;N:NDC/UPN",DIR("A")="Print from VA Generic (G) VA Product (P) or NDC/UPN (N) " D ^DIR G END:$D(DIRUT)
"RTN","NDFPRINT",6,0)
 S DIC=$S(Y="P":"^PSNDF(50.68,",Y="N":"^PSNDF(50.67,",1:"^PSNDF(50.6,"),L=0,DIASKHD="" D EN1^DIP G END
"RTN","NDFPRINT",7,0)
 ;
"RTN","NDFPRINT",8,0)
SEARCH ;
"RTN","NDFPRINT",9,0)
 S DIR(0)="SA^G:VA GENERIC;P:VA PRODUCT;N:NDC/UPN",DIR("A")="Search (G) VA Generic VA Product (P) or NDC/UPN (N) " D ^DIR G END:$D(DIRUT)
"RTN","NDFPRINT",10,0)
 S DIC=$S(Y="P":"^PSNDF(50.68,",Y="N":"^PSNDF(50.67,",1:"^PSNDF(50.6,") D EN^DIS
"RTN","NDFPRINT",11,0)
 ;
"RTN","NDFPRINT",12,0)
END K DIASKHD,DIR,DIC,L,X,Y Q
"RTN","NDFPRINT",13,0)
 ;
"RTN","NDFPRINT",14,0)
 ;
"RTN","NDFPRINT",15,0)
INT ;PRINT INTERACTIONS
"RTN","NDFPRINT",16,0)
 D EN^XUTMDEVQ("ENP^NDFPRINT","PRINT INTERACTIONS") Q
"RTN","NDFPRINT",17,0)
 ;
"RTN","NDFPRINT",18,0)
ENP ;QUEUED ENTRY FOR INTERACTIONS
"RTN","NDFPRINT",19,0)
 S PAGE=1,TODAY=$$HTE^XLFDT(+$H) D HEAD
"RTN","NDFPRINT",20,0)
 S NA="" F  S NA=$O(^PS(56,"B",NA)),DA=0 Q:NA=""  F  S DA=$O(^PS(56,"B",NA,DA)) Q:'DA  S X=^PS(56,DA,0),A=$P(X,"^"),IN=$P(X,"^",7),Y=$P(X,"^",4),C=$P(^DD(56,3,0),"^",2) D Y^DIQ D
"RTN","NDFPRINT",21,0)
 .S ENT="",EN1=$O(^DIA(56,"B",DA,0)) I EN1 S X=^DIA(56,EN1,0) I $P(X,"^",5)="A" S ENT=$P(X,"^",2)\1
"RTN","NDFPRINT",22,0)
 .W !,A,?55,$E(Y,1,4),?60,$J($$FMTE^XLFDT(ENT,2),9),?68," ",$J($$FMTE^XLFDT(IN,2),9) I $Y+4>IOSL D HEAD
"RTN","NDFPRINT",23,0)
 K PAGE,TODAY,NA,DA,X,Y,A,C,EN1,ENT D ^%ZISC Q
"RTN","NDFPRINT",24,0)
 ;
"RTN","NDFPRINT",25,0)
HEAD W:$Y @IOF W !,?20,"INTERACTIONS",?IOM-11," Page ",PAGE,!,"Printed on ",TODAY,!,?5,"INGREDIENTS",?56,"SEV",?62,"ENTER",?72,"INACT",! S PAGE=PAGE+1 Q
"RTN","NDFPRINT",26,0)
 ;
"RTN","NDFPRINT",27,0)
PRODP ;PRINT PRODUCTS AND RESTRICTIONS
"RTN","NDFPRINT",28,0)
 D EN^XUTMDEVQ("ENP1^NDFPRINT","PRINT VA PRODUCTS") Q
"RTN","NDFPRINT",29,0)
 ;
"RTN","NDFPRINT",30,0)
ENP1 ;QUEUED ENTRY FOR PRODUCTS
"RTN","NDFPRINT",31,0)
 K ^TMP($J) S DA=0 F  S DA=$O(^PS(51.7,DA)) Q:'DA  S A=$P(^(DA,0),"^"),T=^(2,1,0),^TMP($J,T)=A
"RTN","NDFPRINT",32,0)
 ;
"RTN","NDFPRINT",33,0)
 S PAGE=1,TODAY=$$HTE^XLFDT(+$H) D HEAD1
"RTN","NDFPRINT",34,0)
 S NA="" F  S NA=$O(^PSNDF(50.68,"B",NA)),DA=0 Q:NA=""  F  S DA=$O(^PSNDF(50.68,"B",NA,DA)) Q:'DA  S A=$P(^PSNDF(50.68,DA,0),"^"),B=$G(^(5)),C=$G(^(6,1,0)) D
"RTN","NDFPRINT",35,0)
 .S T="" I C]"" S T=$G(^TMP($J,C))
"RTN","NDFPRINT",36,0)
 .W ?5,A,?70,B,?90,T,! I $Y+4>IOSL D HEAD1
"RTN","NDFPRINT",37,0)
 K DA,A,T,PAGE,TODAY,NA,DA,A,B,C,^TMP($J) D ^%ZISC Q
"RTN","NDFPRINT",38,0)
 ;
"RTN","NDFPRINT",39,0)
HEAD1 W:$Y @IOF W !,?25,"VA PRODUCTS",?IOM-15,"Page ",PAGE,!,"Printed on ",TODAY,!,?20,"PRODUCT",?66,"INDICATOR",?88,"RESTRICTION",!! S PAGE=PAGE+1 Q
"RTN","NDFPRINT",40,0)
 ;
"RTN","NDFPRINT",41,0)
NEW ;FILEMAN PRINT OF NEW PRODUCTS
"RTN","NDFPRINT",42,0)
 ;S DIC=5000.506,L="LIST OF NEW PRODUCTS",BY=.01,FR="",TO="",FLDS="[DON PRINT]" D EN1^DIP Q
"RTN","NDFPRINT",43,0)
 D ^NDFNPRT
"RTN","NDFPRINT",44,0)
 Q
"RTN","NDFPURGE")
0^36^B6537121
"RTN","NDFPURGE",1,0)
NDFPURGE ;BIR/DMA-PURGE NDF MESSAGE FILES ; 21 Jan 2010  7:49 AM
"RTN","NDFPURGE",2,0)
 ;;4.0; NDF MANAGEMENT;**108,262**; 1 Jan 99;Build 1
"RTN","NDFPURGE",3,0)
 ;
"RTN","NDFPURGE",4,0)
 N LNCNT,DIR S LNCNT=0 W !!,"This will purge all data in the following files",!
"RTN","NDFPURGE",5,0)
 F FILE=5000.2:0.1:5000.9,5000.23,5000.56,5000.506:0.001:5000.509,5000.608,5000.91,5000.92 D
"RTN","NDFPURGE",6,0)
 . W !,?5,$P($G(^NDFK(FILE,0)),"^")," (#",FILE,")"
"RTN","NDFPURGE",7,0)
 . S LNCNT=LNCNT+1
"RTN","NDFPURGE",8,0)
 . I '(LNCNT#10) W ! S DIR(0)="E",DIR("A")="Press Return to continue" D ^DIR W !
"RTN","NDFPURGE",9,0)
 ;
"RTN","NDFPURGE",10,0)
 W !!,"This option should be run after each update transmission",!,"and before entry is started on the next transmission",!
"RTN","NDFPURGE",11,0)
 S (J,DA)=0 F  S DA=$O(^NDFK(5000,1,1,DA)) Q:'DA  S J=$P(^(DA,0),"^",2)'=$O(^DIA(DA," "),-1)+J
"RTN","NDFPURGE",12,0)
 I J W !,"It appears that data has been entered since the last transmission",! S DIR(0)="Y",DIR("A")="Are you SURE you want to purge",DIR("B")="NO" D ^DIR K DIR Q:$D(DIRUT)  Q:'Y
"RTN","NDFPURGE",13,0)
 S DIR(0)="Y",DIR("A")="Are you ready to purge now" D ^DIR K DIR Q:'Y
"RTN","NDFPURGE",14,0)
 S DIR(0)="Y",DIR("A")="Do you want a copy of the mail message",DIR("B")="YES" D ^DIR K DIR Q:$D(DIRUT)  I Y S XMSUB="MESSAGE TO USERS",XMDUZ="NDF MANAGER",XMTEXT="^NDFK(5000,1,2,",XMY(DUZ)="" D ^XMD D
"RTN","NDFPURGE",15,0)
 . S XMSUB="INTERACTION MESSSAGE",XMDUZ="NDF MANAGER",XMTEXT="^NDFK(5000,1,3,",XMY(DUZ)="" D ^XMD
"RTN","NDFPURGE",16,0)
 ;
"RTN","NDFPURGE",17,0)
 ; Purging entries
"RTN","NDFPURGE",18,0)
 F FILE=5000.2:0.1:5000.9,5000.23,5000.56,5000.506:0.001:5000.509,5000.608,5000.91,5000.92 D
"RTN","NDFPURGE",19,0)
 . S LOC=0 F  S LOC=$O(^NDFK(FILE,LOC)) Q:'LOC  D
"RTN","NDFPURGE",20,0)
 . . S DA=LOC,DIK="^NDFK("_FILE_"," D ^DIK K DIK,DIAU
"RTN","NDFPURGE",21,0)
 ;
"RTN","NDFPURGE",22,0)
 K ^NDFK(5000,1,2) ;GET THE MESSAGE
"RTN","NDFPURGE",23,0)
 K ^NDFK(5000,1,3) ;AND THE SECOND MESSAGE
"RTN","NDFPURGE",24,0)
 K ^NDFK(5000,1,4) ;GET THE WORD PROCESSING FIELDS
"RTN","NDFPURGE",25,0)
 K DA,FIL,J,LOC,XMDUZ,XMSUB,XMTEXT,XMY,Y
"RTN","NDFPURGE",26,0)
 Q
"RTN","NDFRECLS")
0^37^B24218333
"RTN","NDFRECLS",1,0)
NDFRECLS ;BIR/DMA-reclass products ;03 Nov 98 / 10:34 AM
"RTN","NDFRECLS",2,0)
 ;;4.0; NDF MANAGEMENT;; 1 Jan 99;Build 1
"RTN","NDFRECLS",3,0)
GO S DIR(0)="SA^P:VA Product;G:VA Generic",DIR("A")="Do you wish to reclass by VA Product (P) or VA Generic (G)? " D ^DIR G END:$D(DIRUT),G:Y="G"
"RTN","NDFRECLS",4,0)
 ;by product
"RTN","NDFRECLS",5,0)
 S DIR(0)="SA^S:SINGLE;M:MULTIPLE",DIR("A")="Single (S) or Multiple (M) Products ?" D ^DIR G END:$D(DIRUT),MULT:Y="M"
"RTN","NDFRECLS",6,0)
 S DIR(0)="SA^P:PRIMARY;S:SECONDARY;B:BOTH",DIR("A")="Reclass Primary (P), Secondary (S), or Both (B)? " D ^DIR G END:$D(DIRUT) S PSB=Y
"RTN","NDFRECLS",7,0)
 F  S DIC=50.68,DIC(0)="AEQM" W !! D ^DIC Q:Y<0  S DA=+Y,DIE=DIC D
"RTN","NDFRECLS",8,0)
 .I PSB'="S" S DR="15;" D ^DIE
"RTN","NDFRECLS",9,0)
 .I PSB="P" Q
"RTN","NDFRECLS",10,0)
 .I '$O(^PSNDF(50.68,DA,4,0)) S NDF="^PSNDF(50.68,"_DA_",4,",NDF1=DA F  S DIC=50.605 D ^DIC Q:Y<0  I '$D(^PSNDF(50.68,4,+Y)) K DD,DO S DIC=NDF,(DINUM,X)=+Y,DA(1)=NDF1,DIC(0)="L",DIC("P")=$P(^DD(50.68,16,0),"^",2) D FILE^DICN
"RTN","NDFRECLS",11,0)
 .K L1,L2 S K=0 F  S K=$O(^PSNDF(50.68,DA,4,K)) Q:'K  S L1($P(^PS(50.605,K,0),"^")_"^"_K)=""
"RTN","NDFRECLS",12,0)
 .Q:'$D(L1)
"RTN","NDFRECLS",13,0)
 .S K="" W !,"Select",! F J=1:1 S K=$O(L1(K)) Q:K=""  W J,?5,$P(K,"^"),! S L2(J)=$P(K,"^",2)
"RTN","NDFRECLS",14,0)
 .F  K DIR S DIR(0)="F^1:3",DIR("A")="Enter 1 - "_$O(L2(" "),-1)_" or ""N"" to add a new one or ""Q"" to quit " D ^DIR Q:$D(DIRUT)  S NDF0=Y Q:NDF0="N"  Q:NDF0="Q"  Q:$D(L2(+NDF0))
"RTN","NDFRECLS",15,0)
 .Q:$D(DIRUT)  Q:NDF0="Q"
"RTN","NDFRECLS",16,0)
 .I NDF0="N" S NDF="^PSNDF(50.68,"_DA_",4,",NDF1=DA F  S DIC=50.605,DIC(0)="AEQMZ" D ^DIC Q:Y<0  I '$D(^PSNDF(50.68,4,+Y)) K DD,DO S DIC=NDF,DA(1)=NDF1,DIC(0)="L",DIC("P")=$P(^DD(50.68,16,0),"^",2),(DINUM,X)=+Y D FILE^DICN
"RTN","NDFRECLS",17,0)
 .I NDF0 S DIE="^PSNDF(50.68,"_DA_",4,",DA(1)=DA,DA=L2(NDF0),DR=".01;" D ^DIE
"RTN","NDFRECLS",18,0)
 G END
"RTN","NDFRECLS",19,0)
 ;
"RTN","NDFRECLS",20,0)
MULT ;Multiple products
"RTN","NDFRECLS",21,0)
 S DIC=50.605,DIC(0)="QEAM",DIC("A")="P^50.605",DIC("A")="Enter VA Drug Class Code to be changed " D ^DIC G GO:Y<0 S COD=+Y
"RTN","NDFRECLS",22,0)
 S DIR(0)="SA^P:PRIMARY;S:SECONDARY;B:BOTH",DIR("A")="Reclass Primary (P), Secondary (S), or Both (B)? " D ^DIR G END:$D(DIRUT) S PSB=Y
"RTN","NDFRECLS",23,0)
 W !,"Excuse me while I sort",! K ^TMP($J) S DA=0 F  S DA=$O(^PSNDF(50.68,DA)) Q:'DA  S NA=$P(^(DA,0),"^") D  I DA#200=0 W "."
"RTN","NDFRECLS",24,0)
 .I PSB'="S",$P(^PSNDF(50.68,DA,3),"^")=COD S ^TMP($J,NA_"^"_DA)=""
"RTN","NDFRECLS",25,0)
 .I PSB'="P",$G(^PSNDF(50.68,DA,4,COD)) S ^TMP($J,NA_"^"_DA_"^"_COD)=""
"RTN","NDFRECLS",26,0)
 I '$D(^TMP($J)) W !,"No Matches Found",! G MULT
"RTN","NDFRECLS",27,0)
 K Y S NA="" F  S NA=$O(^TMP($J,NA)) Q:NA=""  S DA=$P(NA,"^",2) W !!,$P(NA,"^") D  Q:$D(Y)
"RTN","NDFRECLS",28,0)
 .I PSB'="S" S DIE=50.68,DR="15;" D ^DIE
"RTN","NDFRECLS",29,0)
 .I PSB'="P",$P(NA,"^",3) S DIE="^PSNDF(50.68,"_DA_",4,",DA(1)=DA,DA=$P(NA,"^",3),DR=".01;" D ^DIE
"RTN","NDFRECLS",30,0)
 G MULT
"RTN","NDFRECLS",31,0)
 ;
"RTN","NDFRECLS",32,0)
G ;GENERICS
"RTN","NDFRECLS",33,0)
 S DIR(0)="F^1:5",DIR("A")="Enter a VA Drug Class Code to change or ""A"" to display all VA Products " W !! D ^DIR G END:$D(DIRUT) I Y="A" S COD="A"
"RTN","NDFRECLS",34,0)
 E  S X=Y,DIC=50.605,DIC(0)="M" D ^DIC G G:Y<0 S COD=+Y
"RTN","NDFRECLS",35,0)
 S DIR(0)="SA^P:PRIMARY;S:SECONDARY;B:BOTH",DIR("A")="Reclass Primary (P), Secondary (S), or Both (B)? " D ^DIR G END:$D(DIRUT) S PSB=Y
"RTN","NDFRECLS",36,0)
 K DIC S DIC=50.6,DIC(0)="AEQM" D ^DIC G G:Y<0 S DA1=+Y
"RTN","NDFRECLS",37,0)
 W !,"Excuse me while I sort " S DA=0 K ^TMP($J) F  S DA=$O(^PSNDF(50.6,"APRO",DA1,DA)) Q:'DA  S NA=$P(^PSNDF(50.68,DA,0),"^") D
"RTN","NDFRECLS",38,0)
 .I COD="A" S ^TMP($J,NA_"^"_DA)="" Q
"RTN","NDFRECLS",39,0)
 .I PSB'="S",$P(^PSNDF(50.68,DA,3),"^")=COD S ^TMP($J,NA_"^"_DA)=""
"RTN","NDFRECLS",40,0)
 .I PSB'="P",$G(^PSNDF(50.68,DA,4,COD)) S ^TMP($J,NA_"^"_DA_"^"_COD)=""
"RTN","NDFRECLS",41,0)
 I '$D(^TMP($J)) W !,"No Matches Found",! G G
"RTN","NDFRECLS",42,0)
 K Y S NA="" F  S NA=$O(^TMP($J,NA)) Q:NA=""  S DA=$P(NA,"^",2) W !!,$P(NA,"^") D  Q:$D(Y)
"RTN","NDFRECLS",43,0)
 .I PSB'="S" S DIE=50.68,DR="15;" D ^DIE
"RTN","NDFRECLS",44,0)
 .I PSB'="P",COD'="A",$P(NA,"^",3) S DIE="^PSNDF(50.68,"_DA_",4,",DA(1)=DA,DA=$P(NA,"^",3),DR=".01;" D ^DIE
"RTN","NDFRECLS",45,0)
 .I PSB'="P",COD="A" D
"RTN","NDFRECLS",46,0)
 ..I '$O(^PSNDF(50.68,DA,4,0)) S NDF="^PSNDF(50.68,"_DA_",4,",NDF1=DA F  S DIC=50.605 D ^DIC K:Y<0 Y Q:'$D(Y)  I '$D(^PSNDF(50.68,4,+Y)) K DD,DO S DIC=NDF,(DINUM,X)=+Y,DA(1)=NDF1,DIC(0)="L",DIC("P")=$P(^DD(50.68,16,0),"^",2) D FILE^DICN
"RTN","NDFRECLS",47,0)
 ..K L1,L2 S K=0 F  S K=$O(^PSNDF(50.68,DA,4,K)) Q:'K  S L1($P(^PS(50.605,K,0),"^")_"^"_K)=""
"RTN","NDFRECLS",48,0)
 ..I $D(L1) D
"RTN","NDFRECLS",49,0)
 ...S K="" W !,"Select",! F J=1:1 S K=$O(L1(K)) Q:K=""  W J,?5,$P(K,"^"),! S L2(J)=$P(K,"^",2)
"RTN","NDFRECLS",50,0)
 ...F  K DIR S DIR(0)="F^1:3",DIR("A")="Enter 1 - "_$O(L2(" "),-1)_" or ""N"" to add a new one or ""Q"" to quit " D ^DIR Q:$D(DIRUT)  S NDF0=Y Q:NDF0="N"  Q:NDF0="Q"  Q:$D(L2(+NDF0))
"RTN","NDFRECLS",51,0)
 ...Q:$D(DIRUT)  Q:NDF0="Q"
"RTN","NDFRECLS",52,0)
 ...I NDF0="N" S NDF="^PSNDF(50.68,"_DA_",4,",NDF1=DA F  S DIC=50.605 D ^DIC Q:'Y  I '$D(^PSNDF(50.68,4,+Y)) K DD,DO S DIC=NDF,DA(1)=NDF1,DIC(0)="L",DIC("P")=$P(^DD(50.68,16,0),"^",2),(DINUM,X)=+Y D FILE^DICN
"RTN","NDFRECLS",53,0)
 ...I NDF0 S DIE="^PSNDF(50.68,"_DA_",4,",DA(1)=DA,DA=L2(NDF0),DR=".01;" D ^DIE
"RTN","NDFRECLS",54,0)
 G G
"RTN","NDFRECLS",55,0)
END K COD,DA,DA1,DIC,DIR,DIR,DR,L1,L2,NA,NDF,NDF0,NDF1,PSB,X,Y,^TMP($J) Q
"RTN","NDFRR1")
0^38^B7091091
"RTN","NDFRR1",1,0)
NDFRR1 ;BIR/RSB-NDF ENTER EDIT PROMPTS ; 03 Sep 98 / 2:08 PM
"RTN","NDFRR1",2,0)
 ;;4.0; NDF MANAGEMENT;; 1 Jan 99;Build 1
"RTN","NDFRR1",3,0)
 ;
"RTN","NDFRR1",4,0)
GET(F1,F2,DEF,REQ,PROM)         ;
"RTN","NDFRR1",5,0)
 ;  Input F1  -  File number
"RTN","NDFRR1",6,0)
 ;  Input F2  -  Field number
"RTN","NDFRR1",7,0)
 ;  Input DEF -  Default value for prompt
"RTN","NDFRR1",8,0)
 ;  Input REQ -  Is answer required? 0 or 1
"RTN","NDFRR1",9,0)
 N NDFX K NDFABORT
"RTN","NDFRR1",10,0)
GETA D PROM(F1,F2,DEF,PROM) R NDFX:DTIME I NDFX="^"!('$T) S NDFABORT=1 Q "^"
"RTN","NDFRR1",11,0)
 I (NDFX="")&($L(DEF)) S NDFX=DEF G GETB
"RTN","NDFRR1",12,0)
 I $G(REQ)=0&(NDFX="")&('$L(DEF)) Q NDFX
"RTN","NDFRR1",13,0)
 I $G(REQ)=1&(NDFX="")&('$L(DEF)) W "  (Required)" G GETA
"RTN","NDFRR1",14,0)
 I $G(REQ)=1&(NDFX="@") W "   (Required)" H .5 G GETA
"RTN","NDFRR1",15,0)
 I NDFX="?" D HLP(F1,F2) G GETA
"RTN","NDFRR1",16,0)
 I NDFX="??" D HLP2(F1,F2) G GETA
"RTN","NDFRR1",17,0)
 I F1=50.68&(F2=".01")&(NDFX=" ") D
"RTN","NDFRR1",18,0)
 .S NDFX=$S($D(NDFSPACE):NDFSPACE,1:NDFX) W "  ",NDFX
"RTN","NDFRR1",19,0)
GETB ;I '$$CK(F1,F2,NDFX) W "  ??",$C(7) D HLP(F1,F2) G GETA
"RTN","NDFRR1",20,0)
 I F1=50.68&(F2=".01") S NDFSPACE=NDFX
"RTN","NDFRR1",21,0)
 Q NDFX
"RTN","NDFRR1",22,0)
 ;
"RTN","NDFRR1",23,0)
PROM(F1,F2,DEF,PROM)        ;
"RTN","NDFRR1",24,0)
 N NDFAM,NDFT D FIELD^DID(F1,F2,"","LABEL","NDFAM")
"RTN","NDFRR1",25,0)
 ;S NDFT="$T("_F1_F2_"^NDFRR1)",@("NDFT="_NDFT),NDFT=$P(NDFT,";;",2)
"RTN","NDFRR1",26,0)
 ;W !,$S($L(NDFT):NDFT,1:NDFAM("LABEL"))_": "
"RTN","NDFRR1",27,0)
 W !,$S($L(PROM):PROM,1:NDFAM("LABEL"))_": "
"RTN","NDFRR1",28,0)
 I $L(DEF) W " ",DEF,"//"
"RTN","NDFRR1",29,0)
 Q
"RTN","NDFRR1",30,0)
 ;
"RTN","NDFRR1",31,0)
 ;
"RTN","NDFRR1",32,0)
HLP(F1,F2) ;
"RTN","NDFRR1",33,0)
 ; Input: F1 - File #
"RTN","NDFRR1",34,0)
 ;        F2 - Field #
"RTN","NDFRR1",35,0)
 N F,F0,F3,NDFD,NDFHP,NDFT
"RTN","NDFRR1",36,0)
 D FIELD^DID(F1,F2,"","HELP-PROMPT","NDFHP")
"RTN","NDFRR1",37,0)
 I $D(NDFHP("HELP-PROMPT")) S F=$G(NDFHP("HELP-PROMPT")) W !?5 F F0=1:1:$L(F," ") S F3=$P(F," ",F0) W:$L(F3)+$X>78 !?5 W F3_" "
"RTN","NDFRR1",38,0)
 D FIELD^DID(F1,F2,"","DESCRIPTION","NDFD")
"RTN","NDFRR1",39,0)
 F F=0:0 S F=$O(NDFD("DESCRIPTION",F)) Q:'F  I $D(NDFD("DESCRIPTION",F)) W !?2,NDFD("DESCRIPTION",F)
"RTN","NDFRR1",40,0)
 Q
"RTN","NDFRR1",41,0)
 ;
"RTN","NDFRR1",42,0)
HLP2(F1,F2) ;
"RTN","NDFRR1",43,0)
 ; Input: F1 - File #
"RTN","NDFRR1",44,0)
 ;        F2 - Field #
"RTN","NDFRR1",45,0)
 N F,F0,F3,NDFD,NDFHP,NDFT
"RTN","NDFRR1",46,0)
 D FIELD^DID(F1,F2,"","HELP-PROMPT","NDFHP")
"RTN","NDFRR1",47,0)
 I $D(NDFHP("HELP-PROMPT")) S F=$G(NDFHP("HELP-PROMPT")) W !?5 F F0=1:1:$L(F," ") S F3=$P(F," ",F0) W:$L(F3)+$X>78 !?5 W F3_" "
"RTN","NDFRR1",48,0)
 D FIELD^DID(F1,F2,"","DESCRIPTION","NDFD")
"RTN","NDFRR1",49,0)
 F F=0:0 S F=$O(NDFD("DESCRIPTION",F)) Q:'F  I $D(NDFD("DESCRIPTION",F)) W !?2,NDFD("DESCRIPTION",F)
"RTN","NDFRR1",50,0)
 W ! D FIELD^DID(F1,F2,"","XECUTABLE HELP","NDFT") I $D(NDFT("XECUTABLE HELP")) X NDFT("XECUTABLE HELP")
"RTN","NDFRR1",51,0)
 Q
"RTN","NDFRR1",52,0)
 ;
"RTN","NDFRR1",53,0)
DIR(F1,F2)         ;
"RTN","NDFRR1",54,0)
 ; Input F1 - File #
"RTN","NDFRR1",55,0)
 ; Input F2 - Field #
"RTN","NDFRR1",56,0)
 N DIR S DIR(0)=F1_","_F2 D ^DIR
"RTN","NDFRR1",57,0)
 Q Y
"RTN","NDFRR1",58,0)
 ;
"RTN","NDFRR1",59,0)
 ;
"RTN","NDFRR1",60,0)
CK(F1,F2,F3)          ;
"RTN","NDFRR1",61,0)
 ; Input F1 - File #
"RTN","NDFRR1",62,0)
 ; Input F2 - Field #
"RTN","NDFRR1",63,0)
 N ANS D CHK^DIE(F1,F2,"",F3,.ANS)
"RTN","NDFRR1",64,0)
 Q $S(ANS="^":0,$D(ANS):1)
"RTN","NDFRR1",65,0)
 ;
"RTN","NDFRR1",66,0)
ADD(X,X1) ;
"RTN","NDFRR1",67,0)
 S DIR("A")="Are you adding """_X_""" as a new "_X1,DIR(0)="Y"
"RTN","NDFRR1",68,0)
 S DIR("B")="Yes" N Y D ^DIR
"RTN","NDFRR1",69,0)
 Q Y
"RTN","NDFRR1",70,0)
 ;
"RTN","NDFRR1",71,0)
SET(X,X1)          ;
"RTN","NDFRR1",72,0)
 ; place in ^TMP("NDFR",$J
"RTN","NDFRR1",73,0)
 S ^TMP("NDFR",$J,X)=X1
"RTN","NDFRR1",74,0)
 Q
"RTN","NDFRR10")
0^39^B49224079
"RTN","NDFRR10",1,0)
NDFRR10 ;BIR/RSB-EDIT NDC FIELDS ; 06/06/03 15:59
"RTN","NDFRR10",2,0)
 ;;4.0; NDF MANAGEMENT;**62**; 1 Jan 99;Build 1
"RTN","NDFRR10",3,0)
 ;Reference to ^PS(51.2 supported by DBIA #2178
"RTN","NDFRR10",4,0)
 ;
"RTN","NDFRR10",5,0)
 S NDFPCNT=0
"RTN","NDFRR10",6,0)
UPN ; ENTER NEW UPN
"RTN","NDFRR10",7,0)
 K NDFUPNI,NDFUPN
"RTN","NDFRR10",8,0)
 S (NDFM,X)=$$GET^NDFRR1(50.67,2,$S($D(^TMP("NDFD",$J,"50.67,2")):^TMP("NDFD",$J,"50.67,2"),1:""),0,"UPN")
"RTN","NDFRR10",9,0)
 I $D(NDFABORT)&('$D(NDFEDIT2)) Q
"RTN","NDFRR10",10,0)
 I $D(NDFABORT)&($D(NDFEDIT2)) Q
"RTN","NDFRR10",11,0)
 I NDFM=""&($D(^TMP("NDFD",$J,NDFPCNT,"50.67,2"))) G 6
"RTN","NDFRR10",12,0)
 I NDFM=""&('$D(NDFNDC))&('$D(NDFEDIT2)) Q
"RTN","NDFRR10",13,0)
 I NDFM=""&($D(NDFNDC)) Q
"RTN","NDFRR10",14,0)
 ;I NDFM=""&($D(NDFEDIT2)) Q       
"RTN","NDFRR10",15,0)
 I $D(^PSNDF(50.67,"UPN",NDFM)) S NDFUPNI=$O(^PSNDF(50.67,"UPN",NDFM,0)) D EN^VALM("NDF RSB NDC A/E") Q
"RTN","NDFRR10",16,0)
 I $D(^PSNDF(50.67,"UPN",NDFM)) W !,"Duplicate UPN number." H .5 G UPN
"RTN","NDFRR10",17,0)
 I '$$CK^NDFRR1(50.67,2,NDFM) D HLP^NDFRR1(50.67,2) G UPN
"RTN","NDFRR10",18,0)
 I $$CK^NDFRR1(50.67,2,NDFM)&($$ADD^NDFRR1(X,"UPN")) S NDFPCNT=NDFPCNT+1,(^TMP("NDFD",$J,NDFPCNT,"50.67,2"),NDFUPN)=NDFM
"RTN","NDFRR10",19,0)
 E  G UPN
"RTN","NDFRR10",20,0)
 Q:$D(NDFEDIT2)
"RTN","NDFRR10",21,0)
 ;
"RTN","NDFRR10",22,0)
NDC1 ;K DIR S DIR(0)="FO",DIR("A")="Enter the 12 character NDC" 
"RTN","NDFRR10",23,0)
 ;K NDFUPN,NDFLIST,NDFEDIT2,NDFVAPD,^TMP("NDFD",$J)
"RTN","NDFRR10",24,0)
 ;S DIR("?")="Enter the 10 character NDC number.  Enter ""UPN"" to enter a new UPN" D ^DIR K DIR Q:Y<0
"RTN","NDFRR10",25,0)
 ;I $D(DTOUT)!($D(DUOUT)) Q
"RTN","NDFRR10",26,0)
 ;I X="" Q
"RTN","NDFRR10",27,0)
 ;I X'?1.10N!($L(X)>12)!($L(X)<12) W !,"Answer must be a ten digit number or ""UPN""" G NDC1 Q
"RTN","NDFRR10",28,0)
 ;
"RTN","NDFRR10",29,0)
 ;
"RTN","NDFRR10",30,0)
2 ; get Package Size
"RTN","NDFRR10",31,0)
 N NDFY
"RTN","NDFRR10",32,0)
 S NDFC=$G(^TMP("NDFD",$J,"50.67,8")),NDFCC=(NDFC'["|NEW")
"RTN","NDFRR10",33,0)
 S (NDFM,X)=$$GET^NDFRR1(50.609,.01,$S(NDFCC:$S($D(^TMP("NDFD",$J,NDFPCNT,"50.67,8")):$P(^PS(50.609,^TMP("NDFD",$J,NDFPCNT,"50.67,8"),0),"^"),1:""),1:$P(NDFC,"|")),1,"Package Size") K NDFC,NDFCC
"RTN","NDFRR10",34,0)
 I $D(NDFABORT)&('$D(NDFEDIT2)) G ^NDFRR10
"RTN","NDFRR10",35,0)
 I $D(NDFABORT)&($D(NDFEDIT2)) G EXIT^NDFRR2A
"RTN","NDFRR10",36,0)
 I NDFM="" Q
"RTN","NDFRR10",37,0)
 K DIC S DIC=50.609,DIC(0)="EMZ" D ^DIC
"RTN","NDFRR10",38,0)
 I Y=-1 I '$$CK^NDFRR1(50.609,.01,NDFM) D HLP^NDFRR1(50.609,.01) G 2
"RTN","NDFRR10",39,0)
 I Y=-1 S NDFY=$$ADD^NDFRR1(NDFM,"PACKAGE SIZE") I NDFY S ^TMP("NDFD",$J,NDFPCNT,"50.67,8")=NDFM_"|NEW"
"RTN","NDFRR10",40,0)
 I $G(NDFY)=0 G 2
"RTN","NDFRR10",41,0)
 I Y=-1&('$G(NDFY)) G 2
"RTN","NDFRR10",42,0)
 I +Y>0 S NDFM=$S(Y["^":+Y,1:Y) S ^TMP("NDFD",$J,NDFPCNT,"50.67,8")=NDFM
"RTN","NDFRR10",43,0)
 ;
"RTN","NDFRR10",44,0)
3 ; get Package Type
"RTN","NDFRR10",45,0)
 N NDFY
"RTN","NDFRR10",46,0)
 S NDFC=$G(^TMP("NDFD",$J,NDFPCNT,"50.67,9")),NDFCC=(NDFC?1.9N)
"RTN","NDFRR10",47,0)
 S (NDFM,X)=$$GET^NDFRR1(50.608,.01,$S(NDFCC:$S($D(^TMP("NDFD",$J,NDFPCNT,"50.67,9")):$P(^PS(50.608,^TMP("NDFD",$J,NDFPCNT,"50.67,9"),0),"^"),1:""),1:NDFC),1,"Package Type") K NDFC,NDFCC
"RTN","NDFRR10",48,0)
 I $D(NDFABORT)&('$D(NDFEDIT2)) G ^NDFRR10
"RTN","NDFRR10",49,0)
 I $D(NDFABORT)&($D(NDFEDIT2)) G EXIT^NDFRR2A
"RTN","NDFRR10",50,0)
 I NDFM="" Q
"RTN","NDFRR10",51,0)
 K DIC S DIC=50.608,DIC(0)="EMZ" D ^DIC
"RTN","NDFRR10",52,0)
 I Y=-1 I '$$CK^NDFRR1(50.608,.01,NDFM) D HLP^NDFRR1(50.608,.01) G 3
"RTN","NDFRR10",53,0)
 I Y=-1 S NDFY=$$ADD^NDFRR1(NDFM,"PACKAGE TYPE") I NDFY S ^TMP("NDFD",$J,NDFPCNT,"50.67,9")=NDFM
"RTN","NDFRR10",54,0)
 I $G(NDFY)=1 G 4
"RTN","NDFRR10",55,0)
 I Y=-1&('$G(NDFY)) G 3
"RTN","NDFRR10",56,0)
 I +Y>0 S NDFM=$S(Y["^":+Y,1:Y) S ^TMP("NDFD",$J,NDFPCNT,"50.67,9")=NDFM
"RTN","NDFRR10",57,0)
 ;
"RTN","NDFRR10",58,0)
4 ; prompt for UPN if NDC was entered
"RTN","NDFRR10",59,0)
 I $D(NDFNDC) D UPN
"RTN","NDFRR10",60,0)
 ;
"RTN","NDFRR10",61,0)
5 ; get OTX/RX Indicator
"RTN","NDFRR10",62,0)
 K DIR
"RTN","NDFRR10",63,0)
 S:$D(^TMP("NDFD",$J,"50.67,10")) DIR("B")=$$EXTERNAL^DILFD(50.67,10,"",$G(^TMP("NDFD",$J,"50.67,10")))
"RTN","NDFRR10",64,0)
 S DIR(0)="50.67,10" D ^DIR
"RTN","NDFRR10",65,0)
 I $D(DTOUT)!($D(DUOUT))&(($D(NDFEDIT2))) G EXIT^NDFRR2A
"RTN","NDFRR10",66,0)
 I $D(DTOUT)!($D(DUOUT))&(('$D(NDFEDIT2))) G ^NDFRR10
"RTN","NDFRR10",67,0)
 ;I X="" W "  (Required)" G 17
"RTN","NDFRR10",68,0)
 I Y>-1 S ^TMP("NDFD",$J,"50.67,10")=Y
"RTN","NDFRR10",69,0)
 Q:$D(NDFEDIT2)
"RTN","NDFRR10",70,0)
 ;
"RTN","NDFRR10",71,0)
 ;G UPN  ; ask for another UPN
"RTN","NDFRR10",72,0)
 ;
"RTN","NDFRR10",73,0)
6 ; get Manufacturer
"RTN","NDFRR10",74,0)
 I $D(NDFNDC) S NDFDEF=$O(^PS(55.95,"C",$E(NDFNDC,1,6),0))
"RTN","NDFRR10",75,0)
 I  S:NDFDEF NDFDEF=$P(^PS(55.95,+NDFDEF,0),"^")
"RTN","NDFRR10",76,0)
 E  S NDFDEF=""
"RTN","NDFRR10",77,0)
 S NDFC=$G(^TMP("NDFD",$J,"50.67,3")),NDFCC=(NDFC?1.9N)
"RTN","NDFRR10",78,0)
 S (NDFM,X)=$$GET^NDFRR1(55.95,.01,$S(NDFCC:$P(^PS(55.95,^TMP("NDFD",$J,"50.67,3"),0),"^"),$L(NDFC)>1:NDFC,$L(NDFDEF):NDFDEF,1:""),1,"Manufacturer") K NDFC,NDFCC,NDFDEF
"RTN","NDFRR10",79,0)
 I $D(NDFABORT)&('$D(NDFEDIT2)) G ^NDFRR10
"RTN","NDFRR10",80,0)
 I $D(NDFABORT)&($D(NDFEDIT2)) G EXIT^NDFRR2A
"RTN","NDFRR10",81,0)
 I NDFM="" Q
"RTN","NDFRR10",82,0)
 K DIC,NDFY S DIC=55.95,DIC(0)="EMZ" D ^DIC
"RTN","NDFRR10",83,0)
 I Y=-1 I '$$CK^NDFRR1(55.95,.01,NDFM) D HLP^NDFRR1(55.95,.01) G 6
"RTN","NDFRR10",84,0)
 I Y=-1 S NDFY=$$ADD^NDFRR1(NDFM,"MANUFACTURER") I NDFY S ^TMP("NDFD",$J,"50.67,3")=NDFM
"RTN","NDFRR10",85,0)
 I $G(NDFY)=1 G 7
"RTN","NDFRR10",86,0)
 I Y=-1&('$G(NDFY)) G 6
"RTN","NDFRR10",87,0)
 I +Y>0 S NDFM=$S(Y["^":+Y,1:Y) S ^TMP("NDFD",$J,"50.67,3")=NDFM
"RTN","NDFRR10",88,0)
 Q:$D(NDFEDIT2)
"RTN","NDFRR10",89,0)
 G 8
"RTN","NDFRR10",90,0)
 ;
"RTN","NDFRR10",91,0)
7 ; prompt for NDC Identifier for new Manufacturer
"RTN","NDFRR10",92,0)
 S (NDFM,X)=$$GET^NDFRR1(55.95,1,$E(NDFNDC,1,6),1,"NDC Identifier")
"RTN","NDFRR10",93,0)
 I $D(NDFABORT)&('$D(NDFEDIT2)) G ^NDFRR10
"RTN","NDFRR10",94,0)
 I $D(NDFABORT)&($D(NDFEDIT2)) G EXIT^NDFRR2A
"RTN","NDFRR10",95,0)
 ;I NDFM=""&('$D(NDFEDIT2)) G 8
"RTN","NDFRR10",96,0)
 ;I NDFM=""&($D(NDFEDIT2)) Q       
"RTN","NDFRR10",97,0)
 I '$$CK^NDFRR1(55.95,1,NDFM) D HLP^NDFRR1(55.95,1) G 7
"RTN","NDFRR10",98,0)
 I $$CK^NDFRR1(55.95,1,NDFM) S $P(^TMP("NDFD",$J,"50.67,3"),"^",2)=NDFM
"RTN","NDFRR10",99,0)
 Q:$D(NDFEDIT2)
"RTN","NDFRR10",100,0)
 ;
"RTN","NDFRR10",101,0)
8 ; get Trade Name
"RTN","NDFRR10",102,0)
 S (NDFM,X)=$$GET^NDFRR1(50.67,4,$G(^TMP("NDFD",$J,"50.67,4")),0,"Trade Name")
"RTN","NDFRR10",103,0)
 I $D(NDFABORT)&('$D(NDFEDIT2)) G ^NDFRR10
"RTN","NDFRR10",104,0)
 I $D(NDFABORT)&($D(NDFEDIT2)) G EXIT^NDFRR2A
"RTN","NDFRR10",105,0)
 ;I NDFM=""&('$D(NDFEDIT2)) G 8
"RTN","NDFRR10",106,0)
 ;I NDFM=""&($D(NDFEDIT2)) Q       
"RTN","NDFRR10",107,0)
 I '$$CK^NDFRR1(50.67,4,NDFM) D HLP^NDFRR1(50.67,4) G 8
"RTN","NDFRR10",108,0)
 I $$CK^NDFRR1(50.67,4,NDFM) S ^TMP("NDFD",$J,"50.67,4")=NDFM
"RTN","NDFRR10",109,0)
 Q:$D(NDFEDIT2)
"RTN","NDFRR10",110,0)
 ;
"RTN","NDFRR10",111,0)
88      ;  Route of Administration
"RTN","NDFRR10",112,0)
 S CNT=0,NDFADMIN=1
"RTN","NDFRR10",113,0)
888 S (NDFM,X)=$$GET^NDFRR1(51.2,.01,"",0,"Route of Administration")
"RTN","NDFRR10",114,0)
 I $D(NDFABORT)&('$D(NDFEDIT2)) G ^NDFRR2
"RTN","NDFRR10",115,0)
 I $D(NDFABORT)&($D(NDFEDIT2)) G EXIT^NDFRR2A
"RTN","NDFRR10",116,0)
 ;I NDFM=""&($D(^TMP("NDFR",$J,"50.6816,.01")))&('$D(NDFEDIT2)) G 9
"RTN","NDFRR10",117,0)
 ;I NDFM=""&($D(^TMP("NDFR",$J,"50.6816,.01")))&($D(NDFEDIT2)) Q
"RTN","NDFRR10",118,0)
 I NDFM=""&('$D(NDFEDIT2)) G 9
"RTN","NDFRR10",119,0)
 I NDFM=""&($D(NDFEDIT2)) Q
"RTN","NDFRR10",120,0)
 K DIC S DIC=51.2,DIC(0)="EMZ" D ^DIC
"RTN","NDFRR10",121,0)
 I Y=-1 D  G 888
"RTN","NDFRR10",122,0)
 .I '$$CK^NDFRR1(51.2,.01,NDFM) D HLP^NDFRR1(51.2,.01)
"RTN","NDFRR10",123,0)
 S NDFM=Y(0,0),CNT=CNT+1 S ^TMP("NDFD",$J,"50.676,.01",CNT)=NDFM
"RTN","NDFRR10",124,0)
 I '$D(^TMP("NDFD",$J,"50.676,.01")) W "  (Required)" G 888
"RTN","NDFRR10",125,0)
 G 888
"RTN","NDFRR10",126,0)
 ;
"RTN","NDFRR10",127,0)
9 ; get VA Product Name
"RTN","NDFRR10",128,0)
 I $D(NDFNDC) D FIND
"RTN","NDFRR10",129,0)
 D ^NDFRR2
"RTN","NDFRR10",130,0)
 I $D(NDFABORT) Q
"RTN","NDFRR10",131,0)
 I '$D(^TMP("NDFD",$J,"50.67,5")) G 9
"RTN","NDFRR10",132,0)
 D EN^VALM("NDF RSB NDC A/E") Q
"RTN","NDFRR10",133,0)
 Q
"RTN","NDFRR10",134,0)
 ;
"RTN","NDFRR10",135,0)
FIND ;
"RTN","NDFRR10",136,0)
 S NDFL=NDFNDC,NDFX=NDFL_"00" F  S NDFX=$O(^PSNDF(50.67,"NDC",NDFX)) Q:NDFX=""!($E(NDFX,1,10)'=NDFL)  D
"RTN","NDFRR10",137,0)
 .F NDF1=0:0 S NDF1=$O(^PSNDF(50.67,"NDC",NDFX,NDF1)) Q:'NDF1!($D(NDFVAPD))  D
"RTN","NDFRR10",138,0)
 ..S NDFVAPD=$P(^PSNDF(50.67,NDF1,0),"^",6)
"RTN","NDFRR10",139,0)
 ..S NDFVAPD=$P(^PSNDF(50.68,+NDFVAPD,0),"^")
"RTN","NDFRR10",140,0)
 Q
"RTN","NDFRR10",141,0)
 ;
"RTN","NDFRR10",142,0)
E ; edit multiple package codes
"RTN","NDFRR10",143,0)
 W ! K DIR
"RTN","NDFRR10",144,0)
 S DIR("A",1)="Only Product Codes that have just been entered may be deleted."
"RTN","NDFRR10",145,0)
 S DIR("A")="Do you wish to Edit or Delete "
"RTN","NDFRR10",146,0)
 S DIR("A")=DIR("A")_$S($D(^TMP("NDFD",$J,NDFANS,"NDF2DIG"))!($D(NDFNDC)):"Package Code: ",1:"UPN: ")
"RTN","NDFRR10",147,0)
 S DIR("A")=DIR("A")_$S($D(^TMP("NDFD",$J,NDFANS,"NDF2DIG")):^TMP("NDFD",$J,NDFANS,"NDF2DIG"),$L($G(^TMP("NDFD",$J,NDFANS,"50.67,1"))):$E($G(^TMP("NDFD",$J,NDFANS,"50.67,1")),11,12),1:$G(^TMP("NDFD",$J,NDFANS,"50.67,2")))
"RTN","NDFRR10",148,0)
 S DIR(0)="SBOM^E:Edit entries;D:Delete entries" D ^DIR K DIR
"RTN","NDFRR10",149,0)
 I Y="E" D 2^NDFRR9 Q
"RTN","NDFRR10",150,0)
 I Y="D" D EDEL Q
"RTN","NDFRR10",151,0)
 Q
"RTN","NDFRR10",152,0)
EDEL ;
"RTN","NDFRR10",153,0)
 I $D(^TMP("NDFD",$J,NDFANS,"50.67,SEQ")) W !,"Can't be deleted from file." H .6 Q
"RTN","NDFRR10",154,0)
 K ^TMP("NDFD",$J,NDFANS) W !?15," (Deleted)" H .6 S VALMBCK="Q"
"RTN","NDFRR10",155,0)
 Q
"RTN","NDFRR10",156,0)
 ;
"RTN","NDFRR10",157,0)
CLEAN ;
"RTN","NDFRR10",158,0)
 K ^TMP("NDFRSB",$J),^TMP("NDFDRSB",$J)
"RTN","NDFRR10",159,0)
 K ^TMP("NDFD",$J),^TMP("NDFR",$J)
"RTN","NDFRR10",160,0)
 K NDCNT,DNF1,NDFABORT,NDFADD,NDFADMIN,NDFAM,NDFANS,NDFAS,NDFC,NDFCC
"RTN","NDFRR10",161,0)
 K NDFCLASS,NDFCNEW,NDFD,NDFDEF,NDFDEF1,NDFE,NDFEDIT2,NDFG,NDFHP,NDFIEN
"RTN","NDFRR10",162,0)
 K NDFIG,NDFINGL,NDFEDIT2,NDFUPNI,NDFLL
"RTN","NDFRR10",163,0)
 K NDFL,NDFLIST,NDFM,NDFNAME,NDFNDC,NDFNEW,NDFNUM,NDFNW,NDFPCNT
"RTN","NDFRR10",164,0)
 K NDFPOSS,NDFSAVE,NDFSPACE,NDFT,NDFUPN,NDFVAPD,NDFX,NDFY,NEW,NFIELD
"RTN","NDFRR10",165,0)
 K ADESC,AMATCH,ANODE,ASEQNO,ASKHIM,AUTO,BILL,BILLWILL,BRT,BT,DAT,DAT1
"RTN","NDFRR10",166,0)
 K FLAGIT,GCN,GCN1,IEN,IFN,NDC,NDC1,NUM,OGCN,OLDGCN,PREV,PSEQNO,REC
"RTN","NDFRR10",167,0)
 K RECRD,SEQNO,WILL,WRT,FDB,FDBGCN,PPP,PEEYOU,TAT
"RTN","NDFRR10",168,0)
 Q
"RTN","NDFRR10",169,0)
FRESH ; Cleanup before new selection
"RTN","NDFRR10",170,0)
 K ADESC,AMATCH,ANODE,ASEQNO,ASKHIM,AUTO,BILL,BILLWILL,BRT,BT,DAT,DAT1
"RTN","NDFRR10",171,0)
 K FLAGIT,GCN,GCN1,IEN,IFN,NDC,NDC1,NUM,OGCN,OLDGCN,PREV,PSEQNO,REC
"RTN","NDFRR10",172,0)
 K RECRD,SEQNO,WILL,WRT,FDB,FDBGCN,PPP,PEEYOU,TAT
"RTN","NDFRR10",173,0)
 Q
"RTN","NDFRR2")
0^40^B70274183
"RTN","NDFRR2",1,0)
NDFRR2 ;BIR/RSB-PRODUCT EDIT ; 21 Aug 2009  6:45 AM
"RTN","NDFRR2",2,0)
 ;;4.0; NDF MANAGEMENT;**62**; 1 Jan 99;Build 1
"RTN","NDFRR2",3,0)
 ;
"RTN","NDFRR2",4,0)
 W @IOF K ^TMP("NDFR",$J) D FRESH^NDFRR10 S NDFNEW=1
"RTN","NDFRR2",5,0)
1 ; get VA Product Name
"RTN","NDFRR2",6,0)
 D SHOW^NDFRR998
"RTN","NDFRR2",7,0)
 I $G(^TMP("NDFD",$J,"FDBLINK")) W !!,"Associated FDB Information:",! W $P($G(^TMP("NDFD",$J,"FDBLINK")),"^"),!!
"RTN","NDFRR2",8,0)
 K NDFNAME,NDFNW,^TMP("NDFR",$J)
"RTN","NDFRR2",9,0)
 S (NDFM,X)=$$GET^NDFRR1(50.68,.01,$G(NDFVAPD),0,"Enter VA Product Name")
"RTN","NDFRR2",10,0)
 I NDFM=""!(NDFM="^") Q
"RTN","NDFRR2",11,0)
 D FRESH^NDFRR10
"RTN","NDFRR2",12,0)
 K DIC S DIC=50.68,DIC(0)="EMZ",DIC("W")="I Y>0&($G(^PSNDF(50.68,+Y,7))'="""") I $P(^(7),U,3)'="""" S Y1=Y,Y=$P(^(7),U,3) D DD^%DT W Y S Y=Y1" D ^DIC
"RTN","NDFRR2",13,0)
 ;S DIC=50.68,DIC(0)="EMZ" D ^DIC
"RTN","NDFRR2",14,0)
 I +Y>0 S NDFNAME=Y S:$D(NDFNDC)!($D(NDFUPN))!($D(NDFUPNI)) ^TMP("NDFD",$J,"50.67,5")=+Y K NDFCLASS,NDFINGL D EN^VALM("NDF RSB ACCEPT/EDIT") Q:$D(NDFNDC)!($D(NDFUPN))!($D(NDFUPNI))  G 1
"RTN","NDFRR2",15,0)
 I Y=-1 D
"RTN","NDFRR2",16,0)
 .I '$$CK^NDFRR1(50.68,.01,NDFM) D HLP^NDFRR1(50.68,.01) G 1
"RTN","NDFRR2",17,0)
 .S NDFADD=0 I $$ADD^NDFRR1(NDFM,"VA PRODUCT") K ^TMP("NDFR",$J) D SET^NDFRR1("50.68,.01",NDFM) S:$L(^TMP("NDFR",$J,"50.68,.01"))<41 ^TMP("NDFR",$J,"50.68,5")=^TMP("NDFR",$J,"50.68,.01") S NDFADD=1
"RTN","NDFRR2",18,0)
 I '$G(NDFADD) G 1
"RTN","NDFRR2",19,0)
 S NDFNW=1 ; is this a new entry
"RTN","NDFRR2",20,0)
 ;
"RTN","NDFRR2",21,0)
2 ;  ACTIVE INGREDIENTS
"RTN","NDFRR2",22,0)
 S CNT=0
"RTN","NDFRR2",23,0)
21 W ! S (NDFM,X)=$$GET^NDFRR1(50.416,.01,"",0,"Active Ingredients")
"RTN","NDFRR2",24,0)
 I $D(NDFABORT)&('$D(NDFEDIT)) G ^NDFRR2
"RTN","NDFRR2",25,0)
 I NDFM=""&('$D(NDFEDIT)) G 5
"RTN","NDFRR2",26,0)
 I NDFM=""&($D(NDFEDIT)) Q
"RTN","NDFRR2",27,0)
 K DIC S DIC=50.416,DIC(0)="EMZ" D ^DIC
"RTN","NDFRR2",28,0)
 S NDFY=Y I NDFY=-1 D
"RTN","NDFRR2",29,0)
 .S CNT=CNT+1
"RTN","NDFRR2",30,0)
 .I '$$CK^NDFRR1(50.416,.01,NDFM) D HLP^NDFRR1(50.416,.01) Q
"RTN","NDFRR2",31,0)
 .S NDFADD=0 I $$ADD^NDFRR1(NDFM,"DRUG INGREDIENT") S ^TMP("NDFR",$J,"50.6814",CNT)=NDFM,NDFADD=1 D
"RTN","NDFRR2",32,0)
 ..K DIR S DIR(0)="Y",DIR("A")="Is this a primary ingredient" D ^DIR
"RTN","NDFRR2",33,0)
 ..I Y=0 D
"RTN","NDFRR2",34,0)
 ...S DIC=50.416,DIC(0)="QEALMZ",DIC("A")="Enter Primary ingredient: " D ^DIC
"RTN","NDFRR2",35,0)
 ...I Y<0 W !,"Not Marked"
"RTN","NDFRR2",36,0)
 ...I Y>0 S $P(^TMP("NDFR",$J,"50.6814",CNT),"|",4)=+Y
"RTN","NDFRR2",37,0)
 I NDFY=-1&('NDFADD) G 21
"RTN","NDFRR2",38,0)
 I NDFY>0 D
"RTN","NDFRR2",39,0)
 .I $P(^PS(50.416,+Y,0),"^",2) W !?30," (Primary Ingredient)",$C(7)
"RTN","NDFRR2",40,0)
 .S CNT=CNT+1 S ^TMP("NDFR",$J,"50.6814",CNT)=+Y
"RTN","NDFRR2",41,0)
 Q:$D(NDFEDIT)
"RTN","NDFRR2",42,0)
 ;
"RTN","NDFRR2",43,0)
 ;
"RTN","NDFRR2",44,0)
3 ;  STRENGTH
"RTN","NDFRR2",45,0)
 S (NDFM,X)=$$GET^NDFRR1(50.6814,1,"",0,"Strength")
"RTN","NDFRR2",46,0)
 I $D(NDFABORT)&('$D(NDFEDIT)) G ^NDFRR2
"RTN","NDFRR2",47,0)
 I $D(NDFABORT)&($D(NDFEDIT)) G EXIT^NDFRR2A
"RTN","NDFRR2",48,0)
 I NDFM=""&('$D(NDFEDIT)) G 4
"RTN","NDFRR2",49,0)
 I NDFM=""&($D(NDFEDIT)) Q
"RTN","NDFRR2",50,0)
 I '$$CK^NDFRR1(50.6814,1,NDFM) D HLP^NDFRR1(50.6814,1) G 3
"RTN","NDFRR2",51,0)
 I $$CK^NDFRR1(50.6814,1,NDFM) S $P(^TMP("NDFR",$J,"50.6814",CNT),"|",2)=NDFM
"RTN","NDFRR2",52,0)
 Q:$D(NDFEDIT)
"RTN","NDFRR2",53,0)
 ;
"RTN","NDFRR2",54,0)
4 ;  UNITS
"RTN","NDFRR2",55,0)
 S (NDFM,X)=$$GET^NDFRR1(50.6814,2,"",0,"Units")
"RTN","NDFRR2",56,0)
 I $D(NDFABORT)&('$D(NDFEDIT)) G ^NDFRR2
"RTN","NDFRR2",57,0)
 I $D(NDFABORT)&($D(NDFEDIT)) G EXIT^NDFRR2A
"RTN","NDFRR2",58,0)
 I NDFM=""&('$D(NDFEDIT)) G 21
"RTN","NDFRR2",59,0)
 I NDFM=""&($D(NDFEDIT)) Q
"RTN","NDFRR2",60,0)
 ;I $D(NDFABORT) G EXIT^NDFRR2A
"RTN","NDFRR2",61,0)
 ;I NDFM="" Q
"RTN","NDFRR2",62,0)
 K DIC S DIC=50.607,DIC(0)="EMZ" D ^DIC K DIC
"RTN","NDFRR2",63,0)
 I Y=-1 D  G 4
"RTN","NDFRR2",64,0)
 .I '$$CK^NDFRR1(50.6814,2,NDFM) D HLP^NDFRR1(50.6814,2)
"RTN","NDFRR2",65,0)
 .;I $$CK^NDFRR1(50.6814,2,NDFM) S $P(^TMP("NDFR",$J,"50.6814",CNT),"|",3)=NDFM
"RTN","NDFRR2",66,0)
 E  S NDFM=$S(Y["^":+Y,1:Y) S $P(^TMP("NDFR",$J,"50.6814",CNT),"|",3)=NDFM
"RTN","NDFRR2",67,0)
 G 21
"RTN","NDFRR2",68,0)
 ;
"RTN","NDFRR2",69,0)
5 ; VA GENERIC NAME
"RTN","NDFRR2",70,0)
 N ADD S NDFC=$G(^TMP("NDFR",$J,"50.68,.05")),NDFCC=(NDFC?1.9N)
"RTN","NDFRR2",71,0)
 S (NDFM,X)=$$GET^NDFRR1(50.6,.01,$S(NDFCC:$S($D(^TMP("NDFR",$J,"50.68,.05")):$P(^PSNDF(50.6,^TMP("NDFR",$J,"50.68,.05"),0),"^"),1:""),1:NDFC),1,"VA Generic Name") K NDFC,NDFCC
"RTN","NDFRR2",72,0)
 I $D(NDFABORT)&('$D(NDFEDIT)) G ^NDFRR2
"RTN","NDFRR2",73,0)
 I $D(NDFABORT)&($D(NDFEDIT)) G EXIT^NDFRR2A
"RTN","NDFRR2",74,0)
 I NDFM="" Q
"RTN","NDFRR2",75,0)
 K DIC S DIC=50.6,DIC(0)="EMZ" D ^DIC K DIC
"RTN","NDFRR2",76,0)
 I Y=-1 I '$$CK^NDFRR1(50.6,.01,NDFM) D HLP^NDFRR1(50.68,.05) G 5
"RTN","NDFRR2",77,0)
 I Y=-1 S ADD=$$ADD^NDFRR1(NDFM,"VA GENERIC NAME") I ADD S ^TMP("NDFR",$J,"50.68,.05")=NDFM
"RTN","NDFRR2",78,0)
 I $G(ADD)=0 G 5
"RTN","NDFRR2",79,0)
 ; screen out inactive entries
"RTN","NDFRR2",80,0)
 I +Y>0 I $P(^PSNDF(50.6,+Y,0),"^",2)&($P(^PSNDF(50.6,+Y,0),"^",2)'>DT) W "    (Inactive)" H .4 G 5
"RTN","NDFRR2",81,0)
 I +Y>0 S NDFM=$S(Y["^":+Y,1:Y) S ^TMP("NDFR",$J,"50.68,.05")=NDFM
"RTN","NDFRR2",82,0)
 Q:$D(NDFEDIT)
"RTN","NDFRR2",83,0)
 ;
"RTN","NDFRR2",84,0)
 ;
"RTN","NDFRR2",85,0)
6 ; DOSAGE FORM
"RTN","NDFRR2",86,0)
 N NDFY
"RTN","NDFRR2",87,0)
 S NDFC=$G(^TMP("NDFR",$J,"50.68,1")),NDFCC=(NDFC?1.9N)
"RTN","NDFRR2",88,0)
 S (NDFM,X)=$$GET^NDFRR1(50.606,.01,$S(NDFCC:$S($D(^TMP("NDFR",$J,"50.68,1")):$P(^PS(50.606,^TMP("NDFR",$J,"50.68,1"),0),"^"),1:""),1:NDFC),1,"Dosage Form") K NDFC,NDFCC
"RTN","NDFRR2",89,0)
 I $D(NDFABORT)&('$D(NDFEDIT)) G ^NDFRR2
"RTN","NDFRR2",90,0)
 I $D(NDFABORT)&($D(NDFEDIT)) G EXIT^NDFRR2A
"RTN","NDFRR2",91,0)
 I NDFM="" Q
"RTN","NDFRR2",92,0)
 K DIC S DIC=50.606,DIC(0)="EMZ" D ^DIC
"RTN","NDFRR2",93,0)
 I Y=-1 I '$$CK^NDFRR1(50.606,.01,NDFM) D HLP^NDFRR1(50.606,1) W "  ??" G 6
"RTN","NDFRR2",94,0)
 I Y=-1 S NDFY=$$ADD^NDFRR1(NDFM,"DOSAGE FORM") I NDFY S ^TMP("NDFR",$J,"50.68,1")=NDFM
"RTN","NDFRR2",95,0)
 I $G(NDFY)=0 G 6
"RTN","NDFRR2",96,0)
 I +Y>0 S NDFM=$S(Y["^":+Y,1:Y) S ^TMP("NDFR",$J,"50.68,1")=NDFM
"RTN","NDFRR2",97,0)
 Q:$D(NDFEDIT)
"RTN","NDFRR2",98,0)
 ;
"RTN","NDFRR2",99,0)
 ;
"RTN","NDFRR2",100,0)
7 ;  STRENGTH
"RTN","NDFRR2",101,0)
 S (NDFM,X)=$$GET^NDFRR1(50.6814,1,$S($D(^TMP("NDFR",$J,"50.68,2")):^TMP("NDFR",$J,"50.68,2"),1:""),0,"Strength")
"RTN","NDFRR2",102,0)
 I $D(NDFABORT)&('$D(NDFEDIT)) G ^NDFRR2
"RTN","NDFRR2",103,0)
 I $D(NDFABORT)&($D(NDFEDIT)) G EXIT^NDFRR2A
"RTN","NDFRR2",104,0)
 I NDFM=""&('$D(NDFEDIT)) G 8
"RTN","NDFRR2",105,0)
 I NDFM=""&($D(NDFEDIT)) Q
"RTN","NDFRR2",106,0)
 I '$$CK^NDFRR1(50.68,2,NDFM) D HLP^NDFRR1(50.68,2) G 7
"RTN","NDFRR2",107,0)
 I $$CK^NDFRR1(50.68,2,NDFM) S ^TMP("NDFR",$J,"50.68,2")=NDFM
"RTN","NDFRR2",108,0)
 Q:$D(NDFEDIT)
"RTN","NDFRR2",109,0)
 ;
"RTN","NDFRR2",110,0)
8 ;  UNITS
"RTN","NDFRR2",111,0)
 S (NDFM,X)=$$GET^NDFRR1(50.68,3,$S($G(^TMP("NDFR",$J,"50.68,3")):$P(^PS(50.607,^TMP("NDFR",$J,"50.68,3"),0),"^"),1:""),0,"Units")
"RTN","NDFRR2",112,0)
 I $D(NDFABORT)&('$D(NDFEDIT)) G ^NDFRR2
"RTN","NDFRR2",113,0)
 I $D(NDFABORT)&($D(NDFEDIT)) G EXIT^NDFRR2A
"RTN","NDFRR2",114,0)
 I NDFM=""&('$D(NDFEDIT)) G 9
"RTN","NDFRR2",115,0)
 I NDFM=""&($D(NDFEDIT)) Q
"RTN","NDFRR2",116,0)
 K DIC S DIC=50.607,DIC(0)="EMZ" D ^DIC
"RTN","NDFRR2",117,0)
 I Y=-1 D  G 8
"RTN","NDFRR2",118,0)
 .I '$$CK^NDFRR1(50.68,3,NDFM) D HLP^NDFRR1(50.68,3)
"RTN","NDFRR2",119,0)
 .;I $$CK^NDFRR1(50.68,3,NDFM) D SET^NDFRR1("50.68,3",NDFM)
"RTN","NDFRR2",120,0)
 I $$CK^NDFRR1(50.68,3,NDFM) S NDFM=$S(Y["^":+Y,1:Y) S ^TMP("NDFR",$J,"50.68,3")=NDFM
"RTN","NDFRR2",121,0)
 Q:$D(NDFEDIT)
"RTN","NDFRR2",122,0)
 ;
"RTN","NDFRR2",123,0)
9 ; NATIONAL FORMULARY NAME
"RTN","NDFRR2",124,0)
 ;
"RTN","NDFRR2",125,0)
 K NDFDEF,NDFC,NDFCC
"RTN","NDFRR2",126,0)
 S NDFC=$G(^TMP("NDFR",$J,"50.68,.05")) S NDFCC=(NDFC?1.9N)
"RTN","NDFRR2",127,0)
 S NDFDEF=$S(NDFCC:$P($G(^PSNDF(50.6,^TMP("NDFR",$J,"50.68,.05"),0)),"^"),1:$G(^TMP("NDFR",$J,"50.68,.05")))
"RTN","NDFRR2",128,0)
 S NDFC=$G(^TMP("NDFR",$J,"50.68,1")) S NDFCC=(NDFC?1.9N)
"RTN","NDFRR2",129,0)
 S NDFDEF=NDFDEF_" "_$S(NDFCC:$P($G(^PS(50.606,^TMP("NDFR",$J,"50.68,1"),0)),"^"),1:^TMP("NDFR",$J,"50.68,1"))
"RTN","NDFRR2",130,0)
 I $G(^TMP("NDFR",$J,"50.68,4"))]"" S NDFDEF=^("50.68,4")
"RTN","NDFRR2",131,0)
 S (NDFM,X)=$$GET^NDFRR1(50.68,4,NDFDEF,1,"National Formulary Name")
"RTN","NDFRR2",132,0)
 I $D(NDFABORT)&('$D(NDFEDIT)) G ^NDFRR2
"RTN","NDFRR2",133,0)
 I $D(NDFABORT)&($D(NDFEDIT)) G EXIT^NDFRR2A
"RTN","NDFRR2",134,0)
 I NDFM="" Q
"RTN","NDFRR2",135,0)
 I '$$CK^NDFRR1(50.68,4,NDFM) D HLP^NDFRR1(50.68,4) G 9
"RTN","NDFRR2",136,0)
 S ^TMP("NDFR",$J,"50.68,4")=NDFM
"RTN","NDFRR2",137,0)
 S ^TMP("NDFR",$J,"50.68,4")=NDFM
"RTN","NDFRR2",138,0)
 K NDFDEF
"RTN","NDFRR2",139,0)
 Q:$D(NDFEDIT)
"RTN","NDFRR2",140,0)
 ;
"RTN","NDFRR2",141,0)
 ;
"RTN","NDFRR2",142,0)
10 ; VA PRINT NAME
"RTN","NDFRR2",143,0)
 ;
"RTN","NDFRR2",144,0)
 K NDFDEF
"RTN","NDFRR2",145,0)
 S NDFDEF=$S($L($G(^TMP("NDFR",$J,"50.68,5"))):$G(^TMP("NDFR",$J,"50.68,5")),$L(^TMP("NDFR",$J,"50.68,.01"))<41:^TMP("NDFR",$J,"50.68,.01"),1:"")
"RTN","NDFRR2",146,0)
 N CHANGE S CHANGE=$G(^TMP("NDFR",$J,"50.68,5"))
"RTN","NDFRR2",147,0)
 S (NDFM,X)=$$GET^NDFRR1(50.68,5,NDFDEF,1,"VA Print Name")
"RTN","NDFRR2",148,0)
 I $D(NDFABORT)&('$D(NDFEDIT)) G ^NDFRR2
"RTN","NDFRR2",149,0)
 I $D(NDFABORT)&($D(NDFEDIT)) G EXIT^NDFRR2A
"RTN","NDFRR2",150,0)
 I NDFM="" Q
"RTN","NDFRR2",151,0)
 I '$$CK^NDFRR1(50.68,5,NDFM) D HLP^NDFRR1(50.68,5) G 10
"RTN","NDFRR2",152,0)
 S ^TMP("NDFR",$J,"50.68,5")=NDFM
"RTN","NDFRR2",153,0)
 K NDFDEF
"RTN","NDFRR2",154,0)
 I CHANGE'=^TMP("NDFR",$J,"50.68,5")&('$D(NDFNW)) D 119
"RTN","NDFRR2",155,0)
 Q:$D(NDFEDIT)
"RTN","NDFRR2",156,0)
 ;
"RTN","NDFRR2",157,0)
11 ;  VA PRODUCT IDENTIFIER
"RTN","NDFRR2",158,0)
 N SUP,ADD K NDFDEF
"RTN","NDFRR2",159,0)
 I '$D(NDFEDIT) D
"RTN","NDFRR2",160,0)
 .W !,"The next available ID# is ",$$FINDPROD(0)
"RTN","NDFRR2",161,0)
119 ;
"RTN","NDFRR2",162,0)
 W !,"*******",!,"SUP=",$D(SUP),!,"NDFNW=",$D(NDFNW),!,"CHANGE=",$D(CHANGE)
"RTN","NDFRR2",163,0)
 W !,"TMP 50.68,6 =",$G(^TMP("NDFR",$J,"50.68,6"))
"RTN","NDFRR2",164,0)
 W !,"CHANGE=",$D(CHANGE),!,"*********"
"RTN","NDFRR2",165,0)
 S NDFDEF=$S($D(SUP):SUP,$D(NDFNW)!($D(CHANGE)):$$FINDPROD(0),1:$S($D(^TMP("NDFR",$J,"50.68,6")):^TMP("NDFR",$J,"50.68,6"),1:"")),ADD=1
"RTN","NDFRR2",166,0)
 I (NDFDEF=""!($D(CHANGE)))&('$D(NDFNW))&('$D(SUP)) W !,"The next available ID# is ",$$FINDPROD(0) S NDFDEF=$$FINDPROD(0)
"RTN","NDFRR2",167,0)
 S (NDFM,X)=$$GET^NDFRR1(50.68,6,NDFDEF,1,"VA Product Identifier")
"RTN","NDFRR2",168,0)
 I $D(NDFABORT)&('$D(NDFEDIT)) G ^NDFRR2
"RTN","NDFRR2",169,0)
 I $D(NDFABORT)&($D(NDFEDIT)) G EXIT^NDFRR2A
"RTN","NDFRR2",170,0)
 I NDFM="" Q
"RTN","NDFRR2",171,0)
 I NDFM="SUP" S SUP=$$FINDPROD(1) G 119
"RTN","NDFRR2",172,0)
 I $E(NDFM,2,5)["O" W !,"Number contains the letter O",$C(7) G 11
"RTN","NDFRR2",173,0)
 I '$$CK^NDFRR1(50.68,6,NDFM) D HLP^NDFRR1(50.68,6) G 11
"RTN","NDFRR2",174,0)
 I $$CHECKP^NDFRR3($G(^TMP("NDFR",$J,"50.68,5"))) W !,$C(7),NDFM," is assigned to another VA Product name with a different Print Name." G 119
"RTN","NDFRR2",175,0)
 ; find and check identifier
"RTN","NDFRR2",176,0)
 I $D(^PSNDF(50.68,"C",NDFM)) S ADD=$$PROD(NDFM) I ADD S ^TMP("NDFR",$J,"50.68,6")=NDFM
"RTN","NDFRR2",177,0)
 I $G(ADD)=0 G 119
"RTN","NDFRR2",178,0)
 S ^TMP("NDFR",$J,"50.68,6")=NDFM
"RTN","NDFRR2",179,0)
 K NDFDEF
"RTN","NDFRR2",180,0)
 Q:$D(NDFEDIT)  G ^NDFRR22
"RTN","NDFRR2",181,0)
 ;
"RTN","NDFRR2",182,0)
FINDPROD(SUP) ; find next available number
"RTN","NDFRR2",183,0)
 N LAST,LET,II,END,SETID
"RTN","NDFRR2",184,0)
 I 'SUP D
"RTN","NDFRR2",185,0)
 .S LET=$S($D(NDFNW):$E(^TMP("NDFR",$J,"50.68,.01"),1,1),1:$E($P(NDFNAME,"^",2),1,1))
"RTN","NDFRR2",186,0)
 .S II=LET_"0000" F  S II=$O(^PSNDF(50.68,"C",II)) Q:II=""!($E(II,1,1)'=LET)!($E(II,2)'?1N)  S LAST=II
"RTN","NDFRR2",187,0)
 .I $D(LAST) S END=$E(LAST,2,5)+1 S:$L(END)=3 END="0"_END S:$L(END)=2 END="00"_END S:$L(END)=1 END="000"_END S SETID=$E(LAST,1,1)_END
"RTN","NDFRR2",188,0)
 .I '$D(LAST) S:'$D(LAST) SETID=LET_"0001"
"RTN","NDFRR2",189,0)
 I SUP D
"RTN","NDFRR2",190,0)
 .S LET="XR"
"RTN","NDFRR2",191,0)
 .S II=LET_"000" F  S II=$O(^PSNDF(50.68,"C",II)) Q:II=""!($E(II,1,2)'=LET)  S LAST=II
"RTN","NDFRR2",192,0)
 .I $D(LAST) S END=$E(LAST,3,5)+1 S:$L(END)=2 END="0"_END S:$L(END)=1 END="00"_END S SETID=$E(LAST,1,2)_END
"RTN","NDFRR2",193,0)
 .I '$D(LAST) S:'$D(LAST) SETID=LET_"001"
"RTN","NDFRR2",194,0)
 Q SETID
"RTN","NDFRR2",195,0)
 ;
"RTN","NDFRR2",196,0)
PROD(NDFM) ;
"RTN","NDFRR2",197,0)
 N DIR
"RTN","NDFRR2",198,0)
 I +$O(^PSNDF(50.68,"C",NDFM,0))=$P($G(NDFNAME),"^") Q 1
"RTN","NDFRR2",199,0)
 W !,NDFM," is already assigned to VA Product name ",$P(^PSNDF(50.68,+$O(^PSNDF(50.68,"C",NDFM,0)),0),"^")
"RTN","NDFRR2",200,0)
 S DIR(0)="Y",DIR("A")="Do you want to still assign this number" D ^DIR
"RTN","NDFRR2",201,0)
 Q Y
"RTN","NDFRR2",202,0)
 ;
"RTN","NDFRR2",203,0)
 ;
"RTN","NDFRR2",204,0)
 G ^NDFRR22
"RTN","NDFRR22")
0^41^B11657258
"RTN","NDFRR22",1,0)
NDFRR22 ;BIR/RSB-PRODUCT EDIT ; 06/03/03 15:08
"RTN","NDFRR22",2,0)
 ;;4.0; NDF MANAGEMENT;**62**; 1 Jan 99;Build 1
"RTN","NDFRR22",3,0)
 ;
"RTN","NDFRR22",4,0)
12 ; VA DISPENSE UNIT
"RTN","NDFRR22",5,0)
 N NDFY,CHANGE
"RTN","NDFRR22",6,0)
 S (NDFC,CHANGE)=$G(^TMP("NDFR",$J,"50.68,8")) S NDFCC=(NDFC?1.9N)
"RTN","NDFRR22",7,0)
 S (NDFM,X)=$$GET^NDFRR1(50.64,.01,$S(NDFCC:$S($D(^TMP("NDFR",$J,"50.68,8")):$P(^PSNDF(50.64,^TMP("NDFR",$J,"50.68,8"),0),"^"),1:""),1:NDFC),1,"VA Dispense Unit") K NDFC,NDFCC
"RTN","NDFRR22",8,0)
 I $D(NDFABORT)&('$D(NDFEDIT)) G ^NDFRR2
"RTN","NDFRR22",9,0)
 I $D(NDFABORT)&($D(NDFEDIT)) G EXIT^NDFRR2A
"RTN","NDFRR22",10,0)
 I NDFM="" Q
"RTN","NDFRR22",11,0)
 K DIC S DIC=50.64,DIC(0)="EMZ" D ^DIC
"RTN","NDFRR22",12,0)
 I Y=-1 I '$$CK^NDFRR1(50.64,.01,NDFM) D HLP^NDFRR1(50.64,1) G 12
"RTN","NDFRR22",13,0)
 I Y=-1 S NDFY=$$ADD^NDFRR1(NDFM,"VA DISPENSE UNIT") I NDFY S ^TMP("NDFR",$J,"50.68,8")=NDFM
"RTN","NDFRR22",14,0)
 I $G(NDFY)=0 G 12
"RTN","NDFRR22",15,0)
 I +Y>0 I $P(^PSNDF(50.64,+Y,0),"^",2)&($P(^PSNDF(50.64,+Y,0),"^",2)'>DT) W "    (Inactive)" H .4 G 12
"RTN","NDFRR22",16,0)
 I +Y>0 S NDFM=$S(Y["^":+Y,1:Y) S ^TMP("NDFR",$J,"50.68,8")=NDFM
"RTN","NDFRR22",17,0)
 I CHANGE'=^TMP("NDFR",$J,"50.68,8")&('$D(NDFNW)) D 119^NDFRR2
"RTN","NDFRR22",18,0)
 Q:$D(NDFEDIT)
"RTN","NDFRR22",19,0)
 ;
"RTN","NDFRR22",20,0)
 ;
"RTN","NDFRR22",21,0)
13 ;  TRANSMIT TO CMOP? YES OR NO
"RTN","NDFRR22",22,0)
 N DIR
"RTN","NDFRR22",23,0)
 S:$D(^TMP("NDFR",$J,"50.68,7")) DIR("B")=$$EXTERNAL^DILFD(50.68,7,"",$G(^TMP("NDFR",$J,"50.68,7")))
"RTN","NDFRR22",24,0)
 S DIR("A")="Transmit to CMOP"
"RTN","NDFRR22",25,0)
 S DIR(0)="Y" D ^DIR
"RTN","NDFRR22",26,0)
 I $D(DTOUT)!($D(DUOUT))&(($D(NDFEDIT))) G EXIT^NDFRR2A
"RTN","NDFRR22",27,0)
 I $D(DTOUT)!($D(DUOUT))&(('$D(NDFEDIT))) G ^NDFRR2
"RTN","NDFRR22",28,0)
 I $$CMOP^NDFRR8 G 13
"RTN","NDFRR22",29,0)
 S ^TMP("NDFR",$J,"50.68,7")=+Y
"RTN","NDFRR22",30,0)
 Q:$D(NDFEDIT)
"RTN","NDFRR22",31,0)
 ;
"RTN","NDFRR22",32,0)
14 ;   PMIS
"RTN","NDFRR22",33,0)
 ;  ******************************
"RTN","NDFRR22",34,0)
 ;  FIX LATER !!
"RTN","NDFRR22",35,0)
 ;  ******************************
"RTN","NDFRR22",36,0)
 ; N ADD S NDFC=$G(^TMP("NDFR",$J,"50.68,11")),NDFCC=(NDFC?1.9N)
"RTN","NDFRR22",37,0)
 ; S (NDFM,X)=$$GET^NDFRR1(50.628,1,$S(NDFCC:$S($D(^TMP("NDFR",$J,"50.68,11")):$P(^PS(50.628,^TMP("NDFR",$J,"50.68,11"),0),"^",2),1:""),1:NDFC),1,"GCNSEQNO") K NDFC,NDFCC
"RTN","NDFRR22",38,0)
 D ^NDFRR998
"RTN","NDFRR22",39,0)
 I ASKHIM=0 S (NDFM,X)=$$GET^NDFRR1(50.628,1,$S($D(^TMP("NDFR",$J,"50.68,11")):$P(^TMP("NDFR",$J,"50.68,11"),"^"),1:""),0,"GCNSEQNO")
"RTN","NDFRR22",40,0)
 I $D(NDFABORT)&('$D(NDFEDIT)) G ^NDFRR2
"RTN","NDFRR22",41,0)
 I $D(NDFABORT)&($D(NDFEDIT)) G EXIT^NDFRR2A
"RTN","NDFRR22",42,0)
 I NDFM="",$G(NDFNW) G ^NDFRR2A ; W !,"LOOK HERE FARTFACE","  ",NDFM,"  ",NDFEDIT H 3 G ^NDFRR2A
"RTN","NDFRR22",43,0)
 I NDFM="",'$G(NDFNW) Q
"RTN","NDFRR22",44,0)
 I ASKHIM=0 K DIC S DIC=50.628,DIC(0)="EMZn" D ^DIC K DIC
"RTN","NDFRR22",45,0)
 I ASKHIM=0,X="@" S ^TMP("NDFR",$J,"50.68,11")="" W "     (Deleted)" H .5 Q
"RTN","NDFRR22",46,0)
 I ASKHIM=0 I X'="@",Y=-1 I '$$CK^NDFRR1(50.628,1,NDFM) W !,"That is not a valid answer",!! H 1.3 D HLP^NDFRR1(50.68,11) G 14
"RTN","NDFRR22",47,0)
 I ASKHIM=0 I +Y>0 S NDFM=$S(Y["^":+Y,1:Y),BT=^PS(50.628,+Y,0),NDFM=$P(^PS(50.628,+Y,0),"^",2) S ^TMP("NDFR",$J,"50.68,11")=NDFM_"^"_+Y_"^"_$P(BT,"^",2)_" "_$P(BT,"^",3)_" "_$P(BT,"^",4)_" "_$P(BT,"^",5)
"RTN","NDFRR22",48,0)
 I ASKHIM=0,$G(PSEQNO) S ^TMP("NDFR",$J,"50.68,12")=$P(PSEQNO,"^")
"RTN","NDFRR22",49,0)
 I ASKHIM=1 I $G(AUTO) S TAT=$P(AUTO,"^",2),BT=^PS(50.628,TAT,0),NDFM=$P(^PS(50.628,TAT,0),"^",2) S ^TMP("NDFR",$J,"50.68,11")=NDFM_"^"_TAT_"^"_$P(BT,"^",2)_" "_$P(BT,"^",3)_" "_$P(BT,"^",4)_" "_$P(BT,"^",5)
"RTN","NDFRR22",50,0)
 I ASKHIM=1 S:$G(AUTO) ^TMP("NDFR",$J,"50.68,12")=$P(AUTO,"^",5) S:$G(AUTO) ^TMP("NDFR",$J,"50.68,13")=$P(AUTO,"^",4)
"RTN","NDFRR22",51,0)
  Q:$D(NDFEDIT)
"RTN","NDFRR22",52,0)
 ;
"RTN","NDFRR22",53,0)
 G ^NDFRR2A
"RTN","NDFRR2A")
0^42^B141042683
"RTN","NDFRR2A",1,0)
NDFRR2A ;BIR/RSB - VA Product Enter/Edit ; 23 Jun 2009  9:18 AM
"RTN","NDFRR2A",2,0)
 ;;4.0;NDF MANAGEMENT;**70,108,262,263**; 1 Jan 99;Build 1
"RTN","NDFRR2A",3,0)
 ;
"RTN","NDFRR2A",4,0)
15 ;  PRIMARY VA DRUG CLASS
"RTN","NDFRR2A",5,0)
 S (NDFM,X)=$$GET^NDFRR1(50.605,.01,$S($D(^TMP("NDFR",$J,"50.68,15")):$P(^PS(50.605,+^TMP("NDFR",$J,"50.68,15"),0),"^"),1:""),1,"Primary VA Drug Class")
"RTN","NDFRR2A",6,0)
 I $D(NDFABORT)&('$D(NDFEDIT)) G ^NDFRR2
"RTN","NDFRR2A",7,0)
 I $D(NDFABORT)&($D(NDFEDIT)) G EXIT^NDFRR2A
"RTN","NDFRR2A",8,0)
 I NDFM="" Q
"RTN","NDFRR2A",9,0)
 K DIC S DIC=50.605,DIC(0)="EMZ" D ^DIC
"RTN","NDFRR2A",10,0)
 I Y=-1 D  G 15
"RTN","NDFRR2A",11,0)
 .I '$$CK^NDFRR1(50.605,.01,NDFM) D HLP^NDFRR1(50.605,.01)
"RTN","NDFRR2A",12,0)
 .;I $$CK^NDFRR1(50.605,.01,NDFM) D SET^NDFRR1("50.68,15",NDFM)
"RTN","NDFRR2A",13,0)
 S NDFM=+Y S ^TMP("NDFR",$J,"50.68,15")=NDFM
"RTN","NDFRR2A",14,0)
 Q:$D(NDFEDIT)
"RTN","NDFRR2A",15,0)
 ;
"RTN","NDFRR2A",16,0)
16 ;  SECONDARY VA DRUG CLASS
"RTN","NDFRR2A",17,0)
 S CNT=0
"RTN","NDFRR2A",18,0)
161 S (NDFM,X)=$$GET^NDFRR1(50.605,.01,"",0,"Secondary VA Drug Class")
"RTN","NDFRR2A",19,0)
 I $D(NDFABORT)&('$D(NDFEDIT)) G ^NDFRR2
"RTN","NDFRR2A",20,0)
 I $D(NDFABORT)&($D(NDFEDIT)) G EXIT^NDFRR2A
"RTN","NDFRR2A",21,0)
 ;I NDFM=""&($D(^TMP("NDFR",$J,"50.6816,.01")))&('$D(NDFEDIT)) G 17
"RTN","NDFRR2A",22,0)
 ;I NDFM=""&($D(^TMP("NDFR",$J,"50.6816,.01")))&($D(NDFEDIT)) Q
"RTN","NDFRR2A",23,0)
 I NDFM=""&('$D(NDFEDIT)) G 17
"RTN","NDFRR2A",24,0)
 I NDFM=""&($D(NDFEDIT)) Q
"RTN","NDFRR2A",25,0)
 K DIC S DIC=50.605,DIC(0)="EMZ" D ^DIC
"RTN","NDFRR2A",26,0)
 I Y=-1 D  G 161
"RTN","NDFRR2A",27,0)
 .I '$$CK^NDFRR1(50.605,.01,NDFM) D HLP^NDFRR1(50.605,.01)
"RTN","NDFRR2A",28,0)
 I $$CK^NDFRR1(50.605,.01,NDFM) S NDFM=$S(Y["^":+Y,1:Y),CNT=CNT+1 S ^TMP("NDFR",$J,"50.6816,.01",CNT)=NDFM
"RTN","NDFRR2A",29,0)
 I '$D(^TMP("NDFR",$J,"50.6816,.01")) W "  (Required)" G 161
"RTN","NDFRR2A",30,0)
 G 161
"RTN","NDFRR2A",31,0)
 ;
"RTN","NDFRR2A",32,0)
17 ; CS FEDERAL SCHEDULE
"RTN","NDFRR2A",33,0)
 K DIR
"RTN","NDFRR2A",34,0)
 S:$G(^TMP("NDFR",$J,"50.68,19")) DIR("B")=$$EXTERNAL^DILFD(50.68,19,"",$G(^TMP("NDFR",$J,"50.68,19")))
"RTN","NDFRR2A",35,0)
 S DIR(0)="50.68,19" D ^DIR
"RTN","NDFRR2A",36,0)
 ;I $D(DTOUT)!($D(DUOUT)) G EXIT
"RTN","NDFRR2A",37,0)
 I $D(DTOUT)!($D(DUOUT))&(($D(NDFEDIT))) G EXIT^NDFRR2A
"RTN","NDFRR2A",38,0)
 I $D(DTOUT)!($D(DUOUT))&(('$D(NDFEDIT))) G ^NDFRR2
"RTN","NDFRR2A",39,0)
 I X="@" W "   (Required)" H .5
"RTN","NDFRR2A",40,0)
 ;I X="" W "  (Required)" G 17
"RTN","NDFRR2A",41,0)
 I Y>-1 S ^TMP("NDFR",$J,"50.68,19")=Y
"RTN","NDFRR2A",42,0)
 Q:$D(NDFEDIT)
"RTN","NDFRR2A",43,0)
 ;
"RTN","NDFRR2A",44,0)
18 ;  SINGLE/MULTI SOURCE PRODUCT
"RTN","NDFRR2A",45,0)
 K DIR
"RTN","NDFRR2A",46,0)
 S:$D(^TMP("NDFR",$J,"50.68,20")) DIR("B")=$$EXTERNAL^DILFD(50.68,20,"",$G(^TMP("NDFR",$J,"50.68,20")))
"RTN","NDFRR2A",47,0)
 S DIR(0)="50.68,20" D ^DIR
"RTN","NDFRR2A",48,0)
 I $D(DTOUT)!($D(DUOUT))&(($D(NDFEDIT))) G EXIT^NDFRR2A
"RTN","NDFRR2A",49,0)
 I $D(DTOUT)!($D(DUOUT))&(('$D(NDFEDIT))) G ^NDFRR2
"RTN","NDFRR2A",50,0)
 I X="@" W "   (Required)" H .5
"RTN","NDFRR2A",51,0)
 ;I X="" W "  (Required)" G 18
"RTN","NDFRR2A",52,0)
 I Y>-1 S ^TMP("NDFR",$J,"50.68,20")=Y
"RTN","NDFRR2A",53,0)
 Q:$D(NDFEDIT)
"RTN","NDFRR2A",54,0)
 ;
"RTN","NDFRR2A",55,0)
19 ;  INACTIVATION DATE
"RTN","NDFRR2A",56,0)
 K DIR N Y
"RTN","NDFRR2A",57,0)
 I $D(^TMP("NDFR",$J,"50.68,21")) D
"RTN","NDFRR2A",58,0)
 .S Y=$G(^TMP("NDFR",$J,"50.68,21")) X ^DD("DD")
"RTN","NDFRR2A",59,0)
 .S DIR("B")=Y
"RTN","NDFRR2A",60,0)
 S DIR("A")="Inactivation Date",DIR(0)="DO" D ^DIR
"RTN","NDFRR2A",61,0)
 I $D(DTOUT)!($D(DUOUT))&(($D(NDFEDIT))) G EXIT^NDFRR2A
"RTN","NDFRR2A",62,0)
 I $D(DTOUT)!($D(DUOUT))&(('$D(NDFEDIT))) G ^NDFRR2
"RTN","NDFRR2A",63,0)
 I X="@" S ^TMP("NDFR",$J,"50.68,21")="" W "   (Deleted)"
"RTN","NDFRR2A",64,0)
 I Y>-1 S ^TMP("NDFR",$J,"50.68,21")=Y X ^DD("DD") W "   ",Y
"RTN","NDFRR2A",65,0)
 Q:$D(NDFEDIT)
"RTN","NDFRR2A",66,0)
 ;
"RTN","NDFRR2A",67,0)
20 ;  MAX SINGLE DOSE
"RTN","NDFRR2A",68,0)
 K DIR
"RTN","NDFRR2A",69,0)
 S:$D(^TMP("NDFR",$J,"50.68,25")) DIR("B")=$G(^TMP("NDFR",$J,"50.68,25"))
"RTN","NDFRR2A",70,0)
 S DIR(0)="50.68,25" D ^DIR
"RTN","NDFRR2A",71,0)
 I $D(DTOUT)!($D(DUOUT))&(($D(NDFEDIT))) G EXIT^NDFRR2A
"RTN","NDFRR2A",72,0)
 I $D(DTOUT)!($D(DUOUT))&(('$D(NDFEDIT))) G ^NDFRR2
"RTN","NDFRR2A",73,0)
 I X="@" S ^TMP("NDFR",$J,"50.68,25")="" W "   (Deleted)"
"RTN","NDFRR2A",74,0)
 ;I X="" W "  (Required)" G 20
"RTN","NDFRR2A",75,0)
 I Y>-1 S ^TMP("NDFR",$J,"50.68,25")=Y
"RTN","NDFRR2A",76,0)
 Q:$D(NDFEDIT)
"RTN","NDFRR2A",77,0)
 ;
"RTN","NDFRR2A",78,0)
22 ;  MIN SINGLE DOSE
"RTN","NDFRR2A",79,0)
 K DIR
"RTN","NDFRR2A",80,0)
 S:$D(^TMP("NDFR",$J,"50.68,26")) DIR("B")=$G(^TMP("NDFR",$J,"50.68,26"))
"RTN","NDFRR2A",81,0)
 S DIR(0)="50.68,26" D ^DIR
"RTN","NDFRR2A",82,0)
 I $D(DTOUT)!($D(DUOUT))&(($D(NDFEDIT))) G EXIT^NDFRR2A
"RTN","NDFRR2A",83,0)
 I $D(DTOUT)!($D(DUOUT))&(('$D(NDFEDIT))) G ^NDFRR2
"RTN","NDFRR2A",84,0)
 I X="@" S ^TMP("NDFR",$J,"50.68,26")="" W "   (Deleted)"
"RTN","NDFRR2A",85,0)
 ;I X="" W "  (Required)" G 22
"RTN","NDFRR2A",86,0)
 I Y>-1 S ^TMP("NDFR",$J,"50.68,26")=Y
"RTN","NDFRR2A",87,0)
 Q:$D(NDFEDIT)
"RTN","NDFRR2A",88,0)
 ;
"RTN","NDFRR2A",89,0)
23 ;  MAX DAILY DOSE
"RTN","NDFRR2A",90,0)
 K DIR
"RTN","NDFRR2A",91,0)
 S:$D(^TMP("NDFR",$J,"50.68,27")) DIR("B")=$G(^TMP("NDFR",$J,"50.68,27"))
"RTN","NDFRR2A",92,0)
 S DIR(0)="50.68,27" D ^DIR
"RTN","NDFRR2A",93,0)
 I $D(DTOUT)!($D(DUOUT))&(($D(NDFEDIT))) G EXIT^NDFRR2A
"RTN","NDFRR2A",94,0)
 I $D(DTOUT)!($D(DUOUT))&(('$D(NDFEDIT))) G ^NDFRR2
"RTN","NDFRR2A",95,0)
 I X="@" S ^TMP("NDFR",$J,"50.68,27")="" W "   (Deleted)"
"RTN","NDFRR2A",96,0)
 ;I X="" W "  (Required)" G 23
"RTN","NDFRR2A",97,0)
 I Y>-1 S ^TMP("NDFR",$J,"50.68,27")=Y
"RTN","NDFRR2A",98,0)
 Q:$D(NDFEDIT)
"RTN","NDFRR2A",99,0)
 ;
"RTN","NDFRR2A",100,0)
24 ; MIN DAILY DOSE
"RTN","NDFRR2A",101,0)
 K DIR
"RTN","NDFRR2A",102,0)
 S:$D(^TMP("NDFR",$J,"50.68,28")) DIR("B")=$G(^TMP("NDFR",$J,"50.68,28"))
"RTN","NDFRR2A",103,0)
 S DIR(0)="50.68,28" D ^DIR
"RTN","NDFRR2A",104,0)
 I $D(DTOUT)!($D(DUOUT))&(($D(NDFEDIT))) G EXIT^NDFRR2A
"RTN","NDFRR2A",105,0)
 I $D(DTOUT)!($D(DUOUT))&(('$D(NDFEDIT))) G ^NDFRR2
"RTN","NDFRR2A",106,0)
 I X="@" S ^TMP("NDFR",$J,"50.68,28")="" W "   (Deleted)"
"RTN","NDFRR2A",107,0)
 ;I X="" W "  (Required)" G 24
"RTN","NDFRR2A",108,0)
 I Y>-1 S ^TMP("NDFR",$J,"50.68,28")=Y
"RTN","NDFRR2A",109,0)
 Q:$D(NDFEDIT)
"RTN","NDFRR2A",110,0)
 ;
"RTN","NDFRR2A",111,0)
25 ; MAX CUMMULATIVE DOSE
"RTN","NDFRR2A",112,0)
 K DIR
"RTN","NDFRR2A",113,0)
 S:$D(^TMP("NDFR",$J,"50.68,29")) DIR("B")=$G(^TMP("NDFR",$J,"50.68,29"))
"RTN","NDFRR2A",114,0)
 S DIR(0)="50.68,29" D ^DIR
"RTN","NDFRR2A",115,0)
 I $D(DTOUT)!($D(DUOUT))&(($D(NDFEDIT))) G EXIT^NDFRR2A
"RTN","NDFRR2A",116,0)
 I $D(DTOUT)!($D(DUOUT))&(('$D(NDFEDIT))) G ^NDFRR2
"RTN","NDFRR2A",117,0)
 I X="@" S ^TMP("NDFR",$J,"50.68,29")="" W "   (Deleted)"
"RTN","NDFRR2A",118,0)
 ;I X="" W "  (Required)" G 25
"RTN","NDFRR2A",119,0)
 I Y>-1 S ^TMP("NDFR",$J,"50.68,29")=Y
"RTN","NDFRR2A",120,0)
 Q:$D(NDFEDIT)
"RTN","NDFRR2A",121,0)
 ;
"RTN","NDFRR2A",122,0)
 ; GO TO LISTMAN
"RTN","NDFRR2A",123,0)
 I $D(NDFNW) D
"RTN","NDFRR2A",124,0)
 .S $P(NDFNAME,"^",2)=^TMP("NDFR",$J,"50.68,.01")
"RTN","NDFRR2A",125,0)
 .K NDFCLASS,NDFINGL,NDFNW D EN^VALM("NDF RSB ACCEPT/EDIT")
"RTN","NDFRR2A",126,0)
 I $D(NDFNW) G 1^NDFRR2
"RTN","NDFRR2A",127,0)
 ;
"RTN","NDFRR2A",128,0)
 Q
"RTN","NDFRR2A",129,0)
30 ; EXCLUDE DDI Check
"RTN","NDFRR2A",130,0)
 N DIR
"RTN","NDFRR2A",131,0)
 S:$D(^TMP("NDFR",$J,"50.68,23")) DIR("B")=$$EXTERNAL^DILFD(50.68,23,"",$G(^TMP("NDFR",$J,"50.68,23")))
"RTN","NDFRR2A",132,0)
 S DIR("A")="EXCLUDE Drug-Drug Interaction Check"
"RTN","NDFRR2A",133,0)
 S DIR(0)="Y" D ^DIR
"RTN","NDFRR2A",134,0)
 I $D(DTOUT)!($D(DUOUT))&(($D(NDFEDIT))) G EXIT^NDFRR2A
"RTN","NDFRR2A",135,0)
 I $D(DTOUT)!($D(DUOUT))&(('$D(NDFEDIT))) G ^NDFRR2
"RTN","NDFRR2A",136,0)
 S:Y>0 ^TMP("NDFR",$J,"50.68,23")=+Y
"RTN","NDFRR2A",137,0)
 S:Y=0 ^TMP("NDFR",$J,"50.68,23")=""
"RTN","NDFRR2A",138,0)
 Q:$D(NDFEDIT)
"RTN","NDFRR2A",139,0)
 ;
"RTN","NDFRR2A",140,0)
31 ;  OVERRIDE DOSE CHECK
"RTN","NDFRR2A",141,0)
 K DIR
"RTN","NDFRR2A",142,0)
 S:$D(^TMP("NDFR",$J,"50.68,31")) DIR("B")=$$EXTERNAL^DILFD(50.68,31,"",$G(^TMP("NDFR",$J,"50.68,31")))
"RTN","NDFRR2A",143,0)
 S DIR(0)="50.68,31" D ^DIR
"RTN","NDFRR2A",144,0)
 I $D(DTOUT)!($D(DUOUT))&(($D(NDFEDIT))) G EXIT^NDFRR2A
"RTN","NDFRR2A",145,0)
 I $D(DTOUT)!($D(DUOUT))&(('$D(NDFEDIT))) G ^NDFRR2
"RTN","NDFRR2A",146,0)
 ;I.X="@" W "   (Required)" H .5
"RTN","NDFRR2A",147,0)
 ;I X="" W "  (Required)" G 18
"RTN","NDFRR2A",148,0)
 I Y>-1 S ^TMP("NDFR",$J,"50.68,31")=Y
"RTN","NDFRR2A",149,0)
 Q:$D(NDFEDIT)
"RTN","NDFRR2A",150,0)
 ;
"RTN","NDFRR2A",151,0)
40 ; CREATE DEFAULT POSSIBLE DOSAGES
"RTN","NDFRR2A",152,0)
 N DIR,NDFCDPD,NDFPDTC,NDFPKG
"RTN","NDFRR2A",153,0)
 S (NDFCDPD,NDFPDTC,NDFPKG)=""
"RTN","NDFRR2A",154,0)
 S DIR("B")="Yes"
"RTN","NDFRR2A",155,0)
 S:$D(^TMP("NDFR",$J,"50.68,40")) DIR("B")=$$EXTERNAL^DILFD(50.68,40,"",$G(^TMP("NDFR",$J,"50.68,40")))
"RTN","NDFRR2A",156,0)
 S DIR(0)="50.68,40",DIR("A")="Auto-Create Default Possible Dosage" D ^DIR
"RTN","NDFRR2A",157,0)
 I $D(DTOUT)!($D(DUOUT))&(($D(NDFEDIT))) G EXIT^NDFRR2A
"RTN","NDFRR2A",158,0)
 I $D(DTOUT)!($D(DUOUT))&(('$D(NDFEDIT))) G ^NDFRR2
"RTN","NDFRR2A",159,0)
 I Y=-1 G EXIT^NDFRR2A
"RTN","NDFRR2A",160,0)
 S NDFCDPD=Y
"RTN","NDFRR2A",161,0)
 I (NDFCDPD="N") D
"RTN","NDFRR2A",162,0)
 . N DIR,X,Y
"RTN","NDFRR2A",163,0)
 . S:$G(^TMP("NDFR",$J,"50.68,41"))'="" DIR("B")=$G(^TMP("NDFR",$J,"50.68,41"))
"RTN","NDFRR2A",164,0)
 . S DIR(0)="50.68,41",DIR("A")="Possible Dosages To Auto-Create"
"RTN","NDFRR2A",165,0)
 . F  D ^DIR Q:($D(DTOUT)!$D(DUOUT)!(X'=""))  W:X="" "??",$C(7),!
"RTN","NDFRR2A",166,0)
 . I $D(DTOUT)!$D(DUOUT) Q
"RTN","NDFRR2A",167,0)
 . S NDFPDTC=Y
"RTN","NDFRR2A",168,0)
 . I (NDFPDTC'="N") D
"RTN","NDFRR2A",169,0)
 . . N DIR,X,Y,QUIT
"RTN","NDFRR2A",170,0)
 . . S:$G(^TMP("NDFR",$J,"50.68,42"))'="" DIR("B")=$G(^TMP("NDFR",$J,"50.68,42"))
"RTN","NDFRR2A",171,0)
 . . S DIR(0)="50.68,42",DIR("A")="Package",QUIT=0
"RTN","NDFRR2A",172,0)
 . . F  Q:QUIT  D ^DIR Q:$D(DTOUT)!$D(DUOUT)  D
"RTN","NDFRR2A",173,0)
 . . . I X="" W "??",$C(7),! Q
"RTN","NDFRR2A",174,0)
 . . . I '$$PKGCHK(Y) Q
"RTN","NDFRR2A",175,0)
 . . . S NDFPKG=Y,QUIT=1
"RTN","NDFRR2A",176,0)
 I $D(DTOUT)!($D(DUOUT))&(($D(NDFEDIT))) G EXIT^NDFRR2A
"RTN","NDFRR2A",177,0)
 I $D(DTOUT)!($D(DUOUT))&(('$D(NDFEDIT))) G ^NDFRR2
"RTN","NDFRR2A",178,0)
 ;
"RTN","NDFRR2A",179,0)
 ; TMP global update
"RTN","NDFRR2A",180,0)
 I NDFCDPD="N" D
"RTN","NDFRR2A",181,0)
 . I NDFPDTC="N" D
"RTN","NDFRR2A",182,0)
 . . S ^TMP("NDFR",$J,"50.68,40")=NDFCDPD
"RTN","NDFRR2A",183,0)
 . . S ^TMP("NDFR",$J,"50.68,41")=NDFPDTC
"RTN","NDFRR2A",184,0)
 . . S ^TMP("NDFR",$J,"50.68,42")=""
"RTN","NDFRR2A",185,0)
 . E  D
"RTN","NDFRR2A",186,0)
 . . I NDFPKG'="" D
"RTN","NDFRR2A",187,0)
 . . . S ^TMP("NDFR",$J,"50.68,40")=NDFCDPD
"RTN","NDFRR2A",188,0)
 . . . S ^TMP("NDFR",$J,"50.68,41")=NDFPDTC
"RTN","NDFRR2A",189,0)
 . . . S ^TMP("NDFR",$J,"50.68,42")=NDFPKG
"RTN","NDFRR2A",190,0)
 E  D
"RTN","NDFRR2A",191,0)
 . S ^TMP("NDFR",$J,"50.68,40")=NDFCDPD
"RTN","NDFRR2A",192,0)
 . S ^TMP("NDFR",$J,"50.68,41")=""
"RTN","NDFRR2A",193,0)
 . S ^TMP("NDFR",$J,"50.68,42")=""
"RTN","NDFRR2A",194,0)
 ;
"RTN","NDFRR2A",195,0)
 N DIR S DIR(0)="E",DIR("A")="Press Return to continue" W ! D ^DIR
"RTN","NDFRR2A",196,0)
 ;
"RTN","NDFRR2A",197,0)
 Q:$D(NDFEDIT)
"RTN","NDFRR2A",198,0)
 ;
"RTN","NDFRR2A",199,0)
100 ;FDA MED GUIDE
"RTN","NDFRR2A",200,0)
 W !,"FDA Med Guide Server URL: ",$$GET1^DIQ(59.7,1,100),!
"RTN","NDFRR2A",201,0)
 ;
"RTN","NDFRR2A",202,0)
 K DIR
"RTN","NDFRR2A",203,0)
 S:($G(^TMP("NDFR",$J,"50.68,100"))'="") DIR("B")=$$EXTERNAL^DILFD(50.68,100,"",$G(^TMP("NDFR",$J,"50.68,100")))
"RTN","NDFRR2A",204,0)
 S DIR(0)="50.68,100",DIR("A")="FDA Med Guide File Name"
"RTN","NDFRR2A",205,0)
 S DIR("?",1)="Enter the name of the file corresponding to the FDA Medication Guide"
"RTN","NDFRR2A",206,0)
 S DIR("?")="associated with this VA Product."
"RTN","NDFRR2A",207,0)
 D ^DIR
"RTN","NDFRR2A",208,0)
 I $D(DTOUT)!($D(DUOUT))&(($D(NDFEDIT))) G EXIT^NDFRR2A
"RTN","NDFRR2A",209,0)
 I $D(DTOUT)!($D(DUOUT))&(('$D(NDFEDIT))) G ^NDFRR2
"RTN","NDFRR2A",210,0)
 ;I.X="@" W "   (Required)" H .5
"RTN","NDFRR2A",211,0)
 ;I X="" W "  (Required)" G 18
"RTN","NDFRR2A",212,0)
 I Y>-1 S ^TMP("NDFR",$J,"50.68,100")=Y
"RTN","NDFRR2A",213,0)
 Q:$D(NDFEDIT)
"RTN","NDFRR2A",214,0)
 ;
"RTN","NDFRR2A",215,0)
199 ; VA PRODUCT NAMES
"RTN","NDFRR2A",216,0)
 ;S NDFC=$G(^TMP("NDFR",$J,"50.68,.01")) S NDFCC=(NDFC?1.9N) 
"RTN","NDFRR2A",217,0)
 ;N DIR S DIR(0)="SO^E:Edit this Product Name;C:Choose another Product name" D ^DIR  I $D(DTOUT)!($D(DUOUT)) Q
"RTN","NDFRR2A",218,0)
 ;I Y="C" S VALMBCK="B" Q
"RTN","NDFRR2A",219,0)
 ;
"RTN","NDFRR2A",220,0)
 N CHANGE S CHANGE=$P(NDFNAME,"^",2)
"RTN","NDFRR2A",221,0)
 I $D(^PSNDF(50.68,"B",CHANGE)) W !,"Entry already in file.",!,"This entry can only be inactivated!" H 2 Q
"RTN","NDFRR2A",222,0)
 S (NDFM,X)=$$GET^NDFRR1(50.68,.01,$P(NDFNAME,"^",2),0,"Enter VA Product Name")
"RTN","NDFRR2A",223,0)
 I NDFM=""!(NDFM="^") Q
"RTN","NDFRR2A",224,0)
 S $P(NDFNAME,"^",2)=NDFM
"RTN","NDFRR2A",225,0)
 S ^TMP("NDFR",$J,"50.68,.01")=NDFNAME
"RTN","NDFRR2A",226,0)
 S:$L(^TMP("NDFR",$J,"50.68,.01"))<41 ^TMP("NDFR",$J,"50.68,5")=$P(^TMP("NDFR",$J,"50.68,.01"),"^",2)
"RTN","NDFRR2A",227,0)
 I CHANGE'=$P(NDFNAME,"^",2)&('$D(NDFNW)) D 119^NDFRR2
"RTN","NDFRR2A",228,0)
 D HDR^NDFRR6
"RTN","NDFRR2A",229,0)
 Q
"RTN","NDFRR2A",230,0)
EXIT ;
"RTN","NDFRR2A",231,0)
 W !,"    NO CHANGE MADE!" H .5
"RTN","NDFRR2A",232,0)
 Q
"RTN","NDFRR2A",233,0)
 ;
"RTN","NDFRR2A",234,0)
CLASS ;
"RTN","NDFRR2A",235,0)
 D FULL^VALM1 S NDFCLASS=1
"RTN","NDFRR2A",236,0)
 N LIST,FIRST,LAST S LIST="",FIRST=0,LAST=0 W !
"RTN","NDFRR2A",237,0)
 N X,TOT S TOT=0 F X=0:0 S X=$O(^TMP("NDFR",$J,"50.6816,.01",X)) Q:'X  D
"RTN","NDFRR2A",238,0)
 .S:FIRST=0 FIRST=X S:LAST<X LAST=X
"RTN","NDFRR2A",239,0)
 .S:TOT<X TOT=X S LIST=LIST_X_"|"
"RTN","NDFRR2A",240,0)
 .W !,"("_X_")  ",$P(^PS(50.605,+^TMP("NDFR",$J,"50.6816,.01",X),0),"^")
"RTN","NDFRR2A",241,0)
 .W "  ",$P(^PS(50.605,+^TMP("NDFR",$J,"50.6816,.01",X),0),"^",2)
"RTN","NDFRR2A",242,0)
 W ! K DIR S DIR("A")="Do you wish to Add or Delete entries?",DIR(0)="SBOM^A:Add new entries;D:Delete entries" D ^DIR
"RTN","NDFRR2A",243,0)
 I $D(DTOUT)!($D(DUOUT)) Q
"RTN","NDFRR2A",244,0)
 I Y="A" D CLASSA G CLASS
"RTN","NDFRR2A",245,0)
 I Y="D" D CLASSD,ADJUST("NDFR","50.6816,.01") G CLASS
"RTN","NDFRR2A",246,0)
 Q
"RTN","NDFRR2A",247,0)
 ;
"RTN","NDFRR2A",248,0)
CLASSA S (NDFM,X)=$$GET^NDFRR1(50.605,.01,"",0,"Secondary VA Drug Class")
"RTN","NDFRR2A",249,0)
 I NDFM="" Q
"RTN","NDFRR2A",250,0)
 K DIC S DIC=50.605,DIC(0)="EMZ" D ^DIC
"RTN","NDFRR2A",251,0)
 I Y=-1 D  G CLASS
"RTN","NDFRR2A",252,0)
 .I '$$CK^NDFRR1(50.605,.01,NDFM) D HLP^NDFRR1(50.605,.01)
"RTN","NDFRR2A",253,0)
 I $$CK^NDFRR1(50.605,.01,NDFM) S NDFM=$S(Y["^":+Y,1:Y) S ^TMP("NDFR",$J,"50.6816,.01",TOT+1)=NDFM,TOT=TOT+1
"RTN","NDFRR2A",254,0)
 G CLASSA
"RTN","NDFRR2A",255,0)
CLASSD ;
"RTN","NDFRR2A",256,0)
 K DIR S DIR(0)="N^"_FIRST_":"_LAST,DIR("A")="Delete entry" D ^DIR
"RTN","NDFRR2A",257,0)
 I Y=-1 Q
"RTN","NDFRR2A",258,0)
 I $D(DTOUT)!($D(DUOUT)) Q
"RTN","NDFRR2A",259,0)
 K ^TMP("NDFR",$J,"50.6816,.01",Y)
"RTN","NDFRR2A",260,0)
 Q
"RTN","NDFRR2A",261,0)
 ;
"RTN","NDFRR2A",262,0)
ING ;
"RTN","NDFRR2A",263,0)
 S NDFINGL=1
"RTN","NDFRR2A",264,0)
 N X,TOT S TOT=0 F X=0:0 S X=$O(^TMP("NDFR",$J,"50.6814",X)) Q:'X  D
"RTN","NDFRR2A",265,0)
 .S:TOT<X TOT=X
"RTN","NDFRR2A",266,0)
 .W !,"("_X_")"," "
"RTN","NDFRR2A",267,0)
 .S NDFC=$P(^TMP("NDFR",$J,"50.6814",X),"|") S NDFCC=(NDFC?1.9N)
"RTN","NDFRR2A",268,0)
 .I NDFCC W $P(^PS(50.416,+^TMP("NDFR",$J,"50.6814",X),0),"^")
"RTN","NDFRR2A",269,0)
 .I 'NDFCC W NDFC
"RTN","NDFRR2A",270,0)
 .K NDFC,NDFCC
"RTN","NDFRR2A",271,0)
 W ! K DIR S DIR("A")="Do you wish to Add or Delete entries?",DIR(0)="SBOM^A:Add new entries;D:Delete entries" D ^DIR
"RTN","NDFRR2A",272,0)
 I Y="A" D INGA G ING Q
"RTN","NDFRR2A",273,0)
 I Y="D" D INGD,ADJUST("NDFR","50.6814") G ING Q
"RTN","NDFRR2A",274,0)
 ;
"RTN","NDFRR2A",275,0)
INGA ;
"RTN","NDFRR2A",276,0)
 ;
"RTN","NDFRR2A",277,0)
ING21 W ! S (NDFM,X)=$$GET^NDFRR1(50.416,.01,"",0,"Active Ingredients")
"RTN","NDFRR2A",278,0)
 I $D(NDFABORT) G EXIT^NDFRR2A
"RTN","NDFRR2A",279,0)
 I NDFM=""&($D(NDFEDIT)) Q
"RTN","NDFRR2A",280,0)
 K DIC,NDFY,NDFAS S DIC=50.416,DIC(0)="EMZ" D ^DIC
"RTN","NDFRR2A",281,0)
 S NDFY=Y I NDFY=-1 D
"RTN","NDFRR2A",282,0)
 .I '$$CK^NDFRR1(50.416,.01,NDFM) D HLP^NDFRR1(50.416,.01) G ING21
"RTN","NDFRR2A",283,0)
 .S NDFAS=$$ADD^NDFRR1(NDFM,"DRUG INGREDIENT") I NDFAS S ^TMP("NDFR",$J,"50.6814",TOT+1)=NDFM S TOT=TOT+1 D
"RTN","NDFRR2A",284,0)
 ..K DIR S DIR(0)="Y",DIR("A")="Is this a primary ingredient" D ^DIR
"RTN","NDFRR2A",285,0)
 ..I Y=0 D
"RTN","NDFRR2A",286,0)
 ...S DIC=50.416,DIC(0)="QEALMZ",DIC("A")="Enter Primary ingredient: " D ^DIC
"RTN","NDFRR2A",287,0)
 ...I Y<0 W !,"Not Marked"
"RTN","NDFRR2A",288,0)
 ...I Y>0 S $P(^TMP("NDFR",$J,"50.6814",TOT),"|",4)=+Y
"RTN","NDFRR2A",289,0)
 I NDFY>-1 D
"RTN","NDFRR2A",290,0)
 .I $P(^PS(50.416,+Y,0),"^",2) W !?30," (Primary Ingredient)",$C(7)
"RTN","NDFRR2A",291,0)
 .S ^TMP("NDFR",$J,"50.6814",TOT+1)=+Y,TOT=TOT+1
"RTN","NDFRR2A",292,0)
 I $G(NDFAS)=0 Q
"RTN","NDFRR2A",293,0)
 ;
"RTN","NDFRR2A",294,0)
3 ;  STRENGTH
"RTN","NDFRR2A",295,0)
 S (NDFM,X)=$$GET^NDFRR1(50.6814,1,"",0,"Strength")
"RTN","NDFRR2A",296,0)
 I $D(NDFABORT) G EXIT^NDFRR2A
"RTN","NDFRR2A",297,0)
 I NDFM="" G 4
"RTN","NDFRR2A",298,0)
 I '$$CK^NDFRR1(50.6814,1,NDFM) D HLP^NDFRR1(50.6814,1) G 3
"RTN","NDFRR2A",299,0)
 I $$CK^NDFRR1(50.6814,1,NDFM) S $P(^TMP("NDFR",$J,"50.6814",TOT),"|",2)=NDFM
"RTN","NDFRR2A",300,0)
 ;
"RTN","NDFRR2A",301,0)
4 ;  UNITS
"RTN","NDFRR2A",302,0)
 S (NDFM,X)=$$GET^NDFRR1(50.6814,2,"",0,"Units")
"RTN","NDFRR2A",303,0)
 I $D(NDFABORT) G EXIT^NDFRR2A
"RTN","NDFRR2A",304,0)
 I NDFM="" Q
"RTN","NDFRR2A",305,0)
 K DIC S DIC=50.607,DIC(0)="EMZ" D ^DIC
"RTN","NDFRR2A",306,0)
 I Y=-1 D  G 4
"RTN","NDFRR2A",307,0)
 .I '$$CK^NDFRR1(50.6814,2,NDFM) D HLP^NDFRR1(50.6814,2)
"RTN","NDFRR2A",308,0)
 .;I $$CK^NDFRR1(50.6814,2,NDFM) S $P(^TMP("NDFR",$J,"50.6814",TOT),"|",3)=NDFM
"RTN","NDFRR2A",309,0)
 E  S NDFM=$S(Y["^":+Y,1:Y) S $P(^TMP("NDFR",$J,"50.6814",TOT),"|",3)=NDFM
"RTN","NDFRR2A",310,0)
 G INGA
"RTN","NDFRR2A",311,0)
 Q
"RTN","NDFRR2A",312,0)
INGD ;
"RTN","NDFRR2A",313,0)
 K DIR S DIR(0)="N^1:"_TOT,DIR("A")="Delete entry" D ^DIR
"RTN","NDFRR2A",314,0)
 I Y=-1 Q
"RTN","NDFRR2A",315,0)
 I $D(DTOUT)!($D(DUOUT)) Q
"RTN","NDFRR2A",316,0)
 K ^TMP("NDFR",$J,"50.6814",Y) W "   (Deleted)" H .5
"RTN","NDFRR2A",317,0)
 ;
"RTN","NDFRR2A",318,0)
 Q
"RTN","NDFRR2A",319,0)
ADJUST(A,N) ;
"RTN","NDFRR2A",320,0)
 N CNT,X,ARR S CNT=0
"RTN","NDFRR2A",321,0)
 F X=0:0 S X=$O(^TMP(A,$J,N,X)) Q:'X  D
"RTN","NDFRR2A",322,0)
 .S CNT=CNT+1,ARR(CNT)=^TMP(A,$J,N,X)
"RTN","NDFRR2A",323,0)
 .K ^TMP(A,$J,N,X)
"RTN","NDFRR2A",324,0)
 F X=0:0 S X=$O(ARR(X)) Q:'X  D
"RTN","NDFRR2A",325,0)
 .S ^TMP(A,$J,N,X)=ARR(X)
"RTN","NDFRR2A",326,0)
 Q
"RTN","NDFRR2A",327,0)
 ;
"RTN","NDFRR2A",328,0)
PKGCHK(PKG)  ;Validades PACKAGE (#42) field for  VA Product entry
"RTN","NDFRR2A",329,0)
 ;  Input: PKG: Package to validate ("I" - Inpatient, "O" - Outpatient, "IO" - Both)
"RTN","NDFRR2A",330,0)
 ;Output: PKGCHK: 0 - Invalid Package / 1 - Valid Package
"RTN","NDFRR2A",331,0)
 N PKGCHK,UNIT,DOSFRM
"RTN","NDFRR2A",332,0)
 S PKGCHK=1
"RTN","NDFRR2A",333,0)
 S DOSFRM=+$G(^TMP("NDFR",$J,"50.68,1"))
"RTN","NDFRR2A",334,0)
 S UNIT=+$G(^TMP("NDFR",$J,"50.68,3"))
"RTN","NDFRR2A",335,0)
 I PKG["I",'$D(^PS(50.606,"ACONI",DOSFRM,UNIT))!'$O(^PS(50.606,"ADUPI",DOSFRM,0)) D
"RTN","NDFRR2A",336,0)
 . S PKGCHK=0 W !!,"Dosage Form '",$$GET1^DIQ(50.606,DOSFRM,.01),"' and Unit '",$$GET1^DIQ(50.607,UNIT,.01),"' combination cannot be converted"
"RTN","NDFRR2A",337,0)
 . W !,"for Inpatient Medications",!,$C(7)
"RTN","NDFRR2A",338,0)
 I PKG["O",'$D(^PS(50.606,"ACONO",DOSFRM,UNIT))!'$O(^PS(50.606,"ADUPO",DOSFRM,0)) D
"RTN","NDFRR2A",339,0)
 . S PKGCHK=0 W !!,"Dosage Form '",$$GET1^DIQ(50.606,DOSFRM,.01),"' and Unit '",$$GET1^DIQ(50.607,UNIT,.01),"' combination cannot be converted"
"RTN","NDFRR2A",340,0)
 . W !,"for Outpatient Medications",!,$C(7)
"RTN","NDFRR2A",341,0)
 Q PKGCHK
"RTN","NDFRR3")
0^43^B74290120
"RTN","NDFRR3",1,0)
NDFRR3 ;BIR/RSB-PRODUCT ENTER EDIT (Accept) ; 26 Jan 2010  9:17 AM
"RTN","NDFRR3",2,0)
 ;;4.0;NDF MANAGEMENT;**62,70,108,262**; 1 Jan 99;Build 1
"RTN","NDFRR3",3,0)
 ;
"RTN","NDFRR3",4,0)
ACCEPT ;
"RTN","NDFRR3",5,0)
 I '$L($G(^TMP("NDFR",$J,"50.68,21")))&$G(^TMP("NDFR",$J,"50.68,8"))="" W !,$C(7),"VA Dispense Unit must be defined.    < NO FILES UPDATED>" H 2 S VALMBCK="R" Q
"RTN","NDFRR3",6,0)
 W !!,"  Updating NDF files..." K NDFSAVE
"RTN","NDFRR3",7,0)
 I '$P(NDFNAME,"^") D NEW
"RTN","NDFRR3",8,0)
 I $P(NDFNAME,"^") S X=+NDFNAME K DIC S DIC=50.68,DIC(0)="MNZ" D ^DIC
"RTN","NDFRR3",9,0)
 S NDFIEN=+Y I $D(NDFNDC)!($D(NDFUPNI)) S ^TMP("NDFD",$J,"50.67,5")=+Y
"RTN","NDFRR3",10,0)
 I '$D(NDFCNEW) D SAVE
"RTN","NDFRR3",11,0)
 D STUFF,STUFF1,STUFF3,STUFF4,STUFF5,STUFF2 S VALMBCK="B"
"RTN","NDFRR3",12,0)
 I '$D(NDFCNEW) D CHECK
"RTN","NDFRR3",13,0)
 W "..done." H .5 K NDFCNEW,NDFSAVE
"RTN","NDFRR3",14,0)
 S VALMSG="NDF Files updated successfully!",VALMBCK="R"
"RTN","NDFRR3",15,0)
 Q
"RTN","NDFRR3",16,0)
NEW ; ADD NEW ENTRY TO 50.68
"RTN","NDFRR3",17,0)
 K NDFCNEW,DD S DIC="^PSNDF(50.68,",DIC(0)="",X=$P(NDFNAME,"^",2) D FILE^DICN S NDFCNEW=1,$P(NDFNAME,"^")=+Y D
"RTN","NDFRR3",18,0)
 .; SET IF ENTERING A NEW PRODUCT NAME ON A NEW UPN ENTRY
"RTN","NDFRR3",19,0)
 .S:$D(NDFNDC)!($D(NDFUPN))!($D(NDFUPNI)) ^TMP("NDFD",$J,"50.67,5")=+Y
"RTN","NDFRR3",20,0)
 .; ADD TO NEW ENTRY FILE
"RTN","NDFRR3",21,0)
 .K DD S DIC="^NDFK(5000.506,",DIC(0)="",X=+Y N Y D FILE^DICN
"RTN","NDFRR3",22,0)
 .W $C(7),!,$P(NDFNAME,"^",2)," has been added to the NEW VA PRODUCT NAMES File." H 2.5
"RTN","NDFRR3",23,0)
 Q
"RTN","NDFRR3",24,0)
STUFF ; STUFF SINGLE FIELDS THAT DON'T DLAYGO
"RTN","NDFRR3",25,0)
 I $G(^TMP("NDFR",$J,"50.68,40"))="" D
"RTN","NDFRR3",26,0)
 . S ^TMP("NDFR",$J,"50.68,40")="Y",^TMP("NDFR",$J,"50.68,41")="",^TMP("NDFR",$J,"50.68,42")=""
"RTN","NDFRR3",27,0)
 I $G(^TMP("NDFR",$J,"50.68,11"))'="" S PEEYOU=$P(^PSNDF(50.68,$P(NDFNAME,"^"),1),"^",5),DIE=50.68,DA=$P(NDFNAME,"^"),DR="12////"_PEEYOU D ^DIE
"RTN","NDFRR3",28,0)
 S DR=""
"RTN","NDFRR3",29,0)
 N FIELD S DR=""
"RTN","NDFRR3",30,0)
 F FIELD=".01",2,3,4,5,6,7,11,13,15,19,20,21,23,25,26,27,28,29,31,40,41,42,100 D
"RTN","NDFRR3",31,0)
 .S NFIELD="50.68,"_FIELD D
"RTN","NDFRR3",32,0)
 ..I $G(^TMP("NDFR",$J,NFIELD))="" S DR=DR_FIELD_"////"_"@;"
"RTN","NDFRR3",33,0)
 ..I $G(^TMP("NDFR",$J,NFIELD))'="" D
"RTN","NDFRR3",34,0)
 ...S DR=DR_FIELD_"////"_$S(FIELD=".01":$P($G(^TMP("NDFR",$J,NFIELD)),"^",2),FIELD=11:$P($G(^TMP("NDFR",$J,NFIELD)),"^"),1:$G(^TMP("NDFR",$J,NFIELD)))_";"
"RTN","NDFRR3",35,0)
 D DIE
"RTN","NDFRR3",36,0)
 ; set NATIONAL FORMULARY INDICATOR to 0 if node not there
"RTN","NDFRR3",37,0)
 I '$L($G(^PSNDF(50.68,NDFIEN,5))) N DA,DIE,DR S DA=NDFIEN,DIE="^PSNDF(50.68,",DR="17////0;" D ^DIE
"RTN","NDFRR3",38,0)
 Q
"RTN","NDFRR3",39,0)
 ;
"RTN","NDFRR3",40,0)
STUFF1 ; CLEAR AND STUFF SECONDARY VA DRUG CLASS ENTRIES
"RTN","NDFRR3",41,0)
 N NDF1 F NDF1=0:0 S NDF1=$O(^PSNDF(50.68,NDFIEN,4,NDF1)) Q:'NDF1  D
"RTN","NDFRR3",42,0)
 .S DA(1)=NDFIEN,DA=NDF1,DIE="^PSNDF(50.68,"_NDFIEN_",4,",DR=".01///"_"@" D ^DIE K DIE,DR
"RTN","NDFRR3",43,0)
 F NDF1=0:0 S NDF1=$O(^TMP("NDFR",$J,"50.6816,.01",NDF1)) Q:'NDF1  D
"RTN","NDFRR3",44,0)
 .;S DA(1)=NDFIEN,DA=NDF1,DIE="^PSNDF(50.68,"_NDFIEN_",4,",DR=".01////"_$G(^TMP("NDFR",$J,"50.6816,.01",NDF1)) D ^DIE K DIE,DR
"RTN","NDFRR3",45,0)
 .K DD S DIC="^PSNDF(50.68,"_NDFIEN_",4,",DIC(0)="L",DIC("P")="50.6816P",DA(1)=NDFIEN,DA=NDF1,(DINUM,X)=$G(^TMP("NDFR",$J,"50.6816,.01",NDF1)) D FILE^DICN K DINUM
"RTN","NDFRR3",46,0)
 Q
"RTN","NDFRR3",47,0)
 ;
"RTN","NDFRR3",48,0)
STUFF2 ; CLEAR AND STUFF INGREDIENT MULTIPLE
"RTN","NDFRR3",49,0)
 N NDFC,NDFCC,NDF1,NDFE,NDFIG,PIECE
"RTN","NDFRR3",50,0)
 ; CLEAR MULTIPLE
"RTN","NDFRR3",51,0)
 F NDF1=0:0 S NDF1=$O(^PSNDF(50.68,NDFIEN,2,NDF1)) Q:'NDF1  D
"RTN","NDFRR3",52,0)
 .S DA(1)=NDFIEN,DA=NDF1,DIE="^PSNDF(50.68,"_NDFIEN_",2,",DR=".01///"_"@" D ^DIE K DIE,DR
"RTN","NDFRR3",53,0)
 ;
"RTN","NDFRR3",54,0)
 F NDF1=0:0 S NDF1=$O(^TMP("NDFR",$J,"50.6814",NDF1)) Q:'NDF1  D
"RTN","NDFRR3",55,0)
 .F PIECE=1,2,3,4 D
"RTN","NDFRR3",56,0)
 ..S $P(NDFIG,"^",PIECE)=$P(^TMP("NDFR",$J,"50.6814",NDF1),"|",PIECE)
"RTN","NDFRR3",57,0)
 .S NDFC=$P(NDFIG,"^"),NDFCC=(NDFC?1.9N)
"RTN","NDFRR3",58,0)
 .I 'NDFCC D
"RTN","NDFRR3",59,0)
 ..K DIC S X=NDFC,DIC=50.416,DIC(0)="EMZ" D ^DIC K DIC I Y<0 D
"RTN","NDFRR3",60,0)
 ...K DD S DIC="^PS(50.416,",DIC(0)="",X=NDFC D FILE^DICN
"RTN","NDFRR3",61,0)
 ..S NDFE=+Y I Y>0&($P(NDFIG,"^",4)) S DIE="^PS(50.416,",DA=+Y D
"RTN","NDFRR3",62,0)
 ...S DR="2////"_$P(NDFIG,"^",4) D ^DIE K DIE,DR
"RTN","NDFRR3",63,0)
 ..;create new entry in ing multiple
"RTN","NDFRR3",64,0)
 ..K DD S DIC="^PSNDF(50.68,"_NDFIEN_",2,",DIC(0)="L",DIC("P")="50.6814P",DA(1)=NDFIEN,DA=NDF1,(X,DINUM)=+NDFE D FILE^DICN K DINUM,DA,D0,DIC
"RTN","NDFRR3",65,0)
 ..; edit the new entry
"RTN","NDFRR3",66,0)
 ..S NDFG=NDFE S DA(1)=NDFIEN,DA=+Y,DIE="^PSNDF(50.68,"_NDFIEN_",2,"
"RTN","NDFRR3",67,0)
 ..S DR="1////"_$P(NDFIG,"^",2)_";2////"_$P(NDFIG,"^",3) D ^DIE K DIE,DR,NDFG
"RTN","NDFRR3",68,0)
 ..;
"RTN","NDFRR3",69,0)
 .I NDFCC D
"RTN","NDFRR3",70,0)
 ..K DD S DIC="^PSNDF(50.68,"_NDFIEN_",2,",DIC(0)="L",DIC("P")="50.6814P",DA(1)=NDFIEN,DA=NDF1,(X,DINUM)=+$G(^TMP("NDFR",$J,"50.6814",NDF1)) D FILE^DICN K DINUM
"RTN","NDFRR3",71,0)
 ..S DA(1)=NDFIEN,DA=+Y,DIE="^PSNDF(50.68,"_NDFIEN_",2,",DR="1////"_$P(NDFIG,"^",2)_";2////"_$P(NDFIG,"^",3)
"RTN","NDFRR3",72,0)
 ..D ^DIE K DIE,DR
"RTN","NDFRR3",73,0)
 Q
"RTN","NDFRR3",74,0)
 ;
"RTN","NDFRR3",75,0)
STUFF3 ; STUFF AND ADD VA GENERIC NAME
"RTN","NDFRR3",76,0)
 N NDFC,NDFCC,NDFG S NDFC=$G(^TMP("NDFR",$J,"50.68,.05"))
"RTN","NDFRR3",77,0)
 S NDFCC=(NDFC?1.9N)
"RTN","NDFRR3",78,0)
 I NDFCC D
"RTN","NDFRR3",79,0)
 .S DA=NDFIEN,DIE="^PSNDF(50.68,",DR=".05////"_$G(^TMP("NDFR",$J,"50.68,.05")) D ^DIE K DIE,DR
"RTN","NDFRR3",80,0)
 I 'NDFCC D
"RTN","NDFRR3",81,0)
 .K DIC S X=NDFC,DIC=50.6,DIC(0)="EMZ" D ^DIC K DIC I Y<0 D
"RTN","NDFRR3",82,0)
 ..K DD S DIC="^PSNDF(50.6,",DIC(0)="",X=NDFC D FILE^DICN
"RTN","NDFRR3",83,0)
 .S NDFG=Y S DA=NDFIEN,DIE="^PSNDF(50.68,",DR=".05////"_+NDFG D ^DIE K DIE,DR
"RTN","NDFRR3",84,0)
 Q
"RTN","NDFRR3",85,0)
 ;
"RTN","NDFRR3",86,0)
STUFF4 ; STUFF AND ADD DOSAGE FORM
"RTN","NDFRR3",87,0)
 N NDFC,NDFCC,NDFG S NDFC=$G(^TMP("NDFR",$J,"50.68,1"))
"RTN","NDFRR3",88,0)
 S NDFCC=(NDFC?1.9N)
"RTN","NDFRR3",89,0)
 I NDFCC D
"RTN","NDFRR3",90,0)
 .S DA=NDFIEN,DIE="^PSNDF(50.68,",DR="1////"_$G(^TMP("NDFR",$J,"50.68,1")) D ^DIE K DIE,DR
"RTN","NDFRR3",91,0)
 I 'NDFCC D
"RTN","NDFRR3",92,0)
 .K DIC S X=NDFC,DIC=50.606,DIC(0)="EMZ" D ^DIC K DIC I Y<0 D
"RTN","NDFRR3",93,0)
 ..S XPDGREF=1 ; TAKE OUT LATER ?????????????????????????????????????
"RTN","NDFRR3",94,0)
 ..K DD S DIC="^PS(50.606,",DIC(0)="",X=NDFC D FILE^DICN
"RTN","NDFRR3",95,0)
 .S NDFG=Y S DA=NDFIEN,DIE="^PSNDF(50.68,",DR="1////"_+NDFG D ^DIE K DIE,DR
"RTN","NDFRR3",96,0)
 Q
"RTN","NDFRR3",97,0)
 ;
"RTN","NDFRR3",98,0)
STUFF5  ; STUFF AND ADD VA DISPENSE UNIT
"RTN","NDFRR3",99,0)
 N NDFC,NDFCC,NDFG S NDFC=$G(^TMP("NDFR",$J,"50.68,8"))
"RTN","NDFRR3",100,0)
 Q:NDFC=""  ; quit if no dispense unit, only happens on marking inactive
"RTN","NDFRR3",101,0)
 S NDFCC=(NDFC?1.9N)
"RTN","NDFRR3",102,0)
 I NDFCC D
"RTN","NDFRR3",103,0)
 .S DA=NDFIEN,DIE="^PSNDF(50.68,",DR="8////"_$G(^TMP("NDFR",$J,"50.68,8")) D ^DIE K DIE,DR
"RTN","NDFRR3",104,0)
 I 'NDFCC D
"RTN","NDFRR3",105,0)
 .K DIC S X=NDFC,DIC=50.64,DIC(0)="EMZ" D ^DIC K DIC I Y<0 D
"RTN","NDFRR3",106,0)
 ..K DD S DIC="^PSNDF(50.64,",DIC(0)="",X=NDFC D FILE^DICN
"RTN","NDFRR3",107,0)
 .S NDFG=Y S DA=NDFIEN,DIE="^PSNDF(50.68,",DR="8////"_+NDFG D ^DIE K DIE,DR
"RTN","NDFRR3",108,0)
 Q
"RTN","NDFRR3",109,0)
DIE ;
"RTN","NDFRR3",110,0)
 S DA=NDFIEN,DIE="^PSNDF(50.68," D ^DIE K DIE,DR
"RTN","NDFRR3",111,0)
 Q
"RTN","NDFRR3",112,0)
SAVE ; save off fields to compare if they changed
"RTN","NDFRR3",113,0)
 S NDFSAVE("50.68,.05")=$P(^PSNDF(50.68,NDFIEN,0),"^",2)  ; generic name
"RTN","NDFRR3",114,0)
 S NDFSAVE("50.68,.01")=$P(^PSNDF(50.68,NDFIEN,0),"^")  ; product name
"RTN","NDFRR3",115,0)
 S NDFSAVE("50.68,5")=$P(^PSNDF(50.68,NDFIEN,1),"^")  ; print name
"RTN","NDFRR3",116,0)
 S NDFSAVE("50.68,3")=$P(^PSNDF(50.68,NDFIEN,0),"^",5)  ; unit
"RTN","NDFRR3",117,0)
 S NDFSAVE("50.68,1")=$P(^PSNDF(50.68,NDFIEN,0),"^",3)  ; dosage form
"RTN","NDFRR3",118,0)
 S NDFSAVE("50.68,21")=$P($G(^PSNDF(50.68,NDFIEN,7)),"^",3)  ; inact date
"RTN","NDFRR3",119,0)
 S NDFSAVE("50.68,2")=$P(^PSNDF(50.68,NDFIEN,0),"^",4)  ; top level strength
"RTN","NDFRR3",120,0)
 S NDFSAVE("50.68,7")=$P($G(^PSNDF(50.68,NDFIEN,1)),"^",3)   ; transmit to CMOP
"RTN","NDFRR3",121,0)
 S NDFSAVE("50.68,6")=$P($G(^PSNDF(50.68,NDFIEN,1)),"^",2)   ;cmop id
"RTN","NDFRR3",122,0)
 ; S NDFSAVE("50.68,19")=$P($G(^PSNDF(50.68,NDFIEN,7)),"^")   ; cs federal schedule
"RTN","NDFRR3",123,0)
 S NDFSAVE("50.68,15")=$P($G(^PSNDF(50.68,NDFIEN,3)),"^")  ; class
"RTN","NDFRR3",124,0)
 S NDFSAVE("50.68,23")=+$P($G(^PSNDF(50.68,NDFIEN,8)),"^") ;exclude from interaction check
"RTN","NDFRR3",125,0)
 S NDFSAVE("50.68,31")=+$P($G(^PSNDF(50.68,NDFIEN,9)),"^") ;override df check
"RTN","NDFRR3",126,0)
 S NDFSAVE("50.68,40")=$P($G(^PSNDF(50.68,NDFIEN,"DOS")),"^",1) ;Create Default Possible Dosage
"RTN","NDFRR3",127,0)
 S NDFSAVE("50.68,41")=$P($G(^PSNDF(50.68,NDFIEN,"DOS")),"^",2) ;Possible Dosage to Create
"RTN","NDFRR3",128,0)
 S NDFSAVE("50.68,42")=$P($G(^PSNDF(50.68,NDFIEN,"DOS")),"^",3) ;Package
"RTN","NDFRR3",129,0)
 S NDFSAVE("50.68,100")=$G(^PSNDF(50.68,NDFIEN,"MG")) ;URL
"RTN","NDFRR3",130,0)
 Q
"RTN","NDFRR3",131,0)
CHECK ; check fields and save ien if changed
"RTN","NDFRR3",132,0)
 N FLAG S FLAG=0
"RTN","NDFRR3",133,0)
 I NDFSAVE("50.68,.05")'=$P(^PSNDF(50.68,NDFIEN,0),"^",2) S FLAG=1  ; generic name
"RTN","NDFRR3",134,0)
 I NDFSAVE("50.68,.01")'=$P(^PSNDF(50.68,NDFIEN,0),"^") S FLAG=1  ; product name
"RTN","NDFRR3",135,0)
 I $L(NDFSAVE("50.68,5"))>0&(NDFSAVE("50.68,5")'=$P(^PSNDF(50.68,NDFIEN,1),"^")) S FLAG=1  ; print name
"RTN","NDFRR3",136,0)
 I NDFSAVE("50.68,21")'=$P($G(^PSNDF(50.68,NDFIEN,7)),"^",3) S FLAG=1 ; inact
"RTN","NDFRR3",137,0)
 I $L(NDFSAVE("50.68,3"))>0&(NDFSAVE("50.68,3")'=$P(^PSNDF(50.68,NDFIEN,0),"^",5)) S FLAG=2  ; unit
"RTN","NDFRR3",138,0)
 I NDFSAVE("50.68,1")'=$P(^PSNDF(50.68,NDFIEN,0),"^",3) S FLAG=2  ; dosage form
"RTN","NDFRR3",139,0)
 I NDFSAVE("50.68,2")'=$P(^PSNDF(50.68,NDFIEN,0),"^",4) S FLAG=2  ;top level strength
"RTN","NDFRR3",140,0)
 I NDFSAVE("50.68,6")'=$P($G(^PSNDF(50.68,NDFIEN,1)),"^",2) S FLAG=1  ;cmop id
"RTN","NDFRR3",141,0)
 I NDFSAVE("50.68,23")'=+$P($G(^PSNDF(50.68,NDFIEN,8)),"^") D
"RTN","NDFRR3",142,0)
 .I $D(^NDFK(5000.23,NDFIEN)) K ^(NDFIEN) Q
"RTN","NDFRR3",143,0)
 .S ^NDFK(5000.23,NDFIEN,0)=NDFIEN_"^"_+$P($G(^PSNDF(50.68,NDFIEN,8)),"^")
"RTN","NDFRR3",144,0)
 .;change in exclude from ineraction check
"RTN","NDFRR3",145,0)
 I NDFSAVE("50.68,100")'=$G(^PSNDF(50.68,NDFIEN,"MG")) D
"RTN","NDFRR3",146,0)
 .S ^NDFK(5000.91,NDFIEN,0)=NDFIEN_"^"_$S(NDFSAVE("50.68,100")="":"A",$G(^PSNDF(50.68,NDFIEN,"MG"))="":"D",1:"E")
"RTN","NDFRR3",147,0)
 I FLAG D
"RTN","NDFRR3",148,0)
 .K DD S DIC="^NDFK(5000.2,",DIC(0)="",X=NDFIEN D FILE^DICN
"RTN","NDFRR3",149,0)
 .W $C(7),!,$P($G(^PSNDF(50.68,+NDFIEN,0)),"^")," has been added to the PRODUCTS TO UNMATCH File." H 2.5
"RTN","NDFRR3",150,0)
 I FLAG=2 K DD,DO S DIC="^NDFK(5000.4,",X=NDFIEN D FILE^DICN
"RTN","NDFRR3",151,0)
 I NDFSAVE("50.68,7"),'$P($G(^PSNDF(50.68,NDFIEN,1)),"^",3) S ^NDFK(5000.7,NDFIEN,0)=NDFIEN
"RTN","NDFRR3",152,0)
 I 'NDFSAVE("50.68,7"),$P($G(^PSNDF(50.68,NDFIEN,1)),"^",3) K ^NDFK(5000.7,NDFIEN)
"RTN","NDFRR3",153,0)
 ;
"RTN","NDFRR3",154,0)
 ;Does not record class/edits on new VA Products
"RTN","NDFRR3",155,0)
 I '$D(^NDFK(5000.506,"B",NDFIEN)) D
"RTN","NDFRR3",156,0)
 .S NDFCLASS=$P($G(^PSNDF(50.68,NDFIEN,3)),"^")
"RTN","NDFRR3",157,0)
 .I NDFSAVE("50.68,15"),NDFSAVE("50.68,15")'=NDFCLASS D
"RTN","NDFRR3",158,0)
 ..I NDFCLASS=$P($G(^NDFK(5000.8,NDFIEN,0)),"^",2) K ^NDFK(5000.8,NDFIEN) Q
"RTN","NDFRR3",159,0)
 ..;new class equals previous old class - changed back - delete
"RTN","NDFRR3",160,0)
 ..I $D(^NDFK(5000.8,NDFIEN,0)) S $P(^(0),"^",3)=NDFCLASS
"RTN","NDFRR3",161,0)
 ..;previous change exists - changed and changed again - reset new
"RTN","NDFRR3",162,0)
 ..E  S ^NDFK(5000.8,NDFIEN,0)=NDFIEN_"^"_NDFSAVE("50.68,15")_"^"_NDFCLASS_"^"_NDFSAVE("50.68,.05")_"^"_$P(^PSNDF(50.6,NDFSAVE("50.68,.05"),0),"^")
"RTN","NDFRR3",163,0)
 ..;no previous change - set one up
"RTN","NDFRR3",164,0)
 ;
"RTN","NDFRR3",165,0)
 ;override
"RTN","NDFRR3",166,0)
 S NDFOV=$P($G(^PSNDF(50.68,NDFIEN,9)),"^")
"RTN","NDFRR3",167,0)
 I NDFSAVE("50.68,31")'=NDFOV D
"RTN","NDFRR3",168,0)
 .I NDFOV=$P($G(^NDFK(5000.608,NDFIEN,0)),"^",2) K ^NDFK(5000.608,NDFIEN) Q
"RTN","NDFRR3",169,0)
 .I $D(^NDFK(5000.608,NDFIEN,0)) S $P(^(0),"^",3)=NDFOV
"RTN","NDFRR3",170,0)
 .E   S ^NDFK(5000.608,NDFIEN,0)=NDFIEN_"^"_NDFSAVE("50.68,31")_"^"_NDFOV
"RTN","NDFRR3",171,0)
 ;
"RTN","NDFRR3",172,0)
 ;Possible Dosage Settings
"RTN","NDFRR3",173,0)
 N POSDOS,DIC,DD,X,DINUM
"RTN","NDFRR3",174,0)
 S POSDOS=$G(^PSNDF(50.68,NDFIEN,"DOS"))
"RTN","NDFRR3",175,0)
 I (NDFSAVE("50.68,40")'=$P(POSDOS,"^",1))!(NDFSAVE("50.68,41")'=$P(POSDOS,"^",2))!(NDFSAVE("50.68,42")'=$P(POSDOS,"^",3)) D
"RTN","NDFRR3",176,0)
 .K DD S DIC="^NDFK(5000.92,",DIC(0)="",(X,DINUM)=NDFIEN D FILE^DICN
"RTN","NDFRR3",177,0)
 ;
"RTN","NDFRR3",178,0)
 K NDFSAVE,NDFCLASS
"RTN","NDFRR3",179,0)
 ;
"RTN","NDFRR3",180,0)
 Q
"RTN","NDFRR3",181,0)
 ;
"RTN","NDFRR3",182,0)
CHECKP(NAME) ;
"RTN","NDFRR3",183,0)
 N X,PNAME,FLAG S FLAG=0
"RTN","NDFRR3",184,0)
 F X=0:0 S X=$O(^PSNDF(50.68,"C",NDFM,X)) Q:'X  D
"RTN","NDFRR3",185,0)
 .S PNAME=$P($G(^PSNDF(50.68,X,1)),"^") I PNAME'=NAME S FLAG=1
"RTN","NDFRR3",186,0)
 Q FLAG
"RTN","NDFRR5")
0^44^B4003001
"RTN","NDFRR5",1,0)
NDFRR5 ;BIR/RSB - VA Product Enter/Edit ; 23 Jun 2009  9:14 AM
"RTN","NDFRR5",2,0)
 ;;4.0;NDF MANAGEMENT;**62,70,108,262**; 1 Jan 99;Build 1
"RTN","NDFRR5",3,0)
 ;
"RTN","NDFRR5",4,0)
EDIT ;
"RTN","NDFRR5",5,0)
 S VALMBCK="R"
"RTN","NDFRR5",6,0)
 K NDFY N NDFN,Q,NDFB1
"RTN","NDFRR5",7,0)
EFA ;
"RTN","NDFRR5",8,0)
 K NDFE S NDFY="" R !!,"Select FIELDS TO EDIT: ",NDFX:DTIME E  W $C(7) S NDFX="^" Q
"RTN","NDFRR5",9,0)
 I "^"[NDFX Q
"RTN","NDFRR5",10,0)
 I NDFX="??" D FULL^VALM1,H2 G EFA
"RTN","NDFRR5",11,0)
 I NDFX?1."?" D FULL^VALM1,H2 G EFA
"RTN","NDFRR5",12,0)
 ;I  G FDONE
"RTN","NDFRR5",13,0)
 S NDFB1=NDFX
"RTN","NDFRR5",14,0)
 I NDFB1["," F NDFN=1:1:$L(NDFB1,",") S NDFX=$P(NDFB1,",",NDFN) Q:'NDFX!(NDFX="")  D  Q:$D(NDFE)
"RTN","NDFRR5",15,0)
 .I $E(NDFX,1,2)="12" S NDFX=+NDFX
"RTN","NDFRR5",16,0)
 .I NDFX'=+NDFX!(NDFX>26)!(NDFX<1) W " ??" S NDFE=1 H .3
"RTN","NDFRR5",17,0)
 G:$D(NDFE) EFA
"RTN","NDFRR5",18,0)
 I NDFB1["," F NDFN=1:1:$L(NDFB1,",") S NDFX=$P(NDFB1,",",NDFN) Q:'NDFX!(NDFX="")  D FDONE
"RTN","NDFRR5",19,0)
 Q:NDFB1[","
"RTN","NDFRR5",20,0)
 S NDFX=NDFB1
"RTN","NDFRR5",21,0)
 I $E(NDFX,1,2)="12" S NDFX=+NDFX
"RTN","NDFRR5",22,0)
 I NDFX'=+NDFX!(NDFX>26)!(NDFX<1) W " ??" S NDFE=1 H .3 G EFA
"RTN","NDFRR5",23,0)
 D FDONE
"RTN","NDFRR5",24,0)
 Q
"RTN","NDFRR5",25,0)
 ;
"RTN","NDFRR5",26,0)
FDONE   ;
"RTN","NDFRR5",27,0)
 S NDFY=NDFX D EDIT1
"RTN","NDFRR5",28,0)
 Q
"RTN","NDFRR5",29,0)
H2 ;
"RTN","NDFRR5",30,0)
 W !,"Enter the field to edit (1-26) or multiple fields separated by commas.",!," Example: 4,5,20" Q
"RTN","NDFRR5",31,0)
EDIT1 ;
"RTN","NDFRR5",32,0)
 D FULL^VALM1
"RTN","NDFRR5",33,0)
 ;W ! N NDFX F Q=1:1 S Q1=$P(NDFY,",",Q) Q:'Q1  S NDFX=$P($T(@(Q1)),";;",2) D @NDFX
"RTN","NDFRR5",34,0)
 W ! N NDFX S NDFX=$P($T(@(NDFY)),";;",2) D @NDFX
"RTN","NDFRR5",35,0)
 Q
"RTN","NDFRR5",36,0)
 ;
"RTN","NDFRR5",37,0)
FIELDS ;
"RTN","NDFRR5",38,0)
1 ;;199^NDFRR2A
"RTN","NDFRR5",39,0)
2 ;;5^NDFRR2
"RTN","NDFRR5",40,0)
3 ;;6^NDFRR2
"RTN","NDFRR5",41,0)
4 ;;7^NDFRR2
"RTN","NDFRR5",42,0)
5 ;;8^NDFRR2
"RTN","NDFRR5",43,0)
6 ;;9^NDFRR2
"RTN","NDFRR5",44,0)
7 ;;10^NDFRR2
"RTN","NDFRR5",45,0)
8 ;;11^NDFRR2
"RTN","NDFRR5",46,0)
9 ;;13^NDFRR22
"RTN","NDFRR5",47,0)
10 ;;12^NDFRR22
"RTN","NDFRR5",48,0)
11 ;;14^NDFRR22
"RTN","NDFRR5",49,0)
12 ;;ING^NDFRR2A
"RTN","NDFRR5",50,0)
13 ;;15^NDFRR2A
"RTN","NDFRR5",51,0)
14 ;;CLASS^NDFRR2A
"RTN","NDFRR5",52,0)
15 ;;17^NDFRR2A
"RTN","NDFRR5",53,0)
16 ;;18^NDFRR2A
"RTN","NDFRR5",54,0)
17 ;;19^NDFRR2A
"RTN","NDFRR5",55,0)
18 ;;20^NDFRR2A
"RTN","NDFRR5",56,0)
19 ;;22^NDFRR2A
"RTN","NDFRR5",57,0)
20 ;;23^NDFRR2A
"RTN","NDFRR5",58,0)
21 ;;24^NDFRR2A
"RTN","NDFRR5",59,0)
22 ;;25^NDFRR2A
"RTN","NDFRR5",60,0)
23 ;;30^NDFRR2A
"RTN","NDFRR5",61,0)
24 ;;31^NDFRR2A
"RTN","NDFRR5",62,0)
25 ;;100^NDFRR2A
"RTN","NDFRR5",63,0)
26 ;;40^NDFRR2A
"RTN","NDFRR6")
0^45^B81057535
"RTN","NDFRR6",1,0)
NDFRR6 ;BIR/RSB  - VA Product Enter/Edit ; 07 Dec 2010  4:56 PM
"RTN","NDFRR6",2,0)
 ;;4.0;NDF MANAGEMENT;**62,70,108,262**; 1 Jan 99;Build 1
"RTN","NDFRR6",3,0)
 ;
"RTN","NDFRR6",4,0)
HDR ;
"RTN","NDFRR6",5,0)
 S VALMHDR(1)=$$SETSTR^VALM1("VA Product Name: "_$P(NDFNAME,"^",2)," ",2,80)
"RTN","NDFRR6",6,0)
 Q
"RTN","NDFRR6",7,0)
 ;
"RTN","NDFRR6",8,0)
BUILD(Y) ;
"RTN","NDFRR6",9,0)
 I '$P(Y,"^") D LIST Q
"RTN","NDFRR6",10,0)
 S:'$D(^TMP("NDFR",$J,"50.68,.01")) ^TMP("NDFR",$J,"50.68,.01")=$P(^PSNDF(50.68,+Y,0),"^")
"RTN","NDFRR6",11,0)
 ; ACTIVE INGREDIENTS
"RTN","NDFRR6",12,0)
 N X,CNT S CNT=0 F X=0:0 S X=$O(^PSNDF(50.68,+Y,2,X)) Q:'X  D
"RTN","NDFRR6",13,0)
 .I $D(NDFINGL) Q
"RTN","NDFRR6",14,0)
 .S CNT=CNT+1,^TMP("NDFR",$J,"50.6814",CNT)=$P(^PSNDF(50.68,+Y,2,X,0),"^")
"RTN","NDFRR6",15,0)
 .S $P(^TMP("NDFR",$J,"50.6814",CNT),"|",2)=$P(^PSNDF(50.68,+Y,2,X,0),"^",2)
"RTN","NDFRR6",16,0)
 .S $P(^TMP("NDFR",$J,"50.6814",CNT),"|",3)=$P(^PSNDF(50.68,+Y,2,X,0),"^",3)
"RTN","NDFRR6",17,0)
 .S $P(^TMP("NDFR",$J,"50.6814",CNT),"|",4)=$S($P(^PS(50.416,+$P(^PSNDF(50.68,+Y,2,X,0),"^"),0),"^",2):$P(^PS(50.416,+$P(^PSNDF(50.68,+Y,2,X,0),"^"),0),"^",2),1:"")
"RTN","NDFRR6",18,0)
 ; VA GENERIC NAME
"RTN","NDFRR6",19,0)
 S:'$D(^TMP("NDFR",$J,"50.68,.05")) ^TMP("NDFR",$J,"50.68,.05")=$P(^PSNDF(50.68,+Y,0),"^",2)
"RTN","NDFRR6",20,0)
 ; DOSAGE FORM
"RTN","NDFRR6",21,0)
 S:'$D(^TMP("NDFR",$J,"50.68,1")) ^TMP("NDFR",$J,"50.68,1")=$P(^PSNDF(50.68,+Y,0),"^",3)
"RTN","NDFRR6",22,0)
 ; STRENGTH
"RTN","NDFRR6",23,0)
 S:'$D(^TMP("NDFR",$J,"50.68,2")) ^TMP("NDFR",$J,"50.68,2")=$P(^PSNDF(50.68,+Y,0),"^",4)
"RTN","NDFRR6",24,0)
 ; UNITS
"RTN","NDFRR6",25,0)
 S:'$D(^TMP("NDFR",$J,"50.68,3")) ^TMP("NDFR",$J,"50.68,3")=$P(^PSNDF(50.68,+Y,0),"^",5)
"RTN","NDFRR6",26,0)
 ; NATIONAL FORMULARY NAME
"RTN","NDFRR6",27,0)
 S:'$D(^TMP("NDFR",$J,"50.68,4")) ^TMP("NDFR",$J,"50.68,4")=$P(^PSNDF(50.68,+Y,0),"^",6)
"RTN","NDFRR6",28,0)
 ; VA PRINT NAME
"RTN","NDFRR6",29,0)
 S:'$D(^TMP("NDFR",$J,"50.68,5")) ^TMP("NDFR",$J,"50.68,5")=$P($G(^PSNDF(50.68,+Y,1)),"^")
"RTN","NDFRR6",30,0)
 ; VA PRODUCT IDENTIFIER
"RTN","NDFRR6",31,0)
 S:'$D(^TMP("NDFR",$J,"50.68,6")) ^TMP("NDFR",$J,"50.68,6")=$P($G(^PSNDF(50.68,+Y,1)),"^",2)
"RTN","NDFRR6",32,0)
 ; VA DISPENSE UNIT
"RTN","NDFRR6",33,0)
 S:'$D(^TMP("NDFR",$J,"50.68,8")) ^TMP("NDFR",$J,"50.68,8")=$P($G(^PSNDF(50.68,+Y,1)),"^",4)
"RTN","NDFRR6",34,0)
 ; TRANSMIT TO CMOP
"RTN","NDFRR6",35,0)
 S:'$D(^TMP("NDFR",$J,"50.68,7")) ^TMP("NDFR",$J,"50.68,7")=$P($G(^PSNDF(50.68,+Y,1)),"^",3)
"RTN","NDFRR6",36,0)
 ; PMIS
"RTN","NDFRR6",37,0)
 ; S:'$D(^TMP("NDFR",$J,"50.68,11")) ^TMP("NDFR",$J,"50.68,11")=$P($G(^PSNDF(50.68,+Y,1)),"^",5)
"RTN","NDFRR6",38,0)
 D ^NDFRRDP S:'$D(^TMP("NDFR",$J,"50.68,11")) ^TMP("NDFR",$J,"50.68,11")=FDBGCN
"RTN","NDFRR6",39,0)
 ; I SEQNO]"" S:'$D(^TMP("NDFR",$J,"FDBGCN")) ^TMP("NDFR",$J,"FDBGCN")=FDBGCN
"RTN","NDFRR6",40,0)
 ; PREVIOUS GCNSEQNO
"RTN","NDFRR6",41,0)
 ; S:'$D(^TMP("NDFR",$J,"50.68,12")) ^TMP("NDFR",$J,"50.68,12")=$P($G(^PSNDF(50.68,+Y,1)),"^",6)
"RTN","NDFRR6",42,0)
 K ^TMP("NDFR",$J,"50.68,12") D ^NDFRRDP1 S:'$D(^TMP("NDFR",$J,"50.68,12")) ^TMP("NDFR",$J,"50.68,12")=PSEQNO
"RTN","NDFRR6",43,0)
 ; NDC LINK TO GCNSEQNO
"RTN","NDFRR6",44,0)
 S:'$D(^TMP("NDFR",$J,"50.68,13")) ^TMP("NDFR",$J,"50.68,13")=$P($G(^PSNDF(50.68,+Y,1)),"^",7)
"RTN","NDFRR6",45,0)
 ;         LATER!!!!
"RTN","NDFRR6",46,0)
 ; PRIMARY VA DRUG CLASS
"RTN","NDFRR6",47,0)
 S:'$D(^TMP("NDFR",$J,"50.68,15")) ^TMP("NDFR",$J,"50.68,15")=$P($G(^PSNDF(50.68,+Y,3)),"^")
"RTN","NDFRR6",48,0)
 ; SECONDARY VA DRUG CLASS
"RTN","NDFRR6",49,0)
 N X,CNT S CNT=0 F X=0:0 S X=$O(^PSNDF(50.68,+Y,4,X)) Q:'X  D
"RTN","NDFRR6",50,0)
 .I $D(NDFCLASS) Q
"RTN","NDFRR6",51,0)
 .S CNT=CNT+1,^TMP("NDFR",$J,"50.6816,.01",CNT)=$P(^PSNDF(50.68,+Y,4,X,0),"^")
"RTN","NDFRR6",52,0)
 ; CS FEDERAL SCHEDULE
"RTN","NDFRR6",53,0)
 S:'$D(^TMP("NDFR",$J,"50.68,19")) ^TMP("NDFR",$J,"50.68,19")=$P($G(^PSNDF(50.68,+Y,7)),"^")
"RTN","NDFRR6",54,0)
 ; SINGLE/MULTI SOURCE PRODUCT
"RTN","NDFRR6",55,0)
 S:'$D(^TMP("NDFR",$J,"50.68,20")) ^TMP("NDFR",$J,"50.68,20")=$P($G(^PSNDF(50.68,+Y,7)),"^",2)
"RTN","NDFRR6",56,0)
 ; INACTIVATION DATE
"RTN","NDFRR6",57,0)
 S:'$D(^TMP("NDFR",$J,"50.68,21")) ^TMP("NDFR",$J,"50.68,21")=$P($G(^PSNDF(50.68,+Y,7)),"^",3)
"RTN","NDFRR6",58,0)
 ; EXCLUDE DRG-DRG INTERACTION CK
"RTN","NDFRR6",59,0)
 S:'$D(^TMP("NDFR",$J,"50.68,23")) ^TMP("NDFR",$J,"50.68,23")=$P($G(^PSNDF(50.68,+Y,8)),"^")
"RTN","NDFRR6",60,0)
 ; MAX SINGLE DOSE
"RTN","NDFRR6",61,0)
 S:'$D(^TMP("NDFR",$J,"50.68,25")) ^TMP("NDFR",$J,"50.68,25")=$P($G(^PSNDF(50.68,+Y,7)),"^",4)
"RTN","NDFRR6",62,0)
 ; MIN SINGLE DOSE
"RTN","NDFRR6",63,0)
 S:'$D(^TMP("NDFR",$J,"50.68,26")) ^TMP("NDFR",$J,"50.68,26")=$P($G(^PSNDF(50.68,+Y,7)),"^",5)
"RTN","NDFRR6",64,0)
 ;OVERRIDE
"RTN","NDFRR6",65,0)
 S:'$D(^TMP("NDFR",$J,"50.68,31")) ^TMP("NDFR",$J,"50.68,31")=$P($G(^PSNDF(50.68,+Y,9)),"^")
"RTN","NDFRR6",66,0)
 ; MAX DAILY DOSE
"RTN","NDFRR6",67,0)
 S:'$D(^TMP("NDFR",$J,"50.68,27")) ^TMP("NDFR",$J,"50.68,27")=$P($G(^PSNDF(50.68,+Y,7)),"^",6)
"RTN","NDFRR6",68,0)
 ; MIN DAILY DOSE
"RTN","NDFRR6",69,0)
 S:'$D(^TMP("NDFR",$J,"50.68,28")) ^TMP("NDFR",$J,"50.68,28")=$P($G(^PSNDF(50.68,+Y,7)),"^",7)
"RTN","NDFRR6",70,0)
 ; MAX CUMMULATIVE DOSE
"RTN","NDFRR6",71,0)
 S:'$D(^TMP("NDFR",$J,"50.68,29")) ^TMP("NDFR",$J,"50.68,29")=$P($G(^PSNDF(50.68,+Y,7)),"^",8)
"RTN","NDFRR6",72,0)
 ;FDA
"RTN","NDFRR6",73,0)
 S:'$D(^TMP("NDFR",$J,"50.68,100")) ^TMP("NDFR",$J,"50.68,100")=$P($G(^PSNDF(50.68,+Y,"MG")),"^")
"RTN","NDFRR6",74,0)
 ;POSSIBLE DOSAGE CREATION
"RTN","NDFRR6",75,0)
 S:'$D(^TMP("NDFR",$J,"50.68,40")) ^TMP("NDFR",$J,"50.68,40")=$P($G(^PSNDF(50.68,+Y,"DOS")),"^",1)
"RTN","NDFRR6",76,0)
 S:'$D(^TMP("NDFR",$J,"50.68,41")) ^TMP("NDFR",$J,"50.68,41")=$P($G(^PSNDF(50.68,+Y,"DOS")),"^",2)
"RTN","NDFRR6",77,0)
 S:'$D(^TMP("NDFR",$J,"50.68,42")) ^TMP("NDFR",$J,"50.68,42")=$P($G(^PSNDF(50.68,+Y,"DOS")),"^",3)
"RTN","NDFRR6",78,0)
 ;
"RTN","NDFRR6",79,0)
 D LIST
"RTN","NDFRR6",80,0)
 ;
"RTN","NDFRR6",81,0)
 Q
"RTN","NDFRR6",82,0)
LIST ; BUILD LISTMAN SCREEN
"RTN","NDFRR6",83,0)
 N INGNUM,CNT,NDFL S CNT=1
"RTN","NDFRR6",84,0)
 K ^TMP("NDFRSB",$J)
"RTN","NDFRR6",85,0)
 S NDFC=$P(NDFNAME,"^",2),NDFCC=(NDFC?1.9N)
"RTN","NDFRR6",86,0)
 S ^TMP("NDFRSB",$J,CNT,0)=$$SETSTR^VALM1("1)  VA Product: "_$S(NDFCC:$P(^PSNDF(50.68,+NDFNAME,0),"^"),1:NDFC),"",1,80),CNT=CNT+1
"RTN","NDFRR6",87,0)
 S NDFC=$G(^TMP("NDFR",$J,"50.68,.05")),NDFCC=(NDFC?1.9N)
"RTN","NDFRR6",88,0)
 S ^TMP("NDFRSB",$J,CNT,0)=$$SETSTR^VALM1("2)  VA Generic Name: "_$S(NDFCC:$P($G(^PSNDF(50.6,^TMP("NDFR",$J,"50.68,.05"),0)),"^"),1:NDFC),"",1,70),CNT=CNT+1 K NDFC,NDFCC
"RTN","NDFRR6",89,0)
 S NDFC=$G(^TMP("NDFR",$J,"50.68,1")),NDFCC=(NDFC?1.9N)
"RTN","NDFRR6",90,0)
 S NDFEXC=$P($G(^PS(50.606,+$G(^TMP("NDFR",$J,"50.68,1")))),"^")&'$G(^TMP("NDFR",$J,"50.68,31"))
"RTN","NDFRR6",91,0)
 S NDFEXC=$S(NDFEXC:" Exclude from dosage form checks",1:"")
"RTN","NDFRR6",92,0)
 S NDFL=$$SETSTR^VALM1("3)  Dosage Form: "_$S(NDFCC:$P($G(^PS(50.606,^TMP("NDFR",$J,"50.68,1"),0)),"^"),1:NDFC),"",1,32) K NDFC,NDFCC
"RTN","NDFRR6",93,0)
 S NDFL=$$SETSTR^VALM1(NDFEXC,NDFL,35,35) K NDFC,NDFCC,NDFEXC
"RTN","NDFRR6",94,0)
 S ^TMP("NDFRSB",$J,CNT,0)=NDFL,CNT=CNT+1
"RTN","NDFRR6",95,0)
 S NDFL=$$SETSTR^VALM1("4)  Strength: "_$G(^TMP("NDFR",$J,"50.68,2")),"",1,20)
"RTN","NDFRR6",96,0)
 S NDFC=+$G(^TMP("NDFR",$J,"50.68,3"))
"RTN","NDFRR6",97,0)
 S ^TMP("NDFRSB",$J,CNT,0)=$$SETSTR^VALM1("(5) Units: "_$S(NDFC:$P(^PS(50.607,+$G(^TMP("NDFR",$J,"50.68,3")),0),"^"),1:""),NDFL,25,24),CNT=CNT+1
"RTN","NDFRR6",98,0)
 ; build National Formulary name again
"RTN","NDFRR6",99,0)
 S NDFC=$G(^TMP("NDFR",$J,"50.68,.05")) S NDFCC=(NDFC?1.9N)
"RTN","NDFRR6",100,0)
 S NDFDEF=$S(NDFCC:$P($G(^PSNDF(50.6,^TMP("NDFR",$J,"50.68,.05"),0)),"^"),1:$G(^TMP("NDFR",$J,"50.68,.05")))
"RTN","NDFRR6",101,0)
 S NDFC=$G(^TMP("NDFR",$J,"50.68,1")) S NDFCC=(NDFC?1.9N)
"RTN","NDFRR6",102,0)
 S NDFDEF1=$S(NDFCC:$P($G(^PS(50.606,^TMP("NDFR",$J,"50.68,1"),0)),"^"),1:$G(^TMP("NDFR",$J,"50.68,1")))
"RTN","NDFRR6",103,0)
 ;S ^TMP("NDFR",$J,"50.68,4")=NDFDEF_" "_NDFDEF1 K NDFDEF,NDFDEF1,NDFC,NDFCC
"RTN","NDFRR6",104,0)
 S ^TMP("NDFRSB",$J,CNT,0)=$$SETSTR^VALM1("6)  Nat' Formulary Name: "_$G(^TMP("NDFR",$J,"50.68,4")),"",1,80),CNT=CNT+1
"RTN","NDFRR6",105,0)
 S ^TMP("NDFRSB",$J,CNT,0)=$$SETSTR^VALM1("7)  VA Print Name: "_$G(^TMP("NDFR",$J,"50.68,5")),"",1,79),CNT=CNT+1
"RTN","NDFRR6",106,0)
 S NDFL=$$SETSTR^VALM1("8)  VA Product Identifier: "_$G(^TMP("NDFR",$J,"50.68,6")),"",1,35)
"RTN","NDFRR6",107,0)
 S ^TMP("NDFRSB",$J,CNT,0)=$$SETSTR^VALM1("(9) Transmit to CMOP: "_$S($G(^TMP("NDFR",$J,"50.68,7"))=1:"Yes",1:"No"),NDFL,36,70),CNT=CNT+1
"RTN","NDFRR6",108,0)
 S NDFC=$G(^TMP("NDFR",$J,"50.68,8")) S NDFCC=(NDFC?1.9N)
"RTN","NDFRR6",109,0)
 S ^TMP("NDFRSB",$J,CNT,0)=$$SETSTR^VALM1("10) VA Dispense Unit: "_$S(NDFCC:$P($G(^PSNDF(50.64,^TMP("NDFR",$J,"50.68,8"),0)),"^"),1:NDFC),"",1,70),CNT=CNT+1 K NDFC,NDFCC
"RTN","NDFRR6",110,0)
 S ^TMP("NDFRSB",$J,CNT,0)=$$SETSTR^VALM1("11) GCNSEQNO: "_$P($G(^TMP("NDFR",$J,"50.68,11")),"^",3),"",1,70),CNT=CNT+1
"RTN","NDFRR6",111,0)
 S ^TMP("NDFRSB",$J,CNT,0)=$$SETSTR^VALM1("11a) PREVIOUS GCNSEQNO: "_$P($G(^TMP("NDFR",$J,"50.68,12")),"^",3),"",1,70),CNT=CNT+1
"RTN","NDFRR6",112,0)
 S ^TMP("NDFRSB",$J,CNT,0)=$$SETSTR^VALM1("11b) NDC LINK TO GCNSEQNO: "_$G(^TMP("NDFR",$J,"50.68,13")),"",1,70),CNT=CNT+1
"RTN","NDFRR6",113,0)
 S ^TMP("NDFRSB",$J,CNT,0)=$$SETSTR^VALM1("12) Active Ingredients: ","",1,70),CNT=CNT+1
"RTN","NDFRR6",114,0)
 N ING F ING=0:0 S ING=$O(^TMP("NDFR",$J,"50.6814",ING)) Q:'ING  D
"RTN","NDFRR6",115,0)
 .S NDFC=$P($G(^TMP("NDFR",$J,"50.6814",ING)),"|") S NDFCC=(NDFC?1.9N)
"RTN","NDFRR6",116,0)
 .I 'NDFCC K NDFL S ^TMP("NDFRSB",$J,CNT,0)=$$SETSTR^VALM1(NDFC_$S('$L($P(^TMP("NDFR",$J,"50.6814",ING),"|",4)):"  (Primary)",1:""),"",6,72)
"RTN","NDFRR6",117,0)
 .I NDFCC K NDFL S ^TMP("NDFRSB",$J,CNT,0)=$$SETSTR^VALM1($P($G(^PS(50.416,+^TMP("NDFR",$J,"50.6814",ING),0)),"^")_$S('$L($P($G(^PS(50.416,+^TMP("NDFR",$J,"50.6814",ING),0)),"^",2)):"  (Primary)",1:""),"",6,72)
"RTN","NDFRR6",118,0)
 .K NDFC,NDFCC S CNT=CNT+1
"RTN","NDFRR6",119,0)
 .S NDFL=$$SETSTR^VALM1("(12a) Strength: "_$P(^TMP("NDFR",$J,"50.6814",ING),"|",2),"",28,23)
"RTN","NDFRR6",120,0)
 .S ^TMP("NDFRSB",$J,CNT,0)=$$SETSTR^VALM1("(12b) Unit: "_$P($G(^PS(50.607,+$P(^TMP("NDFR",$J,"50.6814",ING),"|",3),0)),"^"),NDFL,51,29),CNT=CNT+1 K NDFL
"RTN","NDFRR6",121,0)
 S ^TMP("NDFRSB",$J,CNT,0)=$$SETSTR^VALM1("13) Primary VA Drug Class: "_$P($G(^PS(50.605,+$G(^TMP("NDFR",$J,"50.68,15")),0)),"^"),"",1,40),CNT=CNT+1
"RTN","NDFRR6",122,0)
 S ^TMP("NDFRSB",$J,CNT,0)=$$SETSTR^VALM1("14) Secondary VA Drug Class:","",1,40),CNT=CNT+1
"RTN","NDFRR6",123,0)
 N SEC F SEC=0:0 S SEC=$O(^TMP("NDFR",$J,"50.6816,.01",SEC)) Q:'SEC  D
"RTN","NDFRR6",124,0)
 .S ^TMP("NDFRSB",$J,CNT,0)=$$SETSTR^VALM1($P($G(^PS(50.605,^TMP("NDFR",$J,"50.6816,.01",SEC),0)),"^"),"",6,40),CNT=CNT+1
"RTN","NDFRR6",125,0)
 S NDFL=$$SETSTR^VALM1("15) CS Fed Schedule: "_$$EXTERNAL^DILFD(50.68,19,"",$G(^TMP("NDFR",$J,"50.68,19"))),"",1,40)
"RTN","NDFRR6",126,0)
 S ^TMP("NDFRSB",$J,CNT,0)=$$SETSTR^VALM1("(16) S/M Source Product: "_$$EXTERNAL^DILFD(50.68,20,"",$G(^TMP("NDFR",$J,"50.68,20"))),NDFL,40,39),CNT=CNT+1
"RTN","NDFRR6",127,0)
 S:$G(^TMP("NDFR",$J,"50.68,21")) Y=$G(^TMP("NDFR",$J,"50.68,21")) X ^DD("DD")
"RTN","NDFRR6",128,0)
 S ^TMP("NDFRSB",$J,CNT,0)=$$SETSTR^VALM1("17) Inactivation Date: "_$S($G(^TMP("NDFR",$J,"50.68,21")):Y,1:""),NDFL,1,70),CNT=CNT+1
"RTN","NDFRR6",129,0)
 S NDFL=$$SETSTR^VALM1("18) Max Single Dose: "_$G(^TMP("NDFR",$J,"50.68,25")),"",1,40)
"RTN","NDFRR6",130,0)
 S ^TMP("NDFRSB",$J,CNT,0)=$$SETSTR^VALM1("(19) Min Single Dose: "_$G(^TMP("NDFR",$J,"50.68,26")),NDFL,40,39),CNT=CNT+1
"RTN","NDFRR6",131,0)
 S NDFL=$$SETSTR^VALM1("20) Max Daily Dose: "_$G(^TMP("NDFR",$J,"50.68,27")),"",1,40)
"RTN","NDFRR6",132,0)
 S ^TMP("NDFRSB",$J,CNT,0)=$$SETSTR^VALM1("(21) Min Daily Dose: "_$G(^TMP("NDFR",$J,"50.68,28")),NDFL,40,39),CNT=CNT+1
"RTN","NDFRR6",133,0)
 S ^TMP("NDFRSB",$J,CNT,0)=$$SETSTR^VALM1("22) Max Cumulative Dose: "_$G(^TMP("NDFR",$J,"50.68,29")),"",1,40),CNT=CNT+1
"RTN","NDFRR6",134,0)
 S ^TMP("NDFRSB",$J,CNT,0)=$$SETSTR^VALM1("23) EXCLUDE Drg-Drg Interaction Check: "_$S($G(^TMP("NDFR",$J,"50.68,23"))=1:"Yes",1:"No"),"",1,50),CNT=CNT+1
"RTN","NDFRR6",135,0)
 S ^TMP("NDFRSB",$J,CNT,0)=$$SETSTR^VALM1("24) OVERRIDE DF dose check exclusion: "_$S($G(^TMP("NDFR",$J,"50.68,31"))=1:"Yes",1:"No"),"",1,50),CNT=CNT+1
"RTN","NDFRR6",136,0)
 S ^TMP("NDFRSB",$J,CNT,0)=$$SETSTR^VALM1("25) FDA Med Guide File Name: "_$G(^TMP("NDFR",$J,"50.68,100")),"",1,80),CNT=CNT+1
"RTN","NDFRR6",137,0)
 S ^TMP("NDFRSB",$J,CNT,0)=$$SETSTR^VALM1("26) Auto-Create Default Possible Dosage: "_$S($G(^TMP("NDFR",$J,"50.68,40"))="N":"No",1:"Yes"),"",1,80),CNT=CNT+1
"RTN","NDFRR6",138,0)
 I $G(^TMP("NDFR",$J,"50.68,40"))="N" D
"RTN","NDFRR6",139,0)
 . N PTC S PTC=$G(^TMP("NDFR",$J,"50.68,41"))
"RTN","NDFRR6",140,0)
 . S ^TMP("NDFRSB",$J,CNT,0)=$$SETSTR^VALM1("26a) Possible Dosages to Auto-Create: "_$S(PTC="N":"No Possible Dosages",PTC="O":"1x Possible Dosage",PTC="B":"1x and 2x Possible Dosages",1:""),"",1,80),CNT=CNT+1
"RTN","NDFRR6",141,0)
 . I (PTC'="N") D
"RTN","NDFRR6",142,0)
 . . N PKG S PKG=$G(^TMP("NDFR",$J,"50.68,42"))
"RTN","NDFRR6",143,0)
 . . S ^TMP("NDFRSB",$J,CNT,0)=$$SETSTR^VALM1("26b) Package: "_$S(PKG="O":"Outpatient",PKG="I":"Inpatient",PKG="IO":"Both Inpatient and Outpatient",1:""),"",1,80),CNT=CNT+1
"RTN","NDFRR6",144,0)
 ;
"RTN","NDFRR6",145,0)
 S VALMCNT=CNT
"RTN","NDFRR6",146,0)
 Q
"RTN","NDFRR7")
0^46^B47852152
"RTN","NDFRR7",1,0)
NDFRR7 ;BIR/RSB-NDC ENTER EDIT ; 06/03/03 15:07
"RTN","NDFRR7",2,0)
 ;;4.0; NDF MANAGEMENT;**62**; 1 Jan 99;Build 1
"RTN","NDFRR7",3,0)
 ;
"RTN","NDFRR7",4,0)
 ; prompt for NDC entry.
"RTN","NDFRR7",5,0)
NDC ;
"RTN","NDFRR7",6,0)
 K NDFNDC,NDFPCNT,NDFUPN D CLEAN^NDFRR10
"RTN","NDFRR7",7,0)
NDC1 W @IOF K DIR S DIR(0)="FO",DIR("A")="Enter the 10 character NDC"
"RTN","NDFRR7",8,0)
 K NDFGO,NDFUPN,NDFUPNI,NDFLIST,NDFEDIT2,NDFVAPD,^TMP("NDFD",$J)
"RTN","NDFRR7",9,0)
 S DIR("?")="Enter the 10 character NDC number.  Enter ""UPN"" to enter a new UPN" D ^DIR K DIR Q:Y<0
"RTN","NDFRR7",10,0)
 I $D(DTOUT)!($D(DUOUT)) Q
"RTN","NDFRR7",11,0)
 I X="" Q
"RTN","NDFRR7",12,0)
 I X="UPN" G ^NDFRR10 Q
"RTN","NDFRR7",13,0)
 I X'?1.10N!($L(X)>10)!($L(X)<10) W !,"Answer must be a ten digit number or ""UPN""" H 1 G NDC1 Q
"RTN","NDFRR7",14,0)
 ;
"RTN","NDFRR7",15,0)
 S NDFPCNT=0,NDFGO=0
"RTN","NDFRR7",16,0)
 S NDFNDC=X I $$BUILD2^NDFRR8 D  W !
"RTN","NDFRR7",17,0)
 .S DIR(0)="SO^A:Add new NDCs;E:Edit existing NDCs" N X,Y D ^DIR Q:$D(DUOUT)!($D(DTOUT))!(Y=-1)
"RTN","NDFRR7",18,0)
 .I Y="E" D EN^VALM("NDF RSB NDC A/E") S NDFGO=1
"RTN","NDFRR7",19,0)
 .I $G(Y)="A" S NDFGO=2
"RTN","NDFRR7",20,0)
 I $G(NDFGO)=1 G NDC
"RTN","NDFRR7",21,0)
 I $$ADD^NDFRR1(X,"NDC") S (^TMP("NDFD",$J,"NDFDIG"),NDFNDC)=X ; record good 10 digit entry
"RTN","NDFRR7",22,0)
 E  G NDC
"RTN","NDFRR7",23,0)
 G 1
"RTN","NDFRR7",24,0)
 ;
"RTN","NDFRR7",25,0)
UPN ; ENTER NEW UPN
"RTN","NDFRR7",26,0)
 S (NDFM,X)=$$GET^NDFRR1(50.67,2,$S($D(^TMP("NDFD",$J,NDFPCNT,"50.67,2")):^TMP("NDFD",$J,NDFPCNT,"50.67,2"),1:""),0,"UPN")
"RTN","NDFRR7",27,0)
 I $D(NDFABORT)&('$D(NDFEDIT2)) Q
"RTN","NDFRR7",28,0)
 I $D(NDFABORT)&($D(NDFEDIT2)) Q
"RTN","NDFRR7",29,0)
 I NDFM=""&('$D(NDFNDC))&('$D(NDFEDIT2)) Q
"RTN","NDFRR7",30,0)
 I NDFM=""&($D(NDFNDC)) G 5
"RTN","NDFRR7",31,0)
 ;I NDFM=""&($D(NDFEDIT2)) Q       
"RTN","NDFRR7",32,0)
 I '$$CK^NDFRR1(50.67,2,NDFM) D HLP^NDFRR1(50.67,2) G UPN
"RTN","NDFRR7",33,0)
 I $$CK^NDFRR1(50.67,2,NDFM) S (^TMP("NDFD",$J,NDFPCNT,"50.67,2"),NDFUPN)=NDFM G 5
"RTN","NDFRR7",34,0)
 Q:$D(NDFEDIT2)
"RTN","NDFRR7",35,0)
 ;
"RTN","NDFRR7",36,0)
1 ; get 2 character package code
"RTN","NDFRR7",37,0)
 K DIR S DIR(0)="NO",DIR("A")="Enter the 2 character package code"
"RTN","NDFRR7",38,0)
 S DIR("?")="Enter the 2 character package code" D ^DIR K DIR Q:Y<0
"RTN","NDFRR7",39,0)
 I $D(DTOUT)!($D(DUOUT)) G ^NDFRR7
"RTN","NDFRR7",40,0)
 I X=""&($D(^TMP("NDFD",$J,1,"NDF2DIG"))) G 6
"RTN","NDFRR7",41,0)
 I X=""&('$D(^TMP("NDFD",$J,1,"NDF2DIG"))) G NDC
"RTN","NDFRR7",42,0)
 I X'?2N!($L(X)>2)!($L(X)<2) W !,"Answer must be a 2 digit number" G 1
"RTN","NDFRR7",43,0)
 I $D(^PSNDF(50.67,"NDC",$G(NDFNDC)_X))!($D(NDFLIST(X))) W !,"Number already used!" G 1
"RTN","NDFRR7",44,0)
 I $$ADD^NDFRR1(X,"PACKAGE CODE") S NDFPCNT=NDFPCNT+1 K ^TMP("NDFD",$J,NDFPCNT) S (NDFLIST(X),^TMP("NDFD",$J,NDFPCNT,"NDF2DIG"))=X ; record good 2 digit entry
"RTN","NDFRR7",45,0)
 E  G 1
"RTN","NDFRR7",46,0)
 Q:$D(NDFEDIT2)
"RTN","NDFRR7",47,0)
 ;
"RTN","NDFRR7",48,0)
2 ; get Package Size
"RTN","NDFRR7",49,0)
 N NDFY
"RTN","NDFRR7",50,0)
 S NDFC=$G(^TMP("NDFD",$J,"50.67,8")),NDFCC=(NDFC'["|NEW")
"RTN","NDFRR7",51,0)
 S (NDFM,X)=$$GET^NDFRR1(50.609,.01,$S(NDFCC:$S($D(^TMP("NDFD",$J,NDFPCNT,"50.67,8")):$P(^PS(50.609,^TMP("NDFD",$J,NDFPCNT,"50.67,8"),0),"^"),1:""),1:$P(NDFC,"|")),1,"Package Size") K NDFC,NDFCC
"RTN","NDFRR7",52,0)
 I $D(NDFABORT)&('$D(NDFEDIT2)) G ^NDFRR7
"RTN","NDFRR7",53,0)
 I $D(NDFABORT)&($D(NDFEDIT2)) G EXIT^NDFRR2A
"RTN","NDFRR7",54,0)
 I NDFM="" Q
"RTN","NDFRR7",55,0)
 K DIC S DIC=50.609,DIC(0)="EMZ" D ^DIC
"RTN","NDFRR7",56,0)
 I Y=-1 I '$$CK^NDFRR1(50.609,.01,NDFM) D HLP^NDFRR1(50.609,.01) G 2
"RTN","NDFRR7",57,0)
 I Y=-1 S NDFY=$$ADD^NDFRR1(NDFM,"PACKAGE SIZE") I NDFY S ^TMP("NDFD",$J,NDFPCNT,"50.67,8")=NDFM_"|NEW"
"RTN","NDFRR7",58,0)
 I $G(NDFY)=0 G 2
"RTN","NDFRR7",59,0)
 I Y=-1&($G(NDFY)=0) G 2
"RTN","NDFRR7",60,0)
 I +Y>0 S NDFM=$S(Y["^":+Y,1:Y) S ^TMP("NDFD",$J,NDFPCNT,"50.67,8")=NDFM
"RTN","NDFRR7",61,0)
 ;
"RTN","NDFRR7",62,0)
3 ; get Package Type
"RTN","NDFRR7",63,0)
 N NDFY
"RTN","NDFRR7",64,0)
 S NDFC=$G(^TMP("NDFD",$J,NDFPCNT,"50.67,9")),NDFCC=(NDFC?1.9N)
"RTN","NDFRR7",65,0)
 S (NDFM,X)=$$GET^NDFRR1(50.608,.01,$S(NDFCC:$S($D(^TMP("NDFD",$J,NDFPCNT,"50.67,9")):$P(^PS(50.608,^TMP("NDFD",$J,NDFPCNT,"50.67,9"),0),"^"),1:""),1:NDFC),1,"Package Type") K NDFC,NDFCC
"RTN","NDFRR7",66,0)
 I $D(NDFABORT)&('$D(NDFEDIT2)) G ^NDFRR7
"RTN","NDFRR7",67,0)
 I $D(NDFABORT)&($D(NDFEDIT2)) G EXIT^NDFRR2A
"RTN","NDFRR7",68,0)
 I NDFM="" Q
"RTN","NDFRR7",69,0)
 K DIC S DIC=50.608,DIC(0)="EMZ" D ^DIC
"RTN","NDFRR7",70,0)
 I Y=-1 I '$$CK^NDFRR1(50.608,.01,NDFM) D HLP^NDFRR1(50.608,.01) G 3
"RTN","NDFRR7",71,0)
 I Y=-1 S NDFY=$$ADD^NDFRR1(NDFM,"PACKAGE TYPE") I NDFY S ^TMP("NDFD",$J,NDFPCNT,"50.67,9")=NDFM
"RTN","NDFRR7",72,0)
 I $G(NDFY)=1 G 4
"RTN","NDFRR7",73,0)
 I Y=-1&('$G(NDFY)) G 3
"RTN","NDFRR7",74,0)
 I +Y>0 S NDFM=$S(Y["^":+Y,1:Y) S ^TMP("NDFD",$J,NDFPCNT,"50.67,9")=NDFM
"RTN","NDFRR7",75,0)
 ;
"RTN","NDFRR7",76,0)
4 ; prompt for UPN if NDC was entered
"RTN","NDFRR7",77,0)
 I $D(NDFNDC) D UPN Q
"RTN","NDFRR7",78,0)
 ;
"RTN","NDFRR7",79,0)
5 ; get OTX/RX Indicator
"RTN","NDFRR7",80,0)
 K DIR
"RTN","NDFRR7",81,0)
 S:$D(^TMP("NDFD",$J,"50.67,10")) DIR("B")=$$EXTERNAL^DILFD(50.67,10,"",$G(^TMP("NDFD",$J,"50.67,10")))
"RTN","NDFRR7",82,0)
 S DIR(0)="50.67,10" D ^DIR
"RTN","NDFRR7",83,0)
 I $D(DTOUT)!($D(DUOUT))&(($D(NDFEDIT2))) G EXIT^NDFRR2A
"RTN","NDFRR7",84,0)
 I $D(DTOUT)!($D(DUOUT))&(('$D(NDFEDIT2))) G ^NDFRR7
"RTN","NDFRR7",85,0)
 ;I X="" W "  (Required)" G 17
"RTN","NDFRR7",86,0)
 I Y>-1 S ^TMP("NDFD",$J,"50.67,10")=Y
"RTN","NDFRR7",87,0)
 Q:$D(NDFEDIT2)
"RTN","NDFRR7",88,0)
 ;
"RTN","NDFRR7",89,0)
 G 1  ; ask for another 2 character package code
"RTN","NDFRR7",90,0)
 ;
"RTN","NDFRR7",91,0)
6 ; get Manufacturer
"RTN","NDFRR7",92,0)
 I $D(NDFNDC) S NDFDEF=$O(^PS(55.95,"C",$E(NDFNDC,1,6),0))
"RTN","NDFRR7",93,0)
 I $D(NDFNDC) S:NDFDEF NDFDEF=$P(^PS(55.95,+NDFDEF,0),"^")
"RTN","NDFRR7",94,0)
 E  S NDFDEF=""
"RTN","NDFRR7",95,0)
 S NDFC=$G(^TMP("NDFD",$J,"50.67,3")),NDFCC=(NDFC?1.9N)
"RTN","NDFRR7",96,0)
 S (NDFM,X)=$$GET^NDFRR1(55.95,.01,$S(NDFCC:$P(^PS(55.95,^TMP("NDFD",$J,"50.67,3"),0),"^"),$L(NDFC)>1:$P(NDFC,"^"),$L(NDFDEF):NDFDEF,1:""),1,"Manufacturer") K NDFC,NDFCC,NDFDEF
"RTN","NDFRR7",97,0)
 I $D(NDFABORT)&('$D(NDFEDIT2)) G ^NDFRR7
"RTN","NDFRR7",98,0)
 I $D(NDFABORT)&($D(NDFEDIT2)) G EXIT^NDFRR2A
"RTN","NDFRR7",99,0)
 I NDFM="" Q
"RTN","NDFRR7",100,0)
 K DIC,NDFY S DIC=55.95,DIC(0)="EMZ" D ^DIC
"RTN","NDFRR7",101,0)
 I Y=-1 I '$$CK^NDFRR1(55.95,.01,NDFM) D HLP^NDFRR1(55.95,.01) G 6
"RTN","NDFRR7",102,0)
 I Y=-1 S NDFY=$$ADD^NDFRR1(NDFM,"MANUFACTURER") I NDFY S ^TMP("NDFD",$J,"50.67,3")=NDFM
"RTN","NDFRR7",103,0)
 I $G(NDFY)=1 G 7
"RTN","NDFRR7",104,0)
 I Y=-1&('$G(NDFY)) G 6
"RTN","NDFRR7",105,0)
 I +Y>0 S NDFM=$S(Y["^":+Y,1:Y) S ^TMP("NDFD",$J,"50.67,3")=NDFM
"RTN","NDFRR7",106,0)
 Q:$D(NDFEDIT2)
"RTN","NDFRR7",107,0)
 G 8
"RTN","NDFRR7",108,0)
 ;
"RTN","NDFRR7",109,0)
7 ; prompt for NDC Identifier for new Manufacturer
"RTN","NDFRR7",110,0)
 S (NDFM,X)=$$GET^NDFRR1(55.95,1,$E($G(NDFNDC),1,6),1,"NDC Identifier")
"RTN","NDFRR7",111,0)
 I $D(NDFABORT)&('$D(NDFEDIT2)) G ^NDFRR7
"RTN","NDFRR7",112,0)
 I $D(NDFABORT)&($D(NDFEDIT2)) G EXIT^NDFRR2A
"RTN","NDFRR7",113,0)
 ;I NDFM=""&('$D(NDFEDIT2)) G 8
"RTN","NDFRR7",114,0)
 ;I NDFM=""&($D(NDFEDIT2)) Q       
"RTN","NDFRR7",115,0)
 I '$$CK^NDFRR1(55.95,1,NDFM) D HLP^NDFRR1(55.95,1) G 7
"RTN","NDFRR7",116,0)
 I $$CK^NDFRR1(55.95,1,NDFM) S $P(^TMP("NDFD",$J,"50.67,3"),"^",2)=NDFM
"RTN","NDFRR7",117,0)
 Q:$D(NDFEDIT2)
"RTN","NDFRR7",118,0)
 ;
"RTN","NDFRR7",119,0)
8 ; get Trade Name
"RTN","NDFRR7",120,0)
 S (NDFM,X)=$$GET^NDFRR1(50.67,4,$G(^TMP("NDFD",$J,"50.67,4")),0,"Trade Name")
"RTN","NDFRR7",121,0)
 I $D(NDFABORT)&('$D(NDFEDIT2)) G ^NDFRR7
"RTN","NDFRR7",122,0)
 I $D(NDFABORT)&($D(NDFEDIT2)) G EXIT^NDFRR2A
"RTN","NDFRR7",123,0)
 ;I NDFM=""&('$D(NDFEDIT2)) G 8
"RTN","NDFRR7",124,0)
 ;I NDFM=""&($D(NDFEDIT2)) Q       
"RTN","NDFRR7",125,0)
 I '$$CK^NDFRR1(50.67,4,NDFM) D HLP^NDFRR1(50.67,4) G 8
"RTN","NDFRR7",126,0)
 I $$CK^NDFRR1(50.67,4,NDFM) S ^TMP("NDFD",$J,"50.67,4")=NDFM
"RTN","NDFRR7",127,0)
 Q:$D(NDFEDIT2)
"RTN","NDFRR7",128,0)
 ;
"RTN","NDFRR7",129,0)
88      ;  Route of Administration
"RTN","NDFRR7",130,0)
 S CNT=0
"RTN","NDFRR7",131,0)
888 S (NDFM,X)=$$GET^NDFRR1(51.2,.01,"",0,"Route of Administration")
"RTN","NDFRR7",132,0)
 I $D(NDFABORT)&('$D(NDFEDIT2)) G ^NDFRR7
"RTN","NDFRR7",133,0)
 I $D(NDFABORT)&($D(NDFEDIT2)) G EXIT^NDFRR2A
"RTN","NDFRR7",134,0)
 ;I NDFM=""&($D(^TMP("NDFR",$J,"50.6816,.01")))&('$D(NDFEDIT2)) G 9
"RTN","NDFRR7",135,0)
 ;I NDFM=""&($D(^TMP("NDFR",$J,"50.6816,.01")))&($D(NDFEDIT2)) Q
"RTN","NDFRR7",136,0)
 I NDFM=""&('$D(NDFEDIT2)) G 9
"RTN","NDFRR7",137,0)
 I NDFM=""&($D(NDFEDIT2)) Q
"RTN","NDFRR7",138,0)
 K DIC S DIC=51.2,DIC(0)="EMZ" D ^DIC
"RTN","NDFRR7",139,0)
 I Y=-1 D  G 888
"RTN","NDFRR7",140,0)
 .D HLP^NDFRR1(51.2,.01)
"RTN","NDFRR7",141,0)
 S NDFM=Y(0,0),CNT=CNT+1 S ^TMP("NDFD",$J,"50.676,.01",CNT)=NDFM G 888
"RTN","NDFRR7",142,0)
 I '$D(^TMP("NDFD",$J,"50.676,.01")) W "  (Required)" G 888
"RTN","NDFRR7",143,0)
 G 888
"RTN","NDFRR7",144,0)
 ;
"RTN","NDFRR7",145,0)
9 ; get VA Product Name
"RTN","NDFRR7",146,0)
 I $D(NDFNDC) D FIND
"RTN","NDFRR7",147,0)
 ; D SHOWEM^NDFRR998
"RTN","NDFRR7",148,0)
 D ^NDFRR2
"RTN","NDFRR7",149,0)
 I $D(NDFABORT) Q
"RTN","NDFRR7",150,0)
 I '$D(^TMP("NDFD",$J,"50.67,5")) G 9
"RTN","NDFRR7",151,0)
 D EN^VALM("NDF RSB NDC A/E") G NDC
"RTN","NDFRR7",152,0)
 Q
"RTN","NDFRR7",153,0)
 ;
"RTN","NDFRR7",154,0)
FIND ;
"RTN","NDFRR7",155,0)
 S NDFL=NDFNDC,NDFX=NDFL_"00" F  S NDFX=$O(^PSNDF(50.67,"NDC",NDFX)) Q:NDFX=""!($E(NDFX,1,10)'=NDFL)  D
"RTN","NDFRR7",156,0)
 .F NDF1=0:0 S NDF1=$O(^PSNDF(50.67,"NDC",NDFX,NDF1)) Q:'NDF1!($D(NDFVAPD))  D
"RTN","NDFRR7",157,0)
 ..S NDFVAPD=$P(^PSNDF(50.67,NDF1,0),"^",6)
"RTN","NDFRR7",158,0)
 ..S NDFVAPD=$P(^PSNDF(50.68,+NDFVAPD,0),"^")
"RTN","NDFRR7",159,0)
 Q
"RTN","NDFRR7",160,0)
 ;
"RTN","NDFRR7",161,0)
E ; edit multiple package codes
"RTN","NDFRR7",162,0)
 ;
"RTN","NDFRR7",163,0)
 W ! K DIR
"RTN","NDFRR7",164,0)
 S DIR("A",1)="Only "_$S($D(NDFNDC):"Product Codes",1:"UPNs")_" that have just been entered may be deleted."
"RTN","NDFRR7",165,0)
 S DIR("A")="Do you wish to Edit or Delete Package Code: "_$S($D(^TMP("NDFD",$J,NDFANS,"NDF2DIG")):^TMP("NDFD",$J,NDFANS,"NDF2DIG"),1:$E(^TMP("NDFD",$J,NDFANS,"50.67,1"),11,12))_" ?"
"RTN","NDFRR7",166,0)
 S DIR(0)="SBOM^E:Edit entries;D:Delete entries" D ^DIR K DIR
"RTN","NDFRR7",167,0)
 I Y="E" D 2^NDFRR9 Q
"RTN","NDFRR7",168,0)
 I Y="D" D EDEL Q
"RTN","NDFRR7",169,0)
 Q
"RTN","NDFRR7",170,0)
EDEL ;
"RTN","NDFRR7",171,0)
 I $D(^TMP("NDFD",$J,NDFANS,"50.67,SEQ")) W !,"Can't be deleted from file." H .6 Q
"RTN","NDFRR7",172,0)
 K ^TMP("NDFD",$J,NDFANS) W !?15," (Deleted)" H .6
"RTN","NDFRR7",173,0)
 Q
"RTN","NDFRR8")
0^47^B36357287
"RTN","NDFRR8",1,0)
NDFRR8 ;BIR/RSB-BUILD LISTMAN SCREEN ; 10 Mar 98 / 2:36 PM [ 11/09/98  10:16 AM ]
"RTN","NDFRR8",2,0)
 ;;4.0; NDF MANAGEMENT;; 1 Jan 99;Build 1
"RTN","NDFRR8",3,0)
 ;
"RTN","NDFRR8",4,0)
BUILD ;
"RTN","NDFRR8",5,0)
 ; find current 12 digit NDC's that contain the 10 digit NDC
"RTN","NDFRR8",6,0)
 N NDFL,NDFX,NDF1,NDCNT S NDCNT=0
"RTN","NDFRR8",7,0)
 I $D(NDFNDC)&($D(^PSNDF(50.67,"NDC",NDFNDC_"00"))) S NDFX=$O(^PSNDF(50.67,"NDC",NDFNDC_"00",0)) S NDCNT=NDCNT+1,NDF1=NDFX D BUILD1
"RTN","NDFRR8",8,0)
 I $D(NDFNDC) S NDFL=NDFNDC,NDFX=NDFL_"00" F  S NDFX=$O(^PSNDF(50.67,"NDC",NDFX)) Q:NDFX=""!($E(NDFX,1,10)'=NDFL)  D
"RTN","NDFRR8",9,0)
 .F NDF1=0:0 S NDF1=$O(^PSNDF(50.67,"NDC",NDFX,NDF1)) Q:'NDF1  D
"RTN","NDFRR8",10,0)
 ..S NDCNT=NDCNT+1 D BUILD1
"RTN","NDFRR8",11,0)
 I '$D(NDFNDC)&($D(NDFUPNI)) S NDF1=$G(NDFUPNI) S NDCNT=1 D BUILD1
"RTN","NDFRR8",12,0)
 D LIST
"RTN","NDFRR8",13,0)
 Q
"RTN","NDFRR8",14,0)
BUILD1 ; build array for entries already there
"RTN","NDFRR8",15,0)
 N A,B,C S A="NDFD",B=$G(^PSNDF(50.67,NDF1,0)),C=NDFPCNT+NDCNT
"RTN","NDFRR8",16,0)
 S ^TMP(A,$J,C,"50.67,.01")=$P(B,"^")
"RTN","NDFRR8",17,0)
 S ^TMP(A,$J,C,"50.67,SEQ")=$P(B,"^")
"RTN","NDFRR8",18,0)
 S:'$D(^TMP(A,$J,C,"50.67,1")) ^TMP(A,$J,C,"50.67,1")=$P(B,"^",2)
"RTN","NDFRR8",19,0)
 S:'$D(^TMP(A,$J,C,"50.67,2")) ^TMP(A,$J,C,"50.67,2")=$P(B,"^",3)
"RTN","NDFRR8",20,0)
 S:'$D(^TMP(A,$J,"50.67,3")) ^TMP(A,$J,"50.67,3")=$P(B,"^",4)
"RTN","NDFRR8",21,0)
 S:'$D(^TMP(A,$J,C,"50.67,3")) ^TMP(A,$J,C,"50.67,3")=$P(B,"^",4)
"RTN","NDFRR8",22,0)
 S:'$D(^TMP(A,$J,"50.67,4")) ^TMP(A,$J,"50.67,4")=$P(B,"^",5)
"RTN","NDFRR8",23,0)
 S:'$D(^TMP(A,$J,C,"50.67,4")) ^TMP(A,$J,C,"50.67,4")=$P(B,"^",5)
"RTN","NDFRR8",24,0)
 S:'$D(^TMP(A,$J,"50.67,5")) ^TMP(A,$J,"50.67,5")=$P(B,"^",6)
"RTN","NDFRR8",25,0)
 S:'$D(^TMP(A,$J,C,"50.67,5")) ^TMP(A,$J,C,"50.67,5")=$P(B,"^",6)
"RTN","NDFRR8",26,0)
 S:'$D(^TMP(A,$J,C,"50.67,8")) ^TMP(A,$J,C,"50.67,8")=$P(B,"^",8)
"RTN","NDFRR8",27,0)
 S:'$D(^TMP(A,$J,C,"50.67,9")) ^TMP(A,$J,C,"50.67,9")=$P(B,"^",9)
"RTN","NDFRR8",28,0)
 S:'$D(^TMP(A,$J,"50.67,10")) ^TMP(A,$J,"50.67,10")=$P(B,"^",10)
"RTN","NDFRR8",29,0)
 S:'$D(^TMP(A,$J,C,"50.67,10")) ^TMP(A,$J,C,"50.67,10")=$P(B,"^",10)
"RTN","NDFRR8",30,0)
 N SEC F SEC=0:0 S SEC=$O(^PSNDF(50.67,NDF1,1,SEC)) Q:'SEC  D
"RTN","NDFRR8",31,0)
 .Q:$D(NDFADMIN)
"RTN","NDFRR8",32,0)
 .S ^TMP("NDFD",$J,"50.676,.01",SEC)=$G(^PSNDF(50.67,NDF1,1,SEC,0))
"RTN","NDFRR8",33,0)
 Q
"RTN","NDFRR8",34,0)
 ;
"RTN","NDFRR8",35,0)
LIST ; build listman screen
"RTN","NDFRR8",36,0)
 K ^TMP("NDFDRSB",$J),NDFPOSS
"RTN","NDFRR8",37,0)
 N A,L,CNT,NDFL S A="NDFDRSB",CNT=1
"RTN","NDFRR8",38,0)
 ;S ^TMP(A,$J,CNT,0)=$$SETSTR^VALM1("10 digit NDC: "_NDFNDC,"",1,70),CNT=CNT+1
"RTN","NDFRR8",39,0)
 S NDFNUM=0,L="" F  S L=$O(^TMP("NDFD",$J,L)) Q:'L!(L="")  D
"RTN","NDFRR8",40,0)
 .Q:L'?1.99N  S NDFNUM=NDFNUM+1  ; count entries
"RTN","NDFRR8",41,0)
 .S NDFPOSS=$S('$D(NDFPOSS):"",1:NDFPOSS)_NDFNUM_"|"
"RTN","NDFRR8",42,0)
 .S NDFL=$$SETSTR^VALM1("("_NDFNUM_") Package Code: "_$S($D(^TMP("NDFD",$J,L,"NDF2DIG")):$G(^TMP("NDFD",$J,L,"NDF2DIG")),1:$E($G(^TMP("NDFD",$J,L,"50.67,1")),$S($D(NDFUPN)!($D(NDFUPNI)):1,1:11),12)),"",1,35)
"RTN","NDFRR8",43,0)
 .S ^TMP(A,$J,CNT,0)=$$SETSTR^VALM1("UPN: "_$G(^TMP("NDFD",$J,L,"50.67,2")),NDFL,36,44),CNT=CNT+1
"RTN","NDFRR8",44,0)
 .S NDFC=$G(^TMP("NDFD",$J,L,"50.67,8")),NDFCC=NDFC'["|NEW"
"RTN","NDFRR8",45,0)
 .S NDFL=$$SETSTR^VALM1("Package Size: "_$S(NDFCC:$P(^PS(50.609,$G(^TMP("NDFD",$J,L,"50.67,8")),0),"^"),1:$P($G(^TMP("NDFD",$J,L,"50.67,8")),"|")),"",5,35)
"RTN","NDFRR8",46,0)
 .S NDFC=$G(^TMP("NDFD",$J,L,"50.67,9")),NDFCC=NDFC?1.9N
"RTN","NDFRR8",47,0)
 .S ^TMP(A,$J,CNT,0)=$$SETSTR^VALM1("Package Type: "_$S(NDFCC:$P(^PS(50.608,$G(^TMP("NDFD",$J,L,"50.67,9")),0),"^"),1:$G(^TMP("NDFD",$J,L,"50.67,9"))),NDFL,36,44),CNT=CNT+1 ;,^TMP(A,$J,CNT,0)=" ",CNT=CNT+1
"RTN","NDFRR8",48,0)
 .S:'$D(^TMP("NDFD",$J,L,"50.67,5")) ^TMP("NDFD",$J,L,"50.67,5")=$G(^TMP("NDFD",$J,"50.67,5"))
"RTN","NDFRR8",49,0)
 .S ^TMP(A,$J,CNT,0)=$$SETSTR^VALM1("VA Product Name: "_$P(^PSNDF(50.68,$G(^TMP("NDFD",$J,L,"50.67,5")),0),"^"),"",5,79),CNT=CNT+1
"RTN","NDFRR8",50,0)
 .S ^TMP(A,$J,CNT,0)=" ",CNT=CNT+1
"RTN","NDFRR8",51,0)
 S NDFC=$G(^TMP("NDFD",$J,"50.67,3")),NDFCC=NDFC?1.9N
"RTN","NDFRR8",52,0)
 S NDFL=$$SETSTR^VALM1("("_(NDFNUM+1)_") Manufacturer: "_$S(NDFCC:$P(^PS(55.95,$G(^TMP("NDFD",$J,"50.67,3")),0),"^"),1:$P($G(^TMP("NDFD",$J,"50.67,3")),"^")),"",1,40)
"RTN","NDFRR8",53,0)
 S ^TMP(A,$J,CNT,0)=$$SETSTR^VALM1("("_(NDFNUM+2)_") Trade Name: "_$G(^TMP("NDFD",$J,"50.67,4")),NDFL,41,39),CNT=CNT+1
"RTN","NDFRR8",54,0)
 S ^TMP(A,$J,CNT,0)=$$SETSTR^VALM1("("_(NDFNUM+3)_") OTC/Rx Indicator: "_$$EXTERNAL^DILFD(50.67,10,"",$G(^TMP("NDFD",$J,"50.67,10"))),"",1,40),CNT=CNT+1
"RTN","NDFRR8",55,0)
 S ^TMP(A,$J,CNT,0)=$$SETSTR^VALM1("("_(NDFNUM+4)_") Route of Administration:","",1,40),CNT=CNT+1
"RTN","NDFRR8",56,0)
 N SEC F SEC=0:0 S SEC=$O(^TMP("NDFD",$J,"50.676,.01",SEC)) Q:'SEC  D
"RTN","NDFRR8",57,0)
 .;S ^TMP(A,$J,CNT,0)=$$SETSTR^VALM1($P($G(^PS(51.2,^TMP("NDFD",$J,"50.676,.01",SEC),0)),"^"),"",6,40),CNT=CNT+1
"RTN","NDFRR8",58,0)
 .S ^TMP(A,$J,CNT,0)=$$SETSTR^VALM1(^TMP("NDFD",$J,"50.676,.01",SEC),"",6,40),CNT=CNT+1
"RTN","NDFRR8",59,0)
 ;S ^TMP(A,$J,CNT,0)=$$SETSTR^VALM1("("_(NDFNUM+5)_") VA Product Name: "_$P(^PSNDF(50.68,$G(^TMP("NDFD",$J,"50.67,5")),0),"^"),"",1,70)
"RTN","NDFRR8",60,0)
 I $G(^TMP("NDFD",$J,"50.67,5")) S NDFVAPD=$P(^PSNDF(50.68,$G(^TMP("NDFD",$J,"50.67,5")),0),"^")
"RTN","NDFRR8",61,0)
 ;
"RTN","NDFRR8",62,0)
 S VALMCNT=CNT
"RTN","NDFRR8",63,0)
 Q
"RTN","NDFRR8",64,0)
ACCEPT ;
"RTN","NDFRR8",65,0)
 Q
"RTN","NDFRR8",66,0)
 ;
"RTN","NDFRR8",67,0)
EDIT ;
"RTN","NDFRR8",68,0)
 S VALMBCK="R"
"RTN","NDFRR8",69,0)
EFA ;
"RTN","NDFRR8",70,0)
 K Y,NDFANS S Y="" R !!,"Select FIELDS TO EDIT: ",X:DTIME E  W $C(7) S X="^" Q
"RTN","NDFRR8",71,0)
 I "^"[X Q
"RTN","NDFRR8",72,0)
 I X="??" D FULL^VALM1,H2 G EFA
"RTN","NDFRR8",73,0)
 I X?1."?" D FULL^VALM1,H2 G EFA
"RTN","NDFRR8",74,0)
 I  G FDONE
"RTN","NDFRR8",75,0)
 I X'=+X!(X>(NDFNUM+4))!(X<1) W "   ??" H .4 G EFA
"RTN","NDFRR8",76,0)
 S:$E(X)="-" X=+PSGEFN_X S:$E($L(X))="-" X=X_$P(PSGEFN,":",2)
"RTN","NDFRR8",77,0)
 F Q=1:1:$L(X,",") S X1=$P(X,",",Q) D FS Q:'$D(X)
"RTN","NDFRR8",78,0)
 I '$D(X) W $C(7),"  ??" G EFA
"RTN","NDFRR8",79,0)
 ;
"RTN","NDFRR8",80,0)
FDONE ;
"RTN","NDFRR8",81,0)
 I '$D(Y) W $C(7)," ??" G EFA
"RTN","NDFRR8",82,0)
 S:Y Y=$E(Y,1,$L(Y)-1)
"RTN","NDFRR8",83,0)
 D EDIT1
"RTN","NDFRR8",84,0)
 K NDFPOSS D HDR^NDFRR8
"RTN","NDFRR8",85,0)
 Q
"RTN","NDFRR8",86,0)
FS ;
"RTN","NDFRR8",87,0)
 I $S(X1?1.N1"-"1.N:0,X1'?1.N:1,1:","_Y[X1) K X Q
"RTN","NDFRR8",88,0)
 I X1'["-" S Y=Y_X1_"," Q
"RTN","NDFRR8",89,0)
 S X2=+X1,Y=Y_X2_"," F  S X2=$O(PSGEFN(X2)) K:$S(X="":1,","_Y[X2:1,1:X2>$P(X1,"-",2)) Y Q:'$D(Y)  S Y=Y_X2_"," Q:X2=$P(X1,"-",2)
"RTN","NDFRR8",90,0)
 Q
"RTN","NDFRR8",91,0)
 ;
"RTN","NDFRR8",92,0)
H2 ;
"RTN","NDFRR8",93,0)
 W !,"Enter the field to edit (1-"_(NDFNUM+4)_")" Q
"RTN","NDFRR8",94,0)
 N X S X="field" W !!?2,"Select ",X,"s either singularly separated by commas"
"RTN","NDFRR8",95,0)
 Q
"RTN","NDFRR8",96,0)
EDIT1 ;
"RTN","NDFRR8",97,0)
 D FULL^VALM1
"RTN","NDFRR8",98,0)
 W ! N X F Q=1:1 S Q1=$P(Y,",",Q) Q:'Q1  D
"RTN","NDFRR8",99,0)
 .I Q1'>NDFNUM&(NDFPOSS'[Q1) W "   ",Q1," is not a choice!" H .5 Q
"RTN","NDFRR8",100,0)
 .S NDFANS=Q1
"RTN","NDFRR8",101,0)
 .I Q1'>NDFNUM S Q1=1
"RTN","NDFRR8",102,0)
 .E  S Q1=Q1-(NDFNUM-1)
"RTN","NDFRR8",103,0)
 .S X=$P($T(@(Q1)),";;",2) D @X
"RTN","NDFRR8",104,0)
 Q
"RTN","NDFRR8",105,0)
 ;
"RTN","NDFRR8",106,0)
HDR ;
"RTN","NDFRR8",107,0)
 I $D(^TMP("NDFD",$J,"NDFDIG")) S VALMHDR(1)=$$SETSTR^VALM1(" NDC: "_$G(^TMP("NDFD",$J,"NDFDIG")),"",3,77) Q
"RTN","NDFRR8",108,0)
 I $D(NDFNDC) S VALMHDR(1)=$$SETSTR^VALM1(" NDC: "_$G(NDFNDC),"",3,77) Q
"RTN","NDFRR8",109,0)
 I $D(NDFUPN) S VALMHDR(1)=$$SETSTR^VALM1(" UPN: "_NDFUPN,"",3,77) Q
"RTN","NDFRR8",110,0)
 I $D(NDFUPNI) S VALMHDR(1)=$$SETSTR^VALM1(" UPN: "_$G(^TMP("NDFD",$J,1,"50.67,2")),"",3,77)
"RTN","NDFRR8",111,0)
 Q
"RTN","NDFRR8",112,0)
 ;
"RTN","NDFRR8",113,0)
BUILD2() ; 
"RTN","NDFRR8",114,0)
 ; find 12 digit NDC's that contain the 10 digit NDC
"RTN","NDFRR8",115,0)
 N NDFL,NDFX,NDF1,NDCNT S NDCNT=0
"RTN","NDFRR8",116,0)
 I $D(NDFNDC) S NDFL=NDFNDC,NDFX=NDFL_"00" I $D(^PSNDF(50.67,"NDC",NDFX)) Q 1 ; gets one entry of "00"
"RTN","NDFRR8",117,0)
 I $D(NDFNDC) S NDFL=NDFNDC,NDFX=NDFL_"00" F  S NDFX=$O(^PSNDF(50.67,"NDC",NDFX)) Q:NDFX=""!($E(NDFX,1,10)'=NDFL)  D
"RTN","NDFRR8",118,0)
 .S NDCNT=NDCNT+1
"RTN","NDFRR8",119,0)
 Q $S(NDCNT=0:0,NDCNT>0:1)
"RTN","NDFRR8",120,0)
 ;
"RTN","NDFRR8",121,0)
CMOP() ;
"RTN","NDFRR8",122,0)
 I +Y=1&('$L(^TMP("NDFR",$J,"50.68,5"))!('$L(^TMP("NDFR",$J,"50.68,8")))!('$L(^TMP("NDFR",$J,"50.68,6")))) W !,"VA Print name, Dispense unit, and Product Identifier must be defined to mark for CMOP." H 1
"RTN","NDFRR8",123,0)
 Q $T
"RTN","NDFRR8",124,0)
 ;
"RTN","NDFRR8",125,0)
FIELDS ;
"RTN","NDFRR8",126,0)
1 ;;E^NDFRR10
"RTN","NDFRR8",127,0)
2 ;;6^NDFRR7
"RTN","NDFRR8",128,0)
3 ;;8^NDFRR7
"RTN","NDFRR8",129,0)
4 ;;5^NDFRR7
"RTN","NDFRR8",130,0)
5 ;;ADMIN^NDFRR9
"RTN","NDFRR8",131,0)
6 ;;1^NDFRR2
"RTN","NDFRR9")
0^48^B51231892
"RTN","NDFRR9",1,0)
NDFRR9 ;BIR/RSB-ACCEPT NDC CHANGE ; 06/03/03 15:08
"RTN","NDFRR9",2,0)
 ;;4.0; NDF MANAGEMENT;**62**; 1 Jan 99;Build 1
"RTN","NDFRR9",3,0)
 ;
"RTN","NDFRR9",4,0)
 ;
"RTN","NDFRR9",5,0)
ACCEPT ;
"RTN","NDFRR9",6,0)
 W !," Updating NDF files...."
"RTN","NDFRR9",7,0)
 N NDFLL,NDFNUM,FIELD
"RTN","NDFRR9",8,0)
 S NDFLL="" F  S NDFLL=$O(^TMP("NDFD",$J,NDFLL)) Q:'NDFLL!(NDFLL="")  D
"RTN","NDFRR9",9,0)
 .Q:NDFLL'?1.99N  S NDFNUM=$S('$D(NDFNUM):1,1:NDFNUM+1)  ; count entries
"RTN","NDFRR9",10,0)
 .K NDFIEN
"RTN","NDFRR9",11,0)
 .I $D(^TMP("NDFD",$J,NDFLL,"50.67,SEQ")) S NDFIEN=$G(^TMP("NDFD",$J,NDFLL,"50.67,SEQ"))
"RTN","NDFRR9",12,0)
 .E  D  ;add new entry to 50.67
"RTN","NDFRR9",13,0)
 ..; check to find ien by UPN number so it doesn't add again.
"RTN","NDFRR9",14,0)
 ..I $D(^TMP("NDFD",$J,NDFLL,"50.67,2")) S NDFIEN=$O(^PSNDF(50.67,"UPN",$G(^TMP("NDFD",$J,NDFLL,"50.67,2")),0))
"RTN","NDFRR9",15,0)
 ..I $G(NDFIEN)'>0 S (NDFIEN,DINUM,X)=$O(^PSNDF(50.67," "),-1)+1 D
"RTN","NDFRR9",16,0)
 ...S DIC(0)="",DIC="^PSNDF(50.67," K DD D FILE^DICN
"RTN","NDFRR9",17,0)
 ...S ^TMP("NDFD",$J,NDFLL,"50.67,SEQ")=+Y
"RTN","NDFRR9",18,0)
 .D STUFF2,STUFF,STUFF1,STUFF3,STUFF4,STUFF5,STUFF6
"RTN","NDFRR9",19,0)
 S VALMBCK="B"
"RTN","NDFRR9",20,0)
 W "  ..done" H .5 Q
"RTN","NDFRR9",21,0)
 ;
"RTN","NDFRR9",22,0)
 ;
"RTN","NDFRR9",23,0)
STUFF2 ;  stuff NDC and UPN fields
"RTN","NDFRR9",24,0)
 I $D(^TMP("NDFD",$J,NDFLL,"50.67,2")) S DR="2////"_$G(^TMP("NDFD",$J,NDFLL,"50.67,2"))_";"
"RTN","NDFRR9",25,0)
 I $D(NDFNDC)!$D(^TMP("NDFD",$J,NDFLL,"50.67,1")) D
"RTN","NDFRR9",26,0)
 .S DR=$G(DR)_"1////"_$S($D(^TMP("NDFD",$J,NDFLL,"50.67,1")):$G(^TMP("NDFD",$J,NDFLL,"50.67,1")),1:$G(^TMP("NDFD",$J,"NDFDIG"))_$G(^TMP("NDFD",$J,NDFLL,"NDF2DIG")))
"RTN","NDFRR9",27,0)
 D DIE
"RTN","NDFRR9",28,0)
 Q
"RTN","NDFRR9",29,0)
STUFF ; STUFF SINGLE FIELDS THAT DON'T DLAYGO
"RTN","NDFRR9",30,0)
 N FIELD S DR=""
"RTN","NDFRR9",31,0)
 F FIELD=4,10 D
"RTN","NDFRR9",32,0)
 .S NFIELD="50.67,"_FIELD D
"RTN","NDFRR9",33,0)
 ..I $G(^TMP("NDFD",$J,NFIELD))="" S DR=DR_FIELD_"////"_"@;"
"RTN","NDFRR9",34,0)
 ..I $G(^TMP("NDFD",$J,NFIELD))'="" D
"RTN","NDFRR9",35,0)
 ...S DR=DR_FIELD_"////"_$S(FIELD=".01":$P($G(^TMP("NDFD",$J,NFIELD)),"^",2),1:$G(^TMP("NDFD",$J,NFIELD)))_";"
"RTN","NDFRR9",36,0)
 D DIE
"RTN","NDFRR9",37,0)
 Q
"RTN","NDFRR9",38,0)
 ;
"RTN","NDFRR9",39,0)
STUFF1  ; Clear and stuff ROUTE OF ADMINISTRATION entries
"RTN","NDFRR9",40,0)
 N NDF1 F NDF1=0:0 S NDF1=$O(^PSNDF(50.67,NDFIEN,1,NDF1)) Q:'NDF1  D
"RTN","NDFRR9",41,0)
 .S DA(1)=NDFIEN,DA=NDF1,DIE="^PSNDF(50.67,"_NDFIEN_",1,",DR=".01///"_"@" D ^DIE K DIE,DR,DR
"RTN","NDFRR9",42,0)
 F NDF1=0:0 S NDF1=$O(^TMP("NDFD",$J,"50.676,.01",NDF1)) Q:'NDF1  D
"RTN","NDFRR9",43,0)
 .;S DA(1)=NDFIEN,DA=NDF1,DIE="^PSNDF(50.67,"_NDFIEN_",1,",DR=".01////"_$G(^TMP("NDFD",$J,"50.676,.01",NDF1)) D ^DIE K DIE,DR,DR
"RTN","NDFRR9",44,0)
 .K DD S DIC="^PSNDF(50.67,"_NDFIEN_",1,",DIC(0)="L",DIC("P")="50.676A",DA(1)=NDFIEN,X=$G(^TMP("NDFD",$J,"50.676,.01",NDF1)) D FILE^DICN
"RTN","NDFRR9",45,0)
 Q
"RTN","NDFRR9",46,0)
 ;
"RTN","NDFRR9",47,0)
STUFF3  ; stuff and add MANUFACTURER
"RTN","NDFRR9",48,0)
 N NDFC,NDFCC,NDFG,NEW S NDFC=$P($G(^TMP("NDFD",$J,"50.67,3")),"^")
"RTN","NDFRR9",49,0)
 S NDFCC=(NDFC?1.9N)
"RTN","NDFRR9",50,0)
 I NDFCC D
"RTN","NDFRR9",51,0)
 .S DA=NDFIEN,DIE="^PSNDF(50.67,",DR="3////"_$G(^TMP("NDFD",$J,"50.67,3")) D ^DIE K DIE,DR,DR
"RTN","NDFRR9",52,0)
 I 'NDFCC D
"RTN","NDFRR9",53,0)
 .K DIC S X=NDFC,DIC=55.95,DIC(0)="EMZ" D ^DIC K DIC I Y<0 D
"RTN","NDFRR9",54,0)
 ..K DD S DIC="^PS(55.95,",DIC(0)="",X=NDFC D FILE^DICN
"RTN","NDFRR9",55,0)
 ..I Y>0 S (NEW,DA)=+Y,DIE="^PS(55.95,",DR="1////"_$P($G(^TMP("NDFD",$J,"50.67,3")),"^",2) D ^DIE K DIE,DR,DR
"RTN","NDFRR9",56,0)
 .S NDFG=$S($G(Y):Y,1:NEW) S DA=NDFIEN,DIE="^PSNDF(50.67,",DR="3////"_+NDFG D ^DIE K DIE,DR,DR
"RTN","NDFRR9",57,0)
 Q
"RTN","NDFRR9",58,0)
STUFF4   ; stuff and add PACKAGE SIZE
"RTN","NDFRR9",59,0)
 N NDFC,NDFCC,NDFG S NDFC=$G(^TMP("NDFD",$J,NDFLL,"50.67,8"))
"RTN","NDFRR9",60,0)
 S NDFCC=NDFC'["|NEW"
"RTN","NDFRR9",61,0)
 I NDFCC D
"RTN","NDFRR9",62,0)
 .S DA=NDFIEN,DIE="^PSNDF(50.67,",DR="8////"_$G(^TMP("NDFD",$J,NDFLL,"50.67,8")) D ^DIE K DIE,DR,DR
"RTN","NDFRR9",63,0)
 I 'NDFCC D
"RTN","NDFRR9",64,0)
 .K DIC S X=$P(NDFC,"|"),DIC=50.609,DIC(0)="EMZ" D ^DIC K DIC I Y<0 D
"RTN","NDFRR9",65,0)
 ..K DD S DIC="^PS(50.609,",DIC(0)="",X=$P(NDFC,"|") D FILE^DICN
"RTN","NDFRR9",66,0)
 .S NDFG=Y S DA=NDFIEN,DIE="^PSNDF(50.67,",DR="8////"_+NDFG D ^DIE K DIE,DR,DR
"RTN","NDFRR9",67,0)
 Q
"RTN","NDFRR9",68,0)
 ;
"RTN","NDFRR9",69,0)
STUFF5    ; stuff and add PACKAGE TYPE
"RTN","NDFRR9",70,0)
 N NDFC,NDFCC,NDFG S NDFC=$G(^TMP("NDFD",$J,NDFLL,"50.67,9"))
"RTN","NDFRR9",71,0)
 S NDFCC=(NDFC?1.9N)
"RTN","NDFRR9",72,0)
 I NDFCC D
"RTN","NDFRR9",73,0)
 .S DA=NDFIEN,DIE="^PSNDF(50.67,",DR="9////"_$G(^TMP("NDFD",$J,NDFLL,"50.67,9")) D ^DIE K DIE,DR,DR
"RTN","NDFRR9",74,0)
 I 'NDFCC D
"RTN","NDFRR9",75,0)
 .K DIC S X=NDFC,DIC=50.608,DIC(0)="EMZ" D ^DIC K DIC I Y<0 D
"RTN","NDFRR9",76,0)
 ..K DD S DIC="^PS(50.608,",DIC(0)="",X=NDFC D FILE^DICN
"RTN","NDFRR9",77,0)
 .S NDFG=Y S DA=NDFIEN,DIE="^PSNDF(50.67,",DR="9////"_+NDFG D ^DIE K DIE,DR,DR
"RTN","NDFRR9",78,0)
 Q
"RTN","NDFRR9",79,0)
 ;
"RTN","NDFRR9",80,0)
STUFF6 ; stuff VA product name
"RTN","NDFRR9",81,0)
 I $D(^TMP("NDFD",$J,NDFLL,"50.67,5")) S DR="5////"_$G(^TMP("NDFD",$J,NDFLL,"50.67,5"))
"RTN","NDFRR9",82,0)
 D DIE
"RTN","NDFRR9",83,0)
 Q
"RTN","NDFRR9",84,0)
DIE ;
"RTN","NDFRR9",85,0)
 S DA=NDFIEN,DIE="^PSNDF(50.67," D ^DIE K DIE,DR
"RTN","NDFRR9",86,0)
 Q
"RTN","NDFRR9",87,0)
 ;
"RTN","NDFRR9",88,0)
UPN ; ENTER NEW UPN
"RTN","NDFRR9",89,0)
 S (NDFM,X)=$$GET^NDFRR1(50.67,2,$S($D(^TMP("NDFD",$J,NDFANS,"50.67,2")):^TMP("NDFD",$J,NDFANS,"50.67,2"),1:""),0,"UPN")
"RTN","NDFRR9",90,0)
 I $D(NDFABORT)&($D(NDFEDIT2)) Q
"RTN","NDFRR9",91,0)
 ;I NDFM=""&('$D(NDFEDIT2)) G 8
"RTN","NDFRR9",92,0)
 ;I NDFM=""&($D(NDFEDIT2)) Q       
"RTN","NDFRR9",93,0)
 I NDFM="" Q
"RTN","NDFRR9",94,0)
 I NDFM="@" S ^TMP("NDFD",$J,NDFANS,"50.67,2")="" W "   (Deleted)"
"RTN","NDFRR9",95,0)
 I $D(^PSNDF(50.67,"UPN",X))&(X'=$G(^TMP("NDFD",$J,NDFANS,"50.67,2"))) W !,"Duplicate UPN" G UPN
"RTN","NDFRR9",96,0)
 I '$$CK^NDFRR1(50.67,2,NDFM) D HLP^NDFRR1(50.67,2) G UPN
"RTN","NDFRR9",97,0)
 I $$CK^NDFRR1(50.67,2,NDFM) S ^TMP("NDFD",$J,NDFANS,"50.67,2")=NDFM
"RTN","NDFRR9",98,0)
 Q
"RTN","NDFRR9",99,0)
 ;
"RTN","NDFRR9",100,0)
2 ; get Package Size
"RTN","NDFRR9",101,0)
 ; prompt for UPN if NDC was entered
"RTN","NDFRR9",102,0)
 I ($D(NDFNDC)&('$D(NDFUPN)))!($D(NDFUPNI)) D UPN
"RTN","NDFRR9",103,0)
 ;
"RTN","NDFRR9",104,0)
 N NDFY
"RTN","NDFRR9",105,0)
 S NDFC=$G(^TMP("NDFD",$J,NDFANS,"50.67,8")),NDFCC=NDFC'["|NEW"
"RTN","NDFRR9",106,0)
 S (NDFM,X)=$$GET^NDFRR1(50.609,.01,$S(NDFCC:$S($D(^TMP("NDFD",$J,NDFANS,"50.67,8")):$P(^PS(50.609,^TMP("NDFD",$J,NDFANS,"50.67,8"),0),"^"),1:""),1:$P(NDFC,"|")),1,"Package Size") K NDFC,NDFCC
"RTN","NDFRR9",107,0)
 I $D(NDFABORT)&($D(NDFEDIT2)) Q
"RTN","NDFRR9",108,0)
 I NDFM="" Q
"RTN","NDFRR9",109,0)
 K DIC S DIC=50.609,DIC(0)="EMZ" D ^DIC
"RTN","NDFRR9",110,0)
 I Y=-1 I '$$CK^NDFRR1(50.609,.01,NDFM) D HLP^NDFRR1(50.609,.01) G 2
"RTN","NDFRR9",111,0)
 I Y=-1 S NDFY=$$ADD^NDFRR1(NDFM,"PACKAGE SIZE") I NDFY S ^TMP("NDFD",$J,NDFANS,"50.67,8")=NDFM_"|NEW"
"RTN","NDFRR9",112,0)
 I $G(NDFY)=0 G 2
"RTN","NDFRR9",113,0)
 I Y=-1&('$G(NDFY)) G 2
"RTN","NDFRR9",114,0)
 I +Y>0 S NDFM=$S(Y["^":+Y,1:Y) S ^TMP("NDFD",$J,NDFANS,"50.67,8")=NDFM
"RTN","NDFRR9",115,0)
 ;
"RTN","NDFRR9",116,0)
 ;
"RTN","NDFRR9",117,0)
3 ; get Package Type
"RTN","NDFRR9",118,0)
 N NDFY
"RTN","NDFRR9",119,0)
 S NDFC=$G(^TMP("NDFD",$J,NDFANS,"50.67,9")),NDFCC=(NDFC?1.9N)
"RTN","NDFRR9",120,0)
 S (NDFM,X)=$$GET^NDFRR1(50.608,.01,$S(NDFCC:$S($D(^TMP("NDFD",$J,NDFANS,"50.67,9")):$P(^PS(50.608,^TMP("NDFD",$J,NDFANS,"50.67,9"),0),"^"),1:""),1:NDFC),1,"Package Type") K NDFC,NDFCC
"RTN","NDFRR9",121,0)
 I $D(NDFABORT)&($D(NDFEDIT2)) Q
"RTN","NDFRR9",122,0)
 I NDFM="" Q
"RTN","NDFRR9",123,0)
 K DIC S DIC=50.608,DIC(0)="EMZ" D ^DIC
"RTN","NDFRR9",124,0)
 I Y=-1 I '$$CK^NDFRR1(50.608,.01,NDFM) D HLP^NDFRR1(50.608,.01) G 3
"RTN","NDFRR9",125,0)
 I Y=-1 S NDFY=$$ADD^NDFRR1(NDFM,"PACKAGE TYPE") I NDFY S ^TMP("NDFD",$J,NDFANS,"50.67,9")=NDFM
"RTN","NDFRR9",126,0)
 I $G(NDFY)=0 G 3
"RTN","NDFRR9",127,0)
 I Y=-1&('$G(NDFY)) G 3
"RTN","NDFRR9",128,0)
 I +Y>0 S NDFM=$S(Y["^":+Y,1:Y) S ^TMP("NDFD",$J,NDFANS,"50.67,9")=NDFM
"RTN","NDFRR9",129,0)
 ;
"RTN","NDFRR9",130,0)
 ; edit VA product
"RTN","NDFRR9",131,0)
 D 1^NDFRR2 S ^TMP("NDFD",$J,NDFANS,"50.67,5")=$G(^TMP("NDFD",$J,"50.67,5"))
"RTN","NDFRR9",132,0)
NDC1 ;
"RTN","NDFRR9",133,0)
 Q:('$D(NDFUPN)&('$D(NDFUPNI)))
"RTN","NDFRR9",134,0)
 K DIR S DIR(0)="FO",DIR("A")="Enter the 12 character NDC"
"RTN","NDFRR9",135,0)
 S DIR("?")="Enter the 12 digit NDC number."
"RTN","NDFRR9",136,0)
 I $D(^TMP("NDFD",$J,NDFANS,"50.67,1")) S DIR("B")=$G(^TMP("NDFD",$J,NDFANS,"50.67,1"))
"RTN","NDFRR9",137,0)
 D ^DIR K DIR Q:Y<0
"RTN","NDFRR9",138,0)
 I $D(DTOUT)!($D(DUOUT)) Q
"RTN","NDFRR9",139,0)
 I X="" Q
"RTN","NDFRR9",140,0)
 I X'?1.12N!($L(X)>12)!($L(X)<12) W !,"Answer must be a 12 digit number." G NDC1 Q
"RTN","NDFRR9",141,0)
 I $D(^PSNDF(50.67,"NDC",X))&(X'=$G(^TMP("NDFD",$J,NDFANS,"50.67,1"))) W !,"Duplicate 12 digit NDC" G NDC1
"RTN","NDFRR9",142,0)
 S ^TMP("NDFD",$J,NDFANS,"50.67,1")=X
"RTN","NDFRR9",143,0)
 ;
"RTN","NDFRR9",144,0)
 Q
"RTN","NDFRR9",145,0)
ADMIN   ;
"RTN","NDFRR9",146,0)
 D FULL^VALM1 S NDFADMIN=1
"RTN","NDFRR9",147,0)
 N FIRST,LIST,LAST S LIST="",FIRST=0,LAST=0 W !
"RTN","NDFRR9",148,0)
 N X,TOT S TOT=0 F X=0:0 S X=$O(^TMP("NDFD",$J,"50.676,.01",X)) Q:'X  D
"RTN","NDFRR9",149,0)
 .S TOT=TOT+1 S:FIRST=0 FIRST=X S:LAST<X LAST=X
"RTN","NDFRR9",150,0)
 .;W !,"("_X_") ",$P(^PS(51.2,+^TMP("NDFD",$J,"50.676,.01",X),0),"^")
"RTN","NDFRR9",151,0)
 .W !,"("_X_") ",^TMP("NDFD",$J,"50.676,.01",X)
"RTN","NDFRR9",152,0)
 W ! K DIR S DIR("A")="Do you wish to Add or Delete entries?",DIR(0)="SBOM^A:Add new entries;D:Delete entries" D ^DIR
"RTN","NDFRR9",153,0)
 I $D(DTOUT)!($D(DUOUT)) Q
"RTN","NDFRR9",154,0)
 I Y="A" D ADMINA G ADMIN
"RTN","NDFRR9",155,0)
 I Y="D" D ADMIND,ADJUST^NDFRR2A("NDFD","50.676,.01") G ADMIN
"RTN","NDFRR9",156,0)
 Q
"RTN","NDFRR9",157,0)
 ;
"RTN","NDFRR9",158,0)
ADMINA S (NDFM,X)=$$GET^NDFRR1(51.2,.01,"",0,"Route of Administration")
"RTN","NDFRR9",159,0)
 I NDFM="" Q
"RTN","NDFRR9",160,0)
 K DIC S DIC=51.2,DIC(0)="EMZ" D ^DIC
"RTN","NDFRR9",161,0)
 I Y=-1 D  G ADMIN
"RTN","NDFRR9",162,0)
 .I '$$CK^NDFRR1(51.2,.01,NDFM) D HLP^NDFRR1(51.2,.01)
"RTN","NDFRR9",163,0)
 S NDFM=Y(0,0) S ^TMP("NDFD",$J,"50.676,.01",TOT+1)=NDFM,TOT=TOT+1
"RTN","NDFRR9",164,0)
 G ADMINA
"RTN","NDFRR9",165,0)
ADMIND ;
"RTN","NDFRR9",166,0)
 K DIR S DIR(0)="NO^"_FIRST_":"_LAST,DIR("A")="Delete entry" D ^DIR
"RTN","NDFRR9",167,0)
 I Y=-1 Q
"RTN","NDFRR9",168,0)
 I $D(DTOUT)!($D(DUOUT)) Q
"RTN","NDFRR9",169,0)
 K ^TMP("NDFD",$J,"50.676,.01",Y) W "  (Deleted)" H .5
"RTN","NDFRR9",170,0)
 Q
"RTN","NDFRR998")
0^49^B10432815
"RTN","NDFRR998",1,0)
NDFRR998 ;BIRM/WRT - Auto matching (mapping) between file #50.67,50.68 and file #50.628 (FDB file).; 06/03/03 15:12
"RTN","NDFRR998",2,0)
 ;;4.0; NDF MANAGEMENT;**62**; 1 Jan 99;Build 1
"RTN","NDFRR998",3,0)
START ; Ask if want to do auto-match within NDF Management
"RTN","NDFRR998",4,0)
 W ! S DIR("A")="Do you want to attempt an auto-match? "
"RTN","NDFRR998",5,0)
 S DIR(0)="YA" D ^DIR K DIR I $D(DTOUT)!$D(DUOUT) W "  No Auto-Match Attempted" H 1.75 S ASKHIM=0 Q
"RTN","NDFRR998",6,0)
 I Y=0 S ASKHIM=Y Q
"RTN","NDFRR998",7,0)
 S ASKHIM=Y W !!,"Attempting a match...",!
"RTN","NDFRR998",8,0)
 D AUTONDFM W:'$G(AUTO) "  No Matches Found." H 1.75
"RTN","NDFRR998",9,0)
 ; K IFN,IEN,REC,GCN,PREVGCN,NDCLINK,VAP,GCNO,DAT,DAT1,NDC,NDC1,SEQNO
"RTN","NDFRR998",10,0)
 Q
"RTN","NDFRR998",11,0)
AUTONDFM ;
"RTN","NDFRR998",12,0)
 S IEN=$S($D(NDFNAME):$P(NDFNAME,"^"),1:"") I IEN S DAT=$P($G(^PS(50.68,IEN,7)),"^",3) I 'DAT!(DAT>DT) D NUPN
"RTN","NDFRR998",13,0)
 Q
"RTN","NDFRR998",14,0)
NUPN S FLAGIT=0,IFN=0 F  S IFN=$O(^PSNDF(50.68,"ANDC",IEN,IFN)) Q:'IFN  S DAT1=$P($G(^PSNDF(50.67,IFN,0)),"^",7) I 'DAT1!(DAT1>DT) S NDC=$P(^PSNDF(50.67,IFN,0),"^",2),NDC1=$E(NDC,2,12) D FDB
"RTN","NDFRR998",15,0)
 Q
"RTN","NDFRR998",16,0)
FDB Q:FLAGIT  I $D(^PS(50.628,"B",NDC1)) S REC=$O(^PS(50.628,"B",NDC1,0)),AMATCH=NDC,ASEQNO=$P(^PS(50.628,REC,0),"^",2),ANODE=^PS(50.628,REC,0),OGCN=$P($G(^PSNDF(50.68,IEN,1)),"^",6) D STUFF Q:FLAGIT
"RTN","NDFRR998",17,0)
 Q
"RTN","NDFRR998",18,0)
STUFF Q:FLAGIT  S ADESC=ASEQNO_" "_$P(ANODE,"^",3)_" "_$P(ANODE,"^",4)_" "_$P(ANODE,"^",5),AUTO=ASEQNO_"^"_REC_"^"_ADESC_"^"_AMATCH_"^"_OGCN S FLAGIT=1 Q
"RTN","NDFRR998",19,0)
 Q
"RTN","NDFRR998",20,0)
SHOW K ^TMP("NDFD",$J,"FDBLINK"),BILLWILL D SHOWEM,SHOWEM1
"RTN","NDFRR998",21,0)
 Q
"RTN","NDFRR998",22,0)
SHOWEM ; Come from new added NDCs
"RTN","NDFRR998",23,0)
 I $G(^TMP("NDFD",$J,"NDFDIG")) S BILL=$P($G(^TMP("NDFD",$J,"NDFDIG")),"^") S NUM=0 F  S NUM=$O(^TMP("NDFD",$J,NUM)) Q:'NUM  S WILL=$P($G(^TMP("NDFD",$J,NUM,"NDF2DIG")),"^") S BILLWILL=BILL_WILL,BILLWILL=$E(BILLWILL,2,12) D SHOWDON
"RTN","NDFRR998",24,0)
 Q
"RTN","NDFRR998",25,0)
SHOWDON I $D(^PS(50.628,"B",BILLWILL)) S ITT=1 S RECRD=$O(^PS(50.628,"B",BILLWILL,0)) S FDB=^PS(50.628,RECRD,0) S ^TMP("NDFD",$J,"FDBLINK")=$P(FDB,"^")_" "_$P(FDB,"^",2)_" "_$P(FDB,"^",3)_" "_$P(FDB,"^",4)_" "_$P(FDB,"^",5)
"RTN","NDFRR998",26,0)
 Q
"RTN","NDFRR998",27,0)
SHOWEM1 I $G(^TMP("NDFD",$J)),'$G(^TMP("NDFD",$J,"NDFDIG")) S ITT=0,PPP=0 F  S PPP=$O(^TMP("NDFD",$J,PPP)) Q:PPP[","  S BILLWILL=$P($G(^TMP("NDFD",$J,PPP,"50.67,1")),"^"),BILLWILL=$E(BILLWILL,2,12) D SHOWDON Q:ITT
"RTN","NDFRR998",28,0)
 Q
"RTN","NDFRRDP")
0^50^B2302396
"RTN","NDFRRDP",1,0)
NDFRRDP ;BIR/WRT-Output Transform Routine Used By NDF Manager To Do Mapping Of PMIs ; 16 Feb 2010  10:18 AM
"RTN","NDFRRDP",2,0)
 ;;4.0; NDF MANAGEMENT;**62**; 30 Oct 98;Build 1
"RTN","NDFRRDP",3,0)
 ; K GCN,WRT,SEQNO,FDBGCN
"RTN","NDFRRDP",4,0)
 S GCN=$P($G(^PSNDF(50.68,+Y,1)),"^",5) I GCN,$D(^PS(50.628)) S OLDGCN=GCN D DISPLAY
"RTN","NDFRRDP",5,0)
 S:'$D(FDBGCN) FDBGCN=""
"RTN","NDFRRDP",6,0)
 Q
"RTN","NDFRRDP",7,0)
DISPLAY S WRT=$O(^PS(50.628,"C",GCN,0)) I WRT]"" S SEQNO=$P(^PS(50.628,WRT,0),"^",2)_" "_$P(^PS(50.628,WRT,0),"^",3)_" "_$P(^PS(50.628,WRT,0),"^",4)_" "_$P(^PS(50.628,WRT,0),"^",5),FDBGCN=GCN_"^"_WRT_"^"_SEQNO_"^"_$P(^PS(50.628,WRT,0),"^")_"^"_OLDGCN
"RTN","NDFRRDP",8,0)
 Q
"RTN","NDFRRDP1")
0^51^B2010305
"RTN","NDFRRDP1",1,0)
NDFRRDP1 ;BIR/WRT-Output Transform Routine Used By NDF Manager To Do Mapping Of PMIs ; 06/03/03 15:10;
"RTN","NDFRRDP1",2,0)
 ;;4.0; NDF MANAGEMENT;**62**; 30 Oct 98;Build 1
"RTN","NDFRRDP1",3,0)
 ; K GCN1,BRT,PSEQNO,PREV
"RTN","NDFRRDP1",4,0)
 S GCN1=$P($G(^PSNDF(50.68,+Y,1)),"^",6) I GCN1,$D(^PS(50.628)) D DISPLAY
"RTN","NDFRRDP1",5,0)
 S:'$D(PSEQNO) PSEQNO=""
"RTN","NDFRRDP1",6,0)
 Q
"RTN","NDFRRDP1",7,0)
DISPLAY S BRT=$O(^PS(50.628,"C",GCN1,0)) Q:'BRT  S PREV=$P(^PS(50.628,BRT,0),"^",2)_" "_$P(^PS(50.628,BRT,0),"^",3)_" "_$P(^PS(50.628,BRT,0),"^",4)_" "_$P(^PS(50.628,BRT,0),"^",5),PSEQNO=GCN1_"^"_BRT_"^"_PREV_"^"_$P(^PS(50.628,BRT,0),"^")
"RTN","NDFRRDP1",8,0)
 Q
"RTN","NDFSHOW")
0^52^B5554261
"RTN","NDFSHOW",1,0)
NDFSHOW ;BIR/DMA-show product information ;19 Aug 98 / 10:56 AM
"RTN","NDFSHOW",2,0)
 ;;4.0; NDF MANAGEMENT;; 1 Jan 99;Build 1
"RTN","NDFSHOW",3,0)
 ;
"RTN","NDFSHOW",4,0)
SHOWALL W "NDC: ",NDC,!,"Trade name: ",TR,!,"Manufacturer: ",$P(^PS(55.95,MFR,0),"^"),?50,"Dose form: ",$P(^PS(50.606,DOS,0),"^"),!,"Strength: ",ST
"RTN","NDFSHOW",5,0)
 W ?50,"Units: ",$P(^PS(50.607,UN,0),"^")
"RTN","NDFSHOW",6,0)
 F J=0:0 S J=$O(PC(J)) Q:'J  W !,"Package code: ",PC(J),?50,"Package type: ",$P(^PS(50.608,+PT(J),0),"^"),!,?3,"Package size: ",$P(^PS(50.609,+PS(J),0),"^")
"RTN","NDFSHOW",7,0)
 I $D(ING) W !,"Ingredients: " F J=0:0 S J=$O(ING(J)) Q:'J  W ?13,$P(^PS(50.416,+ING(J),0),"^"),?50,"Amount: ",$P(ING(J),"^",2),!,?3,"Unit: ",$P($G(^PS(50.607,+$P(ING(J),"^",3),0)),"^"),!
"RTN","NDFSHOW",8,0)
 I '$D(ING) W !,"Ingredients: " F JK1=0:0 S JK1=$O(^PSNDF(50.68,A3DA,2,JK1)) Q:'JK1  S JK2=^(JK1,0) W ?13,$P(^PS(50.416,JK1,0),"^"),?50,"Amount: ",$P(JK2,"^",2),!,?3,"Unit: ",$P($G(^PS(50.607,+$P(JK2,"^",3),0)),"^"),!
"RTN","NDFSHOW",9,0)
 W !,"VA Class: ",$P(^PS(50.605,CL,0),"^"),!,"Product name: ",PN,!,"VA generic name: ",$P(^PSNDF(50.6,$P(A,"^",2),0),"^")
"RTN","NDFSHOW",10,0)
 I $G(B)]"" W !,"National identifier: ",$P(B,"^",2),!,"VA print name: ",$P(B,"^"),!,"VA dispense units: ",$P(B,"^",4),?50,"CMOP?: ",$S($P(B,"^",3):"YES",1:"NO")
"RTN","NDFSHOW",11,0)
 Q
"RTN","NDFSHOW",12,0)
 ;
"RTN","NDFSHOW",13,0)
 ;
"RTN","NDFVUDPL")
0^53^B55796317
"RTN","NDFVUDPL",1,0)
NDFVUDPL ;BIR/WRT-PROPOSED NEW VUID Assignment Report; 12/12/05 12:21 ; 20 Mar 2007  2:12 PM
"RTN","NDFVUDPL",2,0)
 ;;0.0; NATIONAL DRUG FILE MANAGEMENT SYSTEM;; 30 Oct 98;Build 1
"RTN","NDFVUDPL",3,0)
 K I
"RTN","NDFVUDPL",4,0)
 W !,"This report gives you a hard copy of NEW entries with proposed VUIDs.",!,"In addition, it will reflect entries that have been Inactivated or Re-Activated.",!,"You may queue the report to print, if you wish.",!
"RTN","NDFVUDPL",5,0)
 K ^WRT("NDFID") S VUID=$P(^NDFK(5000.991,1,0),"^",2)+1,NUM=1
"RTN","NDFVUDPL",6,0)
DVC K %ZIS,POP,IOP S %ZIS="QM",%ZIS("B")="",%ZIS("A")="Select Printer: " D ^%ZIS G:POP DONE W:$E(IOST)'="P" !!,"This report must be run on a printer.",!! G:$E(IOST)'="P" DVC I POP K IOP,POP,IO("Q") Q
"RTN","NDFVUDPL",7,0)
QUEUE I $D(IO("Q")) K IO("Q") S ZTRTN="ENQ^NDFVUDPL",ZTDESC="List of NEW Entries Pending VUID Assignment",ZTSAVE("VUID")="",ZTSAVE("NUM")="" D ^%ZTLOAD K ZTSK D ^%ZISC Q
"RTN","NDFVUDPL",8,0)
ENQ ;ENTRY POINT WHEN QUEUED
"RTN","NDFVUDPL",9,0)
 U IO
"RTN","NDFVUDPL",10,0)
 S NDFPGCT=0,NDFPGLNG=IOSL-6 D TITLE,LOOP1,NONE,TITLE1,ACT,NONE,TITLE2,LOOP2,NONE,TITLE2A,ACT2,NONE,TITLE3,LOOP3,NONE,TITLE4,LOOP4,NONE,TITLE4A,ACT4,NONE
"RTN","NDFVUDPL",11,0)
DONE W @IOF S:$D(ZTQUEUED) ZTREQ="@" K NDFPRT,I,NAM,IFN,DATE,MAST,MASTER,NBR,NUM,STAMP,VUID,DVUID,ENTRY,MJT,NDFPGCT,NDFPGLNG,Y,IOP,POP,IO("Q") K ^WRT("NDFID") D ^%ZISC
"RTN","NDFVUDPL",12,0)
 Q
"RTN","NDFVUDPL",13,0)
TITLE I $D(IOF),IOF]"" W @IOF S NDFPGCT=NDFPGCT+1
"RTN","NDFVUDPL",14,0)
 S NDFPRT=0 W !,?12," List of NEW Entries Pending VUID Assignment",!
"RTN","NDFVUDPL",15,0)
 W !?27,"VA PRODUCT FILE",!
"RTN","NDFVUDPL",16,0)
 S Y=DT X ^DD("DD") W ?22,"Date printed: ",Y,!
"RTN","NDFVUDPL",17,0)
 W !,"IEN",?8,"VA PRODUCT NAME",!,?8,"PLANNED VUID",?63,"MASTER/NON-MASTER",!
"RTN","NDFVUDPL",18,0)
 F MJT=1:1:80 W "-"
"RTN","NDFVUDPL",19,0)
 Q
"RTN","NDFVUDPL",20,0)
LOOP1 F I=0:0 S I=$O(^PSNDF(50.68,I)) Q:'I  I '$D(^PSNDF(50.68,I,"VUID")) S NAM=$P(^PSNDF(50.68,I,0),"^"),DATE=$P($G(^PSNDF(50.68,I,7)),"^",3) S:'$G(DATE) DATE=DT S MAST=1 S:DATE=DT MAST=1 S MASTER="MASTER" S:MAST=0 MASTER="NON-MASTER" D PROP1
"RTN","NDFVUDPL",21,0)
 Q
"RTN","NDFVUDPL",22,0)
 ; See if term exists & set VUID
"RTN","NDFVUDPL",23,0)
PROP I '$D(^NDFK(5000.992,"C",NAM)),'$D(^WRT("NDFID","C",NAM)) W !!,I,?8,NAM,!,?8,"Planned VUID: ",VUID,"   ","(THIS IS A NEW VUID)" W:DATE'=DT ?8,"   ***INACTIVE" W ?72,MASTER D SETMP S VUID=VUID+1 S NDFPRT=1 Q
"RTN","NDFVUDPL",24,0)
 I $D(^NDFK(5000.992,"C",NAM)),'$D(^WRT("NDFID","C",NAM)) S IFN=$O(^NDFK(5000.992,"C",NAM,0)) S DVUID=$P(^NDFK(5000.992,IFN,0),"^") W !!,I,?8,NAM,!?8,"Planned VUID: ",DVUID,"   ","(THIS IS AN EXISTING VUID)",?72,MASTER S NDFPRT=1 Q
"RTN","NDFVUDPL",25,0)
 I $D(^WRT("NDFID","C",NAM)),'$D(^NDFK(5000.992,"C",NAM)) S IFN=$O(^WRT("NDFID","C",NAM,0)) S DVUID=$P(^WRT("NDFID",IFN,0),"^") W !!,I,?8,NAM,!?8,"Planned VUID: ",DVUID,"    ","(THIS IS A EXISTING VUID)",?72,MASTER S NDFPRT=1 Q
"RTN","NDFVUDPL",26,0)
 Q
"RTN","NDFVUDPL",27,0)
PROP1 W !!,I,?8,NAM,!,?8,"Planned VUID: ",VUID,"   ","(THIS IS A NEW VUID)" W:DATE'=DT ?8,"   ***INACTIVE" W ?72,MASTER S VUID=VUID+1 S NDFPRT=1 Q
"RTN","NDFVUDPL",28,0)
 Q
"RTN","NDFVUDPL",29,0)
 ; Set ^TMP global
"RTN","NDFVUDPL",30,0)
SETMP S ^WRT("NDFID",NUM,0)=VUID_"^"_NAM_"^"_MAST,^WRT("NDFID","C",NAM,NUM)="",^WRT("NDFID","B",VUID,NUM)=""
"RTN","NDFVUDPL",31,0)
 S NUM=NUM+1
"RTN","NDFVUDPL",32,0)
 Q
"RTN","NDFVUDPL",33,0)
ACT S NBR=$P(^NDFK(5000,1,1,50.68,0),"^",2) F  S NBR=$O(^DIA(50.68,NBR)) Q:'NBR  I $P(^(NBR,0),"^",3)=21 S ENTRY=$P(^DIA(50.68,NBR,0),"^") I $D(^PSNDF(50.68,ENTRY,0)) D CHECK
"RTN","NDFVUDPL",34,0)
 Q
"RTN","NDFVUDPL",35,0)
CHECK I $D(^DIA(50.68,NBR,2.1)),'$D(^DIA(50.68,NBR,3.1)) W !!,ENTRY,?8,$P(^PSNDF(50.68,ENTRY,0),"^"),?67,"RE-ACTIVATED" S NDFPRT=1
"RTN","NDFVUDPL",36,0)
 I '$D(^DIA(50.68,NBR,2.1)),$D(^DIA(50.68,NBR,3.1)) S STAMP=$P(^DIA(50.68,NBR,3.1),"^"),Y=STAMP X ^DD("DD") I STAMP>3050310 W !!,ENTRY,?8,$P(^PSNDF(50.68,ENTRY,0),"^"),?67,"INACTIVATED",!?67,Y S NDFPRT=1
"RTN","NDFVUDPL",37,0)
 I $D(^DIA(50.68,NBR,2.1)),$D(^DIA(50.68,NBR,3.1)) S STAMP=$P(^DIA(50.68,NBR,3.1),"^"),Y=STAMP X ^DD("DD") I STAMP>3050310 W !!,ENTRY,?8,$P(^PSNDF(50.68,ENTRY,0),"^"),?67,"INACTIVATED",!?67,Y S NDFPRT=1
"RTN","NDFVUDPL",38,0)
 Q
"RTN","NDFVUDPL",39,0)
TITLE1 I $D(IOF),IOF]"" W @IOF S NDFPGCT=NDFPGCT+1
"RTN","NDFVUDPL",40,0)
 S NDFPRT=0 W !,?8," List of Entries Inactivated/Re-Activated in Next Data Update"
"RTN","NDFVUDPL",41,0)
 W !,?35,"VA PRODUCT FILE",!
"RTN","NDFVUDPL",42,0)
 S Y=DT X ^DD("DD") W ?28,"Date printed: ",Y,!
"RTN","NDFVUDPL",43,0)
 W !,?7,"VA PRODUCT NAME",?67,"STATUS",!?67,"DATE",!
"RTN","NDFVUDPL",44,0)
 F MJT=1:1:80 W "-"
"RTN","NDFVUDPL",45,0)
 Q
"RTN","NDFVUDPL",46,0)
 ; Drug Ingredients
"RTN","NDFVUDPL",47,0)
TITLE2 I $D(IOF),IOF]"" W @IOF S NDFPRT=0 W !!,?13," List of NEW Entries Pending VUID Assignment",!
"RTN","NDFVUDPL",48,0)
 W !?27,"DRUG INGREDIENTS FILE",!
"RTN","NDFVUDPL",49,0)
 S Y=DT X ^DD("DD") W ?25,"Date printed: ",Y,!
"RTN","NDFVUDPL",50,0)
 W !,"IEN",?8,"DRUG INGREDIENT",!?8,"PLANNED VUID",?63,"MASTER/NON-MASTER",!
"RTN","NDFVUDPL",51,0)
 F MJT=1:1:80 W "-"
"RTN","NDFVUDPL",52,0)
 Q
"RTN","NDFVUDPL",53,0)
LOOP2 K NAM,I
"RTN","NDFVUDPL",54,0)
 F I=0:0 S I=$O(^PS(50.416,I)) Q:'I  I '$D(^PS(50.416,I,"VUID")) S NAM=$P(^PS(50.416,I,0),"^"),DATE=$P($G(^PS(50.416,I,2)),"^") S:'$G(DATE) DATE=DT S MAST=1 S:DATE=DT MAST=1 S MASTER="MASTER" S:MAST=0 MASTER="NON-MASTER" D PROP
"RTN","NDFVUDPL",55,0)
 Q
"RTN","NDFVUDPL",56,0)
ACT2 S NBR=$P(^NDFK(5000,1,1,50.416,0),"^",2) F  S NBR=$O(^DIA(50.416,NBR)) Q:'NBR  I $P(^(NBR,0),"^",3)=3 S ENTRY=$P(^DIA(50.416,NBR,0),"^") I $D(^PS(50.416,ENTRY,0)) D CHECK2
"RTN","NDFVUDPL",57,0)
 Q
"RTN","NDFVUDPL",58,0)
CHECK2 I $D(^DIA(50.416,NBR,2.1)),'$D(^DIA(50.416,NBR,3.1)) W !!,ENTRY,?8,$P(^PS(50.416,ENTRY,0),"^"),?67,"RE-ACTIVATED" S NDFPRT=1
"RTN","NDFVUDPL",59,0)
 I '$D(^DIA(50.416,NBR,2.1)),$D(^DIA(50.416,NBR,3.1)) S STAMP=$P(^DIA(50.416,NBR,3.1),"^"),Y=STAMP X ^DD("DD") I STAMP>3050310 W !!,ENTRY,?8,$P(^PS(50.416,ENTRY,0),"^"),?67,"INACTIVATED",!?67,Y S NDFPRT=1
"RTN","NDFVUDPL",60,0)
 I $D(^DIA(50.416,NBR,2.1)),$D(^DIA(50.416,NBR,3.1)) S STAMP=$P(^DIA(50.416,NBR,3.1),"^"),Y=STAMP X ^DD("DD") I STAMP>3050310 W !!,ENTRY,?8,$P(^PS(50.416,ENTRY,0),"^"),?67,"INACTIVATED",!?67,Y S NDFPRT=1
"RTN","NDFVUDPL",61,0)
 Q
"RTN","NDFVUDPL",62,0)
TITLE2A I $D(IOF),IOF]"" W @IOF S NDFPRT=0 W !!,?11," List of Entries Inactivated/Re-Activated in Next Data Update"
"RTN","NDFVUDPL",63,0)
 W !,?35,"DRUG INGREDIENTS FILE",!
"RTN","NDFVUDPL",64,0)
 S Y=DT X ^DD("DD") W ?33,"Date printed: ",Y,!
"RTN","NDFVUDPL",65,0)
 W !,?7,"DRUG INGREDIENT",?67,"STATUS",!?67,"DATE",!
"RTN","NDFVUDPL",66,0)
 F MJT=1:1:80 W "-"
"RTN","NDFVUDPL",67,0)
 Q
"RTN","NDFVUDPL",68,0)
NONE W:NDFPRT=0 !," 0 ENTRIES FOUND"
"RTN","NDFVUDPL",69,0)
 Q
"RTN","NDFVUDPL",70,0)
 ; VA Drug Class
"RTN","NDFVUDPL",71,0)
TITLE3 I $D(IOF),IOF]"" W @IOF S NDFPRT=0 W !!,?13," List of NEW Entries Pending VUID Assignment",!
"RTN","NDFVUDPL",72,0)
 W !?27,"VA DRUG CLASS",!
"RTN","NDFVUDPL",73,0)
 S Y=DT X ^DD("DD") W ?22,"Date printed: ",Y,!
"RTN","NDFVUDPL",74,0)
 W !,"IEN",?8,"VA DRUG CLASS",!?8,"PLANNED VUID",?63,"MASTER/NON-MASTER",!
"RTN","NDFVUDPL",75,0)
 F MJT=1:1:80 W "-"
"RTN","NDFVUDPL",76,0)
 Q
"RTN","NDFVUDPL",77,0)
LOOP3 K NAM,I
"RTN","NDFVUDPL",78,0)
 F I=0:0 S I=$O(^PS(50.605,I)) Q:'I  D SET
"RTN","NDFVUDPL",79,0)
 Q
"RTN","NDFVUDPL",80,0)
SET I '$D(^PS(50.605,I,"VUID")) S NAM=$P(^PS(50.605,I,0),"^")_"  "_$P(^(0),"^",2),DATE=$P($G(^PS(50.605,I,2)),"^") S:'$G(DATE) DATE=DT S MAST=1 S:DATE=DT MAST=1 S MASTER="MASTER" S:MAST=0 MASTER="NON-MASTER" D PROP
"RTN","NDFVUDPL",81,0)
 Q
"RTN","NDFVUDPL",82,0)
 ; VA Generic
"RTN","NDFVUDPL",83,0)
TITLE4 I $D(IOF),IOF]"" W @IOF S NDFPRT=0 W !!,?13," List of NEW Entries Pending VUID Assignment",!
"RTN","NDFVUDPL",84,0)
 W !?27,"VA GENERIC FILE",!
"RTN","NDFVUDPL",85,0)
 S Y=DT X ^DD("DD") W ?22,"Date printed: ",Y,!
"RTN","NDFVUDPL",86,0)
 W !,"IEN",?8,"VA GENERIC NAME",!?8,"PLANNED VUID",?63,"MASTER/NON-MASTER",!
"RTN","NDFVUDPL",87,0)
 F MJT=1:1:80 W "-"
"RTN","NDFVUDPL",88,0)
 Q
"RTN","NDFVUDPL",89,0)
LOOP4 K NAM,I
"RTN","NDFVUDPL",90,0)
 F I=0:0 S I=$O(^PSNDF(50.6,I)) Q:'I  I '$D(^PSNDF(50.6,I,"VUID")) S NAM=$P(^PSNDF(50.6,I,0),"^"),DATE=$P($G(^PSNDF(50.6,I,0)),"^",2) S:'$G(DATE) DATE=DT S MAST=1 S:DATE=DT MAST=1 S MASTER="MASTER" S:MAST=0 MASTER="NON-MASTER" D PROP
"RTN","NDFVUDPL",91,0)
 Q
"RTN","NDFVUDPL",92,0)
ACT4 S NBR=$P(^NDFK(5000,1,1,50.6,0),"^",2) F  S NBR=$O(^DIA(50.6,NBR)) Q:'NBR  I $P(^(NBR,0),"^",3)=1 S ENTRY=$P(^DIA(50.6,NBR,0),"^") I $D(^PSNDF(50.6,ENTRY,0)) D CHECK4
"RTN","NDFVUDPL",93,0)
 Q
"RTN","NDFVUDPL",94,0)
CHECK4 I $D(^DIA(50.6,NBR,2.1)),'$D(^DIA(50.6,NBR,3.1)) W !!,ENTRY,?8,$P(^PSNDF(50.6,ENTRY,0),"^"),?67,"RE-ACTIVATED" S NDFPRT=1
"RTN","NDFVUDPL",95,0)
 I '$D(^DIA(50.6,NBR,2.1)),$D(^DIA(50.6,NBR,3.1)) S STAMP=$P(^DIA(50.6,NBR,3.1),"^"),Y=STAMP X ^DD("DD") I STAMP>3050310 W !!,ENTRY,?8,$P(^PSNDF(50.6,ENTRY,0),"^"),?67,"INACTIVATED",!?67,Y S NDFPRT=1
"RTN","NDFVUDPL",96,0)
 I $D(^DIA(50.6,NBR,2.1)),$D(^DIA(50.6,NBR,3.1)) S STAMP=$P(^DIA(50.6,NBR,3.1),"^"),Y=STAMP X ^DD("DD") I STAMP>3050310 W !!,ENTRY,?8,$P(^PSNDF(50.6,ENTRY,0),"^"),?67,"INACTIVATED",!?67,Y S NDFPRT=1
"RTN","NDFVUDPL",97,0)
 Q
"RTN","NDFVUDPL",98,0)
TITLE4A I $D(IOF),IOF]"" W @IOF S NDFPRT=0 W !!,?11," List of Entries Inactivated/Re-Activated in Next Data Update"
"RTN","NDFVUDPL",99,0)
 W !,?35,"VA GENERIC FILE",!
"RTN","NDFVUDPL",100,0)
 S Y=DT X ^DD("DD") W ?30,"Date printed: ",Y,!
"RTN","NDFVUDPL",101,0)
 W !,?7,"VA GENERIC NAME",?67,"STATUS",!?67,"DATE",!
"RTN","NDFVUDPL",102,0)
 F MJT=1:1:80 W "-"
"RTN","NDFVUDPL",103,0)
 Q
"RTN","NDFVUID")
0^54^B54318253
"RTN","NDFVUID",1,0)
NDFVUID ;BIRM/WRT - Auto populating of VUIDs.; 12/09/05 10:53 ; 13 Apr 2009  8:29 AM
"RTN","NDFVUID",2,0)
 ;;0.0;NATIONAL DRUG FILE MANAGEMENT SYSTEM;; 30 Oct 98;Build 1
"RTN","NDFVUID",3,0)
DISPLAY W !!,"This option is used to assign VUIDs to newly added entries and to update the"
"RTN","NDFVUID",4,0)
 W !,"VUID EFFECTIVE DATE/STATUS fields when an entry is inactivated.",!!,"This option should not be run until the Data Standardization Review team has",!,"reviewed the List of New Entries Pending VUID Assignment report AND has"
"RTN","NDFVUID",5,0)
 W !,"provided written approval of all planned changes.",!!,"Running this option is the last step prior to the actual creation of the NDF",!,"Data Update Patch."
"RTN","NDFVUID",6,0)
 W !! S DIR("A")="Has the Data Standardization Review Team reviewed and provided written approval of the report? "
"RTN","NDFVUID",7,0)
 S DIR("B")="NO",DIR(0)="YA" D ^DIR K DIR I $D(DTOUT)!$D(DUOUT) Q
"RTN","NDFVUID",8,0)
 I Y=0 Q
"RTN","NDFVUID",9,0)
 W !! S DIR("A")="Are you sure you are ready to proceed? "
"RTN","NDFVUID",10,0)
 S DIR("B")="NO",DIR(0)="YA" D ^DIR K DIR I $D(DTOUT)!$D(DUOUT) Q
"RTN","NDFVUID",11,0)
 I Y=0 Q
"RTN","NDFVUID",12,0)
 W !!!,"Please wait while I assign VUIDs...." K ^BT("PSNVUID") S VUID=$P(^NDFK(5000.991,1,0),"^",2)+1 D START,INGRED,CLASS,VAGN,PFS,FIX,KILL D ^NDFORCE W !!,"OK, I'm done",!!,"Now print the report to your screen to see what was assigned.",!
"RTN","NDFVUID",13,0)
 D ^NDFNWVD
"RTN","NDFVUID",14,0)
 Q
"RTN","NDFVUID",15,0)
START ; Begin population process
"RTN","NDFVUID",16,0)
 F I=0:0 S I=$O(^PSNDF(50.68,I)) Q:'I  I '$D(^PSNDF(50.68,I,"VUID")) S NAM=$P(^PSNDF(50.68,I,0),"^"),DATE=$P($G(^PSNDF(50.68,I,7)),"^",3) S:'$G(DATE) DATE=DT S MAST=1 D SETVUID,STATUS
"RTN","NDFVUID",17,0)
 Q
"RTN","NDFVUID",18,0)
SETVUID S DA=I,DIE="^PSNDF(50.68,",DR="99.99////"_VUID D ^DIE S DA=I,DIE="^PSNDF(50.68,",DR="99.98////"_1 D ^DIE S ^BT("PSNVUID","VAPN",I)=VUID D FIL991 S VUID=VUID+1
"RTN","NDFVUID",19,0)
 Q
"RTN","NDFVUID",20,0)
STATUS S:'$D(^PSNDF(50.68,I,"TERMSTATUS",0)) ^PSNDF(50.68,I,"TERMSTATUS",0)="^50.6899DA^^"
"RTN","NDFVUID",21,0)
 I DATE=DT S DA(1)=I,DIC="^PSNDF(50.68,"_I_",""TERMSTATUS"",",X=DATE,DIC(0)="L",DLAYGO=50.6899,DIC("DR")=".02////"_1 D FILE^DICN
"RTN","NDFVUID",22,0)
 I DATE'=DT S DA(1)=I,DIC="^PSNDF(50.68,"_I_",""TERMSTATUS"",",X=DATE,DIC(0)="L",DLAYGO=50.6899,DIC("DR")=".02////"_0 D FILE^DICN
"RTN","NDFVUID",23,0)
 Q
"RTN","NDFVUID",24,0)
FIL991 S $P(^NDFK(5000.991,1,0),"^",2)=VUID,$P(^NDFK(5000.991,1,1,50.68,0),"^",2)=I
"RTN","NDFVUID",25,0)
 Q
"RTN","NDFVUID",26,0)
FIL992 S JJJ=$P(^NDFK(5000.992,0),"^",3)+1,^NDFK(5000.992,JJJ,0)=$P(^PSNDF(50.68,I,"VUID"),"^")_"^"_50.68_"^"_I_"^"_NAM_"^"_MAST_"^"_DATE,^NDFK(5000.992,"B",$P(^PSNDF(50.68,I,"VUID"),"^"),JJJ)="",^NDFK(5000.992,"C",NAM,JJJ)="" D NDEX
"RTN","NDFVUID",27,0)
 S $P(^NDFK(5000.992,0),"^",3)=JJJ,$P(^NDFK(5000.992,0),"^",4)=JJJ
"RTN","NDFVUID",28,0)
 ; KILL K I,NAM,NAM,DATE,PSZ,IEN,VUID,DVUID Q
"RTN","NDFVUID",29,0)
 Q
"RTN","NDFVUID",30,0)
NDEX ; S ^NDFK(5000.992,"F",$P(^PSNDF(50.68,I,"VUID"),"^"),50.68,NAM,JJJ)="" I $P(^NDFK(5000.992,JJJ,0),"^",6)=DT S DA=I,DIE="^PSNDF(50.68,",DR="99.98////"_1 D ^DIE S $P(^NDFK(5000.992,JJJ,0),"^",5)=1
"RTN","NDFVUID",31,0)
 Q
"RTN","NDFVUID",32,0)
INGRED K DATE,JJJ S JJJ=$P(^NDFK(5000.992,0),"^",3)+1 F LL=0:0 S LL=$O(^PS(50.416,LL)) Q:'LL  I '$D(^PS(50.416,LL,"VUID")) S NAME=$P(^PS(50.416,LL,0),"^"),DATE=$P($G(^PS(50.416,LL,2)),"^") S:'$G(DATE) DATE=DT D INGVUID,ST
"RTN","NDFVUID",33,0)
 Q
"RTN","NDFVUID",34,0)
INGVUID I '$D(^NDFK(5000.992,"C",NAME)) S DA=LL,DIE="^PS(50.416,",DR="99.99////"_VUID D ^DIE S DA=LL,DIE="^PS(50.416,",DR="99.98////"_1 D ^DIE S ^BT("PSNVUID","ING",LL)=VUID D FL991 S VUID=VUID+1
"RTN","NDFVUID",35,0)
 I $D(^NDFK(5000.992,"C",NAME)) S IEN=$O(^NDFK(5000.992,"C",NAME,0)),DVUID=$P(^NDFK(5000.992,IEN,0),"^"),DA=LL,DIE="^PS(50.416,",DR="99.99////"_DVUID D ^DIE S DA=LL,DIE="^PS(50.416,",DR="99.98////"_1 D ^DIE S ^BT("PSNVUID","ING",LL)=DVUID
"RTN","NDFVUID",36,0)
 D FL992
"RTN","NDFVUID",37,0)
 Q
"RTN","NDFVUID",38,0)
ST S:'$D(^PS(50.416,LL,"TERMSTATUS",0)) ^PS(50.416,LL,"TERMSTATUS",0)="^50.4169DA^^"
"RTN","NDFVUID",39,0)
 I DATE=DT S DA(1)=LL,DIC="^PS(50.416,"_LL_",""TERMSTATUS"",",X=DATE,DIC(0)="L",DLAYGO=50.4169,DIC("DR")=".02////"_1 D FILE^DICN
"RTN","NDFVUID",40,0)
 I DATE'=DT S DA(1)=LL,DIC="^PS(50.416,"_LL_",""TERMSTATUS"",",X=DATE,DIC(0)="L",DLAYGO=50.4169,DIC("DR")=".02////"_0 D FILE^DICN
"RTN","NDFVUID",41,0)
 Q
"RTN","NDFVUID",42,0)
FL991 S $P(^NDFK(5000.991,1,0),"^",2)=VUID,$P(^NDFK(5000.991,1,1,50.416,0),"^",2)=LL
"RTN","NDFVUID",43,0)
 Q
"RTN","NDFVUID",44,0)
FL992 S JJJ=$P(^NDFK(5000.992,0),"^",3)+1,^NDFK(5000.992,JJJ,0)=$P(^PS(50.416,LL,"VUID"),"^")_"^"_50.416_"^"_LL_"^"_NAME,^NDFK(5000.992,"B",$P(^PS(50.416,LL,"VUID"),"^"),JJJ)="",^NDFK(5000.992,"C",NAME,JJJ)=""
"RTN","NDFVUID",45,0)
 S $P(^NDFK(5000.992,0),"^",3)=JJJ,$P(^NDFK(5000.992,0),"^",4)=JJJ
"RTN","NDFVUID",46,0)
 Q
"RTN","NDFVUID",47,0)
CLASS K DATE,JJJ F PP=0:0 S PP=$O(^PS(50.605,PP)) Q:'PP  I '$D(^PS(50.605,PP,"VUID")) D COMBO S DATE=$P($G(^PS(50.605,PP,2)),"^") S:'$G(DATE) DATE=DT S MAST=1 D CLSVUID,STA
"RTN","NDFVUID",48,0)
 Q
"RTN","NDFVUID",49,0)
COMBO S NME=$P(^PS(50.605,PP,0),"^")_"***"_$P(^PS(50.605,PP,0),"^",2)
"RTN","NDFVUID",50,0)
 Q
"RTN","NDFVUID",51,0)
CLSVUID I '$D(^NDFK(5000.992,"C",NME)) S DA=PP,DIE="^PS(50.605,",DR="99.99////"_VUID D ^DIE S DA=PP,DIE="^PS(50.605,",DR="99.98////"_1 D ^DIE S ^BT("PSNVUID","VACL",PP)=VUID D F991 S VUID=VUID+1
"RTN","NDFVUID",52,0)
 I $D(^NDFK(5000.992,"C",NME)) S IEN=$O(^NDFK(5000.992,"C",NME,0)),DVUID=$P(^NDFK(5000.992,IEN,0),"^"),DA=PP,DIE="^PS(50.605,",DR="99.99////"_DVUID D ^DIE S DA=PP,DIE="^PS(50.605,",DR="99.98////"_1 D ^DIE S ^BT("PSNVUID","VACL",PP)=DVUID
"RTN","NDFVUID",53,0)
 D F992
"RTN","NDFVUID",54,0)
 Q
"RTN","NDFVUID",55,0)
STA S:'$D(^PS(50.605,PP,"TERMSTATUS",0)) ^PS(50.605,PP,"TERMSTATUS",0)="^50.60509DA^^"
"RTN","NDFVUID",56,0)
 I DATE=DT S DA(1)=PP,DIC="^PS(50.605,"_PP_",""TERMSTATUS"",",X=DATE,DIC(0)="L",DLAYGO=50.60509,DIC("DR")=".02////"_1 D FILE^DICN
"RTN","NDFVUID",57,0)
 I DATE'=DT S DA(1)=PP,DIC="^PS(50.605,"_PP_",""TERMSTATUS"",",X=DATE,DIC(0)="L",DLAYGO=50.60509,DIC("DR")=".02////"_0 D FILE^DICN
"RTN","NDFVUID",58,0)
 Q
"RTN","NDFVUID",59,0)
F991 S $P(^NDFK(5000.991,1,0),"^",2)=VUID,$P(^NDFK(5000.991,1,1,50.605,0),"^",2)=PP
"RTN","NDFVUID",60,0)
 Q
"RTN","NDFVUID",61,0)
F992 S JJJ=$P(^NDFK(5000.992,0),"^",3)+1,^NDFK(5000.992,JJJ,0)=$P(^PS(50.605,PP,"VUID"),"^")_"^"_50.605_"^"_PP_"^"_NME_"^"_MAST_"^"_DATE,^NDFK(5000.992,"B",$P(^PS(50.605,PP,"VUID"),"^"),JJJ)="",^NDFK(5000.992,"C",NME,JJJ)="" D DXX
"RTN","NDFVUID",62,0)
 S $P(^NDFK(5000.992,0),"^",3)=JJJ,$P(^NDFK(5000.992,0),"^",4)=JJJ
"RTN","NDFVUID",63,0)
 Q
"RTN","NDFVUID",64,0)
DXX ; S ^NDFK(5000.992,"F",$P(^PS(50.605,PP,"VUID"),"^"),50.68,NME,JJJ)="" I $P(^NDFK(5000.992,JJJ,0),"^",6)=DT S DA=PP,DIE="^PS(50.605,",DR="99.98////"_1,$P(^NDFK(5000.992,JJJ,0),"^",5)=1
"RTN","NDFVUID",65,0)
 Q
"RTN","NDFVUID",66,0)
VAGN K DATE,JJJ
"RTN","NDFVUID",67,0)
 S JJJ=$P(^NDFK(5000.992,0),"^",3)+1 F TT=0:0 S TT=$O(^PSNDF(50.6,TT)) Q:'TT  I '$D(^PSNDF(50.6,TT,"VUID")) S TERM=$P(^PSNDF(50.6,TT,0),"^"),DATE=$P($G(^PSNDF(50.6,TT,0)),"^",2) S:'$G(DATE) DATE=DT S MAST=1 D VAGNVUID,STUTS
"RTN","NDFVUID",68,0)
 Q
"RTN","NDFVUID",69,0)
VAGNVUID I '$D(^NDFK(5000.992,"C",TERM)) S DA=TT,DIE="^PSNDF(50.6,",DR="99.99////"_VUID D ^DIE S DA=TT,DIE="^PSNDF(50.6,",DR="99.98////"_1 D ^DIE S ^BT("PSNVUID","VAGN",TT)=VUID D FILE991 S VUID=VUID+1
"RTN","NDFVUID",70,0)
 I $D(^NDFK(5000.992,"C",TERM)) S IEN=$O(^NDFK(5000.992,"C",TERM,0)),DVUID=$P(^NDFK(5000.992,IEN,0),"^"),DA=TT,DIE="^PSNDF(50.6,",DR="99.99////"_DVUID D ^DIE S DA=TT,DIE="^PSNDF(50.6,",DR="99.98////"_1 D ^DIE S ^BT("PSNVUID","VAGN",TT)=DVUID
"RTN","NDFVUID",71,0)
 D FILE992
"RTN","NDFVUID",72,0)
 Q
"RTN","NDFVUID",73,0)
STUTS S:'$D(^PSNDF(50.6,TT,"TERMSTATUS",0)) ^PSNDF(50.6,TT,"TERMSTATUS",0)="^50.6009DA^^"
"RTN","NDFVUID",74,0)
 I DATE=DT S DA(1)=TT,DIC="^PSNDF(50.6,"_TT_",""TERMSTATUS"",",X=DATE,DIC(0)="L",DLAYGO=50.6009,DIC("DR")=".02////"_1 D FILE^DICN
"RTN","NDFVUID",75,0)
 I DATE'=DT S DA(1)=TT,DIC="^PSNDF(50.6,"_TT_",""TERMSTATUS"",",X=DATE,DIC(0)="L",DLAYGO=50.6009,DIC("DR")=".02////"_0 D FILE^DICN
"RTN","NDFVUID",76,0)
 ; S (PSZ,ZZZ)=0 F  S ZZZ=$O(^PSNDF(50.6,TT,"TERMSTATUS",ZZZ)) Q:'ZZZ  S PSZ=ZZZ
"RTN","NDFVUID",77,0)
 ; S PSZ=PSZ+1 S ^PSNDF(50.6,TT,"TERMSTATUS",PSZ,0)=DATE_"^"_1 S:DATE'=DT $P(^PSNDF(50.6,TT,"TERMSTATUS",PSZ,0),"^",2)=0 S ^PSNDF(50.6,TT,"TERMSTATUS","B",DATE,PSZ)=""
"RTN","NDFVUID",78,0)
 ; S $P(^PSNDF(50.6,TT,"TERMSTATUS",0),"^",3)=PSZ,$P(^PSNDF(50.6,TT,"TERMSTATUS",0),"^",4)=PSZ D FILE991,FILE992
"RTN","NDFVUID",79,0)
 Q
"RTN","NDFVUID",80,0)
FILE991 S $P(^NDFK(5000.991,1,0),"^",2)=VUID,$P(^NDFK(5000.991,1,1,50.6,0),"^",2)=TT
"RTN","NDFVUID",81,0)
 Q
"RTN","NDFVUID",82,0)
FILE992 S JJJ=$P(^NDFK(5000.992,0),"^",3)+1,^NDFK(5000.992,JJJ,0)=$P(^PSNDF(50.6,TT,"VUID"),"^")_"^"_50.6_"^"_TT_"^"_TERM_"^"_MAST_"^"_DATE,^NDFK(5000.992,"B",$P(^PSNDF(50.6,TT,"VUID"),"^"),JJJ)="",^NDFK(5000.992,"C",TERM,JJJ)="" D INDX
"RTN","NDFVUID",83,0)
 S $P(^NDFK(5000.992,0),"^",3)=JJJ,$P(^NDFK(5000.992,0),"^",4)=JJJ
"RTN","NDFVUID",84,0)
 Q
"RTN","NDFVUID",85,0)
INDX ; S ^NDFK(5000.992,"F",$P(^PSNDF(50.6,TT,"VUID"),"^"),50.6,TERM,JJJ)="" I $P(^NDFK(5000.992,JJJ,0),"^",6)=DT S DA=TT,DIE="^PSNDF(50.6,",DR="99.98////"_TT,$P(^NDFK(5000.992,JJJ,0),"^",5)=1
"RTN","NDFVUID",86,0)
 Q
"RTN","NDFVUID",87,0)
SAF ; W !,"HERE" F ZZZ=0:0 S ZZZ=$O(^NDFK(5000.992,"F",ZZZ)) Q:'ZZZ  S CNCPT="" F  S CNCPT=$O(^NDFK(5000.992,ZZZ,CNCPT,50.6)) Q:CNCPT=""  S EEE=$O(^NDFK(5000.992,"F",ZZZ,CNCPT,50.6,0)) I $P(^NDFK(5000.992,EEE,0),"^"5)=0 D SAF1
"RTN","NDFVUID",88,0)
 Q
"RTN","NDFVUID",89,0)
SAF1 ; S $P(^PSNDF(50.6,TT,"VUID"),"^",2)=1,^PSNDF(50.6,"AMASTERVUID",1,TT)="",$P(^NDFK(5000.992,JJJ,0),"^",5)=1
"RTN","NDFVUID",90,0)
 Q
"RTN","NDFVUID",91,0)
PFS N ZQ,DA,DIE,DR S ZQ=" " F  S ZQ=$O(^PSNDF(50.68,ZQ),-1) Q:$D(^(ZQ,"PFS"))  S DIE="^PSNDF(50.68,",DA=ZQ,X=600000+DA,DR="2000////"_X_";" D ^DIE
"RTN","NDFVUID",92,0)
 K ZQ,DA,DIR,DR Q
"RTN","NDFVUID",93,0)
FIX ;EXCLUSIONS
"RTN","NDFVUID",94,0)
 S ZQ=0 F  S ZQ=$O(^PSNDF(50.68,ZQ)) Q:'ZQ  I $P($G(^(ZQ,9)),"^")="" S DA=ZQ,DIE="^PSNDF(50.68,",DR="31////0;" D ^DIE
"RTN","NDFVUID",95,0)
 S ZQ=0 F  S ZQ=$O(^PS(50.606,ZQ)) Q:'ZQ  I $P($G(^(ZQ,1)),"^")="" S DA=ZQ,DIE="^PS(50.606,",DR="11////0;" D ^DIE
"RTN","NDFVUID",96,0)
 K ZQ,DA,DIE,DR Q
"RTN","NDFVUID",97,0)
KILL K DATE,DVUID,VUID,I,IEN,JJJ,LL,MAST,NAM,NAME,NME,PP,PSZ,TERM,TT,VUID,ZZZ
"RTN","NDFVUID",98,0)
 Q
"RTN","NDFWARN")
0^55^B2120655
"RTN","NDFWARN",1,0)
NDFWARN ;BIR/DMA-PRINT WARNING LABELS; 16 Jan 2008  12:44 PM ; 16 Jan 2008  12:45 PM
"RTN","NDFWARN",2,0)
 ;;4.0; NDF MANAGEMENT;; 1 Jan 99;Build 1
"RTN","NDFWARN",3,0)
 ;
"RTN","NDFWARN",4,0)
 W ! K %ZIS,IOP,POP,ZTSK S %ZIS="QM" D ^%ZIS I POP G EXIT
"RTN","NDFWARN",5,0)
 ;
"RTN","NDFWARN",6,0)
 R !,"Turn on capture and press return",X:DTIME G EXIT:'$T G EXIT:X["^"
"RTN","NDFWARN",7,0)
 S NA="",CT=0 F  S NA=$O(^PSNDF(50.68,"B",NA)) Q:NA=""  S DA=$O(^(NA,0)),GNSEC=$P($G(^PSNDF(50.68,DA,1)),"^",5) I GNSEC]"" D
"RTN","NDFWARN",8,0)
 .I $O(^PS(50.627,"B",GNSEC,""))]"" W !,NA,"^" S DA1="" F  S DA1=$O(^PS(50.627,"B",GNSEC,DA1)) Q:'DA1  S DA2=$P(^PS(50.627,DA1,0),"^",2)  I DA2]"" S WARN=$O(^PS(50.625,"B",DA2,0)) D
"RTN","NDFWARN",9,0)
 ..;S K=0 F  S K=$O(^PS(50.625,WARN,1,K)) Q:'K  W ?5,^(K,0),!
"RTN","NDFWARN",10,0)
 ..W DA2,"^"
"RTN","NDFWARN",11,0)
 R !!,"Turn off capture and press return",X,!!
"RTN","NDFWARN",12,0)
EXIT ;
"RTN","NDFWARN",13,0)
 I IO'=IO(0) D ^%ZISC
"RTN","NDFWARN",14,0)
 Q
"SEC","^DIC",5000,5000,0,"AUDIT")
@
"SEC","^DIC",5000,5000,0,"DD")
@
"SEC","^DIC",5000,5000,0,"DEL")
@
"SEC","^DIC",5000,5000,0,"LAYGO")
@
"SEC","^DIC",5000,5000,0,"RD")
@
"SEC","^DIC",5000,5000,0,"WR")
@
"SEC","^DIC",5000.1,5000.1,0,"AUDIT")
@
"SEC","^DIC",5000.1,5000.1,0,"DD")
@
"SEC","^DIC",5000.1,5000.1,0,"DEL")
@
"SEC","^DIC",5000.1,5000.1,0,"LAYGO")
@
"SEC","^DIC",5000.1,5000.1,0,"RD")
@
"SEC","^DIC",5000.1,5000.1,0,"WR")
@
"SEC","^DIC",5000.2,5000.2,0,"AUDIT")
@
"SEC","^DIC",5000.2,5000.2,0,"DD")
@
"SEC","^DIC",5000.2,5000.2,0,"DEL")
@
"SEC","^DIC",5000.2,5000.2,0,"LAYGO")
@
"SEC","^DIC",5000.2,5000.2,0,"RD")
@
"SEC","^DIC",5000.2,5000.2,0,"WR")
@
"SEC","^DIC",5000.23,5000.23,0,"AUDIT")
@
"SEC","^DIC",5000.23,5000.23,0,"DD")
@
"SEC","^DIC",5000.23,5000.23,0,"DEL")
@
"SEC","^DIC",5000.23,5000.23,0,"LAYGO")
@
"SEC","^DIC",5000.23,5000.23,0,"RD")
@
"SEC","^DIC",5000.23,5000.23,0,"WR")
@
"SEC","^DIC",5000.3,5000.3,0,"AUDIT")
@
"SEC","^DIC",5000.3,5000.3,0,"DD")
@
"SEC","^DIC",5000.3,5000.3,0,"DEL")
@
"SEC","^DIC",5000.3,5000.3,0,"LAYGO")
@
"SEC","^DIC",5000.3,5000.3,0,"RD")
@
"SEC","^DIC",5000.3,5000.3,0,"WR")
@
"SEC","^DIC",5000.56,5000.56,0,"AUDIT")
@
"SEC","^DIC",5000.56,5000.56,0,"DD")
@
"SEC","^DIC",5000.56,5000.56,0,"DEL")
@
"SEC","^DIC",5000.56,5000.56,0,"LAYGO")
@
"SEC","^DIC",5000.56,5000.56,0,"RD")
@
"SEC","^DIC",5000.56,5000.56,0,"WR")
@
"SEC","^DIC",5000.6,5000.6,0,"AUDIT")
@
"SEC","^DIC",5000.6,5000.6,0,"DD")
@
"SEC","^DIC",5000.6,5000.6,0,"DEL")
@
"SEC","^DIC",5000.6,5000.6,0,"LAYGO")
@
"SEC","^DIC",5000.6,5000.6,0,"RD")
@
"SEC","^DIC",5000.6,5000.6,0,"WR")
@
"SEC","^DIC",5000.608,5000.608,0,"AUDIT")
@
"SEC","^DIC",5000.608,5000.608,0,"DD")
@
"SEC","^DIC",5000.608,5000.608,0,"DEL")
@
"SEC","^DIC",5000.608,5000.608,0,"LAYGO")
@
"SEC","^DIC",5000.608,5000.608,0,"RD")
@
"SEC","^DIC",5000.608,5000.608,0,"WR")
@
"SEC","^DIC",5000.8,5000.8,0,"AUDIT")
@
"SEC","^DIC",5000.8,5000.8,0,"DD")
@
"SEC","^DIC",5000.8,5000.8,0,"DEL")
@
"SEC","^DIC",5000.8,5000.8,0,"LAYGO")
@
"SEC","^DIC",5000.8,5000.8,0,"RD")
@
"SEC","^DIC",5000.8,5000.8,0,"WR")
@
"SEC","^DIC",5000.91,5000.91,0,"AUDIT")
@
"SEC","^DIC",5000.91,5000.91,0,"DD")
@
"SEC","^DIC",5000.91,5000.91,0,"DEL")
@
"SEC","^DIC",5000.91,5000.91,0,"LAYGO")
@
"SEC","^DIC",5000.91,5000.91,0,"RD")
@
"SEC","^DIC",5000.91,5000.91,0,"WR")
@
"SEC","^DIC",5000.92,5000.92,0,"AUDIT")
@
"SEC","^DIC",5000.92,5000.92,0,"DD")
@
"SEC","^DIC",5000.92,5000.92,0,"DEL")
@
"SEC","^DIC",5000.92,5000.92,0,"LAYGO")
@
"SEC","^DIC",5000.92,5000.92,0,"RD")
@
"SEC","^DIC",5000.92,5000.92,0,"WR")
@
"SEC","^DIC",5000.991,5000.991,0,"AUDIT")
@
"SEC","^DIC",5000.991,5000.991,0,"DD")
@
"SEC","^DIC",5000.991,5000.991,0,"DEL")
@
"SEC","^DIC",5000.991,5000.991,0,"LAYGO")
@
"SEC","^DIC",5000.991,5000.991,0,"RD")
@
"SEC","^DIC",5000.991,5000.991,0,"WR")
@
"SEC","^DIC",5000.992,5000.992,0,"AUDIT")
@
"SEC","^DIC",5000.992,5000.992,0,"DD")
@
"SEC","^DIC",5000.992,5000.992,0,"DEL")
@
"SEC","^DIC",5000.992,5000.992,0,"LAYGO")
@
"SEC","^DIC",5000.992,5000.992,0,"RD")
@
"SEC","^DIC",5000.992,5000.992,0,"WR")
@
"VER")
8.0^22.0
"^DD",5000,5000,0)
FIELD^^7^10
"^DD",5000,5000,0,"DT")
3041207
"^DD",5000,5000,0,"IX","B",5000,.01)

"^DD",5000,5000,0,"NM","UPDATE CONTROL")

"^DD",5000,5000,.01,0)
NAMESPACE^RF^^0;1^K:$L(X)>4!($L(X)<2)!'(X'?1P.E) X
"^DD",5000,5000,.01,1,0)
^.1
"^DD",5000,5000,.01,1,1,0)
5000^B
"^DD",5000,5000,.01,1,1,1)
S ^NDFK(5000,"B",$E(X,1,30),DA)=""
"^DD",5000,5000,.01,1,1,2)
K ^NDFK(5000,"B",$E(X,1,30),DA)
"^DD",5000,5000,.01,3)
Answer must be 2-4 characters in length.
"^DD",5000,5000,.01,21,0)
^^2^2^2960521^
"^DD",5000,5000,.01,21,1,0)
The namespace of the system responsible for updating a national
"^DD",5000,5000,.01,21,2,0)
data base.
"^DD",5000,5000,.01,"DT")
2960521
"^DD",5000,5000,.02,0)
MAIL GROUP^F^^0;2^K:$L(X)>25!($L(X)<1) X
"^DD",5000,5000,.02,3)
Answer must be 1-25 characters in length.
"^DD",5000,5000,.02,21,0)
^^2^2^2960521^
"^DD",5000,5000,.02,21,1,0)
The name of a mail group to receive messages at the remote site
"^DD",5000,5000,.02,21,2,0)
when this data base is updated.
"^DD",5000,5000,.02,"DT")
2960521
"^DD",5000,5000,.03,0)
LAST WORD PROCESSING^NJ6,0^^0;3^K:+X'=X!(X>100000)!(X<1)!(X?.E1"."1N.N) X
"^DD",5000,5000,.03,3)
Type a Number between 1 and 100000, 0 Decimal Digits
"^DD",5000,5000,.03,21,0)
^^3^3^2960523^
"^DD",5000,5000,.03,21,1,0)
The last entry in the WORD PROCESSING FIELDS sub-file that was
"^DD",5000,5000,.03,21,2,0)
transported.  Entries are mad in this field by the application
"^DD",5000,5000,.03,21,3,0)
and should not be edited by using VA FileManager.
"^DD",5000,5000,.03,"DT")
2960523
"^DD",5000,5000,1,0)
FILE^5000.001P^^1;0
"^DD",5000,5000,2,0)
MESSAGE^5000.002^^2;0
"^DD",5000,5000,3,0)
WORD PROCESSING FIELDS^5000.003A^^4;0
"^DD",5000,5000,4,0)
PRE-PRE-TRANSPORT ROUTINE^F^^PRE;E1,17^K:$L(X)>17!($L(X)<1) X
"^DD",5000,5000,4,3)
Answer must be 1-17 characters in length.
"^DD",5000,5000,4,21,0)
^^7^7^2970226^^
"^DD",5000,5000,4,21,1,0)
The pre-transport routine gathers data from the VA FileMan audit
"^DD",5000,5000,4,21,2,0)
file and from this file.  If an application specific routine must
"^DD",5000,5000,4,21,3,0)
be run to load data (like a mail message) into this file, the
"^DD",5000,5000,4,21,4,0)
name of the routine (with an optional entry point) should be
"^DD",5000,5000,4,21,5,0)
entered here.
"^DD",5000,5000,4,21,6,0)
 
"^DD",5000,5000,4,21,7,0)
Entry should be of the form [lineref^]routine
"^DD",5000,5000,4,"DT")
2970226
"^DD",5000,5000,5,0)
POST-POST-INSTALL ROUTINE^F^^POST;E1,17^K:$L(X)>17!($L(X)<1) X
"^DD",5000,5000,5,3)
Answer must be 1-17 characters in length.
"^DD",5000,5000,5,21,0)
^^4^4^2970304^
"^DD",5000,5000,5,21,1,0)
The post-install routine runs from data in the transpost global.  If
"^DD",5000,5000,5,21,2,0)
additional package specific things should be done after the post-install,
"^DD",5000,5000,5,21,3,0)
they can be included in a routine named here.  The entry should be of
"^DD",5000,5000,5,21,4,0)
the form [lineref^]routine.
"^DD",5000,5000,5,"DT")
2970304
"^DD",5000,5000,6,0)
SECOND MESSAGE^5000.06^^3;0
"^DD",5000,5000,7,0)
PATCH^5000.07^^5;0
"^DD",5000,5000.001,0)
FILE SUB-FIELD^^2^3
"^DD",5000,5000.001,0,"DT")
3041207
"^DD",5000,5000.001,0,"IX","B",5000.001,.01)

"^DD",5000,5000.001,0,"NM","FILE")

"^DD",5000,5000.001,0,"UP")
5000
"^DD",5000,5000.001,.01,0)
FILE^MP1'X^DIC(^0;1^S DINUM=X
"^DD",5000,5000.001,.01,1,0)
^.1
"^DD",5000,5000.001,.01,1,1,0)
5000.001^B
"^DD",5000,5000.001,.01,1,1,1)
S ^NDFK(5000,DA(1),1,"B",$E(X,1,30),DA)=""
"^DD",5000,5000.001,.01,1,1,2)
K ^NDFK(5000,DA(1),1,"B",$E(X,1,30),DA)
"^DD",5000,5000.001,.01,21,0)
^^2^2^2960522^
"^DD",5000,5000.001,.01,21,1,0)
This is a list of the files to be updated by this system.  All fields
"^DD",5000,5000.001,.01,21,2,0)
in each of these files which are audited will be updated.
"^DD",5000,5000.001,.01,"DT")
2960523
"^DD",5000,5000.001,1,0)
LAST AUDIT ENTRY^NJ7,0^^0;2^K:+X'=X!(X>9999999)!(X<0)!(X?.E1"."1N.N) X
"^DD",5000,5000.001,1,3)
Type a Number between 0 and 9999999, 0 Decimal Digits
"^DD",5000,5000.001,1,21,0)
^.001^4^4^3041207^^^^
"^DD",5000,5000.001,1,21,1,0)
This is the last entry in the audit file for this file which was
"^DD",5000,5000.001,1,21,2,0)
sent.  Entries in this field are made by the application at the
"^DD",5000,5000.001,1,21,3,0)
time the data is transported and should not be edited by using
"^DD",5000,5000.001,1,21,4,0)
VA FileManager.
"^DD",5000,5000.001,1,23,0)
^.001^1^1^3041207^^^
"^DD",5000,5000.001,1,23,1,0)
 
"^DD",5000,5000.001,1,"DT")
3041207
"^DD",5000,5000.001,2,0)
LAST EXTRA ENTRY^NJ6,0X^^0;3^K:+X'=X!(X>100000)!(X<0)!(X?.E1"."1N.N) X
"^DD",5000,5000.001,2,3)
Type a Number between 0 and 100000, 0 Decimal Digits
"^DD",5000,5000.001,2,21,0)
^^4^4^2960522^
"^DD",5000,5000.001,2,21,1,0)
This is the last entry in the extra audit file for this file that
"^DD",5000,5000.001,2,21,2,0)
was sent.  Entries in this field are made by the application at the
"^DD",5000,5000.001,2,21,3,0)
time the data is transported and should not be edited by using
"^DD",5000,5000.001,2,21,4,0)
VA FileMan.
"^DD",5000,5000.001,2,"DT")
2960523
"^DD",5000,5000.002,0)
MESSAGE SUB-FIELD^^.01^1
"^DD",5000,5000.002,0,"NM","MESSAGE")

"^DD",5000,5000.002,0,"UP")
5000
"^DD",5000,5000.002,.01,0)
MESSAGE^W^^0;1^Q
"^DD",5000,5000.002,.01,21,0)
^^2^2^2960522^
"^DD",5000,5000.002,.01,21,1,0)
This is the message that will be sent to a mail group at the site
"^DD",5000,5000.002,.01,21,2,0)
when the data update is transported.
"^DD",5000,5000.002,.01,"DT")
2960522
"^DD",5000,5000.003,0)
WORD PROCESSING FIELDS SUB-FIELD^^.01^1
"^DD",5000,5000.003,0,"IX","B",5000.003,.01)

"^DD",5000,5000.003,0,"NM","WORD PROCESSING FIELDS")

"^DD",5000,5000.003,0,"UP")
5000
"^DD",5000,5000.003,.01,0)
WORD PROCESSING FIELDS^F^^0;1^K:$L(X)>50!($L(X)<2) X
"^DD",5000,5000.003,.01,1,0)
^.1
"^DD",5000,5000.003,.01,1,1,0)
5000.003^B
"^DD",5000,5000.003,.01,1,1,1)
S ^NDFK(5000,DA(1),4,"B",$E(X,1,30),DA)=""
"^DD",5000,5000.003,.01,1,1,2)
K ^NDFK(5000,DA(1),4,"B",$E(X,1,30),DA)
"^DD",5000,5000.003,.01,3)
Answer must be 2-50 characters in length.
"^DD",5000,5000.003,.01,21,0)
^^2^2^2981123^^^^
"^DD",5000,5000.003,.01,21,1,0)
The list of word processing fields to be updated.  Expressed as a
"^DD",5000,5000.003,.01,21,2,0)
full, closed global root (without the up-arrow) eg PSPPI(17,1)
"^DD",5000,5000.003,.01,23,0)
^^3^3^2981123^^^^
"^DD",5000,5000.003,.01,23,1,0)
Entries should be made by the process which updates word processing
"^DD",5000,5000.003,.01,23,2,0)
fields in a national data base.  Entries should be the full, closed
"^DD",5000,5000.003,.01,23,3,0)
global root (without the up-arrow) of the word processing field.
"^DD",5000,5000.003,.01,"DT")
2960523
"^DD",5000,5000.06,0)
SECOND MESSAGE SUB-FIELD^^.01^1
"^DD",5000,5000.06,0,"DT")
3010607
"^DD",5000,5000.06,0,"NM","SECOND MESSAGE")

"^DD",5000,5000.06,0,"UP")
5000
"^DD",5000,5000.06,.01,0)
SECOND MESSAGE^W^^0;1^Q
"^DD",5000,5000.06,.01,"DT")
3010607
"^DD",5000,5000.07,0)
PATCH SUB-FIELD^^2^3
"^DD",5000,5000.07,0,"DT")
3040322
"^DD",5000,5000.07,0,"NM","PATCH")

"^DD",5000,5000.07,0,"UP")
5000
"^DD",5000,5000.07,.01,0)
PATCH^NJ4,0X^^0;1^K:+X'=X!(X>1000)!(X<1)!(X?.E1"."1N.N) X S DINUM=X
"^DD",5000,5000.07,.01,1,0)
^.1^^0
"^DD",5000,5000.07,.01,3)
Type a Number between 1 and 1000, 0 Decimal Digits
"^DD",5000,5000.07,.01,"DT")
3040322
"^DD",5000,5000.07,1,0)
DATE^D^^0;2^S %DT="ESTXR" D ^%DT S X=Y K:Y<1 X
"^DD",5000,5000.07,1,"DT")
3040322
"^DD",5000,5000.07,2,0)
USER^P200'^VA(200,^0;3^Q
"^DD",5000,5000.07,2,"DT")
3040322
"^DD",5000.1,5000.1,0)
FIELD^^3.2^13
"^DD",5000.1,5000.1,0,"ID","WRITE")
N % S %=$P(^(0),U,2) D EN^DDIOL("   "_$E(%,4,5)_"-"_$E(%,6,7)_"-"_$E(%,2,3)_"@"_$E($P(%_"0000",".",2),1,4),"","?0")
"^DD",5000.1,5000.1,0,"IX","B",5000.1,.01)

"^DD",5000.1,5000.1,0,"IX","C",5000.1,.02)

"^DD",5000.1,5000.1,0,"IX","D",5000.1,.04)

"^DD",5000.1,5000.1,0,"NM","EXTRA AUDIT")

"^DD",5000.1,5000.1,.001,0)
NUMBER^NJ7,0^^ ^K:+X'=X!(X<1)!(X?.E1"."1N.N) X
"^DD",5000.1,5000.1,.001,3)
A whole number greater than 1.
"^DD",5000.1,5000.1,.01,0)
INTERNAL ENTRY NUMBER^RF^^0;1^K:X[""""!($A(X)=45) X I $D(X) K:$L(X)>16!($L(X)<1)!'(X'?1P.E) X
"^DD",5000.1,5000.1,.01,.1)
The Internal Number of the Entry that has been audited.
"^DD",5000.1,5000.1,.01,1,0)
^.1
"^DD",5000.1,5000.1,.01,1,1,0)
5000.1^B
"^DD",5000.1,5000.1,.01,1,1,1)
S ^NDFK(5000.1,DIA,"B",$E(X,1,30),DA)=""
"^DD",5000.1,5000.1,.01,1,1,2)
K ^NDFK(5000.1,DIA,"B",$E(X,1,30),DA)
"^DD",5000.1,5000.1,.01,3)
ANSWER MUST BE 1-16 CHARACTERS IN LENGTH
"^DD",5000.1,5000.1,.02,0)
DATE/TIME RECORDED^RD^^0;2^S %DT="ETXR" D ^%DT S X=Y K:Y<1 X
"^DD",5000.1,5000.1,.02,1,0)
^.1
"^DD",5000.1,5000.1,.02,1,1,0)
5000.1^C
"^DD",5000.1,5000.1,.02,1,1,1)
S ^NDFK(5000.1,DIA,"C",$E(X,1,30),DA)=""
"^DD",5000.1,5000.1,.02,1,1,2)
K ^NDFK(5000.1,DIA,"C",$E(X,1,30),DA)
"^DD",5000.1,5000.1,.03,0)
FIELD NUMBER^RF^^0;3^K:$L(X)>10!$L(X)<1) X
"^DD",5000.1,5000.1,.03,3)
The number of the field that was audited.
"^DD",5000.1,5000.1,.04,0)
USER^RP200'^VA(200,^0;4^Q
"^DD",5000.1,5000.1,.04,1,0)
^.1
"^DD",5000.1,5000.1,.04,1,1,0)
5000.1^D
"^DD",5000.1,5000.1,.04,1,1,1)
S ^NDFK(5000.1,DIA,"D",$E(X,1,30),DA)=""
"^DD",5000.1,5000.1,.04,1,1,2)
K ^NDFK(5000.1,DIA,"D",$E(X,1,30),DA)
"^DD",5000.1,5000.1,1,0)
ENTRY NAME^CJ30^^ ; ^S %=^DIC(DIA,0,"GL"),X=^NDFK(5000.1,DIA,D0,0),X=$S($D(@(%_+X_",0)")):$P(^(0),U,1),1:""),C=$S($D(^DD(DIA,.01,0)):$P(^(0),U,2),1:""),Y=X D:Y]"" Y^DIQ:C]"" S X=Y,C=","
"^DD",5000.1,5000.1,1,9)
^
"^DD",5000.1,5000.1,1.1,0)
FIELD NAME^CJ50X^^ ; ^S Y(5000.1,5000.1)=$S($D(^NDFK(5000.1,DIA,D0,0)):$P(^(0),U,3),1:"") X ^DD(5000.1,5000.1,9.2) K Y(5000.1) S X=$E(X,1,$L(X)-1)
"^DD",5000.1,5000.1,1.1,9)
^
"^DD",5000.1,5000.1,1.1,9.2)
X ^DD(5000.1,5000.1,9.3) S X="" F %=1:1:%-1 S X=X_Y(5000.1,%)_","
"^DD",5000.1,5000.1,1.1,9.3)
S X1=DIA F %=1:1 S X=$P(Y(5000.1,5000.1),",",%) Q:X=""  S Y(5000.1,%)=$S($D(^DD(X1,X,0)):$P(^(0),U,1,2),1:"????"),X1=+$P(Y(5000.1,%),U,2),Y(5000.1,%)=$P(Y(5000.1,%),U,1)
"^DD",5000.1,5000.1,2,0)
OLD VALUE^CJ80^^ ; ^S X=$S($D(^NDFK(5000.1,DIA,D0,2)):^(2),1:"<no previous value>")
"^DD",5000.1,5000.1,2,9)
^
"^DD",5000.1,5000.1,2.1,0)
OLD INTERNAL VALUE^F^^2.1;1^K:$L(X)>30 X
"^DD",5000.1,5000.1,2.2,0)
DATATYPE OF OLD VALUE^S^S:SET;P:POINTER;V:VARIABLE POINTER;^2.1;2^Q
"^DD",5000.1,5000.1,3,0)
NEW VALUE^CJ80^^ ; ^S X=$S($D(^NDFK(5000.1,DIA,D0,3)):^(3),1:"<deleted>")
"^DD",5000.1,5000.1,3,9)
^
"^DD",5000.1,5000.1,3.1,0)
NEW INTERNAL VALUE^F^^3.1;1^K:$L(X)>30 X
"^DD",5000.1,5000.1,3.2,0)
DATATYPE OF NEW VALUE^S^S:SET;P:POINTER;V:VARIABLE POINTER;^3.1;2^Q
"^DD",5000.2,5000.2,0)
FIELD^^.01^1
"^DD",5000.2,5000.2,0,"DT")
2980915
"^DD",5000.2,5000.2,0,"IX","B",5000.2,.01)

"^DD",5000.2,5000.2,0,"NM","PRODUCTS TO UNMATCH")

"^DD",5000.2,5000.2,.01,0)
PRODUCT^RP50.68'^PSNDF(50.68,^0;1^Q
"^DD",5000.2,5000.2,.01,1,0)
^.1
"^DD",5000.2,5000.2,.01,1,1,0)
5000.2^B
"^DD",5000.2,5000.2,.01,1,1,1)
S ^NDFK(5000.2,"B",$E(X,1,30),DA)=""
"^DD",5000.2,5000.2,.01,1,1,2)
K ^NDFK(5000.2,"B",$E(X,1,30),DA)
"^DD",5000.2,5000.2,.01,3)

"^DD",5000.2,5000.2,.01,"DT")
2980915
"^DD",5000.23,5000.23,0)
FIELD^^1^2
"^DD",5000.23,5000.23,0,"DT")
3030516
"^DD",5000.23,5000.23,0,"NM","INTERACTION EXCLUSION/INCLUSION")

"^DD",5000.23,5000.23,.01,0)
NAME^RP50.68'X^PSNDF(50.68,^0;1^S DINUM=X
"^DD",5000.23,5000.23,.01,1,0)
^.1^^0
"^DD",5000.23,5000.23,.01,3)

"^DD",5000.23,5000.23,.01,"DT")
3030516
"^DD",5000.23,5000.23,1,0)
EXCLUDE FROM INTERACTION^S^1:YES;^0;2^Q
"^DD",5000.23,5000.23,1,"DT")
3030516
"^DD",5000.3,5000.3,0)
FIELD^^.01^1
"^DD",5000.3,5000.3,0,"DT")
2980924
"^DD",5000.3,5000.3,0,"IX","B",5000.3,.01)

"^DD",5000.3,5000.3,0,"NM","GENERICS TO BE UNMATCHED")

"^DD",5000.3,5000.3,.01,0)
GENERIC^RP50.6'^PSNDF(50.6,^0;1^Q
"^DD",5000.3,5000.3,.01,1,0)
^.1
"^DD",5000.3,5000.3,.01,1,1,0)
5000.3^B
"^DD",5000.3,5000.3,.01,1,1,1)
S ^NDFK(5000.3,"B",$E(X,1,30),DA)=""
"^DD",5000.3,5000.3,.01,1,1,2)
K ^NDFK(5000.3,"B",$E(X,1,30),DA)
"^DD",5000.3,5000.3,.01,3)

"^DD",5000.3,5000.3,.01,"DT")
2980924
"^DD",5000.4,5000.4,0)
FIELD^^.01^1
"^DD",5000.4,5000.4,0,"DT")
3000322
"^DD",5000.4,5000.4,0,"IX","B",5000.4,.01)

"^DD",5000.4,5000.4,0,"NM","STRENGTH CHANGE")

"^DD",5000.4,5000.4,.01,0)
PRODUCT^P50.68'^PSNDF(50.68,^0;1^Q
"^DD",5000.4,5000.4,.01,1,0)
^.1
"^DD",5000.4,5000.4,.01,1,1,0)
5000.4^B
"^DD",5000.4,5000.4,.01,1,1,1)
S ^NDFK(5000.4,"B",$E(X,1,30),DA)=""
"^DD",5000.4,5000.4,.01,1,1,2)
K ^NDFK(5000.4,"B",$E(X,1,30),DA)
"^DD",5000.4,5000.4,.01,3)

"^DD",5000.4,5000.4,.01,"DT")
3000322
"^DD",5000.5,5000.5,0)
FIELD^^.01^1
"^DD",5000.5,5000.5,0,"DT")
3000726
"^DD",5000.5,5000.5,0,"IX","B",5000.5,.01)

"^DD",5000.5,5000.5,0,"NM","INDICATOR CHANGE")

"^DD",5000.5,5000.5,.01,0)
NAME^RP50.68'X^PSNDF(50.68,^0;1^S DINUM=X
"^DD",5000.5,5000.5,.01,1,0)
^.1
"^DD",5000.5,5000.5,.01,1,1,0)
5000.5^B
"^DD",5000.5,5000.5,.01,1,1,1)
S ^NDFK(5000.5,"B",$E(X,1,30),DA)=""
"^DD",5000.5,5000.5,.01,1,1,2)
K ^NDFK(5000.5,"B",$E(X,1,30),DA)
"^DD",5000.5,5000.5,.01,3)

"^DD",5000.5,5000.5,.01,"DT")
3000726
"^DD",5000.506,5000.506,0)
FIELD^^2^3
"^DD",5000.506,5000.506,0,"DT")
2980911
"^DD",5000.506,5000.506,0,"IX","AC",5000.506,1)

"^DD",5000.506,5000.506,0,"IX","B",5000.506,.01)

"^DD",5000.506,5000.506,0,"NM","NEW VA PRODUCT NAMES")

"^DD",5000.506,5000.506,.01,0)
PRODUCT NAME POINTER^RP50.68'^PSNDF(50.68,^0;1^Q
"^DD",5000.506,5000.506,.01,1,0)
^.1
"^DD",5000.506,5000.506,.01,1,1,0)
5000.506^B
"^DD",5000.506,5000.506,.01,1,1,1)
S ^NDFK(5000.506,"B",$E(X,1,30),DA)=""
"^DD",5000.506,5000.506,.01,1,1,2)
K ^NDFK(5000.506,"B",$E(X,1,30),DA)
"^DD",5000.506,5000.506,.01,3)

"^DD",5000.506,5000.506,.01,"DT")
2980911
"^DD",5000.506,5000.506,1,0)
PRODUCT NAME^F^^0;2^K:$L(X)>70!($L(X)<3) X
"^DD",5000.506,5000.506,1,1,0)
^.1
"^DD",5000.506,5000.506,1,1,1,0)
5000.506^AC^MUMPS
"^DD",5000.506,5000.506,1,1,1,1)
S ^NDFK(5000.506,"A",X,DA)=""
"^DD",5000.506,5000.506,1,1,1,2)
K ^NDFK(5000.506,"A",X,DA)
"^DD",5000.506,5000.506,1,1,1,"DT")
2970226
"^DD",5000.506,5000.506,1,3)
Answer must be 3-70 characters in length.
"^DD",5000.506,5000.506,1,"DT")
2970226
"^DD",5000.506,5000.506,2,0)
NDC INFO^5000.5062A^^1;0
"^DD",5000.506,5000.5062,0)
NDC INFO SUB-FIELD^^.01^1
"^DD",5000.506,5000.5062,0,"DT")
2970226
"^DD",5000.506,5000.5062,0,"IX","B",5000.5062,.01)

"^DD",5000.506,5000.5062,0,"NM","NDC INFO")

"^DD",5000.506,5000.5062,0,"UP")
5000.506
"^DD",5000.506,5000.5062,.01,0)
NDC INFO^F^^0;1^K:$L(X)>100!($L(X)<1) X
"^DD",5000.506,5000.5062,.01,1,0)
^.1
"^DD",5000.506,5000.5062,.01,1,1,0)
5000.5062^B
"^DD",5000.506,5000.5062,.01,1,1,1)
S ^NDFK(5000.506,DA(1),1,"B",$E(X,1,30),DA)=""
"^DD",5000.506,5000.5062,.01,1,1,2)
K ^NDFK(5000.506,DA(1),1,"B",$E(X,1,30),DA)
"^DD",5000.506,5000.5062,.01,3)
Answer must be 1-100 characters in length.
"^DD",5000.506,5000.5062,.01,21,0)
^^1^1^2970226^
"^DD",5000.506,5000.5062,.01,21,1,0)
The information needed for a new product - NDC, package size, package type
"^DD",5000.506,5000.5062,.01,"DT")
2970226
"^DD",5000.507,5000.507,0)
FIELD^^3^4
"^DD",5000.507,5000.507,0,"DDA")
N
"^DD",5000.507,5000.507,0,"DT")
2980911
"^DD",5000.507,5000.507,0,"IX","A",5000.507,1)

"^DD",5000.507,5000.507,0,"IX","B",5000.507,.01)

"^DD",5000.507,5000.507,0,"NM","PRODUCT NAMES WITH CHANGED CLASS")

"^DD",5000.507,5000.507,.01,0)
PRODUCT NAME POINTER^RP50.68'X^PSNDF(50.68,^0;1^S DINUM=X
"^DD",5000.507,5000.507,.01,1,0)
^.1
"^DD",5000.507,5000.507,.01,1,1,0)
5000.507^B
"^DD",5000.507,5000.507,.01,1,1,1)
S ^NDFK(5000.507,"B",$E(X,1,30),DA)=""
"^DD",5000.507,5000.507,.01,1,1,2)
K ^NDFK(5000.507,"B",$E(X,1,30),DA)
"^DD",5000.507,5000.507,.01,3)

"^DD",5000.507,5000.507,.01,"DT")
3070420
"^DD",5000.507,5000.507,1,0)
PRODUCT NAME^F^^0;2^K:$L(X)>70!($L(X)<1) X
"^DD",5000.507,5000.507,1,1,0)
^.1
"^DD",5000.507,5000.507,1,1,1,0)
5000.507^A^MUMPS
"^DD",5000.507,5000.507,1,1,1,1)
S ^NDFK(5000.507,"A",X,DA)=""
"^DD",5000.507,5000.507,1,1,1,2)
K ^NDFK(5000.507,"A",X,DA)
"^DD",5000.507,5000.507,1,1,1,"DT")
2970226
"^DD",5000.507,5000.507,1,3)
Answer must be 1-70 characters in length.
"^DD",5000.507,5000.507,1,"DT")
2970226
"^DD",5000.507,5000.507,2,0)
OLD CLASS^P50.605'^PS(50.605,^0;3^Q
"^DD",5000.507,5000.507,2,"DT")
2970226
"^DD",5000.507,5000.507,3,0)
NEW CLASS^P50.605'^PS(50.605,^0;4^Q
"^DD",5000.507,5000.507,3,"DT")
2970226
"^DD",5000.508,5000.508,0)
FIELD^^1^2
"^DD",5000.508,5000.508,0,"DT")
2970305
"^DD",5000.508,5000.508,0,"IX","B",5000.508,.01)

"^DD",5000.508,5000.508,0,"NM","INGREDIENTS ADDED")

"^DD",5000.508,5000.508,.01,0)
INGREDIENT^RP50.416'X^PS(50.416,^0;1^S DINUM=X
"^DD",5000.508,5000.508,.01,1,0)
^.1
"^DD",5000.508,5000.508,.01,1,1,0)
5000.508^B
"^DD",5000.508,5000.508,.01,1,1,1)
S ^NDFK(5000.508,"B",$E(X,1,30),DA)=""
"^DD",5000.508,5000.508,.01,1,1,2)
K ^NDFK(5000.508,"B",$E(X,1,30),DA)
"^DD",5000.508,5000.508,.01,3)

"^DD",5000.508,5000.508,.01,21,0)
^^1^1^2970305^^
"^DD",5000.508,5000.508,.01,21,1,0)
The ingredient which was added to a new (or existing) VA product.
"^DD",5000.508,5000.508,.01,"DT")
2970307
"^DD",5000.508,5000.508,1,0)
DRUG IDENTIFIER^5000.5081A^^1;0
"^DD",5000.508,5000.5081,0)
DRUG IDENTIFIER SUB-FIELD^^.01^1
"^DD",5000.508,5000.5081,0,"DT")
2970305
"^DD",5000.508,5000.5081,0,"IX","B",5000.5081,.01)

"^DD",5000.508,5000.5081,0,"NM","DRUG IDENTIFIER")

"^DD",5000.508,5000.5081,0,"UP")
5000.508
"^DD",5000.508,5000.5081,.01,0)
DRUG IDENTIFIER^F^^0;1^K:$L(X)>15!($L(X)<1) X
"^DD",5000.508,5000.5081,.01,1,0)
^.1
"^DD",5000.508,5000.5081,.01,1,1,0)
5000.5081^B
"^DD",5000.508,5000.5081,.01,1,1,1)
S ^NDFK(5000.508,DA(1),1,"B",$E(X,1,30),DA)=""
"^DD",5000.508,5000.5081,.01,1,1,2)
K ^NDFK(5000.508,DA(1),1,"B",$E(X,1,30),DA)
"^DD",5000.508,5000.5081,.01,3)
Answer must be 1-15 characters in length.
"^DD",5000.508,5000.5081,.01,21,0)
^^2^2^2970305^
"^DD",5000.508,5000.5081,.01,21,1,0)
The drug identifier in the form N1AN2 where N1 is the pointer to NDF
"^DD",5000.508,5000.5081,.01,21,2,0)
and N2 is the internal entry of the VA product.
"^DD",5000.508,5000.5081,.01,"DT")
2970305
"^DD",5000.509,5000.509,0)
FIELD^^1^2
"^DD",5000.509,5000.509,0,"DT")
2970305
"^DD",5000.509,5000.509,0,"IX","B",5000.509,.01)

"^DD",5000.509,5000.509,0,"NM","INGREDIENTS DELETED")

"^DD",5000.509,5000.509,.01,0)
INGREDIENT^RP50.416'X^PS(50.416,^0;1^S DINUM=X
"^DD",5000.509,5000.509,.01,1,0)
^.1
"^DD",5000.509,5000.509,.01,1,1,0)
5000.509^B
"^DD",5000.509,5000.509,.01,1,1,1)
S ^NDFK(5000.509,"B",$E(X,1,30),DA)=""
"^DD",5000.509,5000.509,.01,1,1,2)
K ^NDFK(5000.509,"B",$E(X,1,30),DA)
"^DD",5000.509,5000.509,.01,3)

"^DD",5000.509,5000.509,.01,21,0)
^^1^1^2970305^^
"^DD",5000.509,5000.509,.01,21,1,0)
The ingredient which was deleted from a VA product.
"^DD",5000.509,5000.509,.01,"DT")
2970307
"^DD",5000.509,5000.509,1,0)
DRUG IDENTIFIER^5000.5091A^^1;0
"^DD",5000.509,5000.5091,0)
DRUG IDENTIFIER SUB-FIELD^^.01^1
"^DD",5000.509,5000.5091,0,"DT")
2970305
"^DD",5000.509,5000.5091,0,"IX","B",5000.5091,.01)

"^DD",5000.509,5000.5091,0,"NM","DRUG IDENTIFIER")

"^DD",5000.509,5000.5091,0,"UP")
5000.509
"^DD",5000.509,5000.5091,.01,0)
DRUG IDENTIFIER^F^^0;1^K:$L(X)>30!($L(X)<3) X
"^DD",5000.509,5000.5091,.01,1,0)
^.1
"^DD",5000.509,5000.5091,.01,1,1,0)
5000.5091^B
"^DD",5000.509,5000.5091,.01,1,1,1)
S ^NDFK(5000.509,DA(1),1,"B",$E(X,1,30),DA)=""
"^DD",5000.509,5000.5091,.01,1,1,2)
K ^NDFK(5000.509,DA(1),1,"B",$E(X,1,30),DA)
"^DD",5000.509,5000.5091,.01,3)
Answer must be 3-30 characters in length.
"^DD",5000.509,5000.5091,.01,21,0)
^^2^2^2970305^
"^DD",5000.509,5000.5091,.01,21,1,0)
The drug identifier in the form of N1AN2 where N1 is the pointer to
"^DD",5000.509,5000.5091,.01,21,2,0)
NDF and N2 is the internal entry of the VA product.
"^DD",5000.509,5000.5091,.01,"DT")
2970305
"^DD",5000.56,5000.56,0)
FIELD^^1^2
"^DD",5000.56,5000.56,0,"DT")
3010502
"^DD",5000.56,5000.56,0,"NM","NEW INTERACTIONS")

"^DD",5000.56,5000.56,.01,0)
INTERACTION^RP56'X^PS(56,^0;1^S DINUM=X
"^DD",5000.56,5000.56,.01,1,0)
^.1^^0
"^DD",5000.56,5000.56,.01,3)

"^DD",5000.56,5000.56,.01,"DT")
2990113
"^DD",5000.56,5000.56,1,0)
A/E/I^S^A:ADD;E:EDIT;I:INACTIVATED;^0;2^Q
"^DD",5000.56,5000.56,1,21,0)
^^2^2^3010502^
"^DD",5000.56,5000.56,1,21,1,0)
A if a new interaction is added, E if it has been edited, I if it has
"^DD",5000.56,5000.56,1,21,2,0)
been inactivated
"^DD",5000.56,5000.56,1,"DT")
3010502
"^DD",5000.6,5000.6,0)
FIELD^^1^2
"^DD",5000.6,5000.6,0,"DDA")
N
"^DD",5000.6,5000.6,0,"DT")
2990202
"^DD",5000.6,5000.6,0,"NM","PMI UPDATE LOG")

"^DD",5000.6,5000.6,.01,0)
VA PRODUCT NAME^RP50.68X^PSNDF(50.68,^0;1^S DINUM=X Q
"^DD",5000.6,5000.6,.01,1,0)
^.1^^0
"^DD",5000.6,5000.6,.01,3)
Enter the VA Product Name.
"^DD",5000.6,5000.6,.01,21,0)
^^3^3^2990202^
"^DD",5000.6,5000.6,.01,21,1,0)
This is the VA Product entry that has had a change to it's link
"^DD",5000.6,5000.6,.01,21,2,0)
to the Patient Medication Information Sheets. This entry may be
"^DD",5000.6,5000.6,.01,21,3,0)
recently linked or have had an existing link deleted.
"^DD",5000.6,5000.6,.01,"DT")
2990202
"^DD",5000.6,5000.6,1,0)
PMI^P54.7'^PSPPI(^0;2^Q
"^DD",5000.6,5000.6,1,3)
Enter the PMI that this VA Product is linked to.
"^DD",5000.6,5000.6,1,21,0)
^^3^3^2990202^
"^DD",5000.6,5000.6,1,21,1,0)
This is the PMI which the VA Product is linked to.  If there is an 
"^DD",5000.6,5000.6,1,21,2,0)
entry in this file without the PMI field entered, the PMI for this
"^DD",5000.6,5000.6,1,21,3,0)
VA Product has been deleted.
"^DD",5000.6,5000.6,1,"DT")
2990202
"^DD",5000.608,5000.608,0)
FIELD^^2^3
"^DD",5000.608,5000.608,0,"DT")
3081001
"^DD",5000.608,5000.608,0,"NM","OVERRIDE CHANGES")

"^DD",5000.608,5000.608,.01,0)
PRODUCT^RP50.68'X^PSNDF(50.68,^0;1^S DINUM=X Q
"^DD",5000.608,5000.608,.01,1,0)
^.1^^0
"^DD",5000.608,5000.608,.01,3)

"^DD",5000.608,5000.608,.01,23,0)
^^1^1^3081001^
"^DD",5000.608,5000.608,.01,23,1,0)
 
"^DD",5000.608,5000.608,.01,"DT")
3081001
"^DD",5000.608,5000.608,1,0)
OLD OVERRIDE^S^1:YES;0:NO;^0;2^Q
"^DD",5000.608,5000.608,1,"DT")
3081001
"^DD",5000.608,5000.608,2,0)
NEEW OVERRIDE^S^1:YES;0:NO;^0;3^Q
"^DD",5000.608,5000.608,2,"DT")
3081001
"^DD",5000.7,5000.7,0)
FIELD^^.01^1
"^DD",5000.7,5000.7,0,"IX","B",5000.7,.01)

"^DD",5000.7,5000.7,0,"NM","UNMARKED FOR CMOP")

"^DD",5000.7,5000.7,.01,0)
DRUG^RP50.68'X^PSNDF(50.68,^0;1^S DIMUN=X
"^DD",5000.7,5000.7,.01,1,0)
^.1
"^DD",5000.7,5000.7,.01,1,1,0)
5000.7^B
"^DD",5000.7,5000.7,.01,1,1,1)
S ^NDFK(5000.7,"B",$E(X,1,30),DA)=""
"^DD",5000.7,5000.7,.01,1,1,2)
K ^NDFK(5000.7,"B",$E(X,1,30),DA)
"^DD",5000.7,5000.7,.01,3)

"^DD",5000.7,5000.7,.01,"DT")
3000922
"^DD",5000.8,5000.8,0)
FIELD^^4^5
"^DD",5000.8,5000.8,0,"DT")
3080806
"^DD",5000.8,5000.8,0,"IX","B",5000.8,.01)

"^DD",5000.8,5000.8,0,"NM","CLASS CHANGES")

"^DD",5000.8,5000.8,.01,0)
NAME^RP50.68'X^PSNDF(50.68,^0;1^S DINUM=X
"^DD",5000.8,5000.8,.01,1,0)
^.1
"^DD",5000.8,5000.8,.01,1,1,0)
5000.8^B
"^DD",5000.8,5000.8,.01,1,1,1)
S ^NDFK(5000.8,"B",$E(X,1,30),DA)=""
"^DD",5000.8,5000.8,.01,1,1,2)
K ^NDFK(5000.8,"B",$E(X,1,30),DA)
"^DD",5000.8,5000.8,.01,3)

"^DD",5000.8,5000.8,.01,"DT")
3001016
"^DD",5000.8,5000.8,1,0)
OLD CLASS^P50.605'^PS(50.605,^0;2^Q
"^DD",5000.8,5000.8,1,"DT")
3001016
"^DD",5000.8,5000.8,2,0)
NEW CLASS^P50.605'^PS(50.605,^0;3^Q
"^DD",5000.8,5000.8,2,"DT")
3001016
"^DD",5000.8,5000.8,3,0)
GENERIC^P50.6'^PSNDF(50.6,^0;4^Q
"^DD",5000.8,5000.8,3,"DT")
3080806
"^DD",5000.8,5000.8,4,0)
GENERIC NAME^F^^0;5^K:$L(X)>64!($L(X)<3) X
"^DD",5000.8,5000.8,4,3)
Answer must be 3-64 characters in length.
"^DD",5000.8,5000.8,4,21,0)
^^1^1^3080806^
"^DD",5000.8,5000.8,4,21,1,0)
 
"^DD",5000.8,5000.8,4,"DT")
3080806
"^DD",5000.9,5000.9,0)
FIELD^^.01^1
"^DD",5000.9,5000.9,0,"DT")
3020301
"^DD",5000.9,5000.9,0,"IX","B",5000.9,.01)

"^DD",5000.9,5000.9,0,"NM","PRODUCTS WITH SCHEDULE CHANGE")

"^DD",5000.9,5000.9,.01,0)
NAME^RP50.68'X^PSNDF(50.68,^0;1^S DINUM=X
"^DD",5000.9,5000.9,.01,1,0)
^.1
"^DD",5000.9,5000.9,.01,1,1,0)
5000.9^B
"^DD",5000.9,5000.9,.01,1,1,1)
S ^NDFK(5000.9,"B",$E(X,1,30),DA)=""
"^DD",5000.9,5000.9,.01,1,1,2)
K ^NDFK(5000.9,"B",$E(X,1,30),DA)
"^DD",5000.9,5000.9,.01,3)

"^DD",5000.9,5000.9,.01,"DT")
3020301
"^DD",5000.91,5000.91,0)
FIELD^^1^2
"^DD",5000.91,5000.91,0,"DT")
3100122
"^DD",5000.91,5000.91,0,"IX","B",5000.91,.01)

"^DD",5000.91,5000.91,0,"NM","MED GUIDE CHANGES")

"^DD",5000.91,5000.91,.01,0)
NAME^RNJ6,0^^0;1^K:+X'=X!(X>999999)!(X<1)!(X?.E1"."1N.N) X
"^DD",5000.91,5000.91,.01,1,0)
^.1
"^DD",5000.91,5000.91,.01,1,1,0)
5000.91^B
"^DD",5000.91,5000.91,.01,1,1,1)
S ^NDFK(5000.91,"B",$E(X,1,30),DA)=""
"^DD",5000.91,5000.91,.01,1,1,2)
K ^NDFK(5000.91,"B",$E(X,1,30),DA)
"^DD",5000.91,5000.91,.01,3)
Type a number between 1 and 999999, 0 decimal digits.
"^DD",5000.91,5000.91,.01,21,0)
^.001^1^1^3100121^^
"^DD",5000.91,5000.91,.01,21,1,0)
 
"^DD",5000.91,5000.91,.01,23,0)
^.001^1^1^3100121^^
"^DD",5000.91,5000.91,.01,23,1,0)
 
"^DD",5000.91,5000.91,.01,"DT")
3100121
"^DD",5000.91,5000.91,1,0)
ADD,DELETE,EDIT^S^A:ADD;D:DELET;E:EDIT;^0;2^Q
"^DD",5000.91,5000.91,1,21,0)
^^1^1^3100122^
"^DD",5000.91,5000.91,1,21,1,0)
 
"^DD",5000.91,5000.91,1,"DT")
3100122
"^DD",5000.92,5000.92,0)
FIELD^^.01^1
"^DD",5000.92,5000.92,0,"DDA")
N
"^DD",5000.92,5000.92,0,"DT")
3100623
"^DD",5000.92,5000.92,0,"IX","B",5000.92,.01)

"^DD",5000.92,5000.92,0,"NM","POSSIBLE DOSAGE SETTING CHANGES")

"^DD",5000.92,5000.92,0,"VRPK")
NDF
"^DD",5000.92,5000.92,.01,0)
VA PRODUCT^RP50.68'^PSNDF(50.68,^0;1^Q
"^DD",5000.92,5000.92,.01,1,0)
^.1
"^DD",5000.92,5000.92,.01,1,1,0)
5000.92^B
"^DD",5000.92,5000.92,.01,1,1,1)
S ^NDFK(5000.92,"B",$E(X,1,30),DA)=""
"^DD",5000.92,5000.92,.01,1,1,2)
K ^NDFK(5000.92,"B",$E(X,1,30),DA)
"^DD",5000.92,5000.92,.01,3)
NAME MUST BE 3-30 CHARACTERS, NOT NUMERIC OR STARTING WITH PUNCTUATION
"^DD",5000.92,5000.92,.01,21,0)
^^1^1^3100623^
"^DD",5000.92,5000.92,.01,21,1,0)
Indicate the VA PRODUCT that had the Possible Dosage setting changed.
"^DD",5000.92,5000.92,.01,23,0)
^^2^2^3100623^
"^DD",5000.92,5000.92,.01,23,1,0)
This field indicate the VA PRODUCT entry that had the Possible Dosage 
"^DD",5000.92,5000.92,.01,23,2,0)
settings changed.
"^DD",5000.92,5000.92,.01,"DT")
3100623
"^DD",5000.991,5000.991,0)
FIELD^^2^3
"^DD",5000.991,5000.991,0,"DT")
3041215
"^DD",5000.991,5000.991,0,"IX","B",5000.991,.01)

"^DD",5000.991,5000.991,0,"NM","DATA FOR VUID")

"^DD",5000.991,5000.991,.01,0)
NAME^RFX^^0;1^S DINUM=1
"^DD",5000.991,5000.991,.01,1,0)
^.1
"^DD",5000.991,5000.991,.01,1,1,0)
5000.991^B
"^DD",5000.991,5000.991,.01,1,1,1)
S ^NDFK(5000.991,"B",$E(X,1,30),DA)=""
"^DD",5000.991,5000.991,.01,1,1,2)
K ^NDFK(5000.991,"B",$E(X,1,30),DA)
"^DD",5000.991,5000.991,.01,3)
There should only be one entry in this file.
"^DD",5000.991,5000.991,1,0)
LAST NUMBER USED^RNJ7,0^^0;2^K:+X'=X!(X>4500623)!(X<4000624)!(X?.E1"."1N.N) X
"^DD",5000.991,5000.991,1,3)
Type a Number between 4000624 and 4500623, 0 Decimal Digits
"^DD",5000.991,5000.991,1,"DT")
3041117
"^DD",5000.991,5000.991,2,0)
FILE^5000.9912P^^1;0
"^DD",5000.991,5000.9912,0)
FILE SUB-FIELD^^1^2
"^DD",5000.991,5000.9912,0,"DT")
3041215
"^DD",5000.991,5000.9912,0,"IX","B",5000.9912,.01)

"^DD",5000.991,5000.9912,0,"NM","FILE")

"^DD",5000.991,5000.9912,0,"UP")
5000.991
"^DD",5000.991,5000.9912,.01,0)
FILE^MP1X^DIC(^0;1^S DINUM=X
"^DD",5000.991,5000.9912,.01,1,0)
^.1
"^DD",5000.991,5000.9912,.01,1,1,0)
5000.9912^B
"^DD",5000.991,5000.9912,.01,1,1,1)
S ^NDFK(5000.991,DA(1),1,"B",$E(X,1,30),DA)=""
"^DD",5000.991,5000.9912,.01,1,1,2)
K ^NDFK(5000.991,DA(1),1,"B",$E(X,1,30),DA)
"^DD",5000.991,5000.9912,.01,"DT")
3041117
"^DD",5000.991,5000.9912,1,0)
LAST ENTRY ASSIGNED A VUID^NJ6,0^^0;2^K:+X'=X!(X>300000)!(X<1)!(X?.E1"."1N.N) X
"^DD",5000.991,5000.9912,1,3)
Type a Number between 1 and 300000, 0 Decimal Digits
"^DD",5000.991,5000.9912,1,21,0)
^.001^1^1^3041215^^
"^DD",5000.991,5000.9912,1,21,1,0)
 
"^DD",5000.991,5000.9912,1,23,0)
^^1^1^3041215^
"^DD",5000.991,5000.9912,1,23,1,0)
 
"^DD",5000.991,5000.9912,1,"DT")
3041215
"^DD",5000.992,5000.992,0)
FIELD^^5^6
"^DD",5000.992,5000.992,0,"DT")
3050315
"^DD",5000.992,5000.992,0,"IX","B",5000.992,.01)

"^DD",5000.992,5000.992,0,"IX","C",5000.992,3)

"^DD",5000.992,5000.992,0,"NM","VUID MAP")

"^DD",5000.992,5000.992,.01,0)
VUID^RF^^0;1^K:$L(X)>20!($L(X)<1)!'(X'?1P.E) X
"^DD",5000.992,5000.992,.01,1,0)
^.1
"^DD",5000.992,5000.992,.01,1,1,0)
5000.992^B
"^DD",5000.992,5000.992,.01,1,1,1)
S ^NDFK(5000.992,"B",$E(X,1,30),DA)=""
"^DD",5000.992,5000.992,.01,1,1,2)
K ^NDFK(5000.992,"B",$E(X,1,30),DA)
"^DD",5000.992,5000.992,.01,3)
Answer must be 1-20 characters in length.
"^DD",5000.992,5000.992,.01,"DT")
3050228
"^DD",5000.992,5000.992,1,0)
FILE^RF^^0;2^K:$L(X)>30!($L(X)<1) X
"^DD",5000.992,5000.992,1,3)
Answer must be 1-30 characters in length.
"^DD",5000.992,5000.992,1,"DT")
3050228
"^DD",5000.992,5000.992,2,0)
IEN^RF^^0;3^K:$L(X)>30!($L(X)<1) X
"^DD",5000.992,5000.992,2,3)
Answer must be 1-30 characters in length.
"^DD",5000.992,5000.992,2,"DT")
3050228
"^DD",5000.992,5000.992,3,0)
TERM^RF^^0;4^K:$L(X)>64!($L(X)<1) X
"^DD",5000.992,5000.992,3,1,0)
^.1
"^DD",5000.992,5000.992,3,1,1,0)
5000.992^C^MUMPS
"^DD",5000.992,5000.992,3,1,1,1)
S ^NDFK(5000.992,"C",X,DA)=""
"^DD",5000.992,5000.992,3,1,1,2)
K ^NDFK(5000.992,"C",X,DA)
"^DD",5000.992,5000.992,3,1,1,"%D",0)
^^1^1^3051014^
"^DD",5000.992,5000.992,3,1,1,"%D",1,0)
 
"^DD",5000.992,5000.992,3,1,1,"DT")
3051014
"^DD",5000.992,5000.992,3,3)
Answer must be 1-64 characters in length.
"^DD",5000.992,5000.992,3,"DT")
3051014
"^DD",5000.992,5000.992,4,0)
MASTER?^S^1:YES;^0;5^Q
"^DD",5000.992,5000.992,4,"DT")
3050308
"^DD",5000.992,5000.992,5,0)
DATE^D^^0;6^S %DT="EX" D ^%DT S X=Y K:Y<1 X
"^DD",5000.992,5000.992,5,"DT")
3050308
"^DIC",5000,5000,0)
UPDATE CONTROL^5000
"^DIC",5000,5000,0,"GL")
^NDFK(5000,
"^DIC",5000,"B","UPDATE CONTROL",5000)

"^DIC",5000.1,5000.1,0)
EXTRA AUDIT^5000.1
"^DIC",5000.1,5000.1,0,"GL")
^NDFK(5000.1,
"^DIC",5000.1,5000.1,"%D",0)
^^9^9^2960522^^
"^DIC",5000.1,5000.1,"%D",1,0)
This file stores an audit trail of changes made to data fields.
"^DIC",5000.1,5000.1,"%D",2,0)
This file is intended to mimic the VA FileMan audit file and hold
"^DIC",5000.1,5000.1,"%D",3,0)
entries which could not be captured by using the VA FileMan audit
"^DIC",5000.1,5000.1,"%D",4,0)
tools.  This file should be used only as a last resort and entries
"^DIC",5000.1,5000.1,"%D",5,0)
should be made very carefully.  The application does some checking
"^DIC",5000.1,5000.1,"%D",6,0)
for the existence of the field before doing the update, but it has
"^DIC",5000.1,5000.1,"%D",7,0)
no way of determining whether the field being updated is the one
"^DIC",5000.1,5000.1,"%D",8,0)
intended.  Users are most strongly urged to use the VA FileMan
"^DIC",5000.1,5000.1,"%D",9,0)
audit tools and avoid the use of this file if at all possible.
"^DIC",5000.1,"B","EXTRA AUDIT",5000.1)

"^DIC",5000.2,5000.2,0)
PRODUCTS TO UNMATCH^5000.2
"^DIC",5000.2,5000.2,0,"GL")
^NDFK(5000.2,
"^DIC",5000.2,"B","PRODUCTS TO UNMATCH",5000.2)

"^DIC",5000.23,5000.23,0)
INTERACTION EXCLUSION/INCLUSION^5000.23
"^DIC",5000.23,5000.23,0,"GL")
^NDFK(5000.23,
"^DIC",5000.23,"B","INTERACTION EXCLUSION/INCLUSION",5000.23)

"^DIC",5000.3,5000.3,0)
GENERICS TO BE UNMATCHED^5000.3
"^DIC",5000.3,5000.3,0,"GL")
^NDFK(5000.3,
"^DIC",5000.3,"B","GENERICS TO BE UNMATCHED",5000.3)

"^DIC",5000.4,5000.4,0)
STRENGTH CHANGE^5000.4P
"^DIC",5000.4,5000.4,0,"GL")
^NDFK(5000.4,
"^DIC",5000.4,"B","STRENGTH CHANGE",5000.4)

"^DIC",5000.5,5000.5,0)
INDICATOR CHANGE^5000.5P
"^DIC",5000.5,5000.5,0,"GL")
^NDFK(5000.5,
"^DIC",5000.5,"B","INDICATOR CHANGE",5000.5)

"^DIC",5000.506,5000.506,0)
NEW VA PRODUCT NAMES^5000.506P
"^DIC",5000.506,5000.506,0,"GL")
^NDFK(5000.506,
"^DIC",5000.506,5000.506,"%D",0)
^^5^5^2970226^
"^DIC",5000.506,5000.506,"%D",1,0)
Data is entered into this file as new products are created.  The
"^DIC",5000.506,5000.506,"%D",2,0)
NDC INFO is created as new entries using this product name are
"^DIC",5000.506,5000.506,"%D",3,0)
entered into NDF.  Data is taken from this file by the
"^DIC",5000.506,5000.506,"%D",4,0)
pre-transport routine and loaded into the transport global and
"^DIC",5000.506,5000.506,"%D",5,0)
then deleted.
"^DIC",5000.506,"B","NEW VA PRODUCT NAMES",5000.506)

"^DIC",5000.507,5000.507,0)
PRODUCT NAMES WITH CHANGED CLASS^5000.507P
"^DIC",5000.507,5000.507,0,"GL")
^NDFK(5000.507,
"^DIC",5000.507,5000.507,"%D",0)
^^2^2^2970226^
"^DIC",5000.507,5000.507,"%D",1,0)
Data is entered into this file if the VA Class for a VA product
"^DIC",5000.507,5000.507,"%D",2,0)
is changed.
"^DIC",5000.507,"B","PRODUCT NAMES WITH CHANGED CLASS",5000.507)

"^DIC",5000.508,5000.508,0)
INGREDIENTS ADDED^5000.508P
"^DIC",5000.508,5000.508,0,"GL")
^NDFK(5000.508,
"^DIC",5000.508,"B","INGREDIENTS ADDED",5000.508)

"^DIC",5000.509,5000.509,0)
INGREDIENTS DELETED^5000.509P
"^DIC",5000.509,5000.509,0,"GL")
^NDFK(5000.509,
"^DIC",5000.509,"B","INGREDIENTS DELETED",5000.509)

"^DIC",5000.56,5000.56,0)
NEW INTERACTIONS^5000.56
"^DIC",5000.56,5000.56,0,"GL")
^NDFK(5000.56,
"^DIC",5000.56,"B","NEW INTERACTIONS",5000.56)

"^DIC",5000.6,5000.6,0)
PMI UPDATE LOG^5000.6
"^DIC",5000.6,5000.6,0,"GL")
^NDFK(5000.6,
"^DIC",5000.6,5000.6,"%D",0)
^^2^2^2990202^
"^DIC",5000.6,5000.6,"%D",1,0)
This file contains a log of PMI updates made during regularly
"^DIC",5000.6,5000.6,"%D",2,0)
scheduled NDF Update releases.
"^DIC",5000.6,"B","PMI UPDATE LOG",5000.6)

"^DIC",5000.608,5000.608,0)
OVERRIDE CHANGES^5000.608
"^DIC",5000.608,5000.608,0,"GL")
^NDFK(5000.608,
"^DIC",5000.608,"B","OVERRIDE CHANGES",5000.608)

"^DIC",5000.7,5000.7,0)
UNMARKED FOR CMOP^5000.7P
"^DIC",5000.7,5000.7,0,"GL")
^NDFK(5000.7,
"^DIC",5000.7,"B","UNMARKED FOR CMOP",5000.7)

"^DIC",5000.8,5000.8,0)
CLASS CHANGES^5000.8
"^DIC",5000.8,5000.8,0,"GL")
^NDFK(5000.8,
"^DIC",5000.8,"B","CLASS CHANGES",5000.8)

"^DIC",5000.9,5000.9,0)
PRODUCTS WITH SCHEDULE CHANGE^5000.9P
"^DIC",5000.9,5000.9,0,"GL")
^NDFK(5000.9,
"^DIC",5000.9,"B","PRODUCTS WITH SCHEDULE CHANGE",5000.9)

"^DIC",5000.91,5000.91,0)
MED GUIDE CHANGES^5000.91
"^DIC",5000.91,5000.91,0,"GL")
^NDFK(5000.91,
"^DIC",5000.91,"B","MED GUIDE CHANGES",5000.91)

"^DIC",5000.92,5000.92,0)
POSSIBLE DOSAGE SETTING CHANGES^5000.92
"^DIC",5000.92,5000.92,0,"GL")
^NDFK(5000.92,
"^DIC",5000.92,5000.92,"%",0)
^1.005^^0
"^DIC",5000.92,5000.92,"%D",0)
^^11^11^3100623^
"^DIC",5000.92,5000.92,"%D",1,0)
This file is used to keep track of changes to VA Products Possible 
"^DIC",5000.92,5000.92,"%D",2,0)
Dosage settings. The changes will be included in the "Products" message, 
"^DIC",5000.92,5000.92,"%D",3,0)
which is sent out to VA sites via the NDF monthly data updates.
"^DIC",5000.92,5000.92,"%D",4,0)
 
"^DIC",5000.92,5000.92,"%D",5,0)
The following fields on the VA PRODUCT file (50.68) are considered
"^DIC",5000.92,5000.92,"%D",6,0)
for the Possible Dosage settings and any changes to any of these fields 
"^DIC",5000.92,5000.92,"%D",7,0)
are being tracked on this file:
"^DIC",5000.92,5000.92,"%D",8,0)
 
"^DIC",5000.92,5000.92,"%D",9,0)
           CREATE DEFAULT POSSIBLE DOSAGE (#40)
"^DIC",5000.92,5000.92,"%D",10,0)
           POSSIBLE DOSAGES TO CREATE (#41)
"^DIC",5000.92,5000.92,"%D",11,0)
           PACKAGE (#42)
"^DIC",5000.92,"B","POSSIBLE DOSAGE SETTING CHANGES",5000.92)

"^DIC",5000.991,5000.991,0)
DATA FOR VUID^5000.991
"^DIC",5000.991,5000.991,0,"GL")
^NDFK(5000.991,
"^DIC",5000.991,"B","DATA FOR VUID",5000.991)

"^DIC",5000.992,5000.992,0)
VUID MAP^5000.992
"^DIC",5000.992,5000.992,0,"GL")
^NDFK(5000.992,
"^DIC",5000.992,"B","VUID MAP",5000.992)
""
**END**
**END**

